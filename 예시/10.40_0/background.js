import{getLayout,getReviewAnalysis,getReviewAnalysisResult,matchPurchaseOption,startNegotiation,continueNegotiation,translateMessage,formatNegotiationMessage,translateWithContext,processAIRocketRequest,generateCoupangAttributes,generateDetailHtmlContent,extractSizeChartFromImages}from"./dist/gemini.bundle.js";var domain="http://localhost:8080/",auth="";let popupDiv;var goSales=!1,localsuppliercode="",collectRankContinue=!0,sstab=null,bstab=null,errorCnt=0,errorStatus=!1,searchinfo={},redirectTabCalled=!1;const NEGOTIATION_STATUS={READY:"ready",IN_PROGRESS:"in_progress",PAUSED:"paused",COMPLETED:"completed",ERROR:"error"},STORAGE_KEYS={NEGOTIATION_STATE:"negotiationState",CONVERSATION:"couplusNegotiation"},initialState={status:NEGOTIATION_STATUS.READY,isPaused:!1,negotiationStyle:{tone:"professional",language:"formal",priority:"price"},currentSession:null,conversationHistory:[]},ERROR_TYPES={API_ERROR:"api_error",NETWORK_ERROR:"network_error",VALIDATION_ERROR:"validation_error",CHAT_ERROR:"chat_error",UNKNOWN_ERROR:"unknown_error"},StateManager={async getState(){return new Promise(t=>{chrome.storage.local.get(STORAGE_KEYS.NEGOTIATION_STATE,e=>{t(e[STORAGE_KEYS.NEGOTIATION_STATE]||initialState)})})},async setState(t){return new Promise(e=>{chrome.storage.local.set({[STORAGE_KEYS.NEGOTIATION_STATE]:t},()=>{e(t)})})},async updateState(e){var t=await this.getState(),t=this.deepMerge(t,e);return this.setState(t)},deepMerge(e,t){var r={...e};for(const a in t)t[a]instanceof Object&&!Array.isArray(t[a])?r[a]=this.deepMerge(r[a]||{},t[a]):r[a]=t[a];return r},async clearState(){return this.setState(initialState)}},ConversationManager={async getConversation(){return new Promise(t=>{chrome.storage.local.get(STORAGE_KEYS.CONVERSATION,e=>{t(e[STORAGE_KEYS.CONVERSATION]||{conversationHistory:[],geminiApiKey:"",geminiModel:"gemini-2.0-flash"})})})},async setConversation(t){return new Promise(e=>{chrome.storage.local.set({[STORAGE_KEYS.CONVERSATION]:t},()=>{e(t)})})},async updateConversation(e){e={...await this.getConversation(),...e};return this.setConversation(e)}};function navigateTo(e,r=null){return new Promise(n=>{const t=a=>{chrome.scripting.executeScript({target:{tabId:a},world:"MAIN",func:e=>{return{originalUrl:window.location.href,targetUrl:window.location.href=e}},args:[e]},r=>{if(console.log("Execute script results:",r),chrome.runtime.lastError)console.error("Chrome runtime error:",chrome.runtime.lastError),n({success:!1,error:chrome.runtime.lastError.message});else if(r&&0<r.length&&r[0].result){let{originalUrl:e,targetUrl:t}=r[0].result;setTimeout(()=>{chrome.scripting.executeScript({target:{tabId:a},world:"MAIN",func:(e,t)=>({success:window.location.href!==e,currentUrl:window.location.href,targetUrl:t}),args:[e,t]},e=>{e&&0<e.length&&e[0].result?n(e[0].result):n({success:!1,error:"Failed to verify navigation"})})},1e3)}else console.error("Unexpected result structure:",r),n({success:!1,error:"Unknown error occurred"})})};r?t(r):chrome.tabs.query({active:!0,currentWindow:!0},e=>{0<e.length?t(e[0].id):(console.error("No active tab found"),n({success:!1,error:"No active tab found"}))})})}async function getSupplierCodeFromAd(e){if(!e)return null;console.log(e);e=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){return console.log(document.querySelector(".current-advertiser-detail")?.children[0]?.children[1]?.innerText),document.querySelector(".current-advertiser-detail")?.children[0]?.children[1]?.innerText||null}});return console.log(e),e[0].result}async function indexRocketDoc(t){var e=await(await fetch("https://supplier.coupang.com/sr/draft/api/drafts",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json();return e&&e.find(e=>e.docId==t)?e.findIndex(e=>e.docId==t):-1}async function verifyRocketReg(a){var n=await chrome.tabs.query({}),o=n.find(e=>e.active&&e.url&&(e.url.includes("couplus.co.kr")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112"))),e=a.suppliercode,s=n.find(e=>e.url.includes("supplier.coupang.com"));if(s)if(!1===await confirmSupplierCode(e,s)&&"A0000TEST"!==e)chrome.tabs.sendMessage(o.id,{msg:"CoupangRegAlert",res:"íŒë§¤ìì½”ë“œ ì¼ì¹˜ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",suppliercode:e});else{var c=a.delay;console.log("Verify with body:",a.body),updateProgress(o.id,"ê²¬ì ì„œë¥¼ ê²€ì¦í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤."),(void 0!==a.shouldRedirect?a.shouldRedirect:!redirectTabCalled)||"https://supplier.coupang.com/sr/registration/step/startPage"!==s.url?(await redirectTab(s.id,"https://supplier.coupang.com/sr/registration/step/startPage",{selector:".rsfe-section",text:"ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"},!0),console.log("í˜ì´ì§€ ë¡œë”© ëŒ€ê¸° ì¤‘... (6ì´ˆ)"),await sleep(6e3),redirectTabCalled=!0):console.log("í˜ì´ì§€ ë¦¬ë””ë ‰ì…˜ ê±´ë„ˆëœ€ (í›„ì† í•­ëª©)"),console.log("ë¬¸ì„œ ìƒì„± ì‹œì‘...");let e;try{var i=await chrome.scripting.executeScript({target:{tabId:s.id},function:createRocketRegDoc,args:[a.body]});if(e=i[0].result,console.log("ë¬¸ì„œ ìƒì„± ê²°ê³¼:",e),!e||!e.docId)throw new Error("ë¬¸ì„œ ìƒì„± ì‹¤íŒ¨: docIdê°€ ì—†ìŠµë‹ˆë‹¤")}catch(e){return console.error("ë¬¸ì„œ ìƒì„± ì˜¤ë¥˜:",e),void chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:"ë¬¸ì„œ ìƒì„± ì‹¤íŒ¨: "+e.toString(),success:!1,text:"ë¬¸ì„œ ìƒì„± ì˜¤ë¥˜"}})}n=e.docId;console.log("ìƒˆ docId ìƒì„±: "+n),a.body.docId=n;try{var l=await chrome.scripting.executeScript({target:{tabId:s.id},function:updateRocketRegDoc,args:[JSON.stringify(a.body)]}),u=l[0].result;if(console.log("Update Rocket Reg result:",u),"object"==typeof u&&null!==u&&u.errorCode)return void chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:"Supplier Hub ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”",success:!1,docId:n,text:"ë¬¸ì„œ Update ì˜¤ë¥˜"}});if("string"==typeof u&&u.includes("errorCode"))return void chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:"Supplier Hub ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”",success:!1,docId:n,text:"ë¬¸ì„œ Update ì˜¤ë¥˜"}})}catch(e){return console.error("Update execution error:",e),void chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:e.toString(),success:!1,docId:n,text:"ë¬¸ì„œ Update ì‹¤í–‰ ì˜¤ë¥˜"}})}var d={docId:n,version:a.body.version};updateProgress(o.id,"ê²¬ì ì„œë¥¼ ê²€í† í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.");let t=null,r=null;for(var p=null,h=2;h<6;h++){if(await sleep(c),p=(l=await chrome.scripting.executeScript({target:{tabId:s.id},function:confirmRocketRegDoc,args:[JSON.stringify(d),h]}))[0]?.result,console.log("docId",d.docId,"step",h,":",p),p&&200!=p.code){t=p.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",r=h;break}if(p&&200==p.code&&!p.data[0].success){r=(t=p.data[0].errors&&0<p.data[0].errors.length&&p.data[0].errors.map(e=>e.columnName+" : "+e.message).join(", ")||"ê²€ì¦ ì‹¤íŒ¨",h);break}}t?chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:t,success:!1,text:r+"ë‹¨ê³„ ê²€ì¦ ì˜¤ë¥˜",docId:n,errorDetails:t,requestId:a.requestId||a.id}}):(console.log(p),i=(l=await chrome.scripting.executeScript({target:{tabId:s.id},function:indexRocketDoc,args:[d.docId]}))[0].result,console.log("ì¸ë±ìŠ¤ì§„í–‰ê²°ê³¼:",i),0<=i&&p&&200==p.code?(u=(l=await chrome.scripting.executeScript({target:{tabId:s.id},function:regRocketRegDoc,args:[a.body,c,i]}))[0].result,console.log("ë“±ë¡ì§„í–‰ê²°ê³¼:",u),chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:u.error||"",success:u.success,text:u.success?"ìƒí’ˆ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.":"ìƒí’ˆ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",docId:n,errorDetails:u.error||null,requestId:a.requestId||a.id}})):chrome.tabs.sendMessage(o.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:"ê²€ì¦ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",success:!1,docId:n,text:"ê²€ì¦ ì‹¤íŒ¨",requestId:a.requestId||a.id}}),redirectTabCalled=!1)}else chrome.tabs.sendMessage(o.id,{msg:"CoupangRegAlert",res:"ìƒˆíƒ­ì— Supplier Hubì— ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",suppliercode:e})}async function getSizeChartExtraction(t,r){try{console.log("ì‚¬ì´ì¦ˆí‘œ ì¶”ì¶œ ìš”ì²­ ë°›ìŒ:",t);var e=await extractSizeChartFromImages(t,r);return chrome.tabs.sendMessage(r.id,{response:!0,data:{type:"AiRocketRegResult",id:t.id,productId:t.productId,workType:"SIZE_CHART",result:e}}),console.log("ì‚¬ì´ì¦ˆí‘œ ì¶”ì¶œ ê²°ê³¼ ì „ì†¡ ì™„ë£Œ:",e),!0}catch(e){return console.error("ì‚¬ì´ì¦ˆí‘œ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜:",e),chrome.tabs.sendMessage(r.id,{response:!0,data:{type:"AiRocketRegError",id:t.id,workType:"SIZE_CHART",message:e.message||"ì‚¬ì´ì¦ˆí‘œ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"}}),!0}}async function getAITranslation(t,r){try{console.log("AI ë²ˆì—­ ìš”ì²­ ë°›ìŒ:",t),chrome.tabs.sendMessage(r.id,{data:{type:"AiRocketRegProgress",text:"AI ë²ˆì—­ ì²˜ë¦¬ ì¤‘..."}});var a={id:t.id,apiKey:t.apiKey,geminiModel:t.geminiModel||"gemini-2.0-flash",prompt:t.prompt,workType:"AI_TRANSLATE",requestArr:[{prompt:t.prompt}]},n=await processAIRocketRequest(a,r);console.log("[DEBUG] processAIRocketRequest ê²°ê³¼:",n);let e=null;n&&n.result?(e=n.result,console.log("[DEBUG] ì¶”ì¶œëœ ë²ˆì—­ ê²°ê³¼:",e)):console.error("[DEBUG] ê²°ê³¼ì—ì„œ ë²ˆì—­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ"),console.log("[DEBUG] ìµœì¢… ë²ˆì—­ ê²°ê³¼ íƒ€ì…:",typeof e),console.log("[DEBUG] ìµœì¢… ë²ˆì—­ ê²°ê³¼:",e);var o=n?.processedText||null,s=!!e||!!o;return console.log("[DEBUG] ì„±ê³µ ì—¬ë¶€:",s),chrome.tabs.sendMessage(r.id,{response:!0,data:{type:"AI_TRANSLATE_RESPONSE",id:t.id,requestId:t.id,success:s,data:{success:s,translateResult:e||o,originalResponse:o}}}),console.log("[DEBUG] AI ë²ˆì—­ ê²°ê³¼ ì „ì†¡ ì™„ë£Œ:",e||o),!0}catch(e){return console.error("AI ë²ˆì—­ ì¤‘ ì˜¤ë¥˜:",e),chrome.tabs.sendMessage(r.id,{response:!0,data:{type:"AI_TRANSLATE_RESPONSE",id:t.id,requestId:t.id,success:!1,data:{success:!1,error:e.message||"AI ë²ˆì—­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"}}}),!0}}async function getDetailHTMLGenerate(t){console.log("ìƒì„¸ HTML ìƒì„± ìš”ì²­ ìˆ˜ì‹  (ë°±ê·¸ë¼ìš´ë“œ):",t),sendProgressUpdate(t.id,30,"AIì— ë‚´ìš© ìƒì„± ìš”ì²­ ì¤‘..."),generateDetailHtml(t).then(e=>{console.log("Gemini APIë¡œë¶€í„° ê²°ê³¼ ìˆ˜ì‹ :",e),sendProgressUpdate(t.id,80,"HTML ìƒì„± ì™„ë£Œ, ê²°ê³¼ ì „ì†¡ ì¤‘..."),sendResultToContentScript(t,e)}).catch(e=>{console.error("HTML ìƒì„± ì˜¤ë¥˜:",e),sendProgressUpdate(t.id,0,"ì˜¤ë¥˜ ë°œìƒ: "+e.message),sendErrorToContentScript(t,e)})}async function generateDetailHtml(e){return e.textAreas&&0!==e.textAreas.length?(sendProgressUpdate(e.id,40,"Gemini AI ë¶„ì„ ì¤‘..."),await generateDetailHtmlContent(e)):{htmlContent:`<div><img src="${e.imageUrl}" alt="${e.productName}"></div>`,additionalOptions:e.additionalOptions}}function sendProgressUpdate(t,r,a){chrome.tabs.query({active:!0,currentWindow:!0},function(e){e&&e[0]&&chrome.tabs.sendMessage(e[0].id,{action:"updateProgress",data:{id:t,progress:r,message:a}})})}function sendResultToContentScript(t,r){chrome.tabs.query({active:!0,currentWindow:!0},function(e){e&&e[0]&&chrome.tabs.sendMessage(e[0].id,{action:"detailHtmlGenerated",data:{id:t.id,productId:t.productId,result:{batchResults:[{result:{htmlContent:r.htmlContent,imageUrl:t.imageUrl,additionalOptions:r.additionalOptions||t.additionalOptions}}]}}})})}function sendErrorToContentScript(t,r){chrome.tabs.query({active:!0,currentWindow:!0},function(e){e&&e[0]&&chrome.tabs.sendMessage(e[0].id,{action:"detailHtmlGenerated",data:{id:t.id,productId:t.productId,error:r.message,result:{batchResults:[{result:{htmlContent:`<div class="error">ì˜¤ë¥˜: ${r.message}</div>`,imageUrl:t.imageUrl,additionalOptions:t.additionalOptions}}]}}})})}async function getAttributeInfo(e){try{var t;console.log("AiRocketReg ìš”ì²­ì„ gemini.jsë¡œ ì „ë‹¬:",e);const activeTab=(await chrome.tabs.query({})).find(e=>e.active&&(e.url.includes("couplus")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112")));activeTab?(t=await generateCoupangAttributes(e,activeTab),chrome.tabs.sendMessage(activeTab.id,{response:!0,data:{type:"getAttributeInfoResult",...t}})):console.error("í™œì„± íƒ­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")}catch(e){console.error("getAttributeInfo ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:",e),activeTab&&chrome.tabs.sendMessage(activeTab.id,{response:!0,data:{type:"getAttributeInfoResult",error:e.message,status:"error"}})}}async function updateRocketReg(r){var a=await chrome.tabs.query({}),n=a.find(e=>e.active&&e.url&&(e.url.includes("couplus.co.kr")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112"))),e=r.suppliercode,o=a.find(e=>e.url.includes("supplier.coupang.com"));if(o)if(!1===await confirmSupplierCode(e,o)&&"A0000TEST"!==e)chrome.tabs.sendMessage(n.id,{msg:"CoupangRegAlert",res:"íŒë§¤ìì½”ë“œ ì¼ì¹˜ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",suppliercode:e});else{var s=r.delay;console.log("data.body:",r.body),updateProgress(n.id,"ê²¬ì ì„œë¥¼ supplierì— ì—…ë°ì´íŠ¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤."),await sleep(s);a=(await chrome.scripting.executeScript({target:{tabId:o.id},function:updateRocketRegDoc,args:[JSON.stringify(r.body)]}))[0].result;if(console.log(a),a.includes("errorCode")&&(await redirectTab(o,"https://supplier.coupang.com/sr/registration/step/startPage",{selector:".rsfe-section",text:"ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"}),a=(await chrome.scripting.executeScript({target:{tabId:o.id},function:updateRocketRegDoc,args:[JSON.stringify(r.body)]}))[0].result,console.log(a),a.includes("errorCode")))chrome.tabs.sendMessage(n.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:"Supplier Hub ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”",success:!1,text:"ë¬¸ì„œ Update ì˜¤ë¥˜"}});else{var c={docId:r.body.docId,version:r.body.version};updateProgress(n.id,"ê²¬ì ì„œë¥¼ ê²€í† í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.");let e=null,t=null;for(var i=2;i<6;i++){await sleep(s);var l=(await chrome.scripting.executeScript({target:{tabId:o.id},function:confirmRocketRegDoc,args:[JSON.stringify(c),i]}))[0]?.result;if(console.log("step",i,":",l),l&&200!==l.code){e=l.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",t=i;break}if(l&&200===l.code&&l.data&&l.data[0]&&!l.data[0].success){l=l.data[0].errors;e=l&&0<l.length?l[0].message:"ê²€ì¦ ì‹¤íŒ¨",t=i;break}}await sleep(2*s),e?chrome.tabs.sendMessage(n.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:e,success:!1,text:t+"ë‹¨ê³„ ê²€ì¦ ì˜¤ë¥˜",errorDetails:e}}):(o.url.includes("https://supplier.coupang.com/sr/registration/step/startPage")||await redirectTab(o,"https://supplier.coupang.com/sr/registration/step/startPage",{selector:".rsfe-section",text:"ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"}),updateProgress(n.id,"ê²¬ì ì„œë¥¼ ë“±ë¡í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤."),await sleep(2*s),a=(await chrome.scripting.executeScript({target:{tabId:o.id},function:regRocketRegDoc,args:[r.body,s]}))[0].result,console.log(a),a.success?chrome.tabs.sendMessage(n.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:a.error,success:!0,text:"ìƒí’ˆ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}}):chrome.tabs.sendMessage(n.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:a.error,success:!1,text:"ìƒí’ˆ ë“±ë¡ì´ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤."}}))}}else chrome.tabs.sendMessage(n.id,{msg:"CoupangRegAlert",res:"ìƒˆíƒ­ì— Supplier Hubì— ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",suppliercode:e})}async function regRocketRegDoc(e,t,r){e=e.productName;try{if(await async function(e,t,r){Array.from(document.querySelectorAll(".btn-outline-secondary")).find(e=>e.innerText.includes("ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°")).click();for(;;){await s(t);var a=document.querySelector(".modal-title");if(a&&a.innerText.includes("ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"))break}await s(t);var n=document.querySelector(".sr-contents__table-draft").querySelectorAll("tbody > tr");n[r].querySelector(".btn-outline-primary").click();for(;;){await s(t);var o=document.querySelector(".rsc-text-input");if(o&&o.children[0].value===e)break}document.querySelector('button[type="submit"]').click();for(;;)if(await s(t),"Product Page"==document.querySelector("#root__title").innerText)break;document.querySelector('button[type="submit"]').click();for(;;)if(await s(t),"Image Page"==document.querySelector("#root__title").innerText)break;document.querySelector('button[type="submit"]').click();for(;;)if(await s(t),"Legal Page"==document.querySelector("#root__title").innerText)break;document.querySelector('button[type="submit"]').click();for(;;)if(await s(t),"Logistics Page"==document.querySelector("#root__title").innerText)break;document.querySelector('button[type="submit"]').click();for(;;)if(await s(t),"ìƒí’ˆ ë“±ë¡ ì™„ë£Œ"==document.querySelector(".text-primary").innerText)break;return await s(2*t),!0}(e,2*t,r))return{success:!0,error:""}}catch(e){return console.log(e),{success:!1,error:e}}async function s(t){return new Promise(e=>setTimeout(e,t))}return result}async function confirmRocketRegDoc(e,t){t=await(await fetch("https://supplier.coupang.com/sr/qvt/api/validate-step/"+t,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/productPage",referrerPolicy:"strict-origin-when-cross-origin",body:e,method:"POST",mode:"cors",credentials:"include"})).json();return console.log(t),t}async function createRocketRegDoc(e){e=await(await fetch("https://supplier.coupang.com/sr/draft/api/create",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify(e),method:"POST",mode:"cors",credentials:"include"})).json();return console.log(e),e}async function updateRocketRegDoc(e){console.log("update Body : "),console.log(JSON.parse(e));e=await(await fetch("https://supplier.coupang.com/sr/draft/api/update",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/productPage",referrerPolicy:"strict-origin-when-cross-origin",body:e,method:"POST",mode:"cors",credentials:"include"})).json();return console.log(e),e}async function deleteRocketReg(e){var t,r=await chrome.tabs.query({}),a=r.find(e=>e.active&&e.url&&(e.url.includes("couplus.co.kr")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112"))),n=e.suppliercode,r=r.find(e=>e.url.includes("supplier.coupang.com"));r?!1===await confirmSupplierCode(n,r)&&"A0000TEST"!==n?chrome.tabs.sendMessage(a.id,{msg:"CoupangRegAlert",res:"íŒë§¤ìì½”ë“œ ì¼ì¹˜ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",suppliercode:n}):(t=(await chrome.scripting.executeScript({target:{tabId:r.id},function:deleteRocketRegDoc,args:[e.docId]}))[0].result,console.log(t),t.includes("errorCode")&&(console.log("refresh"),await redirectTab(r,"https://supplier.coupang.com/sr/registration/step/startPage",{selector:".rsfe-section",text:"ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"}),t=(await chrome.scripting.executeScript({target:{tabId:r.id},function:deleteRocketRegDoc,args:[e.docId]}))[0].result,console.log(t),t.includes("errorCode"))?chrome.tabs.sendMessage(a.id,{response:!0,data:{type:"UPDATE_ROCKET_REG_RESPONSE",result:"Supplier Hub ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”. ë™ì¼í•œ ë¬¸ì œê°€ ì§€ì†ë  ê²½ìš° ìƒˆë¡œ ë“±ë¡í•´ì£¼ì„¸ìš”.",success:!1,text:"ë¬¸ì„œ ì‚­ì œ ì˜¤ë¥˜"}}):chrome.tabs.sendMessage(a.id,{response:!0,data:{type:"DELETE_ROCKET_REG_RESPONSE",delResult:t}})):chrome.tabs.sendMessage(a.id,{msg:"CoupangRegAlert",res:"ìƒˆíƒ­ì— Supplier Hubì— ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",suppliercode:n})}async function deleteRocketRegDoc(e){return await(await fetch("https://supplier.coupang.com/sr/draft/api/delete/"+e,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"DELETE",mode:"cors",credentials:"include"})).text()}async function getCategoryInfoFromCoupang(r){console.log("ì¹´í…Œê³ ë¦¬ ì •ë³´ ìš”ì²­:",r);var a=await chrome.tabs.query({}),n=a.find(e=>e.active&&e.url&&(e.url.includes("couplus.co.kr")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112"))),e=r.suppliercode,a=a.find(e=>e.url.includes("supplier.coupang.com"));if(a)if(!1===await confirmSupplierCode(e,a)&&"A0000TEST"!==e)chrome.tabs.sendMessage(n.id,{msg:"CoupangRegAlert",res:"íŒë§¤ìì½”ë“œ ì¼ì¹˜ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",suppliercode:e});else{console.log("Supplier íƒ­ ì •ë³´:",a);let e,t=!1;if(r.categoryCode)if(console.log("í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ì •ë³´ ìš”ì²­ ì¤‘... (ì²« ë²ˆì§¸ ì‹œë„)",r.categoryCode),o=await chrome.scripting.executeScript({target:{tabId:a.id},function:getAddCategories,args:[r.categoryCode]}),e=o[0].result,Array.isArray(e)&&0<e.length)console.log("í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì„±ê³µ (ì²« ë²ˆì§¸ ì‹œë„)"),t=!0;else{console.log("í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì²« ë²ˆì§¸ ì‹œë„):",e),console.log("ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜ ì‹œë„...");try{await redirectTab(a.id,"https://supplier.coupang.com/sr/registration/step/startPage",{selector:".rsfe-section",text:"ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"},!0),console.log("í˜ì´ì§€ ë¡œë”© ëŒ€ê¸° ì¤‘... (6ì´ˆ)"),await new Promise(e=>setTimeout(e,6e3)),console.log("í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ì •ë³´ ìš”ì²­ ì¤‘... (ë‘ ë²ˆì§¸ ì‹œë„)"),o=await chrome.scripting.executeScript({target:{tabId:a.id},function:getAddCategories,args:[r.categoryCode]}),e=o[0].result,Array.isArray(e)&&0<e.length?(console.log("í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì„±ê³µ (ë‘ ë²ˆì§¸ ì‹œë„)"),t=!0):console.log("í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ë‘ ë²ˆì§¸ ì‹œë„):",e)}catch(e){console.error("ë¦¬ë””ë ‰ì…˜ ë˜ëŠ” ë‘ ë²ˆì§¸ ì‹œë„ ì¤‘ ì˜¤ë¥˜:",e)}}else{console.log("ì´ˆê¸° ì¹´í…Œê³ ë¦¬ ì •ë³´ ìš”ì²­ ì¤‘... (ì²« ë²ˆì§¸ ì‹œë„)");var o=await chrome.scripting.executeScript({target:{tabId:a.id},function:getInitCategories});if(e=o[0].result,Array.isArray(e)&&0<e.length)console.log("ì´ˆê¸° ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì„±ê³µ (ì²« ë²ˆì§¸ ì‹œë„)"),t=!0;else{console.log("ì´ˆê¸° ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì²« ë²ˆì§¸ ì‹œë„):",e),console.log("ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜ ì‹œë„...");try{await redirectTab(a.id,"https://supplier.coupang.com/sr/registration/step/startPage",{selector:".rsfe-section",text:"ì¤‘ê°„ ì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°"},!0),console.log("í˜ì´ì§€ ë¡œë”© ëŒ€ê¸° ì¤‘... (6ì´ˆ)"),await new Promise(e=>setTimeout(e,6e3)),console.log("ì´ˆê¸° ì¹´í…Œê³ ë¦¬ ì •ë³´ ìš”ì²­ ì¤‘... (ë‘ ë²ˆì§¸ ì‹œë„)"),o=await chrome.scripting.executeScript({target:{tabId:a.id},function:getInitCategories}),e=o[0].result,Array.isArray(e)&&0<e.length?(console.log("ì´ˆê¸° ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì„±ê³µ (ë‘ ë²ˆì§¸ ì‹œë„)"),t=!0):console.log("ì´ˆê¸° ì¹´í…Œê³ ë¦¬ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ë‘ ë²ˆì§¸ ì‹œë„):",e)}catch(e){console.error("ë¦¬ë””ë ‰ì…˜ ë˜ëŠ” ë‘ ë²ˆì§¸ ì‹œë„ ì¤‘ ì˜¤ë¥˜:",e)}}}chrome.tabs.sendMessage(n.id,{response:!0,data:{type:"GET_CATEGORY_INFO_RESPONSE",categoryCode:e,success:t}})}else chrome.tabs.sendMessage(n.id,{msg:"CoupangRegAlert",res:"ìƒˆíƒ­ì— Supplier Hubì— ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",suppliercode:e})}async function getAddCategories(e){let t=0,r;for(;t<3;){try{var a=await fetch("https://supplier.coupang.com/sr/category/api/find-by-parent-category-code?categoryCode="+e,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});if(r=await a.json(),console.log(`ì‹œë„ ${t+1} ê²°ê³¼:`,r),Array.isArray(r)&&0<r.length)return r;console.log(`ìœ íš¨í•œ ë°°ì—´ì´ ì•„ë‹™ë‹ˆë‹¤. ì¬ì‹œë„ ì¤‘... (${t+1}/3)`)}catch(e){console.error(`ì‹œë„ ${t+1} ì˜¤ë¥˜:`,e)}++t<3&&(console.log("500ms í›„ ì¬ì‹œë„..."),await async function(t){return new Promise(e=>setTimeout(e,t))}(500))}return console.log("ìµœëŒ€ ì‹œë„ íšŸìˆ˜(3)ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ ê²°ê³¼ ë°˜í™˜"),r}async function searchCategoriesByKeyword(e){console.log("ì¹´í…Œê³ ë¦¬ í‚¤ì›Œë“œ ê²€ìƒ‰:",e);var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&e.url&&(e.url.includes("couplus.co.kr")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112"))),a=e.suppliercode,t=t.find(e=>e.url.includes("supplier.coupang.com"));t?!1===await confirmSupplierCode(a,t)&&"A0000TEST"!==a?chrome.tabs.sendMessage(r.id,{msg:"CoupangRegAlert",res:"íŒë§¤ìì½”ë“œ ì¼ì¹˜ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",suppliercode:a}):(t=await chrome.scripting.executeScript({target:{tabId:t.id},func:fetchCategoryByKeyword,args:[e.keyword]}),console.log("ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ ê²°ê³¼:",t[0].result),chrome.tabs.sendMessage(r.id,{response:!0,data:{type:"SEARCH_CATEGORIES_RESPONSE",results:t[0].result}})):chrome.tabs.sendMessage(r.id,{msg:"CoupangRegAlert",res:"ìƒˆíƒ­ì— Supplier Hubì— ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",suppliercode:a})}async function fetchCategoryByKeyword(e){try{var t=await fetch("https://supplier.coupang.com/sr/category/api/find-by-keyword?keyword="+encodeURIComponent(e),{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});if(t.ok)return await t.json();throw new Error("HTTP error: "+t.status)}catch(e){return console.error("ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ fetch ì˜¤ë¥˜:",e),[]}}async function getInitCategories(){let t=0,e;for(;t<3;){try{var r=await fetch("https://supplier.coupang.com/sr/category/api/",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});if(e=await r.json(),console.log(`ì‹œë„ ${t+1} ê²°ê³¼:`,e),Array.isArray(e)&&0<e.length)return e;console.log(`ìœ íš¨í•œ ë°°ì—´ì´ ì•„ë‹™ë‹ˆë‹¤. ì¬ì‹œë„ ì¤‘... (${t+1}/3)`)}catch(e){console.error(`ì‹œë„ ${t+1} ì˜¤ë¥˜:`,e)}++t<3&&(console.log("500ms í›„ ì¬ì‹œë„..."),await async function(t){return new Promise(e=>setTimeout(e,t))}(500))}return console.log("ìµœëŒ€ ì‹œë„ íšŸìˆ˜(3)ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ ê²°ê³¼ ë°˜í™˜"),e}async function getProductInfoFromCoupang(e,t){console.log(e);var r,a=await chrome.tabs.query({}),n=a.find(e=>e.active&&e.url&&(e.url.includes("couplus.co.kr")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112"))),o=e.suppliercode,a=a.find(e=>e.url.includes("supplier.coupang.com"));a?!1===await confirmSupplierCode(o,a)&&"A0000TEST"!==o?chrome.tabs.sendMessage(n.id,{msg:"CoupangRegAlert",res:"íŒë§¤ìì½”ë“œ ì¼ì¹˜ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",suppliercode:o}):(a=(await chrome.scripting.executeScript({target:{tabId:a.id},function:getRocketRegInfo,args:[e.categoryCode]}))[0].result,console.log(a),r={docId:null,productName:e.productNameTrans,categoryPath:`${e.categoryPathString.replaceAll(" ","")} (${e.categoryCode})`,categoryId:a.kanCategoryId,displayCategoryCode:e.categoryCode,jsonDocument:[{startPage:{productName:e.productNameTrans,categoryPath:`${e.categoryPathString.replaceAll(" ","")} (${e.categoryCode})`}}],scope:a.scopeType,productNoticeNumber:a.noticeNumber,version:a.version},console.log("ì´ˆê¸° body êµ¬ì¡° ìƒì„± (ë¬¸ì„œ ìƒì„±ì€ ê²€ì¦ ë‹¨ê³„ì—ì„œ ìˆ˜í–‰):",r),chrome.tabs.sendMessage(n.id,{response:!0,data:{type:"PRODUCT_INFO_RESPONSE",id:t,data:{optionIndex:e.optionIndex},rocketRegInfo:a,createResult:r}})):chrome.tabs.sendMessage(n.id,{msg:"CoupangRegAlert",res:"ìƒˆíƒ­ì— Supplier Hubì— ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",suppliercode:o})}async function getRocketRegInfo(e){return await(await fetch("https://supplier.coupang.com/sr/schema/api/get-default-schemaform?internalDisplayCode="+e+"&useCustomizedJsonSchema=true",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://supplier.coupang.com/sr/registration/step/startPage",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()}async function getInternalCategories(e){var t,r=[];for(t of(await(await fetch("https://www.coupang.com/np/search/getWrappedOmpWidget?q="+encodeURI(e),{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.coupang.com/np/search?component=&channel=user",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()).productList.map(e=>e.internalCategoryCodes[0]))r.find(e=>e.categoryCode==t)?r.find(e=>e.categoryCode==t).cnt++:r.push({categoryCode:t,cnt:1});return r.sort((e,t)=>t.cnt-e.cnt),r[0].categoryCode}async function handleAIRocketRequest(e,t){try{var r;console.log("AiRocketReg ìš”ì²­ì„ gemini.jsë¡œ ì „ë‹¬:",e);const activeTab=(await chrome.tabs.query({})).find(e=>e.active&&(e.url.includes("couplus")||e.url.includes("localhost:8081")||e.url.includes("43.202.46.112")));activeTab?(r=await processAIRocketRequest(e,activeTab),chrome.tabs.sendMessage(activeTab.id,{response:!0,data:{type:"AiRocketRegResult",...r}})):console.error("í™œì„± íƒ­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")}catch(e){console.error("AiRocketReg ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:",e),activeTab&&chrome.tabs.sendMessage(activeTab.id,{response:!0,data:{type:"AiRocketRegResult",error:e.message,status:"error"}})}}function updateProgress(e,t){chrome.tabs.sendMessage(e,{response:!0,data:{type:"AiRocketRegProgress",text:t}})}async function handleStartNegotiation(e,t){try{var r=(new Date).toISOString(),a="session_"+r,{aiReply:n,conversationHistory:o,context:s}=(await StateManager.updateState({status:NEGOTIATION_STATUS.IN_PROGRESS,currentSession:{id:a,startTime:r,data:e.negotiationData}}),await startNegotiation({...e.negotiationData,geminiModel:e.negotiationData.geminiModel||"gemini-2.0-flash"},{geminiApiKey:e.negotiationData.geminiApiKey,chatHistory:[],context:{currentTopic:"initial_greeting",nextTopic:e.negotiationData.checkItems.inStock.checked?"stock_check":"price_inquiry"}}));await ConversationManager.setConversation({conversationHistory:o,geminiApiKey:e.negotiationData.geminiApiKey,geminiModel:e.negotiationData.geminiModel||"gemini-2.0-flash",context:s}),t({success:!0,aiReply:n,sessionId:a,context:s})}catch(e){console.error("StartNegotiation Error:",e),await StateManager.updateState({status:NEGOTIATION_STATUS.ERROR,error:e.message}),t({success:!1,error:e.message,needsRetry:!0})}}async function handleContinueNegotiation(e,t){try{if((await StateManager.getState()).isPaused)throw new Error("í˜‘ìƒì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤");var r=await ConversationManager.getConversation();if(!r.conversationHistory)throw new Error("ëŒ€í™” ì´ë ¥ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");var{aiReply:a,conversationHistory:n}=await continueNegotiation(r.conversationHistory,e.userMessage,r.geminiApiKey,r.geminiModel||"gemini-2.0-flash");await ConversationManager.updateConversation({conversationHistory:n}),t({success:!0,aiReply:a})}catch(e){console.error("ContinueNegotiation Error:",e),t({success:!1,error:e.message,needsRetry:!0})}}async function handleTranslation(t,r){try{var e=await ConversationManager.getConversation();if(!e.geminiApiKey)throw new Error("Gemini API Keyê°€ ì—†ìŠµë‹ˆë‹¤");var a=t.message,n=await translateWithContext(a,{chatHistory:e.chatHistory||[],currentContext:e.context||{},geminiApiKey:e.geminiApiKey},e.geminiApiKey,e.geminiModel||"gemini-2.0-flash");r({success:!0,translation:n.translation,analysis:n.analysis,originalMessage:a})}catch(e){console.error("Translation Error:",e),r({success:!1,error:e.message,originalMessage:t.message,needsRetry:!0})}}async function aiCreateLayout(e){var t=e.apiKey,r=e.geminiModel||"gemini-2.0-flash",a=e.payload,n=e.productInfo,e=e.labeledImages,o=(await chrome.tabs.query({})).find(e=>e.active&&"couplus"==e.title),s="";t&&a&&(chrome.tabs.sendMessage(o.id,{response:"ANALYZE_LAYOUT_PROGRESS",payload:"AI ìƒì„¸í˜ì´ì§€ ë ˆì´ì•„ì›ƒ ìƒì„± ì¤‘..."}),s=await getLayout(a.option,a.feedback,n,t,r,e,o)),console.log(s),chrome.tabs.sendMessage(o.id,{response:"ANALYZE_LAYOUT_DONE",result:s})}async function aiKeywordCollectAndAnalysis(e){for(var t=e.apiKey,r=e.geminiModel||"gemini-2.0-flash",a=e.keyword,e=e.productInfo,n=await chrome.tabs.query({}),o=n.find(e=>e.active&&"couplus"==e.title),s=n.find(e=>e.url.includes("www.coupang.com")),c=(s||(console.log(n),s=await chrome.tabs.create({url:"https://www.coupang.com",active:!1}),await chrome.tabs.update(s.id,{autoDiscardable:!1})),await getProductListsFromCoupang(a,1,o)),i=[],l=0;l<c.length;l++){var u=c[l];chrome.tabs.sendMessage(o.id,{response:"ANALYZE_PROGRESS",payload:'"'+a+'" í‚¤ì›Œë“œ ë¦¬ë·°ì •ë³´ ìˆ˜ì§‘ ì¤‘ ('+parseInt(l/c.length*100)+"%)"}),u.ratingcount&&0<u.ratingcount&&(u=await getReview(u.productId,s),i=i.concat(u))}console.log(i);var d,n="";t&&i&&0<i.length&&(d=i.map(e=>e.ë¦¬ë·°ì œëª©+" "+e.ë¦¬ë·°ë‚´ìš©).join("\n"),chrome.tabs.sendMessage(o.id,{response:"ANALYZE_PROGRESS",payload:'"'+a+'" í‚¤ì›Œë“œ ë¦¬ë·°ì •ë³´ AI ë¶„ì„ ì¤‘...'}),n=await getReviewAnalysis(e,d,t,r,o)),console.log(n),chrome.tabs.sendMessage(o.id,{response:"ANALYZE_DONE",result:n})}async function collectTop3ProductReviews(e){var t=e.topProducts,e=(console.log("ğŸ” RPI TOP3 ì œí’ˆ ë¦¬ë·° ìˆ˜ì§‘ ì‹œì‘:",{productCount:t.length}),await chrome.tabs.query({})),r=e.find(e=>e.active&&"couplus"==e.title),a=e.find(e=>e.url.includes("www.coupang.com")),e=!1,n=(a||(a=await chrome.tabs.create({url:"https://www.coupang.com",active:!1}),e=!0,await chrome.tabs.update(a.id,{autoDiscardable:!1})),[]),o=[];try{for(var s=0;s<t.length;s++){var c=t[s],i=(chrome.tabs.sendMessage(r.id,{response:"reviewCollectionProgress",message:`TOP${s+1} ìƒí’ˆ ë¦¬ë·° ìˆ˜ì§‘ ì¤‘: ${c.productName?.substring(0,30)}...`}),console.log(`ğŸ“ TOP${s+1} ìƒí’ˆ ë¦¬ë·° ìˆ˜ì§‘:`,{productName:c.productName,productId:c.productId,ratingCount:c.ratingcount||0}),[]);c.productId&&0<(c.ratingcount||0)&&(i=await getReview(c.productId,a)),o.push({rank:s+1,productName:c.productName,productId:c.productId,salePrice:c.salePrice,rpi:c.overall||c.rpi,ctr:c.ctr,cvr:c.cvr,ratingCount:c.ratingcount||0,reviews:i,reviewCount:i.length}),n=n.concat(i),console.log(`âœ… TOP${s+1} ìƒí’ˆ ë¦¬ë·° ìˆ˜ì§‘ ì™„ë£Œ: ${i.length}ê°œ`)}console.log("ğŸ“Š ì „ì²´ ë¦¬ë·° ìˆ˜ì§‘ ì™„ë£Œ:",{totalReviews:n.length,productData:o.map(e=>({rank:e.rank,name:e.productName?.substring(0,20),reviewCount:e.reviewCount}))}),chrome.tabs.sendMessage(r.id,{response:"top3ReviewsCollected",reviews:n,productData:o,totalReviews:n.length})}catch(e){console.error("âŒ ë¦¬ë·° ìˆ˜ì§‘ ì‹¤íŒ¨:",e),chrome.tabs.sendMessage(r.id,{response:"reviewCollectionError",error:e.message||"ë¦¬ë·° ìˆ˜ì§‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}finally{e&&a&&chrome.tabs.remove(a.id)}}async function getReview(e,t){for(var r="https://www.coupang.com/vp/product/reviews?productId="+e+"&size=30&sortBy=ORDER_SCORE_ASC&q=&ratingSummary=true",a=[],n=0;n<5;n++){for(var o=1,s=0;s<o;s++){var c=await chrome.scripting.executeScript({target:{tabId:t.id},function:i,args:[r,e,n+1,s+1]}),c=(console.log(c),c[0].result),a=a.concat(c[0]);if(30<c[4]&&(o=parseInt(c[4]/30)+1),0<a.length&&0<a.filter(e=>e.ë¦¬ë·°ë‚´ìš©).length)break}if(0<a.length&&0<a.filter(e=>e.ë¦¬ë·°ë‚´ìš©).length)break}return a;async function i(e,r,t,a){var n=5-t,o=[e+"&viRoleCode=2&ratings="+t+"&page="+a,e+"&viRoleCode=3&ratings="+t+"&page="+a];let s;for(let t=0;t<o.length;t++)try{console.log("Trying URL:",o[t]);var c=await fetch(o[t],{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="116", "Not)A;Brand";v="24", "Google Chrome";v="116"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://www.coupang.com/vp/products/"+r+"?isAddedCart=",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});break}catch(e){s=e,console.log(`Attempt ${t+1} failed:`,e),t<o.length-1&&await async function(t){return new Promise(e=>setTimeout(e,t))}(1e3)}if(!c)return console.log("All attempts failed:",s),[[],0,s,"error",0];e=await c.text();if(console.log("content:"),console.log(e),e.includes("ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒ")||e.includes("Access Denied"))return[[],0,e,"ì•Œìˆ˜ì—†ëŠ”ì˜¤ë¥˜ ë˜ëŠ” Access Denied",0];var i=(new DOMParser).parseFromString(e,"text/html");if(console.log(i),!i.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")||!i.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")[0].dataset)return[[],0,e,"ë¦¬ë·°ê²°ê³¼ì—†ìŒ : https://www.coupang.com/vp/products/"+r,0];console.log(i.body.innerHTML);t=i.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")[0].dataset.totalCount;if(0==t)return[[],0,"ok","ë¦¬ë·°ê²°ê³¼ì—†ìŒ : https://www.coupang.com/vp/products/"+r,0];for(var a=i.getElementsByClassName("js_reviewArticleHiddenValue")[n].dataset.count,l=(console.log(t,a),{}),u=[],d=0;d<i.getElementsByClassName("js_reviewArticleReviewList").length;d++){var p,h,m,g,f,y,v,w,b,S,k=i.getElementsByClassName("js_reviewArticleReviewList")[d];if(0<u.length&&10<=u.filter(e=>e.ë¦¬ë·°ë‚´ìš©).length)break;k.getElementsByClassName("js_reviewArticleRatingValue")[0].dataset&&(p=k.getElementsByClassName("sdp-review__article__list__attachment__list").length,h=k.getElementsByClassName("sdp-review__article__list__info__user")[0].children[0].dataset.memberId,m=k.getElementsByClassName("sdp-review__article__list__info__user")[0].children[0].textContent,g=k.getElementsByClassName("js_reviewArticleRatingValue")[0].dataset.rating,f=k.getElementsByClassName("sdp-review__article__list__info__product-info__reg-date")[0].textContent,y=k.getElementsByClassName("sdp-review__article__list__info__product-info__seller_name")[0].textContent,v=k.getElementsByClassName("sdp-review__article__list__info__product-info__name")[0].textContent,w=k.getElementsByClassName("sdp-review__article__list__headline")[0]?k.getElementsByClassName("sdp-review__article__list__headline")[0].textContent:"",b=k.getElementsByClassName("js_reviewArticleContent")[0]?k.getElementsByClassName("js_reviewArticleContent")[0].textContent:"",S=!!k.getElementsByClassName("js_reviewArticleAdventureBtn")[0],k=k.getElementsByClassName("js_reviewArticleHelpfulContainer")[0]?k.getElementsByClassName("js_reviewArticleHelpfulContainer")[0].dataset.count:"",l={"ë¦¬ë·°ì–´ë²ˆí˜¸":h,"ì´ë¦„":m,"í‰ì ":g,"ì‘ì„±ì¼":f,"íŒë§¤ì":y.replaceAll("\n","").trim(),"ìƒí’ˆì˜µì…˜ëª…":v,"ë¦¬ë·°ì œëª©":w.replaceAll("\n","").trim(),"ë¦¬ë·°ë‚´ìš©":b.replaceAll("\n","").trim(),"ë„ì›€ëœì¸ì›ìˆ˜":k,"ì‚¬ì§„ìˆ˜":p,"ì²´í—˜ë‹¨":S},console.log(l),u.push(l))}return console.log(u),console.log(t),[u,t,"ok","OK",a]}}async function getProductListsFromCoupang(e,t,r){for(var a=[],n=0;n<t;n++){chrome.tabs.sendMessage(r.id,{response:"ANALYZE_PROGRESS",payload:'"'+e+'" í‚¤ì›Œë“œ ìƒí’ˆì •ë³´ ìˆ˜ì§‘ ì¤‘'});var o=await fetchkeywordb(e,n+1,t);console.log(o),o&&o.productlists&&(a=a.concat(o.productlists))}return console.log(a),a}async function getAIReviewAnalysis(e,t){console.log(e);e=(20<e.length?e.sort((e,t)=>parseFloat(e.í‰ì )-parseFloat(t.í‰ì )).slice(0,20).map(e=>e.ë¦¬ë·°ì œëª©+" "+e.ë¦¬ë·°ë‚´ìš©):e.map(e=>e.ë¦¬ë·°ì œëª©+" "+e.ë¦¬ë·°ë‚´ìš©)).join("\n"),e=await getReviewAnalysisResult(e,t,"gemini-2.0-flash");console.log(e)}async function autoCollectToggle(e){e.data.enabled?chrome.storage.local.set({autoCollectSettings:{enabled:!0,id:e.data.settings.id,pw:e.data.settings.pw,time:e.data.settings.time,items:e.data.settings.items}},()=>{createDailyAlarm(e.data.settings.time)}):chrome.storage.local.remove("autoCollectSettings",()=>{chrome.alarms.clear("autoCollect")})}function createDailyAlarm(e){var t=new Date,[e,r]=[parseInt(e.hour),parseInt(e.minute)],a=new Date;a.setHours(e,r,0,0),a<=t&&a.setDate(a.getDate()+1),chrome.alarms.create("autoCollect",{when:a.getTime(),periodInMinutes:1440})}async function executeCollectionSequentially(e){console.log(e);for(const t of[{key:"rankTracking",name:"ë­í‚¹ì¶”ì "},{key:"rocketGrowthProducts",name:"ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆê´€ë¦¬"},{key:"rocketGrowthSales",name:"ë¡œì¼“ê·¸ë¡œìŠ¤ íŒë§¤í˜„í™©/SCM"},{key:"rocketDeliverySKU",name:"ë¡œì¼“ë°°ì†¡ ìƒí’ˆSKU"},{key:"rocketDeliveryOrder",name:"ë¡œì¼“ë°°ì†¡ ë°œì£¼ì„œ"},{key:"rocketDeliverySales",name:"ë¡œì¼“ë°°ì†¡ íŒë§¤í˜„í™©"}])if(e.items[t.key])try{console.log(t.name+" ìˆ˜ì§‘ ì‹œì‘"),updateAutoCollectStatus(t.name+" ìˆ˜ì§‘ ì‹œì‘"),await executeCollection(t.key,e.id,e.pw),console.log(t.name+" ìˆ˜ì§‘ ì™„ë£Œ"),updateAutoCollectStatus(t.name+" ìˆ˜ì§‘ ì™„ë£Œ")}catch(e){console.error(t.name+" ìˆ˜ì§‘ ì‹¤íŒ¨:",e),updateAutoCollectStatus(t.name+" ìˆ˜ì§‘ ì‹¤íŒ¨: "+e.message);continue}updateAutoCollectStatus("ëª¨ë“  ìˆ˜ì§‘ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}async function executeCollection(e,t,r){var a=["rankTracking","rocketGrowthProducts","rocketGrowthSales"].includes(e);try{if(a){var n=await getCoupangTabOrCreate("https://wing.coupang.com/"),o=(updateAutoCollectStatus(e+" ìˆ˜ì§‘ ì‹œì‘"),await chrome.scripting.executeScript({target:{tabId:n.id},function:loginIfNeeded,args:[{id:t,pw:r}]})),s=o?.[0]?.result||"";if("ë¡œê·¸ì¸ ì‹œë„ ì™„ë£Œ"===s){var c=Date.now();let e=null;for(;Date.now()-c<15e3;){await new Promise(e=>setTimeout(e,1e3));var i=(await chrome.scripting.executeScript({target:{tabId:n.id},function:checkLoginStatus}))?.[0]?.result;if(console.log("Wing ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸:",i),"ë¡œê·¸ì¸ ì„±ê³µ"===i){e="ë¡œê·¸ì¸ ì„±ê³µ";break}if("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."===i){e=i;break}if("2ì°¨ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤."===i){e=i;break}}if("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."===e)throw new Error("Wing ë¡œê·¸ì¸ ì‹¤íŒ¨: "+e);if("2ì°¨ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤."===e)throw new Error("Wing ë¡œê·¸ì¸ ì‹¤íŒ¨: "+e);if("ë¡œê·¸ì¸ ì„±ê³µ"!==e)throw new Error("Wing ë¡œê·¸ì¸ ì‹¤íŒ¨: ë¡œê·¸ì¸ ëŒ€ê¸° ì‹œê°„ ì´ˆê³¼")}else{if("ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."===s)throw new Error("Wing ë¡œê·¸ì¸ ì‹¤íŒ¨: "+s);if(s.includes("ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤")||s.includes("2ì°¨ ì¸ì¦")||s.includes("ëŒ€ê¸° ì‹œê°„ ì´ˆê³¼"))throw new Error("Wing ë¡œê·¸ì¸ ì‹¤íŒ¨: "+s)}switch(e){case"rankTracking":await collectRankTracking(n);break;case"rocketGrowthProducts":await collectRocketGrowthProducts(n);break;case"rocketGrowthSales":await collectRocketGrowthSales(n)}}else{var l=await getCoupangTabOrCreate("https://supplier.coupang.com/"),u=(updateAutoCollectStatus(e+" ìˆ˜ì§‘ ì‹œì‘"),await chrome.scripting.executeScript({target:{tabId:l.id},function:supplierLoginIfNeeded,args:[{id:t,pw:r}]})),d=u?.[0]?.result||"";if("ë¡œê·¸ì¸ ì‹œë„ ì™„ë£Œ"===d){var p=Date.now();let e=null;for(;Date.now()-p<15e3;){await new Promise(e=>setTimeout(e,1e3));var h=(await chrome.scripting.executeScript({target:{tabId:l.id},function:checkSupplierLoginStatus}))?.[0]?.result;if(console.log("Supplier ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸:",h),"ë¡œê·¸ì¸ ì„±ê³µ"===h){e="ë¡œê·¸ì¸ ì„±ê³µ";break}if("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."===h){e=h;break}}if("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."===e)throw new Error("Supplier ë¡œê·¸ì¸ ì‹¤íŒ¨: "+e);if("ë¡œê·¸ì¸ ì„±ê³µ"!==e)throw new Error("Supplier ë¡œê·¸ì¸ ì‹¤íŒ¨: ë¡œê·¸ì¸ ëŒ€ê¸° ì‹œê°„ ì´ˆê³¼")}else{if("ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."===d)throw new Error("Supplier ë¡œê·¸ì¸ ì‹¤íŒ¨: "+d);if(d.includes("ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤")||d.includes("2ì°¨ ì¸ì¦")||d.includes("ëŒ€ê¸° ì‹œê°„ ì´ˆê³¼"))throw new Error("Supplier ë¡œê·¸ì¸ ì‹¤íŒ¨: "+d)}await collectRocketData(e,l)}updateAutoCollectStatus(e+" ìˆ˜ì§‘ ì™„ë£Œ")}catch(e){throw e}}async function collectRocketData(e,t){r=await(await fetch("https://supplier.coupang.com/vendor").catch(e=>{console.log("line432"),console.log(e),alert("ì¿ íŒ¡Supplierì˜ ë¡œê·¸ì¸ìƒíƒœë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”")})).text(),console.log(r),console.log(r.slice(r.search("vendorId")+12,r.search("vendorId")+21));var r=await r.slice(r.search("vendorId")+12,r.search("vendorId")+21);if("A"!=r[0])alert("ì¿ íŒ¡Supplierì˜ ë¡œê·¸ì¸ìƒíƒœë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”");else{var a=await(await fetch(domain+"api/addpolist/confirmvendor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({suppliercode:r})}).catch(e=>{console.log("line451"),console.log(e),alert("[Confirm]COUPLUSì˜ ë¡œê·¸ì¸ìƒíƒœë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”")})).json();if(console.log("companyid : "+a.companyid),"ë¡œê·¸ì¸ì„±ê³µ"==a.loginstatus)if("lite"==a.version)updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡ ìˆ˜ì§‘ì€ í”„ë¦¬ë¯¸ì—„ ë²„ì „ì—ì„œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.");else switch(searchinfo.auth=a.auth,e){case"rocketDeliverySKU":await collectRocketDeliverySKU(a.companyid,t);break;case"rocketDeliveryOrder":await collectRocketDeliveryOrder(a.companyid,t);break;case"rocketDeliverySales":await collectRocketDeliverySales(a.companyid,a.productdb,t)}else alert(a.loginstatus)}}async function collectRocketDeliverySales(r,e,t){var a,n,o=t.id,s=(a=o,await new Promise(n=>{chrome.tabs.update(a,{url:"https://supplier.coupang.com/marketing/dashboard/pa"},async a=>{chrome.tabs.onUpdated.addListener(function e(t,r){"complete"===r.status&&t===a.id&&(chrome.tabs.onUpdated.removeListener(e),n(a))})})})),s=(console.log(s),Date.now(),f((n=Date.now())-2592e6)),c=(g=new Date,c=g.getFullYear(),i=("0"+(1+g.getMonth())).slice(-2),g=("0"+g.getDate()).slice(-2),c+"-"+i+"-"+g),i=(console.log(s,c),updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) ì…ê³ í˜„í™© ìˆ˜ì§‘ì¤‘"),await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e,t){async function u(e,t,r){return await(await fetch("https://supplier.coupang.com/scm/receive/detail?page="+r+"&startDate="+e+"&endDate="+t+"&requestSeq=&vendorPaymentInfoSeq=")).text()}async function d(e){e=await e;return(new DOMParser).parseFromString(e,"text/html")}return async function(e,t){console.log("a");var r=await d(u(e,t,1));if(console.log(r.getElementsByClassName("scmTable basic marginT")),1<r.getElementsByClassName("scmTable basic marginT").length){for(var a="",n=0;n<r.querySelectorAll("script").length;n++){var o=r.querySelectorAll("script")[n];o.innerHTML.includes("#pagination")&&(a=o.innerHTML.slice(o.innerHTML.search("#pagination")+22,o.innerHTML.search("#pagination")+o.innerHTML.slice(o.innerHTML.search("#pagination"),o.innerHTML.length).search("}")+1).replaceAll(" ",""))}s=(s=a).replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": ').replaceAll("'",'"');var s=JSON.parse(s),s=parseInt(s.total),s={total:parseInt(r.getElementsByClassName("scmTable basic marginT")[0].children[0].children[1].children[3].innerText.replaceAll(",","")),pages:s}}else s={total:0};var c=[];if(console.log(s),0<s.total){console.log("b");for(var i,l=s.pages,n=(console.log(l),0);n<l;n++)i=await d(u(e,t,n+1)).then(e=>{for(var t=e.getElementsByClassName("scmTableArea")[0].children[0],r=[],a=[],n=0;n<t.rows[0].cells.length;n++)a[n]=t.rows[0].cells[n].innerText.toLowerCase().replace(/ /gi,"");for(n=1;n<t.rows.length;n++){for(var o=t.rows[n],s={},c=0;c<o.cells.length;c++)s[a[c]]=o.cells[c].innerText.replaceAll("\n","").replaceAll("            ","").trim();r.push(s)}return r}),c=c.concat(i)}return c}(e,t)},args:[s,c]})),l=(console.log(i),i[0].result);if(0<l.length){for(var u,d=[],p=[],h=30;-1<h;h--)u=f(n-864e5*h),d.push({importdate:u,companyid:r,importlist:p});console.log(d),console.log(l),console.log(l.filter(e=>!e["ì…ê³ /ë°˜ì¶œì¼ì"]));var m=0;d.forEach(async t=>{var e;t.importlist=l.filter(e=>e["ì…ê³ /ë°˜ì¶œì¼ì"].slice(0,10)==t.importdate),m+=t.importlist.length,console.log(m,l.length),m==l.length&&(updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) ì…ê³ í˜„í™© ì €ì¥ì¤‘"),e=d,console.log(e),e=await(await fetch(domain+"api/addsales/supplylist/addlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyid:r,data:e})}).catch(e=>{console.log("line212"),console.log(e)})).json(),console.log(e),e.ìš”ì²­ê²°ê³¼)})}updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) íŒë§¤í˜„í™© ìˆ˜ì§‘ì§‘ì¤‘");var g=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e,t){var r,a="",n=0,o=[],s={},c=Date.now(),t=(console.log(c),t.filter(e=>1e7<parseInt(e["SKU ID"])));console.log(t.length);for(r of t){console.log((n+1).toString()+"/"+t.length.toString()),chrome.runtime.sendMessage({target:"updateAutoCollectStatus",text:"ë¡œì¼“ë°°ì†¡(supplierHub) íŒë§¤í˜„í™© ìˆ˜ì§‘ ì¤‘("+(n/t.length*100).toFixed(1)+"%)"}),a="https://supplier.coupang.com/marketing/cmg-api/vendoritems?page=1&size=1&keyword="+parseInt(r["SKU ID"])+"&searchBy=sku";var i=await(await fetch(a).catch(e=>{console.log("line374"),console.log(e)})).text(),i=JSON.parse(i);if(console.log(i),s=0<i.products.length?{companyid:e,date:c,SKUID:r["SKU ID"],"ë°”ì½”ë“œ":r.ë°”ì½”ë“œ,"ë“±ë¡ìƒí’ˆëª…":r.ìƒí’ˆëª…,"ë°œì£¼ê°€ëŠ¥ìƒíƒœ":r.ë°œì£¼ê°€ëŠ¥ìƒíƒœ,"íŒë§¤ìƒí’ˆëª…":i.products[0].itemnm,"íŒë§¤ë§í¬":"https://www.coupang.com/vp/products/"+i.products[0].productid+"?itemId="+i.products[0].itemid+"&vendorItemId="+i.products[0].vendoritemid+"&isAddedCart=","ì¹´í…Œê³ ë¦¬":i.products[0].categoryId,"íŒë§¤ê°€":i.products[0].sales_price,"íŒë§¤ì¬ê³ ":i.products[0].stockQuantity,"ì¸ë„¤ì¼":"https://image10.coupangcdn.com/image/"+i.products[0].mainImagePath,"ë¦¬ë·°ìˆ˜":i.products[0].review.ratingCount,"í‰ì ":i.products[0].review.ratingAverage,"ì•„ì´í…œìœ„ë„ˆ":i.products[0].buyboxStatus}:{companyid:e,date:c,SKUID:r["SKU ID"],"ë°”ì½”ë“œ":r.ë°”ì½”ë“œ,"ë“±ë¡ìƒí’ˆëª…":r.ìƒí’ˆëª…,"ë°œì£¼ê°€ëŠ¥ìƒíƒœ":r.ë°œì£¼ê°€ëŠ¥ìƒíƒœ,"ì¹´í…Œê³ ë¦¬":"","íŒë§¤ìƒí’ˆëª…":"","íŒë§¤ë§í¬":"","íŒë§¤ê°€":"","íŒë§¤ì¬ê³ ":"","ì¸ë„¤ì¼":"","ë¦¬ë·°ìˆ˜":"","í‰ì ":"","ì•„ì´í…œìœ„ë„ˆ":""},o.push(s),++n==t.length)return o}},args:[r,e,o]});console.log(g[0].result);i=await(await fetch(domain+"api/addsales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g[0].result)})).json();function f(e){e=new Date(e);return e.getFullYear()+"-"+("0"+(1+e.getMonth())).slice(-2)+"-"+("0"+e.getDate()).slice(-2)}console.log(i),"íŒë§¤í˜„í™© ì—…ë°ì´íŠ¸ ì™„ë£Œ"!=i.ìš”ì²­ê²°ê³¼?(updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) íŒë§¤í˜„í™© ìˆ˜ì§‘ì‹¤íŒ¨"),console.log(i.ìš”ì²­ê²°ê³¼)):updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) íŒë§¤í˜„í™© ìˆ˜ì§‘ì™„ë£Œ")}async function collectRocketDeliveryOrder(e,t){var r=new Date,a=(a=r-432e7,(a=new Date(a)).getFullYear()+"-"+("0"+(1+a.getMonth())).slice(-2)+"-"+("0"+a.getDate()).slice(-2)),n=(n=new Date).getFullYear()+"-"+("0"+(1+n.getMonth())).slice(-2)+"-"+("0"+n.getDate()).slice(-2);function o(e,t){return{url:"https://supplier.coupang.com/scm/purchase/order/list?page=1&searchDateType=PURCHASE_ORDER_DATE&searchStartDate="+e+"&searchEndDate="+t+"&centerCode=&purchaseOrderSeq=&vendorPaymentInfoSeq=&purchaseOrderStatus=&purchaseOrderType=",urlafter:"&searchDateType=PURCHASE_ORDER_DATE&searchStartDate="+e+"&searchEndDate="+t+"&centerCode=&purchaseOrderSeq=&vendorPaymentInfoSeq=&purchaseOrderStatus=&purchaseOrderType="}}var s=o(a,n).url,a=o(a,n).urlafter,r=new Date;updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) ë°œì£¼ì„œ ìˆ˜ì§‘ì¤‘");n=(await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e,t,r,a,n,o,s,c){console.log(e,t,r,a,n,o,s,c);const i=await fetch(e),l=await i.text();for(var u=new DOMParser,d=(console.log(l),u.parseFromString(l,"text/html")),p=[],h=0;h<d.getElementsByTagName("script").length;h++)if(0<d.getElementsByTagName("script")[h].outerHTML.search("total")){var m=d.getElementsByTagName("script")[h].outerHTML.slice(d.getElementsByTagName("script")[h].outerHTML.search("total")+6,d.getElementsByTagName("script")[h].outerHTML.search("total")+15),m=m.slice(m.search("'"),m.search(","));a=parseInt(m.replaceAll("'","")),console.log(a+"pageê²€ìƒ‰");for(var g=0;g<a;g++)p.push("https://supplier.coupang.com/scm/purchase/order/list?page="+(g+1)+t);break}console.log(p);for(let[e,t]of p.entries()){chrome.runtime.sendMessage({target:"updateAutoCollectStatus",text:"ë¡œì¼“ë°°ì†¡(supplierHub) ë°œì£¼ë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘ ì¤‘("+(e/p.length*100).toFixed(0)+"%)"});const i=await fetch(t),l=await i.text();var u=new DOMParser,f={"ë°œì£¼ì„¸ë¶€ë‚´ì—­":[]},y=u.parseFromString(l,"text/html");if("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."==y.getElementsByClassName("scmTable basic marginT")[0].children[1].children[0].children[0].innerText)return alert("ê°€ì ¸ì˜¬ ë°œì£¼ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤."),!1;for(var v=0;v<y.getElementsByClassName("scmTable basic marginT")[0].children[1].children.length;v++){for(g=1;g<22;g++)f[n[g-1]]=y.getElementsByClassName("scmTable basic marginT")[0].children[1].children[v].children[g].innerText.replaceAll("\n","").replaceAll("SKU ë°”ì½”ë“œ ì¶œë ¥","").trim();f.companyid=s,f.lastupdate=new Date;var w="https://supplier.coupang.com/scm/purchase/order/get/"+f["ë°œì£¼ë²ˆí˜¸"];console.log(w);const i=await fetch(w),l=await i.text();for(var d=(u=new DOMParser).parseFromString(l,"text/html"),b={},h=0;h<d.getElementsByClassName("scmTable productInfo").length;h++)if(0<d.getElementsByClassName("scmTable productInfo")[h].innerText.search("ì…ê³  ì£¼ì†Œ")&&(f["ì…ê³ ì£¼ì†Œ"]=d.getElementsByClassName("scmTable productInfo")[h].children[2].children[0].children[3].innerText),0<d.getElementsByClassName("scmTable productInfo")[h].innerText.search("ë°”ì½”ë“œ")){for(g=0;g<d.getElementsByClassName("scmTable productInfo")[h].children[1].children.length-2;g++)g%2==0?(b[o[0]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[0].innerText.trim(),b[o[1]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[2].innerText.trim(),b[o[2]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[3].children[0].children[0].innerText.trim(),b[o[3]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[2].children[2].src.trim(),b[o[4]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[3].children[0].children[1].innerText.trim(),b[o[5]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[4].children[0].children[0].innerText.trim(),b[o[6]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[4].children[0].children[1].innerText.trim(),b[o[7]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[5].innerText.trim(),b[o[8]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[6].innerText.trim(),b[o[9]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[7].innerText.trim(),b[o[10]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[8].innerText.trim(),b[o[11]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[9].innerText.trim()):(b[o[12]]=d.getElementsByClassName("scmTable productInfo")[h].children[1].children[g].children[0].innerText.trim(),b[o[13]]=c.toLocaleString(),f["ë°œì£¼ì„¸ë¶€ë‚´ì—­"].push(b),b={});break}r.push(f),f={"ë°œì£¼ì„¸ë¶€ë‚´ì—­":[]}}}return r},args:[s,a,[],0,["ë°œì£¼ë²ˆí˜¸","ë°œì£¼ìœ í˜•","ë°œì£¼ì£¼ë¬¸ìœ í˜•","ë°œì£¼ìƒíƒœ","ë°œì£¼ì¼ì‹œ","ë°œì£¼êµ¬ë¶„","ë°œì£¼ìš´ì†¡","ê±°ë˜ì²˜ë‹´ë‹¹","ê±°ë˜ì²˜ëª…","ì²«SKUëª…","SKUê°œìˆ˜","ë°œì£¼ì„¼í„°","ë‚©í’ˆì„¼í„°","ë°œì£¼ìˆ˜ëŸ‰","ì…ê³ ìˆ˜ëŸ‰","ê¸ˆì•¡","ì…ê³ ì˜ˆì •ì¼","ì…ê³ ì‹œì‘ì¼","ì…ê³ ì¢…ë£Œì¼","ì˜ˆì•½ìƒíƒœ","ê³„ì•½ì„œë²ˆí˜¸","ê³„ì•½ì„œìƒíƒœ","ë°œì£¼ì„¸ë¶€ë‚´ì—­"],["ìˆœì„œ","SKUID","ë°”ì½”ë“œ","IMGURL","ìƒí’ˆëª…","ë§¤ì…ìœ í˜•","ë©´ì„¸ì—¬ë¶€","ë°œì£¼ìˆ˜ëŸ‰","í™•ì •ìˆ˜ëŸ‰","ë§¤ì…ê°€","ê³µê¸‰ê°€ì•¡","ë¶€ê°€ì„¸ì•¡","ì…ê³ ìˆ˜ëŸ‰","ë°ì´í„°ìˆ˜ì§‘ì¼ì"],e,r]}))[0].result;console.log(n);try{await fetch(domain+"api/addpolist/addpo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) ë°œì£¼ì„œ ìˆ˜ì§‘ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(e){updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) ë°œì£¼ì„œ ìˆ˜ì§‘ ì‹¤íŒ¨"),console.log("line591"),console.log(e)}}async function collectRocketDeliverySKU(e,t){updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) SKU ë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘ì¤‘");t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(){async function c(e,t){return await(await fetch("https://supplier.coupang.com/plan/v1/ticket/sku/listTicketSku?locale=ko",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",locale:"ko","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://supplier.coupang.com/plan/ticket/supplySkuList",referrerPolicy:"strict-origin-when-cross-origin",body:'{"skuId":"","skuName":"","barcode":"","orderingStatus":"","unit1":"","unit2":"","issueStatus":"","issueType":"","size":'+t+',"page":'+(e+1)+"}",method:"POST",mode:"cors",credentials:"include"}).catch(e=>console.log(e))).text()}async function i(e){return await(await fetch("https://supplier.coupang.com/plan/v1/ticket/sku/get/detail?skuId="+e+"&locale=ko",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",locale:"ko","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://supplier.coupang.com/plan/ticket/supplySkuList",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).catch(e=>console.log("err899line : "+e))).text()}return async function(){var e=[],t=await c(0,10).catch(e=>console.log(e)),r=JSON.parse(t);if(console.log(r),100<=r.body.total){t=await c(0,100).catch(e=>console.log(e));for(s of(r=JSON.parse(t)).body.content){var a=await i(s.skuId);s.detail=JSON.parse(a)}e=e.concat(r.body.content),console.log(r.body.total),console.log(r.body.content.length),console.log(parseInt(r.body.total/r.body.content.length)+1);for(var n=parseInt(r.body.total/r.body.content.length)+1,o=1;o<n;o++){console.log(e),t=await c(o,100).catch(e=>console.log(e));for(s of(r=JSON.parse(t)).body.content)a=await i(s.skuId),s.detail=JSON.parse(a);e=e.concat(r.body.content),chrome.runtime.sendMessage({target:"updateAutoCollectStatus",text:"ë¡œì¼“ë°°ì†¡(supplierHub) SKU ë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘ ì¤‘("+((o-1)/n*100).toFixed(1)+"%)"})}}else{for(var s of r.body.content)s.detail=await i(s.skuId);for(e=e.concat(r.body.content),n=parseInt(r.body.total/r.body.content.length)+1,o=1;o<n;o++){console.log(e),t=await c(o,10).catch(e=>console.log(e));for(s of(r=JSON.parse(t)).body.content)a=await i(s.skuId),s.detail=JSON.parse(a);e=e.concat(r.body.content),chrome.runtime.sendMessage({target:"updateAutoCollectStatus",text:"ë¡œì¼“ë°°ì†¡(supplierHub) SKU ë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘ ì¤‘("+((o-1)/n*100).toFixed(1)+"%)"})}}return console.log(e),e}()}}),console.log(t);var r,t=await t[0].result,a=[];t&&t.forEach(e=>{r={"SKU ID":e.skuId,"ìš”ì²­":e.issueCount,"ìƒí’ˆëª…":e.skuName,"ë°”ì½”ë“œ":e.barCode,"ë°œì£¼ê°€ëŠ¥ìƒíƒœ":e.orderStatus,"ë‹´ë‹¹ BM":e.mdName,"ë°œì£¼ë‹´ë‹¹ì":e.scmName,"ë“±ë¡ì´ë¯¸ì§€":e.imagePath,skudetail:e},a.push(r)}),console.log(a),updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) SKU ë¦¬ìŠ¤íŠ¸ DBì €ì¥ì¤‘"),"ì—…ë°ì´íŠ¸ì™„ë£Œ"==(await(await fetch(domain+"api/addproduct/updateskulist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyid:e,arr:a})})).json()).ìš”ì²­ê²°ê³¼?updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) SKU ë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"):updateAutoCollectStatus("ë¡œì¼“ë°°ì†¡(supplierHub) SKU ë¦¬ìŠ¤íŠ¸ DBì €ì¥ ì‹¤íŒ¨")}async function collectRocketGrowthSales(e){var t,r,a,n=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}})).json(),o=n.companyid,n=n.suppliercode;e&&(!1!==(t=await confirmSupplierCode(n,e))||"A0000TEST"===n)&&!0===t?(t=await(await fetch(domain+"api/getGrowthDBV2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({show:!0})})).json(),updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ íŒë§¤í˜„í™© ìˆ˜ì§‘ì¤‘"),(a=new Date((new Date).getTime()+324e5)).getFullYear(),("0"+(1+a.getMonth())).slice(-2),("0"+a.getDate()).slice(-2),a.setDate(a.getDate()-1),r=a.getFullYear()+`-${("0"+(1+a.getMonth())).slice(-2)}-`+("0"+a.getDate()).slice(-2),a.setDate(a.getDate()-7),a=a.getFullYear()+`-${("0"+(1+a.getMonth())).slice(-2)}-`+("0"+a.getDate()).slice(-2),e=await getStockInfo(e,e,t.growthdb,a,r),console.log(e),updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ íŒë§¤í˜„í™© ì €ì¥ì¤‘"),await saveGrowthSales(e,o,n)):updateAutoCollectStatus("ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ ì‹¤íŒ¨")}async function saveGrowthSales(e,i,l){try{var t=e.filter(e=>"NEW"==e?.listingDetails?.skuGrade),u=e.filter(e=>"NEW"!==e?.listingDetails?.skuGrade);if(0<t.length){var d=[];for(const f of t){let e,t,r,a,n,o,s,c;c=f.trafficInfo?(e=f.trafficInfo.saleSummaryByDate.map(e=>e.unitsSold).slice(-30),t=f.trafficInfo.trafficSummaryByDate.map(e=>e.uniqueVisitor).slice(-30),r=f.trafficInfo.trafficSummaryByDate.map(e=>e.pageViews).slice(-30),a=f.trafficInfo.conversionSummaryByDate.map(e=>e.addToCart).slice(-30),n=f.trafficInfo.conversionSummaryByDate.map(e=>e.orders).slice(-30),o=f.trafficInfo.conversionSummaryByDate.map(e=>Math.round(1e3*e.pvToOrder)/10).slice(-30),s=f.trafficInfo.trafficSummaryByDate.map(e=>e.pageViews).slice(30).reduce((e,t)=>e+t,0),r.reduce((e,t)=>e+t,0)):(e=new Array(30).fill(0),t=new Array(30).fill(0),r=new Array(30).fill(0),a=new Array(30).fill(0),n=new Array(30).fill(0),o=new Array(30).fill(0),s=0);var p=e.reduce((e,t)=>e+t,0)/30,h=e.reduce((e,t)=>e+t,0),m=f.inventoryDetails?.inProgressInboundStatistics?.inProgressInboundQuantity||0,g=u.filter(t=>f.skuName.split(" ").every(e=>t.skuName.includes(e))).sort((e,t)=>t.salePrice-e.salePrice);d.push({"ì¸ë„¤ì¼":"http://image1.coupangcdn.com/image/"+f.listingDetails.mainImagePath,"íŒë§¤ìƒí’ˆëª…":f.listingDetails.vendorInventoryName,"ì˜µì…˜ëª…":f.listingDetails.vendorInventoryItemName,productId:f.listingDetails.productId,vendorItemId:f.vendorItemId,"ì¬ê³ ":f.orderableQuantity,"ì…ê³ ì¤‘":m,"ì›”íŒë§¤ìˆ˜ëŸ‰":h,"ì¼íŒë§¤ìˆ˜ëŸ‰":p,salesHistory:e,visitorHistory:t,pageViewHistory:r,cartHistory:a,orderHistory:n,pvToOrder:o,prevMonthlyClicks:s,currentMonthlyClicks:c,updateDate:f.updateDate,inventoryDetails:f.inventoryDetails,inboundInfo:f.inboundInfo,returnProducts:g,skuGrade:"NEW",companyid:i,suppliercode:l})}var r=await(await fetch(domain+"api/updateGrowthSalesV2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json();return console.log(r),"success"===r.res}return!1}catch(e){return console.error("ë¡œì¼“ê·¸ë¡œìŠ¤ íŒë§¤í˜„í™© ì €ì¥ ì¤‘ ì˜¤ë¥˜:",e),!1}}async function collectRankTracking(e){var t=await(n=await fetch(domain+"api/analysis/getranking",{method:"POST",headers:{"Content-Type":"application/json"},body:null})).json(),r=await chrome.tabs.query({}),a=r.find(e=>"couplus"==e.title),e=(chrome.tabs.update(a.id,{active:!0}),await sleep(8e3),r.find(e=>e.url.includes("wing.coupang.com"))),n=(updateAutoCollectStatus("ë­í‚¹ìˆ˜ì§‘ ì¤‘"),await gettrackingrank(t,a,e,1e3));console.log(n)}async function collectRocketGrowthProducts(e){var t=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}})).json(),r=t.companyid,t=t.suppliercode,a=(await chrome.tabs.query({})).find(e=>"couplus"==e.title),n=(chrome.tabs.update(a.id,{active:!0}),await confirmSupplierCode(t,e));if(!1===n&&"A0000TEST"!==t)updateAutoCollectStatus("ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ ì‹¤íŒ¨");else if(!0===n){updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ì‹ ê·œìƒí’ˆ ìˆ˜ì§‘ì¤‘");var o=await getGrowthProducts(e,a),s=await getUpbundleProducts(o);updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ì¬ê³ í˜„í™© ìˆ˜ì§‘ì¤‘");for(var n=await getTotalGrowthDb(e,a),c=n.map(e=>e.listingDetails.vendorInventoryId),i=0;i<o.length&&!c.includes(o[i].vendorInventoryId);i++)c.push(o[i].vendorInventoryId);console.log(c),console.log(c.includes(15079472224)),console.log(n),updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - í• ì¸ì¿ í° ìˆ˜ì§‘ì¤‘");var l=await getCoupons(c,e,a),u=(updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ë±ƒì§€í˜„í™© ìˆ˜ì§‘ì¤‘"),await getNoBadgeInfo(e,a));updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ìƒì„¸DB ìˆ˜ì§‘ì¤‘");var d,p=(p=await getDetailGrowthInfo(c,e,a,l)).filter(e=>e.skuId),p=(console.log(p.filter(e=>15079472224==e.vendorInventoryId)),console.log(p.filter(e=>90846211101==e.vendorItemId)),updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ìˆ˜ìˆ˜ë£Œ ìˆ˜ì§‘ì¤‘"),await getDetailMarginWithStock(p,e,a,l,n,u,s)),h=p.filter(e=>"NEW"!==e.skuGrade),s=p.filter(e=>e.upBundlingSize);console.log(s);for(d of p=p.filter(e=>"NEW"==e.skuGrade&&!e.upBundlingSize))d.returnProducts=h.filter(t=>d.skuName.split(" ").every(e=>t.skuName.includes(e))).map(e=>({salePrice:e.salePrice,coupon:e.coupon,"ìˆ˜ìˆ˜ë£Œ":e.ìˆ˜ìˆ˜ë£Œ,orderableQuantity:e.orderableQuantity,gmvForLast7Days:e.gmvForLast7Days,gmvForLast30Days:e.gmvForLast30Days,unitsSoldForLast7Days:e.unitsSoldForLast7Days,unitsSoldForLast30Days:e.unitsSoldForLast30Days,CVRFor30Days:e.CVRFor30Days,maxROAS:e.maxROAS,skuGrade:e.skuGrade,vendorItemId:e.vendorItemId,productId:e.productId,badge:e.badge,winner:e.winner,barcode:e.barcode,link:e.link,commission:e.commission})),85080153525==d.vendorItemId&&console.log(d),0<s.filter(e=>e.originVendorItemId==d.vendorItemId).length&&(console.log(d.vendorItemId),console.log(s.filter(e=>e.originVendorItemId==d.vendorItemId)),d.upBundlingProducts=s.filter(e=>e.originVendorItemId==d.vendorItemId).map(e=>({salePrice:e.salePrice,coupon:e.coupon,"ìˆ˜ìˆ˜ë£Œ":e.ìˆ˜ìˆ˜ë£Œ,orderableQuantity:Math.floor(d.orderableQuantity/e.upBundlingSize),gmvForLast7Days:e.gmvForLast7Days,gmvForLast30Days:e.gmvForLast30Days,unitsSoldForLast7Days:e.unitsSoldForLast7Days,unitsSoldForLast30Days:e.unitsSoldForLast30Days,CVRFor30Days:e.CVRFor30Days,maxROAS:e.maxROAS,skuGrade:e.skuGrade,vendorItemId:e.vendorItemId,productId:e.productId,badge:e.badge,winner:e.winner,barcode:e.barcode,link:e.link,commission:e.commission})),console.log(d.upBundlingProducts));console.log(p),console.log(p.filter(e=>e.returnProducts&&0<e.returnProducts.length)),p.filter(e=>e.returnProducts&&0<e.returnProducts.length).forEach(e=>{e.returnProducts=e.returnProducts.sort((e,t)=>t.salePrice-e.salePrice)}),updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ì €ì¥ì¤‘"),await saveGrowthDb(p,r,t)}else updateAutoCollectStatus("ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ ì •ë³´ ë¯¸ì¼ì¹˜")}async function saveGrowthDb(e,t,r){var a=e.map(e=>({...e,companyid:t,suppliercode:r})),n=a.map(e=>e.vendorItemId),o=[];for(let e=0;e<a.length;e+=50)o.push(a.slice(e,e+50));let s=0,c=0,i=0,l=0,u=0;try{for(let e=0;e<o.length;e++){var d=o[e];try{var p=await(await fetch(domain+"api/updateGrowthDBV2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({growthdb:d,vendorItemIds:n})})).json();"success"===p.res?(c++,l+=p.cnt_update,u+=p.cnt_reg):(console.log(d),i++,console.error("ì²­í¬ ì²˜ë¦¬ ì‹¤íŒ¨:",p.alert))}catch(e){i++,console.error("ì²­í¬ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:",e)}s+=d.length,console.log(`ìˆ˜ì§‘ ìƒí’ˆ ì €ì¥ ì¤‘ ... (${Math.round(s/a.length*100)}%)
                ì„±ê³µ: ${c}/${o.length} ì²­í¬,
                ì—…ë°ì´íŠ¸: ${l}, ì‹ ê·œ: `+u),await new Promise(e=>setTimeout(e,50))}0===i?(updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ì €ì¥ì™„ë£Œ"),console.log(`ì²˜ë¦¬ ì™„ë£Œ! ì—…ë°ì´íŠ¸: ${l}, ì‹ ê·œ: `+u),this.search()):(updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ì €ì¥ì¼ë¶€ì‹¤íŒ¨"),console.log(`ì¼ë¶€ ì²˜ë¦¬ ì‹¤íŒ¨ (${i}/${o.length} ì‹¤íŒ¨)
ì—…ë°ì´íŠ¸: ${l}, ì‹ ê·œ: `+u))}catch(e){updateAutoCollectStatus("ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆDB - ì €ì¥ì‹¤íŒ¨"),console.log("ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"),console.error("ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:",e)}}function updateAutoCollectStatus(t){chrome.tabs.query({},e=>{e.forEach(e=>{"couplus"==e.title&&chrome.tabs.sendMessage(e.id,{type:"autoCollectStatus",message:t})})})}function supplierLoginIfNeeded(e){var{id:e,pw:t}=e,r=document.querySelector('input[name="username"]');return r?(r.value=e,(r=document.querySelector('input[name="password"]'))&&(r.value=t),(e=document.querySelector('button.btn.btn-primary[type="submit"]'))?(e.click(),"ë¡œê·¸ì¸ ì‹œë„ ì™„ë£Œ"):"ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."):"ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœ"}function checkSupplierLoginStatus(){var e=document.querySelector("section.alert.alert-danger.rs-login-error");return e&&e.innerText.includes("ì•„ì´ë””")&&e.innerText.includes("ë¹„ë°€ë²ˆí˜¸")?"ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.":document.querySelector('input[name="username"]')?"ë¡œê·¸ì¸ ì§„í–‰ ì¤‘":"ë¡œê·¸ì¸ ì„±ê³µ"}async function getCoupangTabOrCreate(e){e=e.endsWith("/")?e+"*":e+"/*";let c=(await chrome.tabs.query({url:e}))[0];const i="https://wing.coupang.com/";return c?(console.log("[getCoupangTabOrCreate] Found existing tab: "+c.id),new Promise(async(a,t)=>{const n=c.id;let e=null,r=null;const o=()=>{e&&chrome.tabs.onUpdated.removeListener(e),r&&clearTimeout(r)};r=setTimeout(()=>{o(),console.error(`[getCoupangTabOrCreate] Timeout waiting for existing tab ${n} to reload/activate.`),t(new Error(`ê¸°ì¡´ íƒ­ (${n}) ë¡œë“œ/í™œì„±í™” ì‹œê°„ ì´ˆê³¼`))},3e4),e=(e,t,r)=>{e===n&&"complete"===t.status&&(r&&r.url&&r.url.startsWith(i)?console.log(`[getCoupangTabOrCreate] Existing tab ${n} reloaded/activated successfully.`):console.warn(`[getCoupangTabOrCreate] Tab ${n} loaded but URL mismatch: `+r?.url),o(),a(r))},chrome.tabs.onUpdated.addListener(e);try{await chrome.tabs.update(n,{url:i,active:!0});var s=await chrome.tabs.get(n);"complete"===s.status&&s.url&&s.url.startsWith(i)?(console.log(`[getCoupangTabOrCreate] Existing tab ${n} was already complete after update.`),o(),a(s)):console.log(`[getCoupangTabOrCreate] Waiting for existing tab ${n} to complete loading... Current status: `+s.status)}catch(e){console.error(`[getCoupangTabOrCreate] Error updating existing tab ${n}:`,e),o(),t(e)}})):(console.log("[getCoupangTabOrCreate] No existing tab found. Creating new one for "+i),new Promise(async(a,t)=>{let e;try{e=await chrome.tabs.create({url:i,active:!1}),console.log(`[getCoupangTabOrCreate] Created new tab ${e.id}. Waiting for load...`)}catch(e){return console.error("[getCoupangTabOrCreate] Error creating new tab:",e),t(e)}const n=e.id;let r=null,o=null;const s=()=>{r&&chrome.tabs.onUpdated.removeListener(r),o&&clearTimeout(o)};o=setTimeout(()=>{s(),console.error(`[getCoupangTabOrCreate] Timeout waiting for new tab ${n} to load.`),t(new Error(`ìƒˆ íƒ­ (${n}) ë¡œë“œ ì‹œê°„ ì´ˆê³¼`))},3e4),r=(e,t,r)=>{e===n&&"complete"===t.status&&(r&&r.url&&r.url.startsWith(i)?(console.log(`[getCoupangTabOrCreate] New tab ${n} loaded successfully.`),s(),a(r)):r&&(console.log(`[getCoupangTabOrCreate] New tab ${n} loaded but redirected to: `+r.url),s(),a(r)))},chrome.tabs.onUpdated.addListener(r);try{var c=await chrome.tabs.get(n);"complete"===c.status&&c.url&&c.url.startsWith(i)?(console.log(`[getCoupangTabOrCreate] New tab ${n} was already complete.`),s(),a(c)):console.log(`[getCoupangTabOrCreate] New tab ${n} status is '${c.status}'. Waiting for 'complete'.`)}catch(e){console.error(`[getCoupangTabOrCreate] Error checking status of new tab ${n}:`,e),s(),t(e)}}))}function loginIfNeeded(e){var{id:e,pw:t}=e,r=document.querySelector("#username");return r?(r.value=e,(r=document.querySelector("#password"))&&(r.value=t),(e=document.querySelector("#kc-login"))?(e.click(),"ë¡œê·¸ì¸ ì‹œë„ ì™„ë£Œ"):"ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."):"ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœ"}function checkLoginStatus(){var e=document.querySelector("#input-error");if(e){e=e.innerText||"";if(e.includes("ì•„ì´ë””")&&e.includes("ë¹„ë°€ë²ˆí˜¸")&&e.includes("ë‹¤ë¦…ë‹ˆë‹¤"))return"ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."}e=document.querySelector(".cp-mfa-title");return e&&e.innerText.includes("2ë‹¨ê³„")?"2ì°¨ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.":document.querySelector("#username")?"ë¡œê·¸ì¸ ì§„í–‰ ì¤‘":"ë¡œê·¸ì¸ ì„±ê³µ"}function loginTest(e){let n=e.supplierCode;return new Promise(t=>{if(document.querySelector("#username"))t("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. (loginTest ë‹¨ê³„)");else{var r=document.querySelector(".vendor-id-wrapper"),a=document.querySelector(".rs-account__menu--primary");let e=null;r?e=r.innerText.replaceAll("ì—…ì²´ì½”ë“œ ",""):a&&(e=a.innerText),e?e!==n?t("íŒë§¤ì ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."):t("ë¡œê·¸ì¸ ì„±ê³µ"):t("ë¡œê·¸ì¸ ë˜ì—ˆìœ¼ë‚˜ ì—…ì²´ ì½”ë“œ í™•ì¸ ë¶ˆê°€")}})}async function coupangLoginTest(e){var t=(await chrome.tabs.query({})).find(e=>e.active&&"couplus"===e.title);try{var r=await getCoupangTabOrCreate("https://wing.coupang.com/"),a=(console.log("í™•ë³´ëœ wingtab:",r),await chrome.scripting.executeScript({target:{tabId:r.id},function:loginIfNeeded,args:[e]})),n=a?.[0]?.result;if(console.log("loginIfNeeded ê²°ê³¼:",n),"ë¡œê·¸ì¸ ì‹œë„ ì™„ë£Œ"===n){var o=Date.now();let e=null;for(;Date.now()-o<15e3;){await new Promise(e=>setTimeout(e,1e3));var s=(await chrome.scripting.executeScript({target:{tabId:r.id},function:checkLoginStatus}))?.[0]?.result;if(console.log("ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸:",s),"ë¡œê·¸ì¸ ì„±ê³µ"===s){e="ë¡œê·¸ì¸ ì„±ê³µ";break}if("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."===s){e=s;break}if("2ì°¨ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤."===s){e=s;break}}if("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."===e)return void chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."});if("2ì°¨ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤."===e)return void chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"2ì°¨ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ì§ì ‘ ì¸ì¦ì„ ì™„ë£Œí•´ ì£¼ì„¸ìš”."});if("ë¡œê·¸ì¸ ì„±ê³µ"!==e)return void chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ë¡œê·¸ì¸ ëŒ€ê¸° ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤."})}else if("ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."===n)return void chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."});var c,i=(await chrome.scripting.executeScript({target:{tabId:r.id},function:loginTest,args:[e]}))?.[0]?.result;console.log("loginTest ê²°ê³¼:",i),"ë¡œê·¸ì¸ ì„±ê³µ"===i?await confirmSupplierCode(e.supplierCode,r)?chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!0,msg:"ë¡œê·¸ì¸ ë° ê³µê¸‰ì—…ì²´ ì½”ë“œ í™•ì¸ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤."}):chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”."}):"íŒë§¤ì ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."===i?chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ë¡œê·¸ì¸ì€ ë˜ì—ˆì§€ë§Œ íŒë§¤ì ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."}):"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. (loginTest ë‹¨ê³„)"===i?chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”."}):"ë¡œê·¸ì¸ ë˜ì—ˆìœ¼ë‚˜ ì—…ì²´ ì½”ë“œ í™•ì¸ ë¶ˆê°€"===i?chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ë¡œê·¸ì¸ì€ ë˜ì—ˆìœ¼ë‚˜ ì—…ì²´ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}):(c=i||"ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ í™•ì¸ ë¶ˆê°€. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:c}))}catch(e){console.error("coupangLoginTest error:",e),t&&chrome.tabs.sendMessage(t.id,{response:"coupangLoginTest",result:!1,msg:"ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+e.message})}finally{t&&await chrome.tabs.update(t.id,{active:!0})}}async function preventDiscardAllTabs(){try{var e;for(e of await chrome.tabs.query({}))console.log(e.autoDiscardable),e.autoDiscardable&&(await chrome.tabs.update(e.id,{autoDiscardable:!1}),console.log(`íƒ­ ID ${e.id}ì˜ autoDiscardableì´ falseë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`))}catch(e){console.error("ì—ëŸ¬ ë°œìƒ: "+e.message)}}async function getKeywordCategory(e){console.log(e.keyword);var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title),t=t.find(e=>e.url.includes("wing.coupang.com"));t&&(t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:getCategoryFromKeyword,args:[e.keyword]}))[0].result,console.log(t),chrome.tabs.sendMessage(r.id,{response:"getKeywordCategory",category:t.category,click:t.click,rate:t.rate,keyword:e.keyword}))}async function fetchKeywordCategory(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},function:getCategoryFromKeyword,args:[e]}))[0].result}async function getCategoryFromKeyword(e){console.log(e);let t=0;for(;t<3;)try{var r=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],a=await(await fetch("https://wing.coupang.com/tenants/seller-web/pre-matching/search",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-xsrf-token":r},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({keyword:e,excludedProductIds:[],searchPage:0,searchOrder:"DEFAULT",sortType:"DEFAULT"}),method:"POST",mode:"cors",credentials:"include"})).json();if(console.log(a),a.result&&0<a.result.length){var n,o=[];for(let t of a.result)t.displayCategoryInfo[0]&&((n=o.find(e=>e.category===t.displayCategoryInfo[0].categoryHierarchy))?n.cnt++:o.push({cnt:1,category:t.displayCategoryInfo[0].categoryHierarchy}));var s=function(e){if(e.length<=6)return 0;e.forEach(e=>{null==e.pvLast28Day&&(e.pvLast28Day=0)}),e.sort((e,t)=>e.pvLast28Day-t.pvLast28Day);var t=e.length,r=Math.floor(.2*t),e=e.slice(r,t-r),t=e.reduce((e,t)=>e+t.pvLast28Day,0),r=t/e.length;return r}(a.result),c=o.sort((e,t)=>t.cnt-e.cnt),i=c[0].category,l=parseInt(c[0].cnt/o.reduce((e,t)=>e+t.cnt,0)*100);return console.log("click:"+s),console.log("category:",i),console.log("rate:",l),{category:i,rate:l,click:parseInt(s),categories:a.result}}return{category:"ë¯¸ë¶„ë¥˜",rate:0,click:0,categories:[]}}catch(e){if(console.log(`Retry ${t+1}/3: Error occurred, retrying after 1 second...`,e),!(++t<3))return{category:"ë¯¸ë¶„ë¥˜",rate:0,click:0,categories:[]};await(t=>new Promise(e=>setTimeout(e,t)))(1e4)}}async function getTopProductsWing(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},function:getTopProductsFromWing,args:[e]}))[0].result}async function getTopProductsFromWing(e){console.log(e);let t=0;for(;t<3;)try{var r=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],a=await(await fetch("https://wing.coupang.com/tenants/seller-web/pre-matching/search",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-xsrf-token":r},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({keyword:e,excludedProductIds:[],searchPage:0,searchOrder:"DEFAULT",sortType:"DEFAULT"}),method:"POST",mode:"cors",credentials:"include"})).json();return console.log(a),a.result&&0<a.result.length?a.result:[]}catch(e){if(console.log(`Retry ${t+1}/3: Error occurred, retrying after 1 second...`,e),!(++t<3))return[];await(t=>new Promise(e=>setTimeout(e,t)))(1e4)}}async function functionCollectKeyword(t){var e=await chrome.tabs.query({}),r=e.find(e=>e.active&&"couplus"==e.title),a=e.find(e=>e.url.includes("datalab.naver.com/shoppingInsight/sCategory.naver"));if(a){for(var e=parseInt(parseInt(t.startRank-1)/20),n=parseInt(parseInt(t.endRank-1)/20),o=[],s=e;s<n+1;s++){var c=s+1,c=(chrome.tabs.sendMessage(r.id,{response:"datalabKeywordStatus",status:s/n,text:"ë°ì´í„°ë© í‚¤ì›Œë“œ ìˆ˜ì§‘ì¤‘"}),await chrome.scripting.executeScript({target:{tabId:a.id},function:getKeywordFromDataLab,args:[c]})),o=o.concat(c[0].result);await sleep(2e3)}e=o.filter(e=>e.rank>=t.startRank&&e.rank<=t.endRank).map(e=>e.keyword);console.log(e),chrome.tabs.sendMessage(r.id,{response:"collectKeyword",keywords:e})}}async function getKeywordFromDataLab(e){var t=(t=Array.from(document.getElementsByClassName("active")).filter(e=>"active"===e.className)).slice(t.length-1)[0].children[0].dataset.cid,r=document.querySelector(".set_period_target").innerText.replaceAll("\n","").replaceAll(" ","-").split("-ë¶€í„°-")[0],a=document.querySelector(".set_period_target").innerText.replaceAll("\n","").replaceAll(" ","-").split("-ë¶€í„°-")[1],n=document.getElementById("18_device_0").checked?"pc%2Cmo":document.getElementById("18_device_1").checked?"pc":document.getElementById("18_device_2").checked?"mo":"",o=document.getElementById("19_gender_0").checked?"f%2Cm":document.getElementById("19_gender_1").checked?"f":document.getElementById("19_gender_2").checked?"m":"",s="",c=0,c=(document.getElementById("20_age_0").checked?s="10%2C20%2C30%2C40%2C50%2C60":(document.getElementById("20_age_1").checked&&(s="10",c++),document.getElementById("20_age_2").checked&&(0<c?s+="%2C20":s="20",c++),document.getElementById("20_age_3").checked&&(0<c?s+="%2C30":s="30",c++),document.getElementById("20_age_4").checked&&(0<c?s+="%2C40":s="40",c++),document.getElementById("20_age_5").checked&&(0<c?s+="%2C50":s="50",c++),document.getElementById("20_age_6").checked&&(0<c?s+="%2C60":s="60")),"cid="+t+"&timeUnit=date&startDate="+r+"&endDate="+a+"&age="+s+"&gender="+o+"&device="+n+"&page="+e+"&count=20");console.log(c);t=await(await fetch("https://datalab.naver.com/shoppingInsight/getCategoryKeywordRank.naver",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://datalab.naver.com/shoppingInsight/sCategory.naver",referrerPolicy:"unsafe-url",body:c,method:"POST",mode:"cors",credentials:"include"})).text();return(await JSON.parse(t)).ranks}async function functionGetProductInfo(e){var e=e.url,t=(console.log(e),await chrome.tabs.query({})),r=t.find(e=>e.active&&"couplus"==e.title),t=(console.log(t),await chrome.tabs.create({url:e,active:!1})),t=(await chrome.tabs.update(t.id,{autoDiscardable:!1}),await fetchinfo(t,e));console.log(t),t&&chrome.tabs.sendMessage(r.id,{result:t})}async function functionMakePage(e){var r=e.data;console.log(r),chrome.tabs.create({url:r.ë“±ë¡ë§í¬,active:!0},async e=>{var t=await makepage(e,r);console.log(t),t&&(chrome.tabs.create({url:chrome.runtime.getURL("imagepage.html"),selected:!0},e=>{chrome.scripting.executeScript({target:{tabId:e.id},files:["script.js"]},function(){chrome.tabs.sendMessage(e.id,{action:"changeHTML",tabid:e.id,data:t})})}),chrome.tabs.remove(e.id,function(e){console.log(e)}))})}async function functionKeywordAnalysis(e){auth=e.auth;var t,r,a,n,o=e.ad,s=(await secretOn(),await chrome.tabs.query({})),c=(console.log(s),s.find(e=>e.active&&"couplus"==e.title)),i=s.find(e=>e.url.includes("https://advertising.coupang.com/")),l="https://www.coupang.com/np/search?component=&q="+e.data[0]+"&channel=user",u=await chrome.tabs.create({url:l,active:!1}),d=(await chrome.tabs.update(u.id,{autoDiscardable:!1}),s.find(e=>e.url.includes("m.coupang.com"))),p=(d||(d=await chrome.tabs.create({url:"https://m.coupang.com",active:!1}),await chrome.tabs.update(d.id,{autoDiscardable:!1})),await chrome.tabs.create({url:"https://search.shopping.naver.com/search/all",active:!1}));await chrome.tabs.update(p.id,{autoDiscardable:!1}),sstab=s.find(e=>e.url.includes("smartstore.naver.com")),bstab=s.find(e=>e.url.includes("brand.naver.com"));for(t of e.data)[r,a,n]=i?await Promise.all([fetchcoupang([t],u,c,!1,d,o),fetchnaver([t],p,auth,c),fetchcpc([t],i)]):await Promise.all([fetchcoupang([t],u,c,!1,d,o),fetchnaver([t],p,auth,c)]),console.log(r),console.log(a),await chrome.tabs.sendMessage(c.id,{response:"keywordanalysis",coupang:r,naver:a,cpc:n});chrome.tabs.remove(u.id),chrome.tabs.remove(p.id),chrome.tabs.remove(sstab.id),chrome.tabs.remove(bstab.id)}async function functionStoreParsing(e){auth=e.auth;var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title),a=await chrome.tabs.create({url:"https://search.shopping.naver.com/search/all",active:!1}),t=(await chrome.tabs.update(a.id,{autoDiscardable:!1}),sstab=t.find(e=>e.url.includes("smartstore.naver.com")),bstab=t.find(e=>e.url.includes("brand.naver.com")),await fetchnaverparsing(e.data,a,r,auth));console.log(t),await chrome.tabs.sendMessage(r.id,{response:"storeparsing",storeparsing:t}),chrome.tabs.remove(a.id),chrome.tabs.remove(sstab.id),chrome.tabs.remove(bstab.id)}async function functionGetRelatedKeywords(e){await secretOn();var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title),e=e.data,t=(console.log(e),t.find(e=>e.url.includes("https://www.coupang.com"))),e=await fetchrelatedkeywords(e,t=t||await chrome.tabs.create({url:"https://www.coupang.com",active:!1}));console.log(e),e&&chrome.tabs.sendMessage(r.id,{response:"relatedkeywords",relatedkeywords:e.relatedkeywords}),chrome.tabs.remove(t.id,function(e){console.log(e)})}async function functionGetTotalRelatedKeywords(e){await secretOn();var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title),a=e.data,e=(console.log(e.data),t.find(e=>e.url.includes("https://www.coupang.com"))),t=await getrelatedkeywords(a,e=e||await chrome.tabs.create({url:"https://www.coupang.com",active:!1}),r,!1,!0,!0);console.log(t),t&&chrome.tabs.sendMessage(r.id,{response:"totalrelatedkeywords",relatedkeywords:t}),chrome.tabs.remove(e.id,function(e){console.log(e)})}async function functionGetAdKeyword(e){await secretOn();var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title),a=e.data,n=(console.log(e.data),e.cnt),o=e.relKeywordChecked,s=e.autoCompleteChecked,a=await getrelatedkeywords(a,t.find(e=>e.url.includes("https://www.coupang.com"))||await chrome.tabs.create({url:"https://www.coupang.com",active:!1}),r,n,o,s),t=(console.log(a),a);console.log(t),chrome.tabs.sendMessage(r.id,{response:"adkeywords",id:e.id,relatedkeywords:t})}async function functionAddRelatedKeywords(e){await secretOn();var t=(await chrome.tabs.query({})).find(e=>e.active&&"couplus"==e.title),r=e.data,a=(console.log(e.data),e.opt),e=(console.log(e.opt),await getCoupangUrl()),e=await chrome.tabs.create({url:e,active:!1}),r=(await chrome.tabs.update(e.id,{autoDiscardable:!1}),await addrelatedkeywords(r,e,t,a));console.log(r),r&&chrome.tabs.sendMessage(t.id,{response:"addrelkeywords",relatedkeywords:r}),chrome.tabs.remove(e.id,function(e){console.log(e)})}async function getCollectTr(e){var t=e.companyid;console.log(e);e=(await chrome.tabs.query({})).find(e=>e.active&&"couplus"==e.title),t=await collecttrackingproduct(t);console.log(t),t&&chrome.tabs.sendMessage(e.id,{msg:"tracking",cnt:t,res:t.msg})}async function addRank(e){var t,r,a=await chrome.tabs.query({}),n=a.find(e=>e.active&&"couplus"==e.title),a=(a.find(e=>e.url.includes("www.coupang.com"))?t=a.find(e=>e.url.includes("www.coupang.com")):(t=await chrome.tabs.create({url:"https://www.coupang.com",active:!1}),await chrome.tabs.update(t.id,{autoDiscardable:!1})),chrome.tabs.sendMessage(n.id,{response:"keywordanalysisstatusratio",status:0,text:"ë­í‚¹ì¶”ì  ì¶”ê°€ ì¤‘"}),e.link),o=e.keywords,s=await getProductInfo(a,t),c=[];for(r of o)c.push({companyid:e.companyid,keyword:r,vendorItemId:s.vendorItemId,image:"https:"+s.images[0].origin,itemId:s.itemId,itemName:s.itemName,productId:s.productId,ranklist:[]});try{var i=await fetch(domain+"api/analysis/insertrankingall",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),l=(console.log(i),await i.json());console.log(l),"success"==l.ìš”ì²­ê²°ê³¼&&chrome.tabs.sendMessage(n.id,{response:"addRankSuccess"})}catch(e){console.log(e),cnt_error++}chrome.tabs.remove(t.id,function(e){console.log(e)})}async function totalTrackingRank(e){var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title);if(0!=e.rankArr.length)try{var a=t.find(e=>e.url.includes("wing.coupang.com")),n=(chrome.tabs.sendMessage(r.id,{response:"keywordanalysisstatusratio",status:0,text:"ë­í‚¹ìˆ˜ì§‘ ì¤‘"}),await gettrackingrank(e.rankArr,r,a,e.delayTime));console.log(n)}catch(e){console.error("Error in totalTrackingRank:",e),chrome.tabs.sendMessage(r.id,{response:"keywordanalysisstatusratio",status:1,text:"ë­í‚¹ìˆ˜ì§‘ ì˜¤ë¥˜ ë°œìƒ"})}}async function checkActive(e){for(var t=0;;){if((await chrome.scripting.executeScript({target:{tabId:e},function:()=>!!document.querySelector("#goodsList")}))[0].result)return;if(40<t)return;await sleep(500),t++}}async function gettrackingrank(e,t,r,a){for(var n=new Date,o=n.getFullYear()+"-"+("0"+(1+n.getMonth())).slice(-2)+"-"+("0"+n.getDate()).slice(-2),s=(console.log(e),0);s<e.length&&collectRankContinue;s++){var c=e[s],i=(console.log(c),chrome.tabs.sendMessage(t.id,{response:"keywordanalysisstatusratio",status:(s+1/e.length).toFixed(0),text:"ë­í‚¹ìˆ˜ì§‘ ì¤‘"}),"("+(s+1)+"/"+e.length+")"),i=await fetchProductRank(c.keyword,c.productId,t,i,a),l=r?(l=await chrome.scripting.executeScript({target:{tabId:r.id},function:getImpressionsProduct,args:[c.productId,c.itemId]}),console.log(l),l[0].result):null;console.log(i),c.ranklist.find(e=>e.date==o)?(c.ranklist.find(e=>e.date==o).rank=i.rank,c.ranklist.find(e=>e.date==o).totalrank=i.totalrank,c.ranklist.find(e=>e.date==o).click=l):c.ranklist.push({date:o,rank:i.rank,totalrank:i.totalrank,click:l}),100<=c.ranklist.length&&(c.ranklist=c.ranklist.slice(c.ranklist.length-100,c.ranklist.length)),console.log(c);try{var u=await fetch(domain+"api/analysis/updaterankingall",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([c])}),d=(console.log(u),await u.json());console.log(d),"success"==d.ìš”ì²­ê²°ê³¼&&chrome.tabs.sendMessage(t.id,{response:"collectRankResult",result:c})}catch(e){console.log(e),c.productId,c.keyword}}return!0}async function fetchProductRank(e,a,n,t,r){for(var o="30í˜ì´ì§€ ì´ìƒ",s=1e3,c=e,i=(console.log(e,a),30),l=0;l<i&&(await sleep(500),collectRankContinue);l++){let t=null,r=!1;for(let e=0;e<3;e++)try{if(t=await fetchkeywordmAPI(c,l+1),console.log(t,e+"íšŒ"),t.domCheck){r=!0;break}await sleep(1e3)}catch(e){console.log("Error in fetchkeywordmAPI:",e)}if(!r){console.log("ì²« ë²ˆì§¸ 2íšŒ ì‹œë„ ì‹¤íŒ¨, waitForRefresh í˜¸ì¶œ ë° 8ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„");try{await sleep(8e3);for(let e=0;e<2;e++)try{if(t=await fetchkeywordmAPI(c,l+1),console.log(t,"ì¶”ê°€ ì‹œë„ "+e+"íšŒ"),t.domCheck){r=!0;break}await sleep(1e3)}catch(e){console.log("Error in fetchkeywordmAPI (ì¶”ê°€ ì‹œë„):",e)}}catch(e){console.error("waitForRefresh ì˜¤ë¥˜:",e)}if(!r)return console.log("ì¶”ê°€ 2íšŒ ì‹œë„ í›„ì—ë„ domcheck ì‹¤íŒ¨"),{rank:o,totalrank:s}}if(t&&t.lastpage&&t.lastpage<30&&(i=t.lastpage),console.log(l+1+"page / "+i),chrome.tabs.sendMessage(n.id,{response:"keywordanalysisstatusratio",status:l+1+"page / "+i,text:'"'+e+'" ë­í‚¹ìˆ˜ì§‘ ì¤‘'}),null===t||!t.productlists)break;var u=t.productlists.find(e=>parseInt(e.productId)==parseInt(a));if(u){s=l*t.productlists.length+parseInt(u.rank),o=l+1+"p/"+u.rank,console.log(o);break}}return{rank:o,totalrank:s}}async function waitForRefresh(o){return new Promise((r,a)=>{let n=0;console.log("ë¨¼ì € ìƒˆë¡œê³ ì¹¨ ìˆ˜í–‰ í›„ DOM ì²´í¬ ì‹œì‘"),chrome.tabs.reload(o,{},()=>{setTimeout(function t(){n++,console.log(`DOM ì²´í¬ #${n} ì‹œì‘`),async function(){try{var e=(await chrome.scripting.executeScript({target:{tabId:o},function:()=>({hasGoodsList:!!document.querySelector("#goodsList"),url:window.location.href})}))[0].result;return console.log(`DOM check #${n}: goodsList exists: ${e.hasGoodsList}, URL: `+e.url),!!e.hasGoodsList&&(r({id:o,url:e.url}),!0)}catch(e){return console.error("Error checking DOM:",e),!1}}().then(e=>{e||(16<=n?(console.log("ìµœëŒ€ ì²´í¬ íšŸìˆ˜ ë„ë‹¬, ë‹¤ì‹œ ìƒˆë¡œê³ ì¹¨..."),chrome.tabs.reload(o,{},()=>{n=0,setTimeout(t,3e3)})):setTimeout(t,500))}).catch(e=>{a(e)})},3e3)}),setTimeout(()=>{a(new Error("Timeout: Tab did not load in time."))},3e4)})}async function collectRankStop(){collectRankContinue=!1}async function getCoupangUrl(){return"https://www.coupang.com"}async function getMargin(e,t,r){if(t){var a=await chrome.tabs.query({}),n=a.find(e=>e.active&&"couplus"==e.title),a=a.find(e=>e.url.includes("wing.coupang.com"));if(console.log(n),console.log(a),!a)return void alertPage(n,"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");if(!1===await confirmSupplierCode(localsuppliercode,a))return void alertPage(n,"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.")}else a=r;var o,s;return e.info.x=e.info.x||100,e.info.y=e.info.y||100,e.info.z=e.info.z||100,e.info.w=e.info.w||100,e.info.categoryId?(r=await getSizeName(e.info,a),o=await getfulfillmentfee(a,e.info,r),s=await getwarehousefee(a,e.info,r),a=await getSalesFee(a,e.info),console.log(r,o,s,a),t?void applySalesInfo(n,e.info,o,s,a,r):{"ë°°ì†¡ë¹„":parseInt(o),"ì…ì¶œê³ ë¹„":parseInt(s),"íŒë§¤ìˆ˜ìˆ˜ë£Œìœ¨":a,sizeName:r}):{"ë°°ì†¡ë¹„":0,"ì…ì¶œê³ ë¹„":0,"íŒë§¤ìˆ˜ìˆ˜ë£Œìœ¨":0,sizeName:"í™•ì¸ë¶ˆê°€"}}async function applySalesInfo(e,t,r,a,n,o){chrome.scripting.executeScript({target:{tabId:e.id},function:applySales,args:[t,r,a,n,o]})}async function applySales(e,t,r,a,n){console.log(e,t,r,a,n);var o,n=e.rank,e=e.type,e=("products"==e&&(document.querySelector("#productList")&&(s=document.querySelector("#productList").children[n-1].querySelector(".image")),document.querySelector("#product-list"))&&(s=document.querySelector("#product-list").children[n-1].querySelector(".ProductUnit_productImage__Mqcg1")),"bestProducts"==e&&(s=document.querySelector(".best-seller-carousel-item-list")?document.querySelector(".best-seller-carousel-item-list").children[n-1].querySelector(".image"):document.querySelector(".sdw-carousel-list").children[n-1].querySelector(".ProductUnit_productImage__Mqcg1")),"product"==e&&(s=document.querySelector("#repImageContainer")?document.querySelector("#repImageContainer"):document.querySelector(".product-image")),"shopProducts"==e&&(s=document.querySelector(".products-list").children[n-1].querySelector(".info-wrapper-image")),s="storeProducts"==e?document.querySelector("#product-list").children[n-1].querySelector(".image"):s),n=parseFloat(e.querySelector(".price").value),s=Math.round(1.1*r),r=Math.round(1.1*t),t=Math.round(1.1*parseFloat(a)*100)/100,a=Math.round(n*commisionRate*1.1/100+1.1*r+1.1*s),t=(e.querySelector(".commissionRate").innerText=t,e.querySelector(".warehouseFee").innerText=s,e.querySelector(".fullfillmentFee").innerText=r,e.querySelector(".commission").innerText=a,parseFloat(e.querySelector(".currency").value)*parseFloat(e.querySelector(".exchangeRate").value)),s=Math.round(10*(n-t-a)/11),r=Math.round(s/n*100),a=Math.round(s/t*100),c=parseInt(e.querySelector(".monthQty").innerText.replaceAll(",","")),n=n*c,c=c*s;e.querySelector(".cvr")&&(o=parseFloat(e.querySelector(".cvr").innerText),o=Math.round(s*o/100),e.querySelector(".minAdROI").innerText=o),e.querySelector(".purchasePrice").innerText=t.toLocaleString(),e.querySelector(".margin").innerText=s.toLocaleString(),e.querySelector(".marginRate").innerText=r,e.querySelector(".ROI").innerText=a,e.querySelector(".monthSales").innerText=n.toLocaleString(),e.querySelector(".monthMargin").innerText=c.toLocaleString()}async function getSizeName(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},function:async function(e,t,r,a){var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await fetch("https://wing.coupang.com/tenants/rfm/api/accounting/revamp/vendor-item-capacity-type-by-quantity",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/rfm/settlements/fee-information?utm_source=winghome",referrerPolicy:"strict-origin-when-cross-origin",body:'{"length":'+e+',"width":'+t+',"height":'+r+',"weight":'+a+',"quantity":1}',method:"POST",mode:"cors",credentials:"include"})).text()},args:[e.x,e.y,e.z,e.w]}))[0].result}async function getfulfillmentfee(e,t,r){if(t.categoryId)var a=t.categoryId;else{if(!t.salesInfo.productInfo.leafCategoryInfo)return 0;a=t.salesInfo.productInfo.leafCategoryInfo.categoryId}var n=t.price||t.salesInfo.price;return(await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(e,t,r,a){var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await(await fetch("https://wing.coupang.com/tenants/rfm/api/accounting/revamp/fulfillment-fee",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/rfm/settlements/fee-information?utm_source=winghome",referrerPolicy:"strict-origin-when-cross-origin",body:'{"agreementScope":"PRODUCTION","capacityType":"'+r+'","kanCategoryId":'+e+',"amount":"'+t+'","length":'+a.x+',"width":'+a.y+',"height":'+a.z+',"weight":'+a.w+',"quantity":1}',method:"POST",mode:"cors",credentials:"include"})).json()).calculatedFeeDetails.finalTotalAmount.amount},args:[a,n,r,t]}))[0].result}async function getwarehousefee(e,t,r){if(t.categoryId)var a=t.categoryId;else{if(!t.salesInfo.productInfo.leafCategoryInfo)return 0;a=t.salesInfo.productInfo.leafCategoryInfo.categoryId}var n=t.price||t.salesInfo.price;return(await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(e,t,r,a){var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];Date.now();return(await(await fetch("https://wing.coupang.com/tenants/rfm/api/accounting/revamp/warehousing-fee",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/rfm/settlements/fee-information?utm_source=winghome",referrerPolicy:"strict-origin-when-cross-origin",body:'{"agreementScope":"PRODUCTION","capacityType":"'+r+'","kanCategoryId":'+e+',"amount":"'+t+'","length":'+a.x+',"width":'+a.y+',"height":'+a.z+',"weight":'+a.w+',"quantity":1}',method:"POST",mode:"cors",credentials:"include"})).json()).calculatedFeeDetails.finalTotalAmount.amount},args:[a,n,r,t]}))[0].result}async function getSalesFee(e,t){if(t.categoryId)var r=t.categoryId;else{if(!t.salesInfo.productInfo.leafCategoryInfo)return 0;r=t.salesInfo.productInfo.leafCategoryInfo.categoryId}return(await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(e){var t=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await(await fetch("https://wing.coupang.com/tenants/seller-web/v2/vendor-inventory/commission?categoryId="+e,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":t},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()).serviceFeeRatio},args:[r]}))[0].result}async function getOptionUnit(e,t){console.log(e);t=await chrome.scripting.executeScript({target:{tabId:t.id},function:async function(e){var t=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await fetch("https://wing.coupang.com/vendor-inventory/attribute?categoryId=5948",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="122", "Not(A:Brand";v="24", "Google Chrome";v="122"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":t},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()},args:[e]});return console.log(t),t[0].result}async function getCategoryId(e,t,r,a){var n;if(r){for(var o=await fetchkeywordb(e.info.keyword,1,1),s=(console.log(o),[]),c=0;c<o.productlists.length;c++){var i=o.productlists[c],l=i.vendorItemId;n=await getProductInfo("https://www.coupang.com/vp/products/"+i.productId+"?vendorItemId="+l,t),chrome.tabs.sendMessage(a.id,{response:"keywordanalysisstatusratio",status:c/o.productlists.length,text:'"'+e.info.keyword+'" í‚¤ì›Œë“œ ì¹´í…Œê³ ë¦¬ ìˆ˜ì§‘ ì¤‘'}),n&&n.leafCategoryInfo&&s.push({rank:i.rank,categoryId:n.leafCategoryInfo.categoryId,productId:n.productId,productInfo:n})}return s}return(n=e.info.link&&e.info.link.includes("coupang.com")?await getProductInfo(e.info.link,t):(o=await fetchkeywordb(e.info.keyword,1,1),console.log(o),l=o.productlists[0].vendorItemId,await getProductInfo("https://www.coupang.com/vp/products/"+o.productlists[0].productId+"?vendorItemId="+l,t)))&&n.leafCategoryInfo?n.leafCategoryInfo.categoryId:null}async function alertPage(e,t){chrome.scripting.executeScript({target:{tabId:e.id},function:function(e){alert(e)},args:[t]})}async function importShipment(e){var t,e=e.suppliercode,r=(await chrome.tabs.query({})).find(e=>e.active&&"couplus"==e.title),a=await chrome.tabs.create({url:"https://supplier.coupang.com/ibs/asn/active",active:!1});await chrome.tabs.update(a.id,{autoDiscardable:!1}),!a||!1===(t=await confirmSupplierCode(e,a))?chrome.tabs.sendMessage(r.id,{msg:"resImportShipment",res:"ìƒˆíƒ­ì— ì¿ íŒ¡supplierë¥¼ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",shipment:[],suppliercode:e}):!0===t?(a=await getTotalShipment(a),chrome.tabs.sendMessage(r.id,{msg:"resImportShipment",res:"success",shipment:a,suppliercode:e})):chrome.tabs.sendMessage(r.id,{msg:"resImportShipment",res:"ì¿ íŒ¡supplier ë¡œê·¸ì¸ì •ë³´ê°€ ì¿ í”ŒëŸ¬ìŠ¤ ë¡œê·¸ì¸ì •ë³´ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",shipment:[],suppliercode:t})}async function getTotalShipment(e){for(var t=1,r=[],a=0;a<t;a++){var n=(await chrome.scripting.executeScript({target:{tabId:e.id},function:getShipment,args:[a+1,t]}))[0].result;if(!n.pageCnt)break;if(t=n.pageCnt,r=r.concat(n.tableData),n.breakpoint)break}return r}async function getShipment(e,t){var r=new Date,a=r.getFullYear()+"-"+("0"+(1+r.getMonth())).slice(-2)+"-"+("0"+r.getDate()).slice(-2);r=await(await fetch("https://supplier.coupang.com/ibs/shipment/parcel/list?pageNumber="+e+"&centerCode=&carrierCode=&estimatedDeliveryDate=&shipmentSeq=&purchaseOrderSeq=",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="116", "Not)A;Brand";v="24", "Google Chrome";v="116"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://supplier.coupang.com/ibs/asn/active",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),e=await(e=r),r=await(new DOMParser).parseFromString(e,"text/html"),e=function(e,t){var r=e.getElementById(t);if(!r)return console.error("Table not found."),null;var a=[],n=[],o=r.rows[0];for(let e=0;e<o.cells.length-1;e++)a.push(o.cells[e].textContent);for(let e=1;e<r.rows.length;e++){var s=r.rows[e],c={};for(let e=0;e<s.cells.length-1;e++)c[a[e]]=s.cells[e].textContent.replaceAll("\n","").trim();n.push(c)}return n}(r,"parcel-tab"),r=Array.from(r.querySelectorAll("script")).find(e=>e.innerHTML.includes("('#parcel-pagination').bootpag({")).innerHTML,t=parseInt(r.slice(r.search("total"),r.search("prev")).replace("total","").replace(":","").replaceAll(",","").trim()),r=!1;return e.find(e=>e.ì…ê³ ì˜ˆì •ì¼<a)&&(r=!0),{tableData:e,pageCnt:t,breakpoint:r}}async function collectGrowthInfo(e){var t=e.companyid,r=(console.log(e),e.suppliercode),e=e.allowedVendorNames||[],a=await chrome.tabs.query({}),n=a.find(e=>e.active&&"couplus"==e.title),a=a.find(e=>e.url.includes("wing.coupang.com"));if(a){var o=await confirmSupplierCode(r,a);if(!1===o&&"A0000TEST"!==r)chrome.tabs.sendMessage(n.id,{msg:"growthDb",res:"ì¿ íŒ¡ìœ™ì— ë¡œê·¸ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:r,companyid:t});else if(!0===o){var s=await getGrowthProducts(a,n),c=(console.log(s),await getUpbundleProducts(s));console.log(c);for(var i=await getTotalGrowthDb(a,n),l=i.map(e=>e.listingDetails.vendorInventoryId),u=0;u<s.length&&!l.includes(s[u].vendorInventoryId);u++)l.push(s[u].vendorInventoryId);console.log(l),console.log(i);var d,p=await getCoupons(l,a,n),h=(console.log(p),await getNoBadgeInfo(a,n)),m=(console.log(h),[]),a=await getDetailMarginWithStock((await getDetailGrowthInfo(l,a,n,p)).filter(e=>e.skuId),a,n,p,i,h,c),m=a.filter(e=>"NEW"!==e.skuGrade),c=a.filter(e=>e.upBundlingSize);for(d of a=a.filter(e=>"NEW"==e.skuGrade&&!e.upBundlingSize))d.returnProducts=m.filter(t=>d.skuName.split(" ").every(e=>t.skuName.includes(e))).map(e=>({salePrice:e.salePrice,coupon:e.coupon,"ìˆ˜ìˆ˜ë£Œ":e.ìˆ˜ìˆ˜ë£Œ,orderableQuantity:e.orderableQuantity,gmvForLast7Days:e.gmvForLast7Days,gmvForLast30Days:e.gmvForLast30Days,unitsSoldForLast7Days:e.unitsSoldForLast7Days,unitsSoldForLast30Days:e.unitsSoldForLast30Days,CVRFor30Days:e.CVRFor30Days,maxROAS:e.maxROAS,skuGrade:e.skuGrade,vendorItemId:e.vendorItemId,productId:e.productId,badge:e.badge,winner:e.winner,barcode:e.barcode,link:e.link,commission:e.commission})),0<c.filter(e=>e.originVendorItemId==d.vendorItemId).length&&(d.upBundlingProducts=c.filter(e=>e.originVendorItemId==d.vendorItemId).map(e=>({salePrice:e.salePrice,coupon:e.coupon,"ìˆ˜ìˆ˜ë£Œ":e.ìˆ˜ìˆ˜ë£Œ,orderableQuantity:Math.floor(d.orderableQuantity/e.upBundlingSize),gmvForLast7Days:e.gmvForLast7Days,gmvForLast30Days:e.gmvForLast30Days,unitsSoldForLast7Days:e.unitsSoldForLast7Days,unitsSoldForLast30Days:e.unitsSoldForLast30Days,CVRFor30Days:e.CVRFor30Days,maxROAS:e.maxROAS,skuGrade:e.skuGrade,vendorItemId:e.vendorItemId,productId:e.productId,badge:e.badge,winner:e.winner,barcode:e.barcode,link:e.link,commission:e.commission,upBundlingSize:e.upBundlingSize})),console.log(d.upBundlingProducts));a.filter(e=>e.returnProducts&&0<e.returnProducts.length).forEach(e=>{e.returnProducts=e.returnProducts.sort((e,t)=>t.salePrice-e.salePrice)}),0<e.length&&(chrome.tabs.sendMessage(n.id,{res:"growthdbratio",ratio:0,text:"íƒ€ì‚¬ë§¤ì¹­ ì •ë³´ ìˆ˜ì§‘ ì¤‘..."}),a=await collectOtherSellersInfo(a,e,n)),chrome.tabs.sendMessage(n.id,{msg:"growthDb",res:"success",growthdb:a,suppliercode:r,companyid:t})}else chrome.tabs.sendMessage(n.id,{msg:"growthDb",res:"ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ì •ë³´ê°€ ì¿ í”ŒëŸ¬ìŠ¤ ë¡œê·¸ì¸ì •ë³´ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:o,companyid:t})}else chrome.tabs.sendMessage(n.id,{msg:"growthDb",res:"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:r,companyid:t})}async function collectOtherSellersInfo(t,a,r){console.log("íƒ€ì‚¬ë§¤ì¹­ ì •ë³´ ìˆ˜ì§‘ ì‹œì‘",{allowedVendorNames:a,totalProducts:t});for(let e=0;e<t.length;e+=10){var n=t.slice(e,e+10),o=Math.round(e/t.length*100),o=(chrome.tabs.sendMessage(r.id,{res:"growthdbratio",ratio:o,text:`íƒ€ì‚¬ë§¤ì¹­ ì •ë³´ ìˆ˜ì§‘ ì¤‘... (${e+1}/${t.length})`}),n.map(async t=>{try{var e,r=await fetchOtherSellersInfo(t.productId,t.vendorItemId,t.itemId);r&&r.items?(e=r.items.map(e=>e.vendorName).filter(e=>!a.includes(e)),t.otherSellers={hasOtherSellers:0<e.length,otherVendorNames:e,totalCount:r.totalCount||0}):t.otherSellers={hasOtherSellers:!1,otherVendorNames:[],totalCount:0}}catch(e){console.error("íƒ€ì‚¬ë§¤ì¹­ ì •ë³´ ìˆ˜ì§‘ ì˜¤ë¥˜:",t.productId,e),t.otherSellers={hasOtherSellers:!1,otherVendorNames:[],totalCount:0}}}));await Promise.all(o),e+10<t.length&&await new Promise(e=>setTimeout(e,100))}return console.log("íƒ€ì‚¬ë§¤ì¹­ ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ"),t}async function fetchOtherSellersInfo(e,t,r){try{var a=await fetch(`https://www.coupang.com/next-api/products/other-seller-info?productId=${e}&selectedId=${t}&itemId=`+r,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://www.coupang.com/vp/products/"+e,body:null,method:"GET",mode:"cors",credentials:"include"});if(a.ok)return await a.json();throw new Error("HTTP error! status: "+a.status)}catch(e){return console.error("íƒ€ì‚¬ë§¤ì¹­ API í˜¸ì¶œ ì˜¤ë¥˜:",e),null}}async function getUpbundleProducts(e){var t,r=[];for(t of e.filter(e=>e.vendorInventoryItems&&e.vendorInventoryItems.find(e=>e?.upbundlingInfo?.upBundling)))for(var a of t.vendorInventoryItems.filter(e=>e?.upbundlingInfo?.upBundling))r.push({vendorItemId:a.vendorItemId,originVendorItemId:a.upbundlingInfo.upBundlingOriginalVendorItemId,upBundlingSize:a.upbundlingInfo.upBundlingSize,salePrice:a.salePrice,optionName:a.itemName});return r}async function getGrowthProducts(e,t){for(var r=1,a=[],n=0;n<r;n++){var o=await chrome.scripting.executeScript({target:{tabId:e.id},function:getGrowthProductsDetail,args:[n+1]}),r=o[0].result.data.pagination.totalPages,a=a.concat(o[0].result.data.productList);chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:n/r*100,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ì‹ ê·œ ìƒí’ˆ ìˆ˜ì§‘ ì¤‘..."})}return a}async function getGrowthProductsDetail(e){var t=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return await(await fetch("https://wing.coupang.com/tenants/seller-web/v2/vendor-inventory/search",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not A(Brand";v="8", "Chromium";v="132", "Google Chrome";v="132"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",vdc:"ko_KR","x-xsrf-token":t},referrer:"https://wing.coupang.com/vendor-inventory/list?searchKeywordType=ALL&searchKeywords=&salesMethod=ALL&productStatus=ALL&stockSearchType=ALL&shippingFeeSearchType=ALL&displayCategoryCodes=&listingStartTime=null&listingEndTime=null&saleEndDateSearchType=ALL&bundledShippingSearchType=ALL&upBundling=ALL&displayDeletedProduct=false&shippingMethod=ALL&exposureStatus=ALL&locale=ko_KR&sortMethod=SORT_BY_REGISTRATION_DATE&countPerPage=50&page=1",referrerPolicy:"strict-origin-when-cross-origin",body:'{"searchKeywordType":"ALL","searchKeywords":"","salesMethod":"ALL","productStatus":["ALL"],"stockSearchType":"ALL","shippingFeeSearchType":"ALL","displayCategoryCodes":[],"listingStartTime":null,"listingEndTime":null,"saleEndDateSearchType":"ALL","bundledShippingSearchType":"ALL","displayDeletedProduct":false,"shippingMethod":"ALL","exposureStatus":"ALL","sortMethod":"SORT_BY_REGISTRATION_DATE","countPerPage":500,"page":'+e+',"locale":"ko_KR","coupangAttributeOptimized":false,"upBundleSearchOption":"ALL"}',method:"POST",mode:"cors",credentials:"include"})).json()}async function collectGrowthSales(e){var t=e.companyid,r=(console.log(e),e.suppliercode),a=e.growthSales,n=e.startDate,e=e.endDate,o=await chrome.tabs.query({}),s=o.find(e=>e.active&&"couplus"==e.title),c=o.find(e=>e.url.includes("wing.coupang.com"));if(c){o=o.find(e=>e.url.includes("https://advertising.coupang.com/"));if(o){if("A0000TEST"!==r){o=await getSupplierCodeFromAd(o);if(console.log("ê´‘ê³ ì„¼í„° supplierCode:",o),!o||r!==o)return void chrome.tabs.sendMessage(s.id,{msg:"growthSales",res:"ê´‘ê³ ì„¼í„° ë¡œê·¸ì¸ ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:o,companyid:t})}o=await confirmSupplierCode(r,c);!1===o&&"A0000TEST"!==r?chrome.tabs.sendMessage(s.id,{msg:"growthSales",res:"ì¿ íŒ¡ìœ™ì— ë¡œê·¸ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:r,companyid:t}):!0===o?(a=await getStockInfo(c,s,a,n,e),n=await checkSaverPack(c),console.log("isSaverPack:",n),console.log(a),console.log(a),chrome.tabs.sendMessage(s.id,{msg:"growthSales",res:"success",suppliercode:r,stockInfo:a,isSaverPack:n})):chrome.tabs.sendMessage(s.id,{msg:"growthSales",res:"ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ì •ë³´ê°€ ì¿ í”ŒëŸ¬ìŠ¤ ë¡œê·¸ì¸ì •ë³´ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:o,companyid:t})}else chrome.tabs.sendMessage(s.id,{msg:"growthSales",res:"ìƒˆíƒ­ì— ê´‘ê³ ì„¼í„°ë¥¼ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:r,companyid:t})}else chrome.tabs.sendMessage(s.id,{msg:"growthSales",res:"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",growthdb:[],suppliercode:r,companyid:t})}async function collectSettlementData(e){var t=e.companyid,r=(console.log("ì •ì‚°í˜„í™©ìˆ˜ì§‘ ìš”ì²­:",e),e.suppliercode),e=e.dateRange,a=e.startDate,e=e.endDate,n=await chrome.tabs.query({}),o=n.find(e=>e.active&&"couplus"==e.title),s=n.find(e=>e.url.includes("wing.coupang.com"));if(s){n=n.find(e=>e.url.includes("https://advertising.coupang.com/"));if(n){if("A0000TEST"!==r){var c=await getSupplierCodeFromAd(n);if(console.log("ê´‘ê³ ì„¼í„° supplierCode:",c),!c||r!==c)return void chrome.tabs.sendMessage(o.id,{msg:"settlementData",res:"ê´‘ê³ ì„¼í„° ë¡œê·¸ì¸ ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",stockInfo:[],suppliercode:c,companyid:t})}var i,c=await confirmSupplierCode(r,s);!1===c&&"A0000TEST"!==r?chrome.tabs.sendMessage(o.id,{msg:"settlementData",res:"ì¿ íŒ¡ìœ™ì— ë¡œê·¸ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",stockInfo:[],suppliercode:r,companyid:t}):!0===c?(s=await getSettlementData(s,o,a,e,r),console.log("ì •ì‚°í˜„í™© ë°ì´í„° :",s),n=await addAdSales(o,n,a,e),console.log("ê´‘ê³  ë°ì´í„° :",n),i=await integrateAdData(s,n),console.log("í†µí•© ì •ì‚°í˜„í™© ë°ì´í„° :",i),console.log("ì–´ì œ ê´‘ê³ ë¹„ :",i.filter(e=>"2025-08-18"===e.revenueDate&&e.adCost).reduce((e,t)=>e+t.adCost,0)),console.log("ì „ì²´ ë§¤ì¶œ : ",i.reduce((e,t)=>e+t.saleAmount,0)),s=filterDataByDateRange(i,a,e),chrome.tabs.sendMessage(o.id,{msg:"settlementData",res:"success",suppliercode:r,adData:n,settlementData:s})):chrome.tabs.sendMessage(o.id,{msg:"settlementData",res:"ì¿ íŒ¡ìœ™ ë¡œê·¸ì¸ì •ë³´ê°€ ì¿ í”ŒëŸ¬ìŠ¤ ë¡œê·¸ì¸ì •ë³´ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",stockInfo:[],suppliercode:c,companyid:t})}else chrome.tabs.sendMessage(o.id,{msg:"settlementData",res:"ìƒˆíƒ­ì— ê´‘ê³ ì„¼í„°ë¥¼ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",stockInfo:[],suppliercode:r,companyid:t})}else chrome.tabs.sendMessage(o.id,{msg:"settlementData",res:"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",stockInfo:[],suppliercode:r,companyid:t})}async function integrateAdData(r,s){return console.log("ì •ì‚°í˜„í™© ë°ì´í„° í†µí•© ì‹œì‘:",r),console.log("ê´‘ê³  ë°ì´í„° í†µí•© ì‹œì‘:",s),console.log(r.find(e=>"93125635951"===e.vendorItemId)),new Promise(e=>{var t,a=[],n=0,o=[];Object.keys(s).forEach(r=>{Object.keys(s[r]).forEach(t=>{Object.keys(s[r][t]).forEach(e=>{"20250818"===t&&(console.log(r,t,e,s[r][t][e].cost),n+=s[r][t][e].cost),o.find(e=>e.vendorItemId==r&&e.date==t)?o.find(e=>e.vendorItemId==r&&e.date==t).cost+=s[r][t][e].cost:o.push({vendorItemId:r,date:t,cost:s[r][t][e].cost}),s[r][t][e].detail.forEach(e=>{a.find(e=>e.vendorItemId==r&&e.date==t)?a.find(e=>e.vendorItemId==r&&e.date==t).units+=e.units:a.push({vendorItemId:r,date:t,units:e.units})})})})}),console.log("dailyAdData:",o),console.log("ì–´ì œ ê´‘ê³ ë¹„ :",o.filter(e=>"20250818"===e.date).reduce((e,t)=>e+t.cost,0)),console.log("ì–´ì œ ê´‘ê³ ë¹„ :",n),console.log("dailyAdSales:",a);for(t of o)r.find(e=>e.vendorItemId==t.vendorItemId&&e.revenueDate.replaceAll("-","")==t.date)?(r.find(e=>e.vendorItemId==t.vendorItemId&&e.revenueDate.replaceAll("-","")==t.date).adCost=t.cost,r.find(e=>e.vendorItemId==t.vendorItemId&&e.revenueDate.replaceAll("-","")==t.date).adCostVAT=Math.round(.1*t.cost),r.find(e=>e.vendorItemId==t.vendorItemId&&e.revenueDate.replaceAll("-","")==t.date).saleQuantityFromAd=a.find(e=>e.vendorItemId==t.vendorItemId&&e.date==t.date)?.units||0):0<t.cost&&r.push({adCost:t.cost,adCostVAT:Math.round(.1*t.cost),saleQuantityFromAd:a.find(e=>e.vendorItemId==t.vendorItemId&&e.date==t.date)?.units||0,commission:0,commissionVAT:0,coupangDiscount:0,instantCoupon:0,downloadCoupon:0,salePrice:0,saleQuantity:0,saleAmount:0,warehouseFee:0,shippingFee:0,revenueDate:t.date.slice(0,4)+"-"+t.date.slice(4,6)+"-"+t.date.slice(6,8),vendorItemId:t.vendorItemId,salePriceHistory:0,productName:r.find(e=>e.vendorItemId==t.vendorItemId)?.productName||"",optionName:r.find(e=>e.vendorItemId==t.vendorItemId)?.optionName||""});r.forEach(e=>{e.shippingFeeVAT=Math.round(.1*e.shippingFee),e.warehouseFeeVAT=Math.round(.1*e.warehouseFee)}),e(r)})}async function getSettlementData(e,t,r,a,n){try{console.log("getSettlementData ì‹œì‘:",r,"~",a),chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:0,text:"ì •ì‚°í˜„í™© ìˆ˜ì§‘ ì‹œì‘..."});var o=(await chrome.scripting.executeScript({target:{tabId:e.id},func:getSettlementDownloadUrls,args:[r,a,n]}))[0].result;return o&&o.success?(console.log("background.jsì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œì‘"),chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:50,text:"ì •ì‚°í˜„í™© íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘..."}),await downloadAndParseSettlementReports(o.data,t,r,a)):(console.error("ë‹¤ìš´ë¡œë“œ URL íšë“ ì‹¤íŒ¨:",o),null)}catch(e){return console.error("getSettlementData ì˜¤ë¥˜:",e),null}}function filterDataByDateRange(e,t,r){if(!e||0===e.length)return console.log("í•„í„°ë§í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."),[];console.log(`ë‚ ì§œ í•„í„°ë§ ì‹œì‘: ${t} ~ ${r}, ì „ì²´ ë°ì´í„°: ${e.length}ê°œ`);const a=new Date(t),n=new Date(r);t=e.filter(e=>{e=new Date(e.revenueDate);return e>=a&&e<=n});return console.log(`ë‚ ì§œ í•„í„°ë§ ì™„ë£Œ: ${e.length}ê°œ â†’ ${t.length}ê°œ`),t}async function getSettlementDownloadUrls(e,t,r){try{var a=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],n=(console.log("ì •ì‚°í˜„í™© ë‹¤ìš´ë¡œë“œ URL íšë“ ì‹œì‘:",e,"~",t),await async function(e,t,r){try{var a=new Date(t),n=new Date(r),o=new Date(a.getFullYear(),a.getMonth()-1,a.getDate()),s=new Date(n.getFullYear(),n.getMonth()+1,n.getDate()),c=o.toISOString(),i=s.toISOString();console.log("token:",e),console.log(`ì •ì‚°í˜„í™© ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ: ${c} ~ `+i);var l=await(await fetch("https://wing.coupang.com/tenants/rfm/v2/settlements/status/api",{method:"POST",headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm/settlements/status-new",body:JSON.stringify({startDate:c,endDate:i,searchDateType:"SALES"}),mode:"cors",credentials:"include"})).json();return console.log("ì •ì‚°í˜„í™© ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ê²°ê³¼:",l),l.settlementStatusReports||[]}catch(e){return console.error("ì •ì‚°í˜„í™© ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì˜¤ë¥˜:",e),[]}}(a,e,t));if(!n||0===n.length)throw new Error("ì •ì‚°í˜„í™© ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì‹¤íŒ¨");var o=function(e,t,r){var a=new Date(t),n=new Date(r),o=[];for(const i of e){var s=new Date(i.settlementPeriodStartDate),c=new Date(i.settlementPeriodEndDate);s<=n&&a<=c&&o.push(i.settlementGroupKey)}t=[...new Set(o)];return console.log("í•„í„°ë§ëœ settlementGroupKey ê°œìˆ˜: "+t.length,t),t}(n,e,t);if(0===o.length)throw new Error("í•´ë‹¹ ê¸°ê°„ì— í•´ë‹¹í•˜ëŠ” ì •ì‚° ê·¸ë£¹ì´ ì—†ìŠµë‹ˆë‹¤");var s={commissionUrls:[],shippingUrls:[]};for(const u of o){console.log(`settlementGroupKey: ${u} ë°ì´í„° ìš”ì²­ ì¤‘...`);var c=await l(a,"CATEGORY_TR",u),i=(c&&s.commissionUrls.push({url:c,settlementGroupKey:u}),await l(a,"WAREHOUSING_SHIPPING",u));i&&s.shippingUrls.push({url:i,settlementGroupKey:u})}return{success:!0,data:s,originalStartDate:e,originalEndDate:t}}catch(e){return console.error("ë‹¤ìš´ë¡œë“œ URL íšë“ ì˜¤ë¥˜:",e),{success:!1,error:e.message}}async function l(e,t,r){var a,n,o,s=(a=e,n=t,r=r,o=Date.now().toString(),r={sellerReportType:n,requestTime:o,settlementGroupKeys:[r],locale:"ko"},console.log("ë¦¬í¬íŠ¸ ìš”ì²­ payload:",r),a=await fetch("https://wing.coupang.com/tenants/rfm/v2/settlements/request-download/api",{method:"POST",headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":a},referrer:"https://wing.coupang.com/tenants/rfm/settlements/status-new",body:JSON.stringify(r),mode:"cors",credentials:"include"}),r=await a.json(),console.log(n+" ë¦¬í¬íŠ¸ ìš”ì²­ ê²°ê³¼:",r),await{requestId:r.requestId,requestTime:o}).requestTime;let c=0;for(;c<20;){await new Promise(e=>setTimeout(e,3e3));var i=await async function(e,t){var r=(parseInt(t)-6e4).toString(),a=(parseInt(t)+6e4).toString(),r={requestTimeFrom:r,requestTimeTo:a},a=await fetch("https://wing.coupang.com/tenants/rfm/v2/settlements/download-list/api",{method:"POST",headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm/settlements/status-new",body:JSON.stringify(r),mode:"cors",credentials:"include"}),e=await a.json();return e.find(e=>e.requestTime===t)}(e,s);if(i&&"COMPLETED"===i.downloadStatus)return async function(e,t){t={requestTime:t,locale:"ko"},e=await fetch("https://wing.coupang.com/tenants/rfm/v2/settlements/download/api/v2",{method:"POST",headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm/settlements/status-new",body:JSON.stringify(t),mode:"cors",credentials:"include"}),t=await e.json();return t.url}(e,s);c++}throw new Error(t+" ë¦¬í¬íŠ¸ ì™„ë£Œ ëŒ€ê¸° ì‹œê°„ ì´ˆê³¼")}}async function downloadAndParseSettlementReports(e,t,r,a){try{console.log("background.jsì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œì‘");var n=[],o=[];chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:30,text:"íŒë§¤ìˆ˜ìˆ˜ë£Œ íŒŒì¼ë“¤ ë‹¤ìš´ë¡œë“œ ì¤‘..."});for(const l of e.commissionUrls){console.log("CATEGORY_TR íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œì‘: "+l.settlementGroupKey);var s=await downloadAndParseExcel(l.url,"CATEGORY_TR");s&&0<s.length&&n.push(...s)}chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:60,text:"ì…ì¶œê³ ë°°ì†¡ë¹„ íŒŒì¼ë“¤ ë‹¤ìš´ë¡œë“œ ì¤‘..."});for(const u of e.shippingUrls){console.log("WAREHOUSING_SHIPPING íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œì‘: "+u.settlementGroupKey);var c=await downloadAndParseExcel(u.url,"WAREHOUSING_SHIPPING");c&&0<c.length&&o.push(...c)}chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:80,text:"ë‚ ì§œ ë²”ìœ„ í•„í„°ë§ ì¤‘..."}),console.log("ìˆ˜ì§‘ê²°ê³¼ - íŒë§¤ìˆ˜ìˆ˜ë£Œ: ",n),console.log("ìˆ˜ì§‘ê²°ê³¼ - ì…ì¶œê³ ë°°ì†¡ë¹„: ",o),chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:90,text:"ì •ì‚°í˜„í™© ë°ì´í„° í†µí•© ì¤‘..."});var i=integrateSettlementData(n,o);return chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:100,text:"ì •ì‚°í˜„í™© ìˆ˜ì§‘ ì™„ë£Œ!"}),i}catch(e){return console.error("ì •ì‚°í˜„í™© ë‹¤ìš´ë¡œë“œ/íŒŒì‹± ì˜¤ë¥˜:",e),{success:!1,error:e.message}}}async function downloadAndParseExcel(e,a){try{console.log(a+" íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œì‘:",e);var t=await fetch(e,{method:"GET",mode:"cors"});if(!t.ok)throw new Error(`ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨: ${t.status} `+t.statusText);var n=await t.arrayBuffer(),o=(console.log(a+" íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ:",n.byteLength,"bytes"),console.log(a+" background.jsì—ì„œ ì§ì ‘ íŒŒì‹± ì‹œì‘"),new Uint8Array(n)),s=String.fromCharCode(o[0],o[1]);if(console.log(a+" íŒŒì¼ ì‹œê·¸ë‹ˆì²˜:",s,"(PKì—¬ì•¼ í•¨)"),console.log(a+" íŒŒì¼ í¬ê¸°:",o.length,"bytes"),console.log("XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ ì •ë³´:",{version:void 0!==XLSX?XLSX.version:"undefined",available:void 0!==XLSX}),"PK"!==s)throw new Error(`ìœ íš¨í•˜ì§€ ì•Šì€ Excel íŒŒì¼ í˜•ì‹ (ì‹œê·¸ë‹ˆì²˜: ${s})`);let r;var c=[{type:"array",WTF:!1,ignoreEC:!0,cellDates:!1,cellNF:!1,cellStyles:!1},{type:"array",WTF:!0,ignoreEC:!0,cellDates:!1,cellNF:!1,cellStyles:!1},{type:"array",WTF:!0},{type:"array"}];for(let t=0;t<c.length;t++)try{console.log(`${a} íŒŒì‹± ì‹œë„ ${t+1}/${c.length}:`,c[t]);const h=console.error;console.error=function(...e){e.join(" ").includes("Bad uncompressed size")||h.apply(console,e)},r=XLSX.read(n,c[t]),console.error=h,console.log(a+" íŒŒì‹± ì„±ê³µ! ì‹œíŠ¸ëª…:",r.SheetNames);break}catch(e){if(console.log(`${a} íŒŒì‹± ì‹œë„ ${t+1} ì‹¤íŒ¨:`,e.message),t===c.length-1)throw e}if("CATEGORY_TR"===a){let e=null;for(const m of r.SheetNames)if(m.includes("íŒë§¤ìˆ˜ìˆ˜ë£Œ")){e=r.Sheets[m],console.log(a+" íŒë§¤ìˆ˜ìˆ˜ë£Œ ì‹œíŠ¸ ë°œê²¬:",m);break}e||(e=r.Sheets[r.SheetNames[0]],console.log(a+" ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©:",r.SheetNames[0])),console.log(e);var i=XLSX.utils.sheet_to_json(e);return console.log(`${a} íŒŒì‹± ê²°ê³¼: ${i.length}ê°œ í–‰`),parseCommissionDataInBackground(i)}if("WAREHOUSING_SHIPPING"!==a)return[];var l,u,d=r.Sheets["ì…ì¶œê³ ë¹„"],p=r.Sheets["ë°°ì†¡ë¹„"];if(d&&p)return l=XLSX.utils.sheet_to_json(d,{header:["ì •ì‚°ìœ í˜•","ì •ì‚°ì£¼ê¸°(ì¢…ë£Œì¼)","ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì›”","ë°œìƒì¼(ë°°ì†¡ì™„ë£Œì¼)","ë§¤ì¶œì¸ì‹ì¼","ê±°ë˜ìœ í˜•","ì£¼ë¬¸ID","ë°°ì†¡ID","ì£¼ë¬¸ì¼","ë“±ë¡ìƒí’ˆ ID","ì˜µì…˜ID","SKU ID","ë“±ë¡ìƒí’ˆëª…","ì˜µì…˜ëª…","ë‹¨í’ˆ íŒë§¤ê°€","ì¹´í…Œê³ ë¦¬ 1ì°¨","ì¹´í…Œê³ ë¦¬ 2ì°¨","ê°œë³„í¬ì¥ ìƒí’ˆ ì‚¬ì´ì¦ˆ","ë¬¼ë¥˜ì„¼í„°","íŒë§¤ìˆ˜ëŸ‰","ë‹¨í’ˆ ê¸°ì¤€ êµ¬ë§¤ ìˆ˜ëŸ‰","ì˜µì…˜ ìœ í˜•","ì…ì¶œê³ ë¹„ ë°œìƒë¹„ìš©(A)","ì…ì¶œê³ ë¹„ í• ì¸ê°€(B)","ì…ì¶œê³ ë¹„ í• ì¸ì ìš©ê°€(A-B)","ë¹„ê³ "],range:1}),u=XLSX.utils.sheet_to_json(p,{header:["ì •ì‚°ìœ í˜•","ì •ì‚°ì£¼ê¸°(ì¢…ë£Œì¼)","ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì›”","ë°œìƒì¼(ë°°ì†¡ì™„ë£Œì¼)","ë§¤ì¶œì¸ì‹ì¼","ê±°ë˜ìœ í˜•","ì£¼ë¬¸ID","ë°°ì†¡ID","ì£¼ë¬¸ì¼","ë“±ë¡ìƒí’ˆ ID","ì˜µì…˜ID","SKU ID","ë“±ë¡ìƒí’ˆëª…","ì˜µì…˜ëª…","ì´ íŒë§¤ê°€","ì¹´í…Œê³ ë¦¬ 1ì°¨","ì¹´í…Œê³ ë¦¬ 2ì°¨","ê°œë³„í¬ì¥ ìƒí’ˆ ì‚¬ì´ì¦ˆ","êµ¬ë§¤ ìˆ˜ëŸ‰ ì´ ì‚¬ì´ì¦ˆ","ë¬¼ë¥˜ì„¼í„°","íŒë§¤ìˆ˜ëŸ‰","ë°°ì†¡ë¹„ ë°œìƒë¹„ìš©(A)","ë°°ì†¡ë¹„ í• ì¸ê°€(B)","ë°°ì†¡ë¹„ í• ì¸ì ìš©ê°€(A-B)","ë°°ì†¡ë¹„ ì¶”ê°€ë¹„ìš©","ë°°ì†¡ë¹„ ìµœì¢…ë¹„ìš©"],range:1}),l=l.filter(e=>e.ì •ì‚°ìœ í˜•&&"ì •ì‚°ìœ í˜•"!==e.ì •ì‚°ìœ í˜•),u=u.filter(e=>e.ì •ì‚°ìœ í˜•&&"ì •ì‚°ìœ í˜•"!==e.ì •ì‚°ìœ í˜•),console.log(`ì…ì¶œê³ ë¹„ íŒŒì‹± ê²°ê³¼: ${l.length}ê°œ í–‰`),console.log(`ë°°ì†¡ë¹„ íŒŒì‹± ê²°ê³¼: ${u.length}ê°œ í–‰`),parseWarehouseShippingDataInBackground(l,u);throw new Error("ì…ì¶œê³ ë¹„ ë˜ëŠ” ë°°ì†¡ë¹„ ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")}catch(e){return console.error(a+" ë‹¤ìš´ë¡œë“œ/íŒŒì‹± ì˜¤ë¥˜:",e),[]}}function parseCommissionDataInBackground(e){console.log("íŒë§¤ìˆ˜ìˆ˜ë£Œ :",e);e=e.filter(e=>e["ì£¼ë¬¸ID"]||e["ì˜µì…˜ID"]);console.log("ìœ íš¨í•œ íŒë§¤ìˆ˜ìˆ˜ë£Œ ë°ì´í„°:",e.length,"ê°œ"),console.log(e.find(e=>"26100127998594"===e["ì£¼ë¬¸ID"]));var t,r=[];for(t of e.map(e=>({vendorItemId:e["ì˜µì…˜ID"],productName:e["ë“±ë¡ìƒí’ˆëª…"],optionName:e["ì˜µì…˜ëª…"],orderId:e["ì£¼ë¬¸ID"],isCancel:e["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ"),revenueDate:e["ë§¤ì¶œì¸ì‹ì¼"],salePrice:parseFloat(e["íŒë§¤ê°€(A)"]||0),saleQuantity:parseInt(e["íŒë§¤ìˆ˜ëŸ‰(B)"]||0),saleAmount:parseFloat(e["íŒë§¤ì•¡(A*B)"]||0),commission:parseFloat(e["íŒë§¤ìˆ˜ìˆ˜ë£Œ"]||0),commissionVAT:parseFloat(e["íŒë§¤ìˆ˜ìˆ˜ë£Œ VAT"]||0),coupangDiscount:parseFloat(e["ì¿ íŒ¡ì§€ì›í• ì¸(C)"]||0),instantCoupon:parseFloat(e["ì¦‰ì‹œí• ì¸ì¿ í°(D)"]||0),downloadCoupon:parseFloat(e["ë‹¤ìš´ë¡œë“œì¿ í°(E)"]||0)}))){var a=r.find(e=>e.orderId===t.orderId&&e.vendorItemId===t.vendorItemId&&e.isCancel===t.isCancel);a?(a.salePriceHistory.find(e=>e.salePrice===t.salePrice)?a.salePriceHistory.find(e=>e.salePrice===t.salePrice).saleQuantity+=t.saleQuantity:a.salePriceHistory.push({salePrice:t.salePrice,saleQuantity:t.saleQuantity}),a.saleQuantity+=t.saleQuantity,a.saleAmount+=t.saleAmount,a.commission+=t.commission,a.commissionVAT+=t.commissionVAT,a.coupangDiscount+=t.coupangDiscount,a.instantCoupon+=t.instantCoupon,a.downloadCoupon+=t.downloadCoupon):r.push({revenueDate:t.revenueDate,orderId:t.orderId,vendorItemId:t.vendorItemId,productName:t.productName,optionName:t.optionName,isCancel:t.isCancel,saleQuantity:t.saleQuantity,saleAmount:t.saleAmount,commission:t.commission,commissionVAT:t.commissionVAT,coupangDiscount:t.coupangDiscount,instantCoupon:t.instantCoupon,downloadCoupon:t.downloadCoupon,salePriceHistory:[{salePrice:t.salePrice,saleQuantity:t.saleQuantity}]})}for(t of r)t.salePrice=Math.round(t.saleAmount/t.saleQuantity);return console.log(r.find(e=>"26100127998594"===e.orderId)),r}function parseWarehouseShippingDataInBackground(e,t){console.log("ì…ì¶œê³ ë°°ì†¡ë¹„ íŒŒì‹± ì‹œì‘"),console.log("ì…ì¶œê³ ë¹„ ë°ì´í„°:",e),console.log("ë°°ì†¡ë¹„ ë°ì´í„°:",t);const r=[];return console.log(e.find(e=>"26100127998594"===e["ì£¼ë¬¸ID"])),e.filter(e=>e["ì˜µì…˜ID"]).forEach(t=>{r.find(e=>e.vendorItemId===t["ì˜µì…˜ID"]&&e.orderId===t["ì£¼ë¬¸ID"]&&e.isCancel===t["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ"))?r.find(e=>e.vendorItemId===t["ì˜µì…˜ID"]&&e.orderId===t["ì£¼ë¬¸ID"]&&e.isCancel===t["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ")).warehouseFee+=parseFloat(t["ì…ì¶œê³ ë¹„ í• ì¸ì ìš©ê°€(A-B)"]||0):r.push({vendorItemId:t["ì˜µì…˜ID"],orderId:t["ì£¼ë¬¸ID"],revenueDate:t["ë§¤ì¶œì¸ì‹ì¼"],orderDate:t["ì£¼ë¬¸ì¼"],saleQuantity:t["íŒë§¤ìˆ˜ëŸ‰"],isCancel:t["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ"),warehouseFee:parseFloat(t["ì…ì¶œê³ ë¹„ í• ì¸ì ìš©ê°€(A-B)"]||0),shippingFee:0})}),console.log(t.find(e=>"26100127998594"===e["ì£¼ë¬¸ID"])),t.filter(e=>e["ì˜µì…˜ID"]).forEach(t=>{r.find(e=>e.vendorItemId===t["ì˜µì…˜ID"]&&e.orderId===t["ì£¼ë¬¸ID"]&&e.isCancel===t["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ"))?r.find(e=>e.vendorItemId===t["ì˜µì…˜ID"]&&e.orderId===t["ì£¼ë¬¸ID"]&&e.isCancel===t["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ")).shippingFee+=parseFloat(t["ë°°ì†¡ë¹„ ìµœì¢…ë¹„ìš©"]||0):r.push({vendorItemId:t["ì˜µì…˜ID"],orderId:t["ì£¼ë¬¸ID"],revenueDate:t["ë§¤ì¶œì¸ì‹ì¼"],orderDate:t["ì£¼ë¬¸ì¼"],saleQuantity:t["íŒë§¤ìˆ˜ëŸ‰"],isCancel:t["ê±°ë˜ìœ í˜•"]?.includes("ì·¨ì†Œ"),warehouseFee:0,shippingFee:parseFloat(t["ë°°ì†¡ë¹„ ìµœì¢…ë¹„ìš©"]||0)})}),console.log("ì…ì¶œê³ ë°°ì†¡ë¹„ íŒŒì‹± ì™„ë£Œ:",r),r}function integrateSettlementData(e,t){console.log("ë°ì´í„° í†µí•© ì‹œì‘"),console.log(e.find(e=>"26100127998594"===e.orderId));for(var r of e)t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId)?1==t.filter(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId).length?(r.warehouseFee=t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId).warehouseFee,r.shippingFee=t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId).shippingFee):t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId&&e.isCancel===r.isCancel)?(r.warehouseFee=t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId&&e.isCancel===r.isCancel).warehouseFee,r.shippingFee=t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId&&e.isCancel===r.isCancel).shippingFee):(console.log(r),console.log(t.filter(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId)),console.log(t.find(e=>e.orderId===r.orderId&&e.vendorItemId===r.vendorItemId&&e.isCancel===r.isCancel))):t.findLast(e=>e.vendorItemId===r.vendorItemId&&e.saleQuantity===r.saleQuantity)?(r.warehouseFee=t.findLast(e=>e.vendorItemId===r.vendorItemId&&e.saleQuantity===r.saleQuantity).warehouseFee,r.shippingFee=t.findLast(e=>e.vendorItemId===r.vendorItemId&&e.saleQuantity===r.saleQuantity).shippingFee):(r.warehouseFee=0,r.shippingFee=0);var a,n=[];for(r of e)0<n.length&&n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId)?(n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).saleQuantity+=r.saleQuantity,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).saleAmount+=r.saleAmount,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).coupangDiscount+=r.coupangDiscount,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).instantCoupon+=r.instantCoupon,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).downloadCoupon+=r.downloadCoupon,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).commission+=r.commission,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).commissionVAT+=r.commissionVAT,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).warehouseFee+=r.warehouseFee,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).shippingFee+=r.shippingFee,(a=n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).salePriceHistory).find(e=>e.salePrice===r.salePrice)?a.find(e=>e.salePrice===r.salePrice).saleQuantity+=r.saleQuantity:a.push({salePrice:r.salePrice,saleQuantity:r.saleQuantity}),a=0<a.reduce((e,t)=>e+t.saleQuantity,0)?a.reduce((e,t)=>e+t.salePrice*t.saleQuantity,0)/a.reduce((e,t)=>e+t.saleQuantity,0):0,n.find(e=>e.revenueDate===r.revenueDate&&e.vendorItemId===r.vendorItemId).salePrice=a):n.push({commission:r.commission,commissionVAT:r.commissionVAT,coupangDiscount:r.coupangDiscount,instantCoupon:r.instantCoupon,downloadCoupon:r.downloadCoupon,salePrice:r.salePrice,saleQuantity:r.saleQuantity,saleAmount:r.saleAmount,warehouseFee:r.warehouseFee,shippingFee:r.shippingFee,revenueDate:r.revenueDate,vendorItemId:r.vendorItemId,salePriceHistory:r.salePriceHistory,productName:r.productName,optionName:r.optionName});return console.log("ë°ì´í„° í†µí•© ì™„ë£Œ:",n),n}async function addAdSales(t,e,r,a){try{console.log("addAdSales ì‹œì‘");var n={startDate:r,endDate:a},o=(console.log("ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ê¸°ê°„:",n.startDate,"~",n.endDate),chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:0,text:"ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘..."}),await collectAdDataFromExcel(e,n.startDate,n.endDate,t));return chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:100,text:"ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ"}),o}catch(e){return console.error("addAdSales ì˜¤ë¥˜:",e),chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:100,text:"ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì˜¤ë¥˜ ë°œìƒ"}),null}}async function collectAdDataFromExcel(e,t,r,a){try{chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:10,text:"ê´‘ê³  ë¦¬í¬íŒ… í˜ì´ì§€ ì´ë™ ì¤‘..."});chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:30,text:"ì¼ë³„ ê´‘ê³  ë¦¬í¬íŠ¸ ìƒì„± ì¤‘..."});var n=await chrome.scripting.executeScript({target:{tabId:e.id},function:collectDailyAdReportFromTab,args:[t,r,a.id]});if(console.log("ìˆ˜ì§‘ ê²°ê³¼:",n),!n||!n[0]||!n[0].result)throw new Error("ì¼ë³„ ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨: ì‘ë‹µì´ ì—†ê±°ë‚˜ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤");var o,s=n[0].result;if(console.log("ìˆ˜ì§‘ëœ ë°ì´í„°:",s),!s)throw new Error("ì¼ë³„ ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨: ê²°ê³¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");if("json"===s.type)o=processExcelAdData(s.data);else{if("excel"!==s.type)throw new Error("ì•Œ ìˆ˜ ì—†ëŠ” ë°ì´í„° íƒ€ì…: "+s.type);chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:60,text:"CSV/TSV íŒŒì¼ íŒŒì‹± ì¤‘..."}),console.log("CSV/TSV íŒŒì¼ íŒŒì‹± ì‹œì‘, í¬ê¸°:",s.size,"íŒŒì¼ëª…:",s.filename);var c=await parseAdDataInBackground(s.data,s.filename);console.log("íŒŒì‹± ì™„ë£Œ:",c),o=processExcelAdData(c)}return chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:80,text:"ê´‘ê³  ë°ì´í„° ê°€ê³µ ì¤‘..."}),o}catch(e){throw console.error("ì—‘ì…€ ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì˜¤ë¥˜:",e),chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:100,text:"ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨"}),e}}async function collectAdPerformanceData(e,t,r,a){try{chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:10,text:"ê´‘ê³ ì„¼í„° í˜ì´ì§€ ì´ë™ ì¤‘..."});var n,o,s="https://advertising.coupang.com/marketing/dashboard/sales",c=(e.url.includes(s)||(n=await navigateTo(s,e.id),console.log("ê´‘ê³ ì„¼í„° í˜ì´ì§€ ì´ë™:",n)),chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:30,text:"ê´‘ê³  ìº í˜ì¸ ë°ì´í„° ìˆ˜ì§‘ ì¤‘..."}),await chrome.scripting.executeScript({target:{tabId:e.id},function:collectAdDataFromAdTab,args:[t,r,a.id]}));return c&&c[0]&&c[0].result?(o=c[0].result,console.log("ìˆ˜ì§‘ëœ ê´‘ê³  ë°ì´í„°:",o),chrome.tabs.sendMessage(a.id,{msg:"growthDbRatio",ratio:80,text:"ê´‘ê³  ë°ì´í„° ê°€ê³µ ì¤‘..."}),processAdPerformanceData(o)):(console.log("ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨"),[])}catch(e){return console.error("ê´‘ê³  ì„±ê³¼ ë°ì´í„° ìˆ˜ì§‘ ì˜¤ë¥˜:",e),[]}}async function collectDailyAdReportFromTab(t,r,e){try{console.log("ì¼ë³„ ê´‘ê³  ë¦¬í¬íŠ¸ ìˆ˜ì§‘ ì‹œì‘:",t,"~",r);var a=parseInt(t.replaceAll("-","")),n=parseInt(r.replaceAll("-",""));console.log("ìº í˜ì¸ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì¤‘...");var o=(await(await fetch("https://advertising.coupang.com/marketing-reporting/v2/graphql",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing-reporting/billboard/reports/pa",body:'[{"operationName":"GetCampaignListInBillboard","variables":{"startDate":'+a+',"endDate":'+n+',"reportType":"pa"},"query":"query GetCampaignListInBillboard($startDate: Int!, $endDate: Int!, $reportType: ReportType!) {\\n  getCampaignList(\\n    startDate: $startDate\\n    endDate: $endDate\\n    reportType: $reportType\\n  ) {\\n    id\\n    name\\n    __typename\\n  }\\n}\\n"}]',method:"POST",mode:"cors",credentials:"include"})).json())[0]?.data?.getCampaignList||[];if(0===o.length)throw new Error("í™œì„± ìº í˜ì¸ì´ ì—†ìŠµë‹ˆë‹¤. í•´ë‹¹ ê¸°ê°„ì— ê´‘ê³ ë¥¼ ì§„í–‰í•œ ìº í˜ì¸ì´ ì—†ìŠµë‹ˆë‹¤.");console.log(o.length+"ê°œì˜ ìº í˜ì¸ ë°œê²¬");var s=o.map(e=>e.id);console.log("ì¼ë³„ ê´‘ê³  ë¦¬í¬íŠ¸ ìš”ì²­ ì¤‘...");var c=await(await fetch("https://advertising.coupang.com/marketing-reporting/v2/graphql",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing-reporting/billboard/reports/pa",body:'[{"variables":{"reportType":"pa","startDate":'+a+',"endDate":'+n+',"dateGroup":"daily","granularity":"keyword","excludeIfNoClickCount":false,"campaignIds":'+JSON.stringify(s)+'},"query":"mutation ($startDate: Int!, $endDate: Int!, $campaignIds: [ID], $reportType: ReportType!, $dateGroup: DateGroup!, $granularity: Granularity, $excludeIfNoClickCount: Boolean) {\\n  requestReport(\\n    data: {startDate: $startDate, endDate: $endDate, campaignIds: $campaignIds, reportType: $reportType, dateGroup: $dateGroup, granularity: $granularity, excludeIfNoClickCount: $excludeIfNoClickCount}\\n  ) {\\n    ...ReportRequest\\n    __typename\\n  }\\n}\\n\\nfragment ReportRequest on ReportRequest {\\n  id\\n  requestDate\\n  startDate\\n  endDate\\n  reportType\\n  dateGroup\\n  granularity\\n  excludeIfNoClickCount\\n  campaignName\\n  campaignCount\\n  status\\n  isLargeReport\\n  schedule {\\n    scheduleType\\n    title\\n    __typename\\n  }\\n  __typename\\n}\\n"}]',method:"POST",mode:"cors",credentials:"include"})).json();const y=c[0]?.data?.requestReport?.id;if(!y)throw console.error("ë¦¬í¬íŠ¸ ìš”ì²­ ì‹¤íŒ¨:",c),new Error("ë¦¬í¬íŠ¸ ìš”ì²­ ì‹¤íŒ¨: ë¦¬í¬íŠ¸ IDë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤");console.log("ë¦¬í¬íŠ¸ ìš”ì²­ ì™„ë£Œ. ID: "+y);var i=Date.now();let e=!1;for(;Date.now()-i<12e4&&!e;){await new Promise(e=>setTimeout(e,1e3));var l=((await(await fetch("https://advertising.coupang.com/marketing-reporting/v2/graphql",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing-reporting/billboard/reports/pa",body:'[{"variables":{"reportType":"pa","page":1,"pageSize":10,"duration":90,"onlyScheduledReport":false},"query":"query ($reportType: ReportType!, $page: Int!, $pageSize: Int!, $duration: Int!, $onlyScheduledReport: Boolean) {\\n  reportList(\\n    data: {reportType: $reportType, page: $page, pageSize: $pageSize, duration: $duration, onlyScheduledReport: $onlyScheduledReport}\\n  ) {\\n    ...ReportList\\n    __typename\\n  }\\n}\\n\\nfragment ReportList on ReportList {\\n  page\\n  pageSize\\n  total\\n  duration\\n  onlyScheduledReport\\n  reports {\\n    id\\n    requestDate\\n    startDate\\n    endDate\\n    reportType\\n    dateGroup\\n    granularity\\n    excludeIfNoClickCount\\n    campaignName\\n    campaignCount\\n    status\\n    isLargeReport\\n    schedule {\\n      title\\n      scheduleType\\n      createDay\\n      requestDate\\n      expireAt\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}\\n"}]',method:"POST",mode:"cors",credentials:"include"})).json())[0]?.data?.reportList?.reports||[]).find(e=>e.id===y);if(l)if(console.log(`ë¦¬í¬íŠ¸ ${y} ìƒíƒœ: `+l.status),"completed"===l.status)e=!0;else if("failed"===l.status)return console.error("ë¦¬í¬íŠ¸ ìƒì„± ì‹¤íŒ¨"),null}if(!e)return console.error("ë¦¬í¬íŠ¸ ìƒì„± íƒ€ì„ì•„ì›ƒ"),null;console.log("ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ, ë°ì´í„° ë‹¤ìš´ë¡œë“œ ì‹œì‘...");var u,d=await fetch("https://advertising.coupang.com/marketing-reporting/v2/api/excel-report?id="+y,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Google Chrome";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing-reporting/billboard/reports/pa",body:null,method:"GET",mode:"cors",credentials:"include"}),p=(console.log("ì—‘ì…€ ë°ì´í„° ë‹¤ìš´ë¡œë“œ ì‘ë‹µ ìˆ˜ì‹ ",d),d.headers.get("content-type")),h=d.headers.get("content-disposition"),m=d.headers.get("content-length");if(console.log("ì‘ë‹µ í—¤ë” ì •ë³´:"),console.log("- Content-Type:",p),console.log("- Content-Disposition:",h),console.log("- Content-Length:",m),console.log("- Status:",d.status,d.statusText),p&&p.includes("application/json"))return u=await d.json(),console.log("JSON í˜•íƒœì˜ ë¦¬í¬íŠ¸ ë°ì´í„° ìˆ˜ì‹ "),{type:"json",data:u};{var g,f=await d.arrayBuffer();console.log("íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ, í¬ê¸°:",f.byteLength);let e="ì¼ë³„ê´‘ê³ ë°ì´í„°.xlsx";return h&&(g=h.match(/filename=([^;]+)/))&&(e=g[1].trim()),console.log("ì‹¤ì œ íŒŒì¼ëª…:",e),{type:"excel",data:f,filename:e,size:f.byteLength}}}catch(e){return console.error("ì¼ë³„ ê´‘ê³  ë¦¬í¬íŠ¸ ìˆ˜ì§‘ ì˜¤ë¥˜:",e),null}}async function parseAdDataInBackground(e,t){try{console.log("ê´‘ê³  ë°ì´í„° íŒŒì‹± ì‹œì‘, í¬ê¸°:",e.byteLength,"íŒŒì¼ëª…:",t);var r,a=t&&(t.includes(".csv")||t.includes(".tsv")),n=t&&(t.includes(".xlsx")||t.includes(".xls"));return a?(console.log("CSV/TSV íŒŒì¼ë¡œ ì²˜ë¦¬"),await parseCSVData(e,t)):n?(console.log("ì—‘ì…€ íŒŒì¼ë¡œ ì²˜ë¦¬"),await parseExcelData(e)):(r=new Uint8Array(e),"PK"===String.fromCharCode(r[0],r[1])?(console.log("ì‹œê·¸ë‹ˆì²˜ ê¸°ë°˜ ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬"),await parseExcelData(e)):(console.log("ì‹œê·¸ë‹ˆì²˜ ê¸°ë°˜ CSV/TSV íŒŒì¼ ì²˜ë¦¬"),await parseCSVData(e,t)))}catch(e){throw console.error("ê´‘ê³  ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜:",e),e}}async function parseCSVData(e,t){try{var r=new TextDecoder("utf-8").decode(e),a=(console.log("CSV í…ìŠ¤íŠ¸ ê¸¸ì´:",r.length),console.log("CSV ì²« 500ì:",r.substring(0,500)),(r.match(/\t/g)||[]).length),n=(r.match(/,/g)||[]).length<a?"\t":",",o=(console.log("êµ¬ë¶„ì íŒë‹¨:","\t"==n?"TSV (íƒ­)":"CSV (ì‰¼í‘œ)"),r.split("\n").filter(e=>e.trim()));if(console.log("ì´ ë¼ì¸ ìˆ˜:",o.length),0===o.length)throw new Error("CSV ë°ì´í„°ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤");var s=o[0].split(n).map(e=>e.trim().replace(/"/g,"")),c=(console.log("CSV í—¤ë”:",s),[]);for(let e=1;e<o.length;e++){const i=o[e].split(n).map(e=>e.trim().replace(/"/g,""));if(i.length===s.length){const l={};s.forEach((e,t)=>{l[e]=i[t]}),c.push(l)}}return console.log(`CSV íŒŒì‹± ì™„ë£Œ: ${c.length}ê°œ í–‰`),c}catch(e){throw console.error("CSV íŒŒì‹± ì˜¤ë¥˜:",e),e}}async function parseExcelData(e){return parseAdExcelInBackground(e)}async function parseAdExcelInBackground(r){try{console.log("ê´‘ê³  ì—‘ì…€ íŒŒì¼ íŒŒì‹± ì‹œì‘, í¬ê¸°:",r.byteLength);var t,a=new Uint8Array(r),n=String.fromCharCode(a[0],a[1]),o=(console.log("íŒŒì¼ ì‹œê·¸ë‹ˆì²˜:",n,"(PKì—¬ì•¼ í•¨)"),Array.from(a.slice(0,100)).map(e=>String.fromCharCode(e)).join("")),s=(console.log("íŒŒì¼ ì²˜ìŒ 100ë°”ì´íŠ¸:",o),Array.from(a.slice(0,20)).map(e=>e.toString(16).padStart(2,"0")).join(" "));if(console.log("íŒŒì¼ ì²˜ìŒ 20ë°”ì´íŠ¸ (16ì§„ìˆ˜):",s),"PK"!==n)throw t=new TextDecoder("utf-8").decode(a.slice(0,1e3)),console.log("í…ìŠ¤íŠ¸ë¡œ í•´ì„í•œ ë‚´ìš© (ì²˜ìŒ 1000ì):",t),new Error(`ìœ íš¨í•˜ì§€ ì•Šì€ Excel íŒŒì¼ í˜•ì‹ (ì‹œê·¸ë‹ˆì²˜: ${n})`);if(void 0===XLSX)throw new Error("XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤");console.log("XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „:",XLSX.version);let e;var c=[{type:"array",WTF:!1,ignoreEC:!0,cellDates:!1,cellNF:!1,cellStyles:!1},{type:"array",WTF:!0,ignoreEC:!0,cellDates:!1,cellNF:!1,cellStyles:!1},{type:"array",WTF:!0},{type:"array"}];for(let t=0;t<c.length;t++)try{console.log(`ê´‘ê³  ì—‘ì…€ íŒŒì‹± ì‹œë„ ${t+1}/${c.length}:`,c[t]);const d=console.error;console.error=function(...e){e.join(" ").includes("Bad uncompressed size")||d.apply(console,e)},e=XLSX.read(r,c[t]),console.error=d,console.log("ê´‘ê³  ì—‘ì…€ íŒŒì‹± ì„±ê³µ! ì‹œíŠ¸ëª…:",e.SheetNames);break}catch(e){if(console.log(`ê´‘ê³  ì—‘ì…€ íŒŒì‹± ì‹œë„ ${t+1} ì‹¤íŒ¨:`,e.message),t===c.length-1)throw e}var i=e.SheetNames[0],l=e.Sheets[i],u=(console.log("ë°ì´í„° ì¶”ì¶œ ì‹œíŠ¸:",i),XLSX.utils.sheet_to_json(l));return console.log(`ê´‘ê³  ì—‘ì…€ íŒŒì‹± ì™„ë£Œ: ${u.length}ê°œ í–‰`),u}catch(e){throw console.error("ê´‘ê³  ì—‘ì…€ íŒŒì‹± ì˜¤ë¥˜:",e),e}}function processExcelAdData(e){try{var u,d;return(console.log("ì—‘ì…€ ë°ì´í„° ê°€ê³µ ì‹œì‘, ë°ì´í„° íƒ€ì…:",typeof e,"ê¸¸ì´:",Array.isArray(e)?e.length:"N/A"),console.log("ì—‘ì…€ ë°ì´í„° :",e),e&&Array.isArray(e))?(u={},d=0,e.forEach(e=>{var t=e["ë‚ ì§œ"],r=e["ê´‘ê³  ë…¸ì¶œ ì§€ë©´"],a=e["ê´‘ê³ ì§‘í–‰ ì˜µì…˜ID"],n=e["ê´‘ê³ ì „í™˜ë§¤ì¶œë°œìƒ ì˜µì…˜ID"],o=parseInt(e["ë…¸ì¶œìˆ˜"]||0),s=parseInt(e["í´ë¦­ìˆ˜"]||0),c=parseFloat(e["ê´‘ê³ ë¹„"]||0),i=parseInt(e["ì´ ì£¼ë¬¸ìˆ˜(14ì¼)"]||0),l=parseInt(e["ì´ íŒë§¤ìˆ˜ëŸ‰(14ì¼)"]||0),e=parseFloat(e["ì´ ì „í™˜ë§¤ì¶œì•¡(14ì¼)"]||0);a&&t&&(d++,u[a]||(u[a]={}),u[a][t]||(u[a][t]={}),u[a][t][r]||(u[a][t][r]={impressions:0,clicks:0,cost:0,cpc:0,detail:[]}),u[a][t][r].impressions+=o,u[a][t][r].clicks+=s,u[a][t][r].cost+=c,0<u[a][t][r].clicks&&(u[a][t][r].cpc=u[a][t][r].cost/u[a][t][r].clicks),0<i||0<l||0<e)&&(0<=(o=u[a][t][r].detail.findIndex(e=>e.vendorItemId===n))?(u[a][t][r].detail[o].orders+=i,u[a][t][r].detail[o].units+=l,u[a][t][r].detail[o].sales+=e):u[a][t][r].detail.push({vendorItemId:n,orders:i,units:l,sales:e}))}),console.log(`ì—‘ì…€ ë°ì´í„° ê°€ê³µ ì™„ë£Œ: ${d}ê°œ í–‰ ì²˜ë¦¬, ${Object.keys(u).length}ê°œ ìƒí’ˆ`),console.log("ê°€ê³µëœ ë°ì´í„° êµ¬ì¡°:",u),u):(console.log("ê°€ê³µí•  ë°ì´í„°ê°€ ì—†ê±°ë‚˜ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),{})}catch(e){return console.error("ì—‘ì…€ ë°ì´í„° ê°€ê³µ ì˜¤ë¥˜:",e),{}}}async function collectAdDataFromAdTab(e,t,r){try{chrome.runtime.sendMessage({msg:"growthDbRatio",ratio:40,text:"ê´‘ê³  ìº í˜ì¸ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì¤‘...",activetabId:r});var a=await async function(e,t){try{var r=e.replaceAll("-",""),a=t.replaceAll("-","");return(await(await fetch("https://advertising.coupang.com/marketing-reporting/v2/graphql",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing-reporting/billboard/custom-report",body:'[{"operationName":"GetCampaignListInCustom","variables":{"startDate":'+r+',"endDate":'+a+',"includePa":true,"includeBpa":false,"includeNca":false},"query":"query GetCampaignListInCustom($startDate: Int!, $endDate: Int!, $includePa: Boolean!, $includeBpa: Boolean!, $includeNca: Boolean!) {\\n  paCampaigns: getCampaignList(\\n    startDate: $startDate\\n    endDate: $endDate\\n    reportType: pa\\n  ) @include(if: $includePa) {\\n    id\\n    name\\n    __typename\\n  }\\n  bpaCampaigns: getCampaignList(\\n    startDate: $startDate\\n    endDate: $endDate\\n    reportType: bpa\\n  ) @include(if: $includeBpa) {\\n    id\\n    name\\n    __typename\\n  }\\n  ncaCampaigns: getCampaignList(\\n    startDate: $startDate\\n    endDate: $endDate\\n    reportType: nca\\n  ) @include(if: $includeNca) {\\n    id\\n    name\\n    __typename\\n  }\\n}\\n"}]',method:"POST",mode:"cors",credentials:"include"})).json())[0]?.data?.paCampaigns||[]}catch(e){return console.error("ìº í˜ì¸ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì˜¤ë¥˜:",e),[]}}(e,t);return a&&0!==a.length?(console.log("í™œì„± ìº í˜ì¸ ìˆ˜:",a.length),chrome.runtime.sendMessage({msg:"growthDbRatio",ratio:60,text:"ê´‘ê³  ì„±ê³¼ ë°ì´í„° ì¡°íšŒ ì¤‘...",activetabId:r}),{campaigns:a,adData:await async function(e,t,r,a){try{if(!e||0===e.length)return[];for(var n=t.replaceAll("-",""),o=r.replaceAll("-",""),s=e.map(e=>({id:e.id,type:"pa"})),c=[],i=1,l=!0;l;){console.log(`ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì¤‘... ${i}í˜ì´ì§€ `),chrome.runtime.sendMessage({msg:"growthDbRatio",ratio:0,text:"ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì¤‘... í˜ì´ì§€ "+i,activetabId:a});var u=await(await fetch("https://advertising.coupang.com/marketing-reporting/v2/graphql",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing-reporting/billboard/custom-report",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify([{variables:{columns:["dt","placement","advertised_vendor_item_id","advertised_vendor_item_name","vendor_item_id","vendor_item_name","impressions_count","clicks_count","total_order_14_days","total_unit_14_days","total_sale_14_days","ad_cost_sum"],page:i,pageSize:500,reportType:"custom",templateId:null,lang:"KO",campaigns:s,startDate:n,endDate:o},query:`fragment customReport on CustomReport {
                            id
                            reportColumns: columns
                            totalCount
                            rows: items {
                                dt
                                placement
                                advertised_vendor_item_id
                                advertised_vendor_item_name
                                vendor_item_id
                                vendor_item_name
                                impressions_count
                                clicks_count
                                total_order_14_days
                                total_unit_14_days
                                total_sale_14_days
                                ad_cost_sum
                                __typename
                            }
                            __typename
                        }

                        query ($startDate: String!, $endDate: String!, $campaigns: [CustomReportCampaignsInput!]!, $reportType: CustomReportType!, $columns: [CustomColumn!]!, $templateId: ID, $page: Int, $pageSize: Int, $lang: ExportLanguage!) {
                            report: generateCustomReport(
                                params: {startDate: $startDate, endDate: $endDate, campaigns: $campaigns, reportType: $reportType, templateId: $templateId, columns: $columns, page: $page, pageSize: $pageSize, lang: $lang}
                            ) {
                                ...customReport
                                __typename
                            }
                        }`}]),method:"POST",mode:"cors",credentials:"include"})).json(),d=(console.log(`í˜ì´ì§€ ${i} ê´‘ê³  ì„±ê³¼ ë°ì´í„° ì¡°íšŒ ê²°ê³¼:`,u),u[0]?.data?.report?.rows||[]);c=c.concat(d),d.length<500?l=!1:i++}return console.log(`ì´ ${c.length}ê°œì˜ ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ`),c}catch(e){return console.error("ê´‘ê³  ì„±ê³¼ ë°ì´í„° ì¡°íšŒ ì˜¤ë¥˜:",e),[]}}(a,e,t,r)}):(console.log("í™œì„± ìº í˜ì¸ì´ ì—†ìŠµë‹ˆë‹¤."),{campaigns:[],adData:[]})}catch(e){return console.error("ê´‘ê³  ë°ì´í„° ìˆ˜ì§‘ ì˜¤ë¥˜:",e),{campaigns:[],adData:[]}}}function processAdPerformanceData(e){try{var s;return e.adData&&0!==e.adData.length?(s={},e.adData.forEach(e=>{var t,r=e.advertised_vendor_item_id,a=e.vendor_item_id,n=e.dt,o=e.placement;n&&8===n.length&&(n=n.substring(0,4)+"-"+n.substring(4,6)+"-"+n.substring(6,8)),s[r]||(s[r]={}),s[r][n]||(s[r][n]={}),s[r][n][o]||(s[r][n][o]={impressions:0,clicks:0,cost:0,cpc:0,detail:[]}),s[r][n][o].impressions+=e.impressions_count||0,s[r][n][o].clicks+=e.clicks_count||0,s[r][n][o].cost+=e.ad_cost_sum||0,0<s[r][n][o].clicks&&(s[r][n][o].cpc=s[r][n][o].cost/s[r][n][o].clicks),(0<(e.total_order_14_days||0)||0<(e.total_unit_14_days||0)||0<(e.total_sale_14_days||0))&&(0<=(t=s[r][n][o].detail.findIndex(e=>e.vendorItemId===a))?(s[r][n][o].detail[t].orders+=e.total_order_14_days||0,s[r][n][o].detail[t].units+=e.total_unit_14_days||0,s[r][n][o].detail[t].sales+=e.total_sale_14_days||0):s[r][n][o].detail.push({vendorItemId:a,orders:e.total_order_14_days||0,units:e.total_unit_14_days||0,sales:e.total_sale_14_days||0}))}),console.log("ê°€ê³µëœ ê´‘ê³  ë°ì´í„°:",s),s):(console.log("ê°€ê³µí•  ê´‘ê³  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."),{})}catch(e){return console.error("ê´‘ê³  ë°ì´í„° ê°€ê³µ ì˜¤ë¥˜:",e),{}}}function mergeAdDataToStockInfo(t,o){try{return o&&0!==Object.keys(o).length?t.forEach(e=>{var t,n=e.vendorItemId;o[n]&&(e.trafficInfo||(e.trafficInfo={}),t=[],Object.keys(o[n]).forEach(e=>{var r=o[n][e],a={date:e};Object.keys(r).forEach(e=>{var t=r[e];a[e]={impressions:t.impressions,clicks:t.clicks,cost:t.cost,cpc:t.cpc,detail:t.detail}}),t.push(a)}),t.sort((e,t)=>new Date(e.date)-new Date(t.date)),e.trafficInfo.adSummaryByDate=t)}):console.log("ë³‘í•©í•  ê´‘ê³  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."),t}catch(e){return console.error("ê´‘ê³  ë°ì´í„° ë³‘í•© ì˜¤ë¥˜:",e),t}}async function checkSaverPack(e){return(await chrome.scripting.executeScript({target:{tabId:e.id},function:checkSaverPackDetail}))[0].result}async function checkSaverPackDetail(){var e=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];try{return"SUBSCRIBED"===(await(await fetch("https://wing.coupang.com/tenants/rfm/vas/subscription-plan/v1/wing/details",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm/settlements/home",body:null,method:"POST",mode:"cors",credentials:"include"})).json()).subscriptionPlansStatus.LAUNCHER_PACK[0].subscriptionPlanSubscribeStatus}catch(e){return console.log(e),!1}}async function getSizeInfo(e,t){chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:0,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ì‚¬ì´ì¦ˆ ì •ë³´ ìˆ˜ì§‘ ì¤‘..."});var t=(await chrome.scripting.executeScript({target:{tabId:e.id},function:getExcelData}))[0].result,e=new Uint8Array(t),t=XLSX.read(e,{type:"array"}),e=t.SheetNames[0],t=t.Sheets[e],e=XLSX.utils.sheet_to_json(t,{header:1}),n=(console.log(e),e[2]),t=e.slice(4,e.length),o=[];return t.forEach(r=>{var a={};n.forEach((e,t)=>{a[e]=r[t]}),o.push(deepClone(a))}),o}async function getStockInfo(e,t,r,a,n){var o,s,c=new Date,i=c.getFullYear()+`-${("0"+(1+c.getMonth())).slice(-2)}-`+("0"+c.getDate()).slice(-2),c=(console.log("=== background.js updateDate ë””ë²„ê¹… ==="),console.log("í˜„ì¬ ì‹œê°„:",c),console.log("ê³„ì‚°ëœ updateDate:",i),console.log("===================================="),o=a,s=n,console.log("ì‚¬ìš©ì ì§€ì • ë‚ ì§œ ë²”ìœ„:",o,"~",s),r.map(e=>e.vendorItemId)),l=r.filter(e=>e.upBundlingProducts&&0<e.upBundlingProducts.length).map(t=>(t.upBundlingProducts.forEach(e=>{e.originVendorItemId=t.vendorItemId}),t.upBundlingProducts)).flat();if(console.log(r),console.log(c),0<r.length&&0==c.length)return[];var u=await getTotalGrowthDb(e,t),a=(console.log("getTotalGrowthDb:",u),u.map(e=>e.listingDetails.vendorInventoryId)),d=(d=await getDetailGrowthInfo(a,e,t)).filter(e=>e.skuId),p=[];o&&s&&(p=await getProductTraffic(e,o,s));for(var h=0;h<u.length;h++){console.log(u[h]);var m=u[h];chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:h/u.length*100,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ íŒë§¤ ì •ë³´ ìˆ˜ì§‘ ì¤‘..."}),0<p.length&&p.includes(m.vendorItemId)?m.trafficInfo=await getImpressions(m,e,o,s):m.trafficInfo=null,m.inboundInfo=await getInboundInfo(m,e)}for(var g=u.map(t=>{var e={};return e.vendorItemId=t.vendorItemId,e.orderableQuantity=t?.inventoryDetails?.orderableQuantity,e.gmvForLast7Days=t.gmvForLast7Days,e.gmvForLast30Days=t.gmvForLast30Days,e.unitsSoldForYesterday=t?.salesStatistics?.yesterdaySales?t.salesStatistics.yesterdaySales.unitsSoldBeforeExcludingCancellations+t.salesStatistics.yesterdaySales.unitsCancelled:0,e.unitsSoldForLast7Days=t?.salesStatistics?.last7DaysSales?t.salesStatistics.last7DaysSales.unitsSoldBeforeExcludingCancellations+t.salesStatistics.last7DaysSales.unitsCancelled:0,e.unitsSoldForLast30Days=t?.salesStatistics?.last30DaysSales?t.salesStatistics.last30DaysSales.unitsSoldBeforeExcludingCancellations+t.salesStatistics.last30DaysSales.unitsCancelled:0,e.CVRFor30Days=t?.salesStatistics?.last30DaysSales?e.unitsSoldForLast30Days/t.salesStatistics.last30DaysSales.totalPageViews:0,e.skuGrade=t?.listingDetails?.skuGrade,e.listingDetails=t.listingDetails,e.winner=t?.pricing?.buyboxStatus,e.trafficInfo=t.trafficInfo,e.inventoryDetails=t.inventoryDetails,e.updateDate=i,e.inboundInfo=t.inboundInfo,e.salePrice=t.pricing.salesPrice.amount,e.upBundlingProducts=[],e.skuName=d.find(e=>e.vendorItemId==t.vendorItemId)?.skuName,e}),h=0;h<l.length;h++)console.log(l[h]),m=l[h],chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:h/l.length*100,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ë²ˆë“¤ ì •ë³´ ìˆ˜ì§‘ ì¤‘..."}),0<p.length&&p.includes(m.vendorItemId)?m.trafficInfo=await getImpressions(m,e,o,s):m.trafficInfo=null;return l.map(e=>{var t={};return t.originVendorItemId=e.originVendorItemId,t.vendorItemId=e.vendorItemId,t.trafficInfo=e.trafficInfo,t.updateDate=i,t.upBundlingSize=e.upBundlingSize,t}).forEach(t=>{g.find(e=>e.vendorItemId==t.originVendorItemId)&&g.find(e=>e.vendorItemId==t.originVendorItemId).upBundlingProducts.push(t)}),g}async function getInboundInfo(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},function:getInboundInfoDetail,args:[e.skuDetails.externalSkuIds[0]]}))[0].result}async function getInboundInfoDetail(e){e="https://wing.coupang.com/tenants/rfm-inventory/cfs-stowed-detail?skuId="+e;try{return await(await fetch(e,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Not/A)Brand";v="99", "Google Chrome";v="115", "Chromium";v="115"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://wing.coupang.com/tenants/rfm/inventory/management/list",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()}catch(e){return{cfsStowedDetailList:[]}}}async function getImpressions(e,r,a,n){var t;return console.log(e),e.vendorItemId?(t=await new Promise(t=>{chrome.tabs.sendMessage(r.id,{action:"getProductSales",vendorItemId:e.vendorItemId,startDate:a,endDate:n},e=>{t(e)})}),console.log("getProductSales ê²°ê³¼:",t),t):null}async function getImpressionsProduct(e,t){var r=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],e=await(await fetch("https://wing.coupang.com/tenants/seller-web/vendor-inventory/productmatch/prematch/product-items?productId="+e+"&itemId="+t+"&allowSingleProduct=true&categoryId=",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5","sec-ch-ua":'"Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest","x-xsrf-token":r},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json();return console.log(e),e.pvLast28Day}async function getProductTraffic(e,r,a){for(var t=1,n=[],o=0;o<t;o++){var s=await new Promise(t=>{chrome.tabs.sendMessage(e.id,{action:"getProductTrafficDetail",startDate:r,endDate:a,page:o},e=>{t(e)})});if(!s)break;console.log("getProductTrafficDetail ê²°ê³¼:",s),n=n.concat(s?.vendorItems?.map(e=>e?.vendorItemDetails?.vendorItemId)),t=s.paginationDetails.totalPages}return n}async function getProductTrafficDetail(e,t,r){console.log(e,t,r);var a=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],a=await fetch("https://wing.coupang.com/tenants/rfm-ss/api/business-insight/vi-detail-search",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":a},referrer:"https://wing.coupang.com/tenants/business-insight/sales-analysis?startDate="+e+"&endDate="+t,referrerPolicy:"strict-origin-when-cross-origin",body:'{"startDate":"'+e+'","endDate":"'+t+'","registrationTypes":["RFM"],"pageNumber":'+r+',"pageSize":100,"sortBy":"GMV","sortOrder":"DESC","vendorItemIds":[],"productName":"","includeSoldVICount":true}',method:"POST",mode:"cors",credentials:"include"}),e=await a.text(),t=(console.log(e),await a.json());return console.log(t),t}async function getProductSales(e,t,r){e=parseInt(e),console.log(e);try{var a=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],n=await(await fetch("https://wing.coupang.com/tenants/rfm-ss/api/business-insight/vendor-item-summary",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":a},referrer:"https://wing.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:'{"startDate":"'+t+'","endDate":"'+r+'","vendorItemId":'+e+"}",method:"POST",mode:"cors",credentials:"include"})).json();return console.log(n),n.saleSummaryByDate?n:null}catch(e){return console.log(e),null}}async function getGrowthSalesWithDates(e){for(var t=[],r=1,a=0;a<r;a++)var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],n=await(await fetch("https://wing.coupang.com/seller/notification/metrics/vendoritems?dateFrom="+e[0]+"&dateTo="+e[e.length-1]+"&vendorItemName=&vendorItemIds=&category=&category2=&page="+a+"&pageSize=500&sortBy=GMV&asc=false&actionedOn=false&rfmFlag=true",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest","x-xsrf-token":n},referrer:"https://wing.coupang.com/seller/notification/metrics/dashboard",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json(),r=n.result.totalPages,t=t.concat(n.result.result);return t}async function getYesterdayGrowthSales(e){var t=new Date,r=(t.setDate(t.getDate()-1),t.getFullYear()),a=("0"+(1+t.getMonth())).slice(-2),t=("0"+t.getDate()).slice(-2),e=(await chrome.scripting.executeScript({target:{tabId:e.id},function:getGrowthSalesWithDates,args:[[r+"-"+a+"-"+t]]}))[0].result;return console.log(e),e}async function getStockDetailInfo(e){var t=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return await(await fetch("https://wing.coupang.com/tenants/rfm-inventory/health/V2/search-sku-data",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json","sec-ch-ua":'"Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":t},referrer:"https://wing.coupang.com/tenants/rfm-inventory/health/V2/search-sku-data",referrerPolicy:"strict-origin-when-cross-origin",body:'{"vendorItemId":"","skuId":"","vendorInventoryId":"","vendorInventoryName":"","skuBand":"","excludeNewSku":false,"hideBySellerStatus":"NOT_HIDDEN","sortKey":"ORDERABLE_QTY","sortOrder":"DESC","pageIndex":'+e+',"pageSize":100,"regDateFrom":"","regDateTo":"","orderableQty":"","moreThan30DaysOosVisOnly":false,"bizType":"ROD"}',method:"POST",mode:"cors",credentials:"include"})).json()}async function getNoBadgeInfo(e,t){return chrome.tabs.sendMessage(t.id,{msg:"growthDbRatio",ratio:0,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ë±ƒì§€ì •ë³´ ìˆ˜ì§‘ ì¤‘..."}),(await chrome.scripting.executeScript({target:{tabId:e.id},function:getNoBadgeDetailInfo}))[0].result}async function getNoBadgeDetailInfo(){var e=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await(await fetch("https://wing.coupang.com/tenants/rfm/exposure-management/search",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json","sec-ch-ua":'"Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm/badge-management/main",referrerPolicy:"strict-origin-when-cross-origin",body:'{"paginationDto":{"numItemsPerPage":200,"pageNumber":1},"sortBy":"HIGHEST_SALES","rodBadges":["NO_BADGE"]}',method:"POST",mode:"cors",credentials:"include"})).json()).items}async function getCoupons(e,t,r){chrome.tabs.sendMessage(r.id,{msg:"growthDbRatio",ratio:50,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ í• ì¸ì¿ í° ì •ë³´ ìˆ˜ì§‘ ì¤‘..."});r=(await chrome.scripting.executeScript({target:{tabId:t.id},function:getCouponDetailInfo,args:[e]}))[0].result;return console.log(r),r?r.filter(e=>e&&e.hasCoupon):[]}async function getCouponDetailInfo(t){console.log("ì¿ í°ë‚´ì—­:");let r=[];for(let e=0;e<t.length;e+=50){var a=t.slice(e,e+50),a=JSON.stringify(a),n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],n=await(await fetch("https://wing.coupang.com/tenants/seller-promotion-platform/v2/seller-funding-coupon/application/items",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json; charset=UTF-8",csrftoken:"e40e3bd9-2d9b-4c29-8970-f610d1303d87",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/seller-promotion-platform/v2/seller-funding-coupon/application",referrerPolicy:"strict-origin-when-cross-origin",body:'{"categoryId":null,"vendorInventoryIds":'+a+',"vendorItemIds":[],"productId":null,"vendorInventoryItemName":"","couponId":null}',method:"POST",mode:"cors",credentials:"include"})).json();r=r.concat(n.vendorItemsForSellerFunding)}return console.log(r),r}async function getDetailGrowthInfo(e,t,r){t=await chrome.scripting.executeScript({target:{tabId:t.id},function:getItemDetailInfo,args:[e]});return chrome.tabs.sendMessage(r.id,{msg:"growthDbRatio",ratio:50,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆ ìƒì„¸ DB ìˆ˜ì§‘ ì¤‘..."}),t[0].result}async function getDetailMarginWithStock(e,t,r,a,n,o,s){e=e.map(e=>({statusName:e.inventoryDto?.statusName,vendorInventoryId:e.inventoryDto?.vendorInventoryId,autoPricingInfo:e.autoPricingInfo,barcode:e.barcode,createdAt:e.createdAt,displayCategoryCode:e.displayCategoryCode,imgUrl:e.imgUrl,categoryId:e.inventoryDto?.categoryId,displayProductName:e.inventoryDto?.displayProductName,itemName:e.itemName,itemId:e.itemId,categoryId:e.kanCategoryId,kanCategoryId:e.kanCategoryId,originalPrice:e.originalPrice,productId:e.productId,productOrigin:e.productOrigin,salePrice:e.salePrice,searchTag:e.searchTag,skuId:e.skuId,skuInfo:e.skuInfo,skuMeasured:e.skuMeasured,skuSizeGuide:e.skuSizeGuide,skuSizeV2:e.skuSizeV2,validText:e.validText,skuName:e.skuName,vendorItemId:e.vendorItemId,link:"https://www.coupang.com/vp/products/"+e.productId+"?vendorItemId="+e.vendorItemId,"ìƒí’ˆëª…":e.displayProductName+", "+e.itemName}));for(var c of s){var i;e.find(e=>e.vendorItemId==c.originVendorItemId)&&(i=e.find(e=>e.vendorItemId==c.originVendorItemId),console.log(i),e.push({...i,vendorItemId:c.vendorItemId,itemId:c.itemId,link:"https://www.coupang.com/vp/products/"+i.productId+"?vendorItemId="+c.vendorItemId,salePrice:c.salePrice,upBundlingSize:c.upBundlingSize,originVendorItemId:c.originVendorItemId}))}console.log(e);for(var l=0;l<e.length;l++){console.log("íŒë§¤í˜„í™© ë° ìˆ˜ìˆ˜ë£Œ ìˆ˜ì§‘ì¤‘ ("+l+"/"+e.length+")");var u,d=e[l],p=(a&&0<a.length&&a.find(e=>e.vendorItemId==d.vendorItemId)?d.coupon=a.find(e=>e.vendorItemId==d.vendorItemId).couponAmount:d.coupon=0,0<o.length&&o.find(e=>e.vendorItemId==d.vendorItemId)?d.badge=!1:d.badge=!0,{info:{price:d.salePrice-d.coupon,categoryId:d.kanCategoryId,x:d.skuInfo.width,y:d.skuInfo.length,z:d.skuInfo.height,w:d.skuInfo.weight}}),p=(d.upBundlingSize&&(u=Math.min([p.info.x,p.info.y,p.info.z]),p.info.x===u?p.info.x*=d.upBundlingSize:p.info.y===u?p.info.y*=d.upBundlingSize:p.info.z*=d.upBundlingSize),d.ìˆ˜ìˆ˜ë£Œ=await getMargin(p,!1,t),d.ìˆ˜ìˆ˜ë£Œ.íŒë§¤ìˆ˜ìˆ˜ë£Œ=.01*d.ìˆ˜ìˆ˜ë£Œ.íŒë§¤ìˆ˜ìˆ˜ë£Œìœ¨*1.1*(d.salePrice-d.coupon),d.upBundlingSize&&(u=e.find(e=>e.vendorItemId==d.originVendorItemId),console.log(u),console.log(d),d.ìˆ˜ìˆ˜ë£Œ.ì…ì¶œê³ ë¹„=u?.ìˆ˜ìˆ˜ë£Œ?.ì…ì¶œê³ ë¹„*d.upBundlingSize),d.commission=Math.round(parseInt(d.ìˆ˜ìˆ˜ë£Œ.ë°°ì†¡ë¹„)+parseInt(d.ìˆ˜ìˆ˜ë£Œ.ì…ì¶œê³ ë¹„)+d.ìˆ˜ìˆ˜ë£Œ.íŒë§¤ìˆ˜ìˆ˜ë£Œ),n.find(e=>e.vendorItemId==d.vendorItemId));p?(d.orderableQuantity=p.inventoryDetails.orderableQuantity,d.gmvForLast7Days=p.gmvForLast7Days,d.gmvForLast30Days=p.gmvForLast30Days,d.unitsSoldForLast7Days=p.salesStatistics.last7DaysSales?p.salesStatistics.last7DaysSales.unitsSoldBeforeExcludingCancellations+p.salesStatistics.last7DaysSales.unitsCancelled:0,d.unitsSoldForLast30Days=p.salesStatistics.last30DaysSales?p.salesStatistics.last30DaysSales.unitsSoldBeforeExcludingCancellations+p.salesStatistics.last30DaysSales.unitsCancelled:0,d.CVRFor30Days=p.salesStatistics.last30DaysSales?d.unitsSoldForLast30Days/p.salesStatistics.last30DaysSales.totalPageViews:0,d.skuGrade=p.listingDetails.skuGrade,d.listingDetails=p.listingDetails,d.winner=p.pricing.buyboxStatus):(d.orderableQuantity=0,d.gmvForLast7Days=0,d.gmvForLast30Days=0,d.unitsSoldForLast7Days=0,d.unitsSoldForLast30Days=0,d.CVRFor30Days=0,d.skuGrade="NEW",d.listingDetails={},d.winner=""),chrome.tabs.sendMessage(r.id,{msg:"growthDbRatio",ratio:l/e.length*100,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ìƒí’ˆë³„ íŒë§¤/í’€í•„ë¨¼íŠ¸ ìˆ˜ìˆ˜ë£Œ ìˆ˜ì§‘ ì¤‘..."})}return e}async function getExcelData(){var e=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return await(await fetch("https://wing.coupang.com/tenants/rfm/v2/inbound/excel",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json","sec-ch-ua":'"Not.A/Brand";v="8", "Chromium";v="114", "Google Chrome";v="114"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm/v2/inbound/main",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"POST",mode:"cors",credentials:"include"})).arrayBuffer()}async function getItemDetailInfo(e){var t=JSON.stringify(e),e=(console.log(e),document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1]),e=await(await fetch("https://wing.coupang.com/tenants/rfm-inbound/data/vendor-inventory/item-details/bulk",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":e},referrer:"https://wing.coupang.com/tenants/rfm-inbound/inbound/main",referrerPolicy:"strict-origin-when-cross-origin",body:t,method:"POST",mode:"cors",credentials:"include"})).json();return console.log(e),e}async function getTotalGrowthDb(n,o){var s={};let c=0,i=0;for(;;){i++,console.log(`===== Iteration #${i} ì‹œì‘ =====`);let r=1,a=null;for(let t=0;t<r;t++){var l,u=(await chrome.scripting.executeScript({target:{tabId:n.id},function:getGrowthDb,args:[t,a]}))[0].result;r=Math.floor(u.paginationResponse.totalNumberOfElements/100)+1,a=u.paginationResponse.searchAfterSortValues,1===i&&0===t&&(c=u.paginationResponse.totalNumberOfElements,console.log("ì„œë²„ì—ì„œ ì•Œë ¤ì¤€ totalNumberOfElements = "+c));let e=0;for(l of u.viProperties)s[l.vendorItemId]||(s[l.vendorItemId]=l,e++);0<e?console.log(`[í˜ì´ì§€ ${t}] ìƒˆë¡œ ë°œê²¬ëœ vendorItemId ìˆ˜: `+e):console.log(`[í˜ì´ì§€ ${t}] ìƒˆë¡œ ë°œê²¬ëœ vendorItemId ì—†ìŒ`),chrome.tabs.sendMessage(o.id,{msg:"growthDbRatio",ratio:(t+1)/r*100,text:"ë¡œì¼“ê·¸ë¡œìŠ¤ ì¬ê³ í˜„í™© ìˆ˜ì§‘ ì¤‘("+i+")..."});var u=Object.keys(s).length;if(u>=c)return console.log(`í•„ìš”í•œ ëª¨ë“  vendorItemId (${u}/${c})ë¥¼ ìˆ˜ì§‘í–ˆìŠµë‹ˆë‹¤.`),u=Object.values(s),console.log(u),u}var e,t=Object.keys(s).length;if(console.log(`===== Iteration #${i} ì™„ë£Œ: `+`ìˆ˜ì§‘ëœ ê³ ìœ  vendorItemId ìˆ˜ = ${t}ê°œ =====`),t>=c)return console.log(`ëª¨ë“  vendorItemId (${t}/${c}) ìˆ˜ì§‘ ì™„ë£Œ. ìŠ¤ìº” ì¢…ë£Œí•©ë‹ˆë‹¤.`),e=Object.values(s),console.log(e),e;console.log(`ì•„ì§ ${t}ê°œ / ì´ ${c}ê°œ. `+"ë°ì´í„° ìë¦¬ ë³€ê²½ ê°€ëŠ¥ì„±ì„ ê³ ë ¤í•´ í˜ì´ì§€ë¥¼ 0ë¶€í„° ë‹¤ì‹œ ìŠ¤ìº”í•©ë‹ˆë‹¤.")}}async function getGrowthDb(e,t){t=JSON.stringify(t);var r=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];console.log('{"paginationRequest":{"pageSize":100,"pageNumber":'+e+',"searchAfterSortValues":'+t+'},"hiddenStatus":"VISIBLE","sort":[{"sortParameter":"ORDERABLE_QUANTITY","sortDirection":"DESCENDING"}]}');r=await(await fetch("https://wing.coupang.com/tenants/rfm-inventory/inventory-health-dashboard/search",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":r},referrer:"https://wing.coupang.com/tenants/rfm-inventory/management/list",referrerPolicy:"strict-origin-when-cross-origin",body:'{"paginationRequest":{"pageSize":100,"pageNumber":'+e+',"searchAfterSortValues":'+t+'},"hiddenStatus":"VISIBLE","sort":[{"sortParameter":"ORDERABLE_QUANTITY","sortDirection":"DESCENDING"}]}',method:"POST",mode:"cors",credentials:"include"})).json();return console.log(r),r}async function confirmSupplierCode(e,t){t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:getsuppliercode}))[0].result;return!!t&&(t==e||t)}async function getsuppliercode(){return document.querySelector(".vendor-id-wrapper")?document.querySelector(".vendor-id-wrapper").innerText.replaceAll("ì—…ì²´ì½”ë“œ ",""):!!document.querySelector(".rs-account__menu--primary")&&document.querySelector(".rs-account__menu--primary").innerText}function splitArrayIntoChunks(t,r){var a=[];for(let e=0;e<t.length;e+=r)a.push(t.slice(e,e+r));return a}async function getrelatedkeywords(e,t,r,a,n,o){var s=[],c=(e.forEach(e=>{s.push(e)}),[]);if(console.log(e.length),a){for(var i=a,l=s.length,u=0;u<i;u++){console.log(l);for(var d=0;d<l;d++){chrome.tabs.sendMessage(r.id,{response:"relkeywordsrate",n:u+1,rate:d/l}),c=await getrelfromcoupang(s[d],t,n,o),console.log(c);for(var p=0;p<c.length;p++)s.includes(c[p])||s.push(c[p])}l=s.length}return s}for(d=0;d<e.length;d++){chrome.tabs.sendMessage(r.id,{response:"relkeywordsrate",n:1,rate:d/s.length});for(c=await getrelfromcoupang(e[d],t,n,o),p=0;p<c.length;p++)s.includes(c[p])||s.push(c[p])}var h=[];for(d=0;d<s.length;d++){chrome.tabs.sendMessage(r.id,{response:"relkeywordsrate",n:2,rate:d/s.length}),c=await getrelfromcoupang(s[d],t,n,o);for(p=0;p<c.length;p++)h.includes(c[p])||h.push(c[p])}return h}async function addrelatedkeywords(e,t,r,a){var n=[];for(i=0;i<e.length;i++)for(var o=await getrelfromcoupang(e[i],t,!0,!0),s=0;s<o.length;s++){var c="";if(!n.includes(o[s])){for(var c=o[s],l=0;l<a.length;l++)c.includes(a[l].keyword)&&(c=c.replaceAll(a[l].keyword,"").trim());if(""!==c&&(n.push(o[s]),chrome.tabs.sendMessage(r.id,{response:"relkeywordsrate",n:1,rate:n.length/30}),30<n.length))return n}}return n}async function getrelfromnaver(e,t){return{relatedkeywords:(await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchnaverrelatedkeyword,args:[e]}))[0].result.relatedkeywords}}async function fetchnaverrelatedkeyword(e){var e=await(await fetch("https://search.shopping.naver.com/search/all?query="+e+"&prevQuery="+e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://search.shopping.naver.com/search/all?query="+e,referrerPolicy:"unsafe-url",body:null,method:"GET",mode:"cors",credentials:"include"}).catch(console.log)).text(),e=(new DOMParser).parseFromString(e,"text/html"),t=[];if(Array.from(e.getElementsByClassName("relatedTags_relation_srh__YG9s7")))for(var r=Array.from(e.getElementsByClassName("relatedTags_relation_srh__YG9s7")),a=0;a<r[0].children[1].children.length;a++){var n=r[0].children[1].children[a].innerText;t.includes(n)||t.push(n)}if(Array.from(e.querySelectorAll(".filter_finder_col__k6BKF")).find(e=>e.innerText.includes("í‚¤ì›Œë“œì¶”ì²œ"))){console.log(Array.from(e.querySelectorAll(".filter_finder_col__k6BKF")).find(e=>e.innerText.includes("í‚¤ì›Œë“œì¶”ì²œ")).children[1].children[0].children[0]);for(var o=Array.from(e.querySelectorAll(".filter_finder_col__k6BKF")).find(e=>e.innerText.includes("í‚¤ì›Œë“œì¶”ì²œ")).children[1].children[0].children[0],a=0;a<o.children.length;a++)n=o.children[a].innerText,t.includes(n)||t.push(n)}return{relatedkeywords:t}}async function getrelfromcoupang(e,t,r,a){var n=[];return r&&(r=await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchrelatedkeywordcoupang,args:[e]}),console.log(r),n=r[0].result&&0<r[0].result.length?r[0].result:[e]),a&&(r=await chrome.scripting.executeScript({target:{tabId:t.id},function:getautokeywords,args:[e]}),console.log(r),r[0].result)&&0<r[0].result.length&&(n=n.concat(r[0].result)),console.log(n),n}async function fetchrelatedkeywordcoupang(e){var e=await(await fetch("https://www.coupang.com/np/search?q="+encodeURI(e),{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5","sec-ch-ua":'"Chromium";v="112", "Google Chrome";v="112", "Not:A-Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),t=(new DOMParser).parseFromString(e,"text/html"),r=[];if(t.querySelector(".search-related-keyword")&&0<t.querySelector(".search-related-keyword").children[1].children.length)for(i=0;i<t.querySelector(".search-related-keyword").children[1].children.length;i++)element=t.querySelector(".search-related-keyword").children[1].children[i],r.push(element.innerText);if(t.querySelector(".srp_relatedKeywords__DJiuK")&&0<t.querySelector(".srp_relatedKeywords__DJiuK").children.length)for(i=1;i<t.querySelector(".srp_relatedKeywords__DJiuK").children.length;i++)element=t.querySelector(".srp_relatedKeywords__DJiuK").children[i],r.push(element.innerText);return r}async function getautokeywords(t){try{var r=(n=await(a=await fetch("https://www.coupang.com/n-api/web-adapter/search?keyword="+t+"&_=1747668595224",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.coupang.com/np/search?q="+encodeURI(t),referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()).map(e=>e.keyword)}catch(e){var a=await fetch("https://www.coupang.com/np/search/autoComplete?callback=jQuery111104777436103598398_1683352433937&keyword="+encodeURI(t)+"&_=1683352433940",{headers:{accept:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5","sec-ch-ua":'"Chromium";v="112", "Google Chrome";v="112", "Not:A-Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.coupang.com/np/search?q="+encodeURI(t),referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}),n=(console.log(a),await a.text()),t=JSON.parse(n.slice(n.search("{")-1,-1)),r=(console.log(t),t.map(e=>e.keyword));console.log(r)}return r}async function fetchnaverparsing(e,t,r,a){var n,o=0,s=[];for(n of e){chrome.tabs.sendMessage(r.id,{response:"keywordanalysisstatus",status:o/e.length}),o++;var c=await fetchnaverpageparsing(n,t,a,r);console.log(c),s.push(c)}return s}async function fetchcoupang(e,t,r,a,n,o){var s,c,i=0,l=[];for(s of e)console.log(s),chrome.tabs.sendMessage(r.id,{response:"keywordanalysisstatus",status:i/e.length}),i++,c=a?await fetchpageinfoNomad(s,t,a,r,n):await fetchpageinfo(s,t,a,r,o),console.log(c),l.push(c);return l}async function fetchpageinfoNomad(e,t,r,a,n){var t=await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchkeywordrocket,args:[e]}),t=(console.log(t),t[0].result),o=(console.log(t),t?t.productqty:0);return{keyword:e,productqty:t?t.totalproductqty:0,rocketqty:o}}async function fetchkeywordcoupang(e,t,r,a){for(var n=[],o=0;o<t;o++){await sleep(500),chrome.tabs.sendMessage(a.id,{response:"keywordanalysisstatusratio",status:o/t,text:'"'+e+'" í‚¤ì›Œë“œ ìƒí’ˆë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘ ì¤‘'});var s=await fetchkeywordmAPI(e,o+1);console.log(s),console.log(s),s&&s.productlists&&(n=n.concat(s.productlists)),console.log(n)}return n}async function fetchnaver(e,t,r,a){var n,o=[];for(n of e){var s=await fetchnaverpageinfo(n,t,r,a);console.log(s),o.push(s)}return o}async function fetchnaverpageparsing(e,t,r,a){console.log(t),await sleep(500);var n,t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:getoverseasproducts,args:[e,r]}))[0].result;return console.log(t),t?(n=await getkeywordvalue(t,a),console.log(n)):n=[],{keyword:e,keywordvalue:n}}async function fetchnaverpageinfo(e,t,r,a){console.log(t),console.log(e,r),await sleep(500);var n,t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:gethighlevelproducts,args:[e,r]}))[0].result;return console.log(t),t?(n=await getkeywordvalue(t,a),console.log(n)):n=[],{keyword:e,products:t,keywordvalue:n}}async function getoverseasproducts(e,t){for(var r=[],a=0;a<3;a++){var n="https://search.shopping.naver.com/api/search/all?sort=review&pagingIndex="+(a+1)+"&pagingSize=80&viewType=list&productSet=overseas&deliveryFee=&deliveryTypeValue=&frm=NVSHOVS&query="+e+"&origQuery="+e+"&iq=&eq=&xq=&window=",n=await(await fetch(n,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",logic:"PART",sbth:t,"sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:n,referrerPolicy:"unsafe-url",body:null,method:"GET",mode:"cors",credentials:"include"}).catch(console.log)).text(),n=await JSON.parse(n);n.shoppingResult&&n.shoppingResult.products&&(r=r.concat(n.shoppingResult.products))}return console.log(r),r}async function gethighlevelproducts(e,t){console.log(e,t);t=await(await fetch("https://search.shopping.naver.com/api/search/all?sort=rel&pagingIndex=1&pagingSize=40&viewType=list&productSet=total&query="+e+"&origQuery="+e+"&adQuery="+e+"&iq=&eq=&xq=",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",logic:"PART",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="135", "Not-A.Brand";v="8", "Chromium";v="135"',"sec-ch-ua-arch":'"x86"',"sec-ch-ua-bitness":'"64"',"sec-ch-ua-form-factors":'"Desktop"',"sec-ch-ua-full-version-list":'"Google Chrome";v="135.0.7049.85", "Not-A.Brand";v="8.0.0.0", "Chromium";v="135.0.7049.85"',"sec-ch-ua-mobile":"?0","sec-ch-ua-model":'""',"sec-ch-ua-platform":'"Windows"',"sec-ch-ua-platform-version":'"19.0.0"',"sec-ch-ua-wow64":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://search.shopping.naver.com/search/all?query="+e+"&vertical=search",referrerPolicy:"unsafe-url",body:null,method:"GET",mode:"cors",credentials:"include"}).catch(console.log)).text(),e=await JSON.parse(t);return console.log(e),e.shoppingResult.products}async function refreshTabAfterRedirect(e){e=await chrome.tabs.create({url:e,active:!1});return await chrome.tabs.update(e.id,{autoDiscardable:!1}),waitForRedirectAndRefresh(e.id)}async function redirectTab(c,i,l=null,e=!0){return e?new Promise((e,t)=>{let a=!1,r=null;async function n(){if(!a&&l)try{var e=await chrome.scripting.executeScript({target:{tabId:c},function:e=>{var t;return"string"==typeof e?!!document.querySelector(e):!("object"!=typeof e||!e.selector||!(t=document.querySelector(e.selector)))&&(e.text?(e.useInnerHTML?t.innerHTML:t.innerText).includes(e.text):!e.attribute||void 0===e.value||t.getAttribute(e.attribute)===e.value)},args:[l]});e&&e[0]&&!0===e[0].result?o():setTimeout(n,500)}catch(e){console.error("DOM í™•ì¸ ì¤‘ ì˜¤ë¥˜:",e),setTimeout(n,1e3)}}function o(){a||(a=!0,r&&clearTimeout(r),chrome.tabs.onUpdated.removeListener(s),chrome.tabs.reload(c,()=>{e({tabId:c})}))}function s(e,t,r){e!==c||"complete"!==t.status||a||(l?n:o)()}try{chrome.tabs.onUpdated.addListener(s),chrome.tabs.update(c,{url:i},e=>{chrome.runtime.lastError?(a=!0,chrome.tabs.onUpdated.removeListener(s),t(new Error(chrome.runtime.lastError.message))):r=setTimeout(()=>{a||(a=!0,chrome.tabs.onUpdated.removeListener(s),t(new Error("Timeout: Tab did not load in time.")))},3e4)})}catch(e){a||(a=!0,chrome.tabs.onUpdated.removeListener(s),t(e))}}):(console.log("redirectTab: ë¦¬ë‹¤ì´ë ‰íŠ¸ ê±´ë„ˆëœ€ (shouldRedirect=false)"),Promise.resolve({tabId:c}))}async function refreshTabAfterRedirectActive(e){e=await chrome.tabs.create({url:e,active:!0});return await chrome.tabs.update(e.id,{autoDiscardable:!1}),waitForRedirectAndRefresh(e.id)}async function waitForRedirectAndRefresh(o){return new Promise((a,e)=>{function n(e,t,r){e===o&&"complete"===t.status&&(chrome.tabs.reload(o,()=>{a(r)}),chrome.tabs.onUpdated.removeListener(n))}chrome.tabs.onUpdated.addListener(n),setTimeout(()=>{e(new Error("Timeout: Tab did not load in time.")),chrome.tabs.onUpdated.removeListener(n)},15e3)})}async function getkeywordvalue(e,t){async function r(e,t){await secretOnNaver();var r,a,n="";async function o(e){try{return(await fetch(e)).url}catch(e){return e.name}}sstab||bstab?sstab?(r=await chrome.scripting.executeScript({target:{tabId:sstab.id},function:o,args:[e]}))[0].result&&r[0].result.includes("TypeError")?bstab?n=e.replace("smartstore","brand"):(n=(a=await refreshTabAfterRedirect(e)).url,bstab=a):n=r[0].result:(r=await chrome.scripting.executeScript({target:{tabId:bstab.id},function:o,args:[e]}))[0].result&&r[0].result.includes("TypeError")?(n=(a=await refreshTabAfterRedirect(e)).url,sstab=a):n=r[0].result:(n=(a=await refreshTabAfterRedirect(e)).url).includes("smartstore.naver.com")?sstab=a:bstab=a,r=n.includes("smartstore.naver.com")?await chrome.scripting.executeScript({target:{tabId:sstab.id},function:s,args:[t,n]}):await chrome.scripting.executeScript({target:{tabId:bstab.id},function:s,args:[t,n]}),console.log(r);e=r[0].result;return e||{sales:0,salesShort:0,reviewAmount:{}};async function s(e,t){var r="https://smartstore.naver.com/i/v1",t=(r=t.includes("brand.naver.com")?"https://brand.naver.com/n/v1":r)+"/simple-products?ids[]="+e+"&useChannelProducts=false&excludeAuthBlind=false&excludeDisplayableFilter=false&forceOrder=true",e=await fetch(t,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-client-version":"20240716122101"},referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors",credentials:"include"});console.log(e);t=(await e.json())[0];console.log(t),console.log(t.productNo),t.sales=0,t.salesShort=0;e=await(await fetch(r+"/marketing-message/"+t.productNo+"?currentPurchaseType=Paid&usePurchased=true&basisPurchased=1&usePurchasedIn2Y=true&useRepurchased=true&basisRepurchased=1",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-client-version":"20240716122101"},referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors",credentials:"include"})).json();return e.prefix.includes("ìƒí’ˆì„")||(e.prefix.includes("1ì£¼ê°„")?(t.sales=parseInt(parseInt(e.mainPhrase.replace("ëª…ì´ êµ¬ë§¤","").replaceAll(",",""))/7*30),t.salesShort=parseInt(e.mainPhrase.replace("ëª…ì´ êµ¬ë§¤","").replaceAll(",",""))):(e=parseInt(e.mainPhrase.replace("ëª…ì´ êµ¬ë§¤","").replaceAll(",",""))+1,(r=await(await fetch(r+"/marketing-message/"+t.productNo+"?currentPurchaseType=Paid&usePurchased=true&basisPurchased="+e+"&usePurchasedIn2Y=true&useRepurchased=true&basisRepurchased="+e,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-client-version":"20240716122101"},referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors",credentials:"include"})).json()).prefix.includes("ìƒí’ˆì„")?(t.sales=parseInt((e-1)/7*30),t.salesShort=e-1):r.prefix.includes("1ì£¼ê°„")&&(t.sales=parseInt(parseInt(r.mainPhrase.replace("ëª…ì´ êµ¬ë§¤","").replaceAll(",",""))/7*30),t.salesShort=parseInt(r.mainPhrase.replace("ëª…ì´ êµ¬ë§¤","").replaceAll(",",""))))),t}}for(var a=e,n=(console.log(a),[]),o=[],s=0;s<a.length;s++){console.log("keywordvalue : "+s+"/"+a.length),chrome.tabs.sendMessage(t.id,{response:"keywordanalysisstatus",status:s/a.length});var c,i,l,u;a[s].lowMallList?a[s].lowMallList.find(e=>e.chnlSeq&&e.mallPid&&"STOREFARM"==e.chnlType)&&(i="Y"==(c=a[s].lowMallList.find(e=>e.chnlSeq&&e.mallPid&&"STOREFARM"==e.chnlType)).isOfficialMall?"https://brand.naver.com/main/products/"+c.mallPid:"https://smartstore.naver.com/main/products/"+c.mallPid,console.log(c.mallPid),l=await r(i,c.mallPid),console.log(l),l)&&(u={rank:s+1,catalog:!0,productName:a[s].productTitle,productId:c.mallPid,price:parseInt(c.price.replaceAll(",","")),long:l.sales,short:l.salesShort,info:l,purchaseInfo:{},imgUrl:a[s].imageUrl},console.log(u),console.log("íŒë§¤ëŸ‰:"+u.short+" / result:"+(0<u.short)),u.info.reviewAmount&&u.info.reviewAmount.totalReviewCount&&u.info.reviewAmount.averageReviewScore?(console.log("ë¦¬ë·°ìˆ˜:"+u.info.reviewAmount.totalReviewCount+" / result:"+(5<u.info.reviewAmount.totalReviewCount)),console.log("í‰ì :"+u.info.reviewAmount.averageReviewScore+" / result:"+(4.7<u.info.reviewAmount.averageReviewScore))):(console.log("ë¦¬ë·°ìˆ˜:0 / result:"+!1),console.log("í‰ì :0 / result:"+!1)),n.push(u),0<u.short+u.long)&&u.info.reviewAmount&&u.info.reviewAmount.totalReviewCount&&5<u.info.reviewAmount.totalReviewCount&&4.7<u.info.reviewAmount.averageReviewScore&&(o.push(deepClone(u)),console.log("í†µê³¼")):a[s].chnlSeq&&a[s].mallProductId&&a[s].mallPcUrl.includes("smartstore.naver.com")&&(i=0<a[s].isBrandStore?"https://brand.naver.com/main/products/"+a[s].mallProductId:"https://smartstore.naver.com/main/products/"+a[s].mallProductId,console.log(a[s].mallProductId),l=await r(i,a[s].mallProductId,a[s].originalMallProductId),console.log(l),l)&&(u={rank:s+1,catalog:!1,productName:a[s].productTitle,productId:a[s].mallProductId,price:parseInt(a[s].price.replaceAll(",","")),long:l.sales,short:l.salesShort,info:l,purchaseInfo:{},imgUrl:a[s].imageUrl},console.log(u),console.log("íŒë§¤ëŸ‰:"+u.short+" / result:"+(0<u.short)),u.info.reviewAmount&&u.info.reviewAmount.totalReviewCount&&u.info.reviewAmount.averageReviewScore?(console.log("ë¦¬ë·°ìˆ˜:"+u.info.reviewAmount.totalReviewCount+" / result:"+(5<u.info.reviewAmount.totalReviewCount)),console.log("í‰ì :"+u.info.reviewAmount.averageReviewScore+" / result:"+(4.7<u.info.reviewAmount.averageReviewScore))):(console.log("ë¦¬ë·°ìˆ˜:0 / result:"+!1),console.log("í‰ì :0 / result:"+!1)),n.push(u),0<u.short+u.long)&&u.info.originAreaInfo&&u.info.reviewAmount&&u.info.reviewAmount.totalReviewCount&&5<u.info.reviewAmount.totalReviewCount&&4.7<u.info.reviewAmount.averageReviewScore&&(o.push(deepClone(u)),console.log("í†µê³¼"))}return console.log("í†µê³¼ìˆ˜ëŸ‰"+o.length),n}async function getsalesinfo2(e,t){var r;return result=(r=e,r=await(await fetch("https://smartstore.naver.com/i/v1/stores/"+e+"/products/"+t,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",logic:"PART","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://smartstore.naver.com",referrerPolicy:"unsafe-url",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),await JSON.parse(r))}async function getcpc(e,t){return console.log(t),t?(t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchcpckeyword,args:[e]}))[0].result,console.log(t),t):{}}async function fetchcpc(e,t){var r;return console.log(t),t?(r=await linktoad(t.id,"https://advertising.coupang.com/marketing/campaign/registration"),console.log(r),t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchcpckeyword,args:[e]}))[0].result,console.log(t),console.log(r),t):{}}async function linktoad(e,t){return new Promise(n=>{chrome.tabs.update(e,{url:t},async a=>{chrome.tabs.onUpdated.addListener(function e(t,r){"complete"===r.status&&t===a.id&&(chrome.tabs.onUpdated.removeListener(e),n(a))})})})}async function fetchcpckeyword(e){e=await(await fetch("https://advertising.coupang.com/marketing/cmg-api/recommendation/keyword",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json;charset=UTF-8","sec-ch-ua":'"Google Chrome";v="123", "Not:A-Brand";v="8", "Chromium";v="123"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://advertising.coupang.com/marketing/campaign/registration",referrerPolicy:"strict-origin-when-cross-origin",body:'{"credentials":"include","headers":{"Content-Type":"text/html charset=utf-8"},"keywords":'+JSON.stringify(e)+"}",method:"POST",mode:"cors",credentials:"include"})).text();return JSON.parse(e)}async function makepage(e,t){var r,a=t.ë“±ë¡ë²ˆí˜¸,n=t.ìƒí’ˆëª…kr,o=t.option1array;return e=e,r=await chrome.scripting.executeScript({target:{tabId:e.id},func:s}),console.log(r),{product_num:a,product_name:n,option1_kr:o,total:await(r=await chrome.scripting.executeScript({target:{tabId:e.id},func:c})),data:t};async function s(){var t,e=0;return setInterval(function(){e<50&&(window.scrollTo(1e3*e,1e3*e+1e3),e++)},200),t=7e3,await new Promise(e=>setTimeout(e,t)),!0}async function c(){var e=[],t=[],r=[],a=[];if(document.querySelector("body").innerHTML.search("widget-custom-container")<0&&document.querySelector("body").innerHTML.search("J_UlThumb")<0){a.push("1688");for(var n=0;n<document.querySelectorAll("script").length;n++)0<document.querySelectorAll("script")[n].innerHTML.search("window.__GLOBAL_DADA")&&(p=document.querySelectorAll("script")[n].innerHTML);for(var o=p.search("window.__INIT_DATA"),s=p.slice(o+19,p.length),c=JSON.parse(s),i=c.globalData.skuModel.skuProps,n=(c.globalData.skuModel.skuInfoMap,0);n<c.globalData.images.length;n++)e.push(c.globalData.images[n].fullPathImageURI);var l="content-detail";for(n=0;n<i[0].value.length;n++)void 0!==i[0].value[n].imageUrl&&t.push(i[0].value[n].imageUrl);for(n=0;n<document.getElementsByClassName(l)[0].getElementsByTagName("img").length;n++)r.push(document.getElementsByClassName(l)[0].getElementsByTagName("img")[n].src)}else if(document.querySelector("body").innerHTML.search("J_UlThumb")<0){a.push("1688");var o=document.getElementsByClassName("widget-custom-container")[0].innerHTML,u=o.search("var iDetailData ="),d=o.search("iDetailData.allTagIds ="),o=o.slice(u,d),i=(u=(o=(o=(o=o.trim()).replace(/ /gi,"")).replace('"skuProps"',"skuProps").replace('"skuMap"',"skuMap").replace('},"end"',"end")).search("skuProps"),d=o.search("skuMap"),endtext2=o.search("end:0"),data1=o.slice(u+9,d-2),data2=o.slice(d+7,endtext2-2),JSON.parse(data1));JSON.parse(data2);for(n=0;n<4;n++)e.push(document.getElementsByClassName("tab-content-container")[0].getElementsByClassName("box-img")[n].children[0].src.replace("64x64.","").replace("60x60.",""));l="desc-lazyload-container";for(n=0;n<i[0].value.length;n++)void 0!==i[0].value[n].imageUrl&&t.push(i[0].value[n].imageUrl);for(n=0;n<document.getElementsByClassName(l)[0].getElementsByTagName("img").length;n++)r.push(document.getElementsByClassName(l)[0].getElementsByTagName("img")[n].src)}else{a.push("taobao");for(var p,h="",h=0<(p=document.querySelector("#J_UlThumb").innerHTML.replaceAll("data-src","").replaceAll("_30x30.jpg","").replaceAll("_50x50.jpg","")).search(".jpg")?".jpg":".png";0<p.search("src=");)p=p.slice(p.search("src=")-1,p.length),e.push("https:"+p.slice(p.search("src=")+5,p.search(h)+4).replace("https:","")),p=p.replace("src=","");for(s=document.querySelector(".tb-skin").innerHTML.replaceAll("_30x30.jpg","");0<s.search("//");)console.log(s),s=s.search("//")>s.search(".jpg")&&0<s.search(".jpg")?s.replace(".jpg",""):s.search("//")>s.search(".png")&&0<s.search(".png")?s.replace(".png",""):(s.search("tb-out-of-stock")<s.search("//")&&0<s.search("tb-out-of-stock")?s=s.replace("tb-out-of-stock",""):(0<s.search(".jpg")&&0<s.search(".png")?h=s.search(".jpg")<s.search("png")?".jpg":".png":s.search(".jpg")<0?s.search(".png")<0?s.replaceAll("//",""):h=".png":h=".jpg",console.log("https:"+s.slice(s.search("//"),s.search(h)+4).replace("https:","")),t.push("https:"+s.slice(s.search("//"),s.search(h)+4).replace("https:","")),s)).replace("//","");for(0<(g=document.querySelector("#description").innerHTML).search(".jpg")?h=".jpg":0<g.search(".png")?h=".png":0<g.search(".gif")&&(h=".gif");0<g.search('src="https://img');)var m="https:"+g.slice(g.search('src="https://img')+5,g.search(h)+4).replace("https:",""),g=(m.slice(0,-3).includes(".jpg")||m.slice(0,-3).includes(".png")||m.slice(0,-3).includes(".gif")||r.push(m),(g=g.replace('src="https://img',"")).slice(g.search('src="https://img')-1,g.length))}console.log(t);u=[];return u.push(e),u.push(t),u.push(r),u.push(a),u}}async function changestatus(a){chrome.tabs.onUpdated.addListener((e,t,r)=>{if(r.url==a.url&&"complete"==t.status)return console.log(t),!0})}async function findtab(e,t){var r={};return t.includes("1688.com")?e.some(e=>{if(e.url.includes("1688.com"))return r=e,!0}):(t.includes("taobao")||t.includes("tmall"))&&e.some(e=>{if(e.url.includes("taobao.com")||e.url.includes("tmall.com"))return r=e,!0}),r}async function fetchinfo(e,t){return await chrome.scripting.executeScript({target:{tabId:e.id},function:pagefunc,args:[t]})}async function pagefunc(e){var t,r=[],a=[],n=[],o=[],s={},e=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","cache-control":"max-age=0","sec-ch-ua":'"Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),c=(new DOMParser).parseFromString(e,"text/html");if(c.querySelector("body").innerHTML.search("widget-custom-container")<0&&c.querySelector("body").innerHTML.search("J_UlThumb")<0){for(i=0;i<c.querySelectorAll("script").length;i++)0<c.querySelectorAll("script")[i].innerHTML.search("window.__GLOBAL_DADA")&&(t=c.querySelectorAll("script")[i].innerHTML);e=t.search("window.__INIT_DATA"),e=t.slice(e+19,t.length),e=JSON.parse(e);if((s.obj=e).globalData.skuModel.skuProps){var l=e.globalData.skuModel.skuProps,u=e.globalData.skuModel.skuInfoMap,d=(s.obj1=l,s.obj2=u,{});for(i=0;i<l[0].value.length;i++)d=Object.keys(l[0].value[i]).includes("imageUrl")?{name:l[0].value[i].name,imageUrl:l[0].value[i].imageUrl}:{name:l[0].value[i].name,imageUrl:""},r.push(d);if(1<l.length)for(i=0;i<l[1].value.length;i++)d=Object.keys(l[1].value[i]).includes("imageUrl")?{name:l[1].value[i].name,imageUrl:l[1].value[i].imageUrl}:{name:l[1].value[i].name,imageUrl:""},a.push(d)}}else if(c.querySelector("body").innerHTML.search("J_UlThumb")<0){var e=c.getElementsByClassName("widget-custom-container")[0].innerHTML,p=e.search("var iDetailData ="),h=e.search("iDetailData.allTagIds ="),e=e.slice(p,h),p=(e=(e=(e=e.trim()).replace(/ /gi,"")).replace('"skuProps"',"skuProps").replace('"skuMap"',"skuMap").replace('},"end"',"end")).search("skuProps"),h=e.search("skuMap");endtext2=e.search("end:0"),data1=e.slice(p+9,h-2),data2=e.slice(h+7,endtext2-2);const l=JSON.parse(data1),u=JSON.parse(data2);for(s.obj1=l,s.obj2=u,i=0;i<l[0].value.length;i++)d=Object.keys(l[0].value[i]).includes("imageUrl")?{name:l[0].value[i].name,imageUrl:l[0].value[i].imageUrl}:{name:l[0].value[i].name,imageUrl:""},r.push(d);if(1<l.length)for(i=0;i<l[1].value.length;i++)d=Object.keys(l[1].value[i]).includes("imageUrl")?{name:l[1].value[i].name,imageUrl:l[1].value[i].imageUrl}:{name:l[1].value[i].name,imageUrl:""},a.push(d)}else{for(i=0;i<c.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[0].children[0].children.length;i++)r.push(c.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[0].children[0].children[i].children[0].children[0].innerText.replace("å·²é€‰ä¸­",""));if(c.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].parentElement.innerHTML.search("æ•°é‡")<0)for(i=0;i<c.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].children[0].children.length;i++)a.push(c.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].children[0].children[i].children[0].children[0].innerText.replace("å·²é€‰ä¸­",""));if(c.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].parentElement.innerHTML.search("æ•°é‡")<0)for(i=0;i<r.length;i++)for(j=0;j<a.length;j++)n.push(r[i]+"&"+a[j]),o.push("");else for(i=0;i<r.length;i++)n.push(r[i]),o.push("")}return{option1array:r,option2array:a,info:s}}async function fetchrelatedkeyword(e){e="https://www.coupang.com/np/search?component=&q="+encodeURI(e)+"&channel=relate";console.log(e);try{var t=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:e,referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),r=(new DOMParser).parseFromString(t,"text/html"),a=(console.log(r),console.log(r.querySelector(".search-related-keyword")),[]);if(r.querySelector(".search-related-keyword")&&0<r.querySelector(".search-related-keyword").children[1].children.length)for(i=0;i<r.querySelector(".search-related-keyword").children[1].children.length;i++)element=r.querySelector(".search-related-keyword").children[1].children[i],a.push(element.innerText);if(r.querySelector(".srp_relatedKeywords__DJiuK")&&0<r.querySelector(".srp_relatedKeywords__DJiuK").children.length)for(i=1;i<r.querySelector(".srp_relatedKeywords__DJiuK").children.length;i++)element=r.querySelector(".srp_relatedKeywords__DJiuK").children[i],a.push(element.innerText);return console.log(a),{relatedkeywords:a}}catch(e){return console.log(e),{relatedkeywords:[]}}}async function fetchkeywordb(t,r,a,n=0){var o;o=10,await new Promise(e=>setTimeout(e,o));var e=`https://m.coupang.com/nm/search?q=${encodeURI(t)}&page=`+r;try{var s=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","user-agent":"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Mobile Safari/537.36","sec-ch-ua":'"Chromium";v="127", "Not=A?Brand";v="99", "Google Chrome";v="127"',"sec-ch-ua-mobile":"?1","sec-ch-ua-platform":'"Android"',"sec-fetch-site":"cross-site","sec-fetch-mode":"navigate","sec-fetch-user":"?1","sec-fetch-dest":"document",Referer:"https://m.coupang.com/"},method:"GET",mode:"cors",credentials:"include"})).text();if(!checkIfMobileVersion(s)&&n<30)return console.log("PC ë²„ì „ ê°ì§€. ëª¨ë°”ì¼ ë²„ì „ìœ¼ë¡œ ë‹¤ì‹œ ì‹œë„í•©ë‹ˆë‹¤."),await secretOn(),fetchkeywordb(t,r,a,n+1);console.log("fetchkeywordbTab : ");var c=(await chrome.tabs.query({})).find(e=>e.url.startsWith("https://")&&!e.url.includes("chrome")&&"complete"===e.status),[i]=(console.log(c),await chrome.scripting.executeScript({target:{tabId:c.id},func:parseHTML,args:[s,r,a]}));if(i&&i.result)return i.result;throw new Error("íŒŒì‹± ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.")}catch(e){if(console.error("Error in fetchkeywordb:",e),n<30)return await secretOn(),console.log(`ì¬ì‹œë„ ì¤‘... (${n+1}/30)`),fetchkeywordb(t,r,a,n+1);throw e}}function checkIfMobileVersion(e){e={urlPattern:e.includes("m.coupang.com/nm/"),mobileViewport:e.includes('meta name="viewport" content="width=device-width')};return console.log("Mobile Detection Results:",e),Object.values(e).every(Boolean)}function parseHTML(e,t,r){function a(e){if(null===e||"object"!=typeof e)return e;var t,r=Array.isArray(e)?[]:{};for(t of Object.keys(e))r[t]=a(e[t]);return r}var e=(new DOMParser).parseFromString(e,"text/html"),n=(console.log(e),[]),o=[],s={},c=0;if(console.log(e.querySelector("#pagination")),e.querySelector("#pagination")&&(parseInt(e.querySelector("#pagination").getAttribute("count"))&&(c=parseInt(e.querySelector("#pagination").getAttribute("count"))),"page next dim"==e.querySelector("#pagination").children[0].children[e.querySelector("#pagination").children[0].children.length-1].className)&&(r=t),console.log(c),console.log(r),console.log(e.querySelector("#productList")),e.querySelector("#productList")&&0<e.querySelector("#productList").children.length)for(var i=Array.from(e.querySelector("#productList").children),l=(console.log(i),0),u=0;u<i.length;u++)console.log(i[u]),console.log(i[u].querySelector(".title")),i[u].querySelector(".title")&&(i[u].className.includes("search-product__cmg-badge")||l++,s={rank:l,type:i[u].innerHTML.includes("vendor_inventory")?i[u].innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",productName:i[u].querySelector(".title ").innerText,price:i[u].querySelector(".discount-price ")?parseInt(i[u].querySelector(".discount-price ").children[0].innerText.replaceAll(",","")):0,rating:i[u].querySelector(".rating")?parseFloat(i[u].querySelector(".rating").innerText):0,ratingcount:i[u].querySelector(".rating-total-count")?parseInt(i[u].querySelector(".rating-total-count").innerText.replaceAll(",","").replaceAll("(","").replaceAll(")","")):0,vendorItemId:i[u].dataset.vendorItemId,productId:i[u].dataset.productId,itemId:i[u].dataset.itemId,ad:i[u].className.includes("search-product__cmg-badge"),imgUrl:i[u].querySelector(".thumbnail").children[0].src},(i[u].className.includes("search-product__cmg-badge")?o:n).push(a(s)));if(e.querySelector("#product-list")&&0<e.querySelector("#product-list").children.length){var d=e.querySelector("#product-list").children;console.log(d);for(u=0;u<d.length;u++){var p,h,m,g=d[u];g.className.includes("ProductUnit_productUnit__Qd6sv")&&(g.querySelector("IMG")&&(p=g.querySelector("IMG").src),m=function(t){try{var r=new URL(t),a=r.pathname.split("/");let e=null;3<a.length&&"vp"===a[1]&&"products"===a[2]&&(e=a[3]);var n=r.searchParams.get("itemId"),o=r.searchParams.get("vendorItemId");return e&&n&&o?{productId:e,itemId:n,vendorItemId:o}:(console.error("URLì—ì„œ ëª¨ë“  IDë¥¼ ì¶”ì¶œí•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."),e||console.error(" - productIdë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê²½ë¡œ í˜•ì‹ì„ í™•ì¸í•˜ì„¸ìš”:",r.pathname),n||console.error(" - itemId ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),o||console.error(" - vendorItemId ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),null)}catch(e){return console.error("ìœ íš¨í•˜ì§€ ì•Šì€ URLì…ë‹ˆë‹¤:",e.message),null}}(h=g.children[0].href),s={rank:u+1,productName:g.querySelector(".ProductUnit_productName__gre7e").innerText,type:g.innerHTML.includes("vendor_inventory")?g.innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",price:g.querySelector(".Price_priceValue__A4KOr")?parseInt(g.querySelector(".Price_priceValue__A4KOr").innerText.replaceAll(",","")):0,rating:g.querySelector(".ProductRating_star__RGSlV")?parseFloat(g.querySelector(".ProductRating_star__RGSlV").innerText):0,ratingcount:g.querySelector(".ProductRating_ratingCount__R0Vhz")?parseInt(g.querySelector(".ProductRating_ratingCount__R0Vhz").innerText.replaceAll("(","").replaceAll(")","")):0,product:m,ad:!!g.querySelector(".AdMark_adMark__KPMsC"),productId:m.productId,imgUrl:p,url:h},n.push(s))}}return console.log(o),console.log(n),console.log(r),console.log(c),{lastpage:r,productlists:n,productqty:c,adlists:o}}chrome.commands.onCommand.addListener(async function(e){"secretOn"===e&&doSecretOn()}),chrome.runtime.onMessage.addListener(async function(n,o,t){if(console.log(n),chrome.tabs.query({},e=>{e.find(e=>e.url.includes("couplus.co.kr"))&&(e=e.find(e=>e.url.includes("couplus.co.kr")).url,domain=e.slice(0,e.search("kr")+2)+"/")}),"growthDbRatio"===n.msg&&n.activetabId&&chrome.tabs.sendMessage(n.activetabId,{msg:"growthDbRatio",ratio:n.ratio,text:n.text}),await preventDiscardAllTabs(),"getproductinfo"===n.joke&&functionGetProductInfo(n),"makepage"===n.joke&&functionMakePage(n),"keywordanalysis"===n.joke&&functionKeywordAnalysis(n),"collectKeyword"===n.joke&&functionCollectKeyword(n),"storeparsing"===n.joke&&functionStoreParsing(n),"getrelatedkeywords"===n.joke&&functionGetRelatedKeywords(n),"gettotalrelatedkeywords"===n.joke&&functionGetTotalRelatedKeywords(n),"getKeywordCategory"===n.joke&&getKeywordCategory(n),"addrelatedkeywords"===n.joke&&functionAddRelatedKeywords(n),"collecttr"===n.joke&&getCollectTr(n),"importShipment"===n.joke&&importShipment(n),"collectGrowthDb"===n.joke&&collectGrowthInfo(n),"collectGrowthSales"===n.joke&&collectGrowthSales(n),"collectSettlementData"===n.joke&&collectSettlementData(n),"getMargin"===n.joke&&getMargin(n,!0,{}),"getCommission"===n.joke&&fetchCommission(n),"collectRank"===n.joke&&totalTrackingRank(n),"collectRankStop"===n.joke&&collectRankStop(),"coupangrank"===n.joke&&addRank(n),"getadkeyword"===n.joke&&functionGetAdKeyword(n),"getCategoryAnalysis"===n.joke&&categoryAnalysis(n),"getCategoryStats"===n.joke&&getCategoryStats(n),"coupangLoginTest"===n.joke&&coupangLoginTest(n),"autoCollectToggle"===n.type&&autoCollectToggle(n),"AiRocketRegRequest"===n.type&&(console.log("AiRocketRegRequest ìš”ì²­ ì„¸ë¶€ ì •ë³´:",{id:n.data.id,workType:n.data.workType,task:n.data.task,hasRequestArr:!!n.data.requestArr,requestArrLength:n.data.requestArr?.length||0}),handleAIRocketRequest(n.data,o.tab)),"GET_PRODUCT_INFO"===n.action&&getProductInfoFromCoupang(n.data,n.requestId),"GET_CATEGORY_INFO"===n.action&&getCategoryInfoFromCoupang(n.data),"SEARCH_CATEGORIES"===n.action&&searchCategoriesByKeyword(n.data),"GET_ATTRIBUTE_INFO"===n.type&&getAttributeInfo(n.data),"AiRocketRegDetailRequest"===n.type&&getDetailHTMLGenerate(n.data),"DELETE_ROCKET_REG_DOC"===n.action&&deleteRocketReg(n.data),"VERIFY_ROCKET_REG_DOC"===n.action&&(n.data.requestId=n.requestId,verifyRocketReg(n.data)),"SIZE_CHART_EXTRACTION"===n.type&&getSizeChartExtraction(n.data,o.tab),"AI_TRANSLATE_REQUEST"===n.type&&getAITranslation(n.data,o.tab),"REQUEST_ANALYZE_KEYWORD"===n.joke&&aiKeywordCollectAndAnalysis(n),"REQUEST_LAYOUT"===n.joke&&aiCreateLayout(n),"COLLECT_TOP3_REVIEWS"===n.type&&collectTop3ProductReviews(n),"updateAutoCollectStatus"===n.target&&updateAutoCollectStatus(n.text),"executeScript"===n.action)return chrome.scripting.executeScript({target:{tabId:o.tab.id},func:e=>{var t=document.querySelector(".input-area").querySelector("pre");return!!t&&(t.textContent=e,t.dispatchEvent(new Event("input",{bubbles:!0})),!0)},args:[n.text]}).then(e=>{t({success:e[0].result})}).catch(e=>{console.error("Script execution error:",e),t({success:!1})}),!0;switch(n.action){case"startAIProcessing":(async()=>{try{var e=await ConversationManager.getConversation(),t=await continueNegotiation(e.conversationHistory,n.message,e.geminiApiKey,e.geminiModel||"gemini-2.0-flash");chrome.tabs.sendMessage(o.tab.id,{action:"aiResponseReady",aiReply:t.aiReply,originalMessage:n.message})}catch(e){console.error("AI ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:",e),chrome.tabs.sendMessage(o.tab.id,{action:"aiError",error:e.message})}})();break;case"startNegotiation":(async()=>{try{var e=(new Date).toISOString(),t="session_"+e,r=n.negotiationData,a=(await StateManager.updateState({status:NEGOTIATION_STATUS.IN_PROGRESS,currentSession:{id:t,startTime:e,data:r}}),await startNegotiation({...r,geminiModel:r.geminiModel||"gemini-2.0-flash"}));await ConversationManager.setConversation({conversationHistory:a.conversationHistory,geminiApiKey:r.geminiApiKey,geminiModel:r.geminiModel||"gemini-2.0-flash",context:a.context}),chrome.tabs.sendMessage(o.tab.id,{action:"aiResponseReady",aiReply:a.aiReply,sessionId:t})}catch(e){console.error("í˜‘ìƒ ì‹œì‘ ì˜¤ë¥˜:",e),chrome.tabs.sendMessage(o.tab.id,{action:"aiError",error:e.message})}})();break;case"updateNegotiationStyle":StateManager.updateState({negotiationStyle:n.style});break;case"getState":StateManager.getState();break;case"updateState":StateManager.updateState(n.state);break;case"clearState":StateManager.clearState()}}),chrome.alarms.onAlarm.addListener(e=>{"autoCollect"===e.name&&chrome.storage.local.get("autoCollectSettings",async e=>{e.autoCollectSettings&&e.autoCollectSettings.enabled&&await executeCollectionSequentially(e.autoCollectSettings)})}),chrome.runtime.onMessage.addListener((e,t,r)=>{if("fetchKeyword"===e.action)return fetchkeywordb(e.keyword,e.page,e.lastpage).then(e=>r({success:!0,data:e})).catch(e=>r({success:!1,error:e.toString()})),!0});let keywordSessions=new Map,keywordPageCache=new Map,lastProcessedKeyword=null;function initializeSessionConfig(e){var t;return keywordSessions.has(e)||(t={osVersion:"13",appVersion:"7.8.2",accessToken:"",gcmRegisterId:"",uuid:generateUUID(),isCoupangAutoLogin:!1,deviceModel:"SM-S918N",androidIdMD5:generateMD5Hash(t=generateUUID().replace(/-/g,"")),googleAid:"",resolution:"1080x2340",pcid:t.substring(0,32),bValue:0,memberSrl:"",activeNetworkType:"WIFI",ddpResolution:"",sessionKey:"",updateToken:"",timeZoneId:Intl.DateTimeFormat().resolvedOptions().timeZone,sid:"",accessTokenSecret:"",deviceWidth:1080,deviceDpi:420,signalLevel:-80,fontScale:1,webpSupported:!0},keywordSessions.set(e,t)),keywordSessions.get(e)}function generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function generateMD5Hash(t){let r=0;if(0===t.length)return r.toString(16);for(let e=0;e<t.length;e++){var a=t.charCodeAt(e);r=(r<<5)-r+a,r&=r}return Math.abs(r).toString(16).padStart(8,"0").repeat(4).substring(0,32)}function generateCoupangUserAgent(e){var t=[];return t.push("COUPANG|Android"),t.push(e.osVersion),t.push(e.appVersion),t.push(e.accessToken),t.push(e.gcmRegisterId),t.push(e.uuid),t.push(e.isCoupangAutoLogin?"Y":"N"),t.push(e.deviceModel),t.push(e.androidIdMD5),t.push(e.googleAid),t.push(e.resolution),t.push(e.pcid),t.push(""),t.push(""),t.push(e.bValue),t.push(e.memberSrl),t.push(e.activeNetworkType),t.push(e.ddpResolution),t.push(e.sessionKey),t.push(e.updateToken),t.push(e.timeZoneId),t.push(e.sid),t.push(e.accessTokenSecret),t.push(e.deviceWidth),t.push(e.deviceDpi),t.push(e.signalLevel),t.push(e.fontScale),t.push(e.webpSupported),t.join("|")}async function searchCoupangProductsAPI(r,a=null,n=null){for(let t=1;t<=3;t++)try{let e="filter=KEYWORD:"+encodeURIComponent(r);e=(e=(e=(e+="&channel="+encodeURIComponent("app_search"))+("&selectedViewType="+encodeURIComponent("LIST")))+("&resultType="+encodeURIComponent("default")))+("&extraQueryParams="+encodeURIComponent("sort=RANK"))+"&preventingRedirection=false",a&&(e+="&nextPageKey="+encodeURIComponent(a)),n&&(e+="&nextPageParams="+encodeURIComponent(n));var o="https://cmapi.coupang.com/v3/products?"+e,s=initializeSessionConfig(r),c={"coupang-app":generateCoupangUserAgent(s),"run-mode":"production","X-COUPANG-ACCEPT-LANGUAGE":"ko-KR","X-COUPANG-ORIGIN-REGION":"KR","X-COUPANG-TARGET-MARKET":"KR","X-COUPANG-APP-NAME":"coupang","X-COUPANG-FONT-SCALE":"1.0","x-view-name":"SRP","x-cp-app-req-time":Date.now().toString(),"X-COUPANG-APP-REQUEST":"true",Accept:"application/json, text/plain, */*","X-Coupang-App-Version":"7.8.2","X-Coupang-Device-Id":s.uuid};const d=new AbortController;var i,l=setTimeout(()=>d.abort(),1e4),u=await fetch(o,{method:"GET",headers:c,signal:d.signal});if(clearTimeout(l),u.ok)return(i=await u.json())&&i.rData&&i.rData.entityList&&Array.isArray(i.rData.entityList)?{products:i.rData.entityList,nextPageKey:i.rData.nextPageKey,nextPageParams:i.rData.nextPageParams,pageUUID:i.rData.pageUUID,totalCount:i.rData.totalCount,hasNextPage:!!i.rData.nextPageKey}:{products:[],nextPageKey:null,nextPageParams:null,pageUUID:null,totalCount:0,hasNextPage:!1};throw new Error("HTTP error! Status: "+u.status)}catch(e){if(console.error(`API í˜¸ì¶œ ì‹¤íŒ¨ ${t}/3 - í‚¤ì›Œë“œ: `+r,e),!(t<3))throw console.error("API í˜¸ì¶œ ìµœì¢… ì‹¤íŒ¨ - í‚¤ì›Œë“œ: "+r),new Error("API í˜¸ì¶œ ì‹¤íŒ¨ (3íšŒ ì‹œë„): "+e.message);console.log("3ì´ˆ í›„ ì¬ì‹œë„..."),await sleep(3e3)}}async function fetchkeywordmAPI(e,t){lastProcessedKeyword&&lastProcessedKeyword!==e&&(r=keywordSessions.size,s=keywordPageCache.size,keywordSessions.clear(),keywordPageCache.clear(),console.log(`í‚¤ì›Œë“œê°€ "${lastProcessedKeyword}"ì—ì„œ "${e}"ë¡œ ë³€ê²½ë˜ì–´ ëª¨ë“  ìºì‹œë¥¼ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤. (ì„¸ì…˜: ${r}ê°œ, í˜ì´ì§€ìºì‹œ: ${s}ê°œ)`));for(var r=lastProcessedKeyword=e,a=(keywordPageCache.has(r)||keywordPageCache.set(r,{pages:[]}),keywordPageCache.get(r)),n=0;a.pages.length<t;){var o=a.pages.length,o=await searchCoupangProductsAPI(e,0===o?null:a.pages[o-1].nextPageKey,0===o?null:a.pages[o-1].nextPageParams),n=o.totalCount;if(!o||!o.products||0===o.products.length)break;if(a.pages.push(o),!o.hasNextPage)break}if(a.pages.length<t)return{lastpage:t-1,productlists:[],productqty:0,adlists:[],domCheck:!0};for(var s=a.pages[t-1],c=s.products,i=[],l=[],u=0,d=0;d<c.length;d++){var p=c[d];let t=null;if(p.entity&&p.entity.displayItem?t=p.entity.displayItem:p.displayItem&&(t=p.displayItem),t){var h,p=!("PRODUCT_BANNER"!==p.type&&!t.sponsoredText);p||u++;let e=0;t.salesPrice&&Array.isArray(t.salesPrice)&&(m=t.salesPrice[0])&&(e=parseInt(m.replace(/[^0-9]/g,""))||0),t.deliveryBadgeIcon?.caption?t.deliveryBadgeIcon.caption.includes("MERCHANT")?h="jet":t.deliveryBadgeIcon.caption.includes("ROCKET")&&(h="rocket"):h="wing";var m={rank:p?null:u,type:h,productName:t.title||"",price:e,rating:parseFloat(t.ratingAverage)||0,ratingcount:t?.ratingCount?parseInt(t?.ratingCount?.replaceAll(")","")?.replaceAll("(","")?.replaceAll(",","")):0,vendorItemId:t.vendorItemId||null,productId:t.id||null,itemId:t.itemId||null,ad:p,imgUrl:t.thumbnailSquare||""};(p?i:l).push(deepClone(m))}}return{lastpage:s.hasNextPage&&a.pages.length>=t?t+1:t,productlists:l,productqty:n,adlists:i,domCheck:!0}}async function fetchKeywordW(e,t=1){var e=await async function(e,t=1){var r,a=encodeURIComponent(e),e=encodeURIComponent(JSON.stringify(["",{children:["srp",{children:[`__PAGE__?{"component":"","q":"${e}","channel":"user"}`,{},`/np/search?component=&q=${a}&channel=user`,"refresh"]}]},null,null,!0])),t=(a=await fetch("https://www.coupang.com/np/search"+`?q=${a}&channel=user&page=${t}&_rsc=4togz`,{method:"GET",mode:"cors",credentials:"include",referrer:"https://www.coupang.com",referrerPolicy:"strict-origin-when-cross-origin",headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","next-router-state-tree":e,"next-url":"/srp",priority:"u=1, i",rsc:"1","sec-ch-ua":'"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"}})).headers.get("content-type")||"",e=await a.text();if(console.log(e),t.includes("text/x-component"))return a=e.split("\n").map(e=>{var t=e.indexOf(":");if(-1===t)return null;try{return JSON.parse(e.slice(t+1))}catch{return null}}).filter(Boolean).at(-1),console.log(a),0==(r=a?.[0]?.[0]?.[3]?.children?.[1]?.[3]?.children?.[0]?.[3]?.children?.[1]?.[3]?.children?.[2]?.[3]?.children?.[0]?.[3]?.products??[]).length?a?.[0]?.[0]?.[3]?.children?.[1]?.[3]?.children?.[0]?.[3]?.children?.[1]?.[3]?.children?.[3]?.[3]?.children?.[0]?.[3]?.products??[]:r;if(t.includes("text/html"))return a=(new DOMParser).parseFromString(e,"text/html"),Array.from(a.querySelectorAll("#productList > li.search-product")).map(e=>{var t=e.className.includes("search-product__ad-badge")||e.className.includes("search-product__cmg-badge"),r=e.querySelector(".badge.rocket img"),a=r?.src||"",r=!!r||"true"===e.dataset.isRocket,n=e.querySelector(".price-value")?.textContent.replace(/[,â‚©]/g,"")||"0";return{adBadgeArea:{sponsored:t},rocketArea:{show:r,badgeImage:{iconUrl:a}},imageAndTitleArea:{title:e.querySelector(".name,.title")?.textContent.trim()??"",defaultUrl:"https:"+(e.querySelector("img")?.getAttribute("src")??"")},priceArea:{price:n,i18nSalesPrice:{amount:n}},reviewArea:{ratingAverage:parseFloat(e.querySelector(".rating")?.textContent)||0,ratingCount:parseInt(e.querySelector(".rating-total-count")?.textContent.replace(/[(),]/g,""))||0},vendorItemId:e.dataset.vendorItemId??null,legacyProductId:e.dataset.productId??null,index:{itemId:e.dataset.itemId??null}}});try{return JSON.parse(e)}catch{return[]}}(e,t),r=(console.log(e),[]),a=[];let n=0;for(const i of e){var o=!!i.adBadgeArea?.sponsored;let e;e=i.rocketArea?.show?i.rocketArea.badgeImage?.iconUrl?.includes("logoRocketMerchant")?"jet":"rocket":"wing";var s=i.priceArea?.i18nSalesPrice?parseInt(i.priceArea.i18nSalesPrice.amount):parseInt((i.priceArea?.price||"0").replaceAll(",","")),c=i.imageAndTitleArea?.defaultUrl?i.imageAndTitleArea.defaultUrl.startsWith("//")?"https:"+i.imageAndTitleArea.defaultUrl:i.imageAndTitleArea.defaultUrl:"",s={rank:o?null:++n,type:e,productName:i.imageAndTitleArea?.title||"",price:s,rating:i.reviewArea?.ratingAverage??0,ratingcount:i.reviewArea?.ratingCount??0,vendorItemId:i.vendorItemId??null,productId:i.legacyProductId??null,itemId:i.index?.itemId??null,ad:o,imgUrl:c};(o?r:a).push(function e(t){if(null===t||"object"!=typeof t)return t;var r=Array.isArray(t)?[]:{};for(const a of Object.keys(t))r[a]=e(t[a]);return r}(s))}return{lastpage:0===e.length?t:t+1,productlists:a,productqty:a.length+r.length,adlists:r,domCheck:!0}}async function fetchkeywordm(e,t){function a(e){if(null===e||"object"!=typeof e)return e;var t,r=Array.isArray(e)?[]:{};for(t of Object.keys(e))r[t]=a(e[t]);return r}e="https://m.coupang.com/nm/search?q="+encodeURI(e)+"&page="+t;console.log("################ current url :"+e+"current page : "+t+"page");try{var r=await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=0, i","sec-ch-ua":'"Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:e,referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});console.log(r)}catch(e){return console.log(e),{lastpage:i,productlists:s,productqty:c,adlists:o,domCheck:!1,secretOn:!0}}var n,e=await r.text(),r=(new DOMParser).parseFromString(e,"text/html"),o=(console.log(r),[]),s=[],c=0;if(!r.querySelector("#goodsList"))return console.log("No goodsList"),{lastpage:i,productlists:s,productqty:c,adlists:o,domCheck:!1};if(!r.querySelector("#productList"))return console.log("No productList"),{lastpage:i=t,productlists:s,productqty:c,adlists:o,domCheck:!0};var i=t+1;if(r.querySelector("#pagination")&&(parseInt(r.querySelector("#pagination").getAttribute("count"))&&(c=parseInt(r.querySelector("#pagination").getAttribute("count"))),"page next dim"==r.querySelector("#pagination").children[0].children[r.querySelector("#pagination").children[0].children.length-1].className)&&(i=t),r.querySelector("#productList")&&0<r.querySelector("#productList").children.length)for(var l=Array.from(r.querySelector("#productList").children),u=(console.log("ìƒí’ˆìˆ˜ : ",l.length),0),d=0;d<l.length;d++)l[d].querySelector(".title")&&(l[d].className.includes("search-product__cmg-badge")||u++,n={rank:u,type:l[d].innerHTML.includes("vendor_inventory")?l[d].innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",productName:l[d].querySelector(".title ").innerText,price:l[d].querySelector(".discount-price ")?parseInt(l[d].querySelector(".discount-price ").children[0].innerText.replaceAll(",","")):0,rating:l[d].querySelector(".rating")?parseFloat(l[d].querySelector(".rating").innerText):0,ratingcount:l[d].querySelector(".rating-total-count")?parseInt(l[d].querySelector(".rating-total-count").innerText.replaceAll(",","").replaceAll("(","").replaceAll(")","")):0,vendorItemId:l[d].dataset.vendorItemId,productId:l[d].dataset.productId,itemId:l[d].dataset.itemId,ad:l[d].className.includes("search-product__cmg-badge"),imgUrl:l[d].querySelector(".thumbnail").children[0].src},(l[d].className.includes("search-product__cmg-badge")?o:s).push(a(n)));return{lastpage:i,productlists:s,productqty:c,adlists:o,domCheck:!0}}async function fetchkeyword(e,t,r){var r=r?"https://www.coupang.com/np/search?rocketAll=true&q="+encodeURI(e)+"&brand=&offerCondition=&filter=&availableDeliveryFilter=&filterType=rocket_wow%2Ccoupang_global&isPriceRange=false&priceRange=&minPrice=&maxPrice=&page=1&trcid=&traid=&filterSetByUser=true&channel=user&backgroundColor=&component=&rating=0&sorter=scoreDesc&listSize=36":"https://www.coupang.com/np/search?rocketAll=false&q="+encodeURI(e)+"&brand=&offerCondition=&filter=&availableDeliveryFilter=&filterType=&isPriceRange=false&priceRange=&minPrice=&maxPrice=&page="+t+"&trcid=&traid=&filterSetByUser=true&channel=user&backgroundColor=&component=&rating=0&sorter=scoreDesc&listSize=36",e=await(await fetch(r,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),t=(new DOMParser).parseFromString(e,"text/html"),a=(console.log(t),[]),n=[],o={},r=0,e=(console.log(t.querySelector(".search-pagination")),parseInt(t.querySelector(".search-wrapper").dataset.productCount));if(console.log(e),console.log(t),r=t.querySelector(".btn-last")?parseInt(t.querySelector(".btn-last").innerText):27,console.log(r),console.log(t.querySelector("#productList")),t.querySelector("#productList")&&0<t.querySelector("#productList").children.length){var s=t.querySelector("#productList").children;console.log(s);for(var c=0;c<s.length;c++){var i=s[c];i.className.includes("search-product")&&(i.className.includes("search-product__ad-badge")?(o={rank:c+1,productName:i.querySelector(".name").innerText,type:i.innerHTML.includes("vendor_inventory")?i.innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",price:i.querySelector(".price-value")?parseInt(i.querySelector(".price-value").innerText.replaceAll(",","")):0,rating:i.querySelector(".rating")?parseFloat(i.querySelector(".rating").innerText):0,ratingcount:i.querySelector(".rating-total-count")?parseInt(i.querySelector(".rating-total-count").innerText.replaceAll("(","").replaceAll(")","")):0,product:JSON.parse(i.children[0].dataset.srpLog),ad:!0},n.push(o)):o={rank:c+1,productName:i.querySelector(".name").innerText,type:i.innerHTML.includes("vendor_inventory")?i.innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",price:i.querySelector(".price-value")?parseInt(i.querySelector(".price-value").innerText.replaceAll(",","")):0,rating:i.querySelector(".rating")?parseFloat(i.querySelector(".rating").innerText):0,ratingcount:i.querySelector(".rating-total-count")?parseInt(i.querySelector(".rating-total-count").innerText.replaceAll("(","").replaceAll(")","")):0,product:JSON.parse(i.children[0].dataset.srpLog),ad:!1},a.push(o))}}return console.log(n),console.log(a),console.log(r),console.log(e),{lastpage:r,adlists:n,productlists:a,productqty:e}}async function fetchkeywordrocket(e){function t(e){return"string"!=typeof e||null===e?(console.error("ì…ë ¥ëœ í…ìŠ¤íŠ¸ê°€ ìœ íš¨í•œ ë¬¸ìì—´ì´ ì•„ë‹™ë‹ˆë‹¤."),null):(e=e.match(/"searchCount":\s*(\d+)/))&&e[1]?parseInt(e[1],10):null}var r,a="https://www.coupang.com/np/search?rocketAll=true&q="+encodeURI(e)+"&brand=&offerCondition=&filter=&availableDeliveryFilter=&filterType=rocket_wow%2Ccoupang_global&isPriceRange=false&priceRange=&minPrice=&maxPrice=&page=1&trcid=&traid=&filterSetByUser=true&channel=user&backgroundColor=&component=&rating=0&sorter=scoreDesc&listSize=36",n=await fetch(a,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}),o=await n.text(),s=new DOMParser,c=s.parseFromString(o,"text/html"),i=(console.log(c),0),e=(i=c.querySelector(".search-wrapper")?parseInt(c.querySelector(".search-wrapper").dataset.productCount):t(o.slice(o.search("searchCount")-1,o.search("searchCount")+20)),c.querySelector("#productList")?console.log(c.querySelector("#productList")):console.log(c.querySelector("#product-list")),console.log(i),r=3e3,await new Promise(e=>setTimeout(e,r)),a="https://www.coupang.com/np/search?component=&q="+encodeURI(e)+"&channel=user",o=await(n=await fetch(a,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),c=(s=new DOMParser).parseFromString(o,"text/html"),console.log(c),0);return e=c.querySelector(".search-wrapper")?parseInt(c.querySelector(".search-wrapper").dataset.productCount):t(o.slice(o.search("searchCount")-1,o.search("searchCount")+20)),c.querySelector("#productList")?console.log(c.querySelector("#productList")):console.log(c.querySelector("#product-list")),console.log(e),{productqty:i,totalproductqty:e}}function sleep(t){return new Promise(e=>setTimeout(e,t))}async function fetchpageinfo(e,t,r,a,n){var o=!1,s=0,c=(await sleep(500),await fetchkeywordmAPI(e,1)),i=30,l=(console.log(c),c.productqty),u=[],d=c.productlists;if(n)for(var p=0;p<i&&(await sleep(500),(c=await fetchkeywordmAPI(e,p+1))&&c.lastpage&&c.lastpage<30&&(i=c.lastpage),console.log(p+1+"page"),chrome.tabs.sendMessage(a.id,{response:"keywordanalysisstatus",status:p/i}),console.log(c),null!==c)&&(0<c.adlists.length?c.adlists.forEach(t=>{s++,u.find(e=>e.vendorItemId==t.vendorItemId)||u.push(t)}):o=!0,!o);p++);return{keyword:e,adplace:s,adqty:u.length,totalqty:l,rocketqty:0,adlists:u,productlists:[],productlists1p:d}}async function fetchrelatedkeywords(e,t){console.log(t),await sleep(500);var r=[],a=await chrome.scripting.executeScript({target:{tabId:t.id},function:confirmRelKeyword,args:[e]});console.log(a[0].result),a[0].result&&(r=r.concat(a[0].result)),await sleep(500);a=(await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchrelatedkeyword,args:[e]}))[0].result.relatedkeywords;return{relatedkeywords:r=r.concat(a)}}async function moveKeyword(e){var t;document.querySelector("#headerSearchKeyword").value=e,t=1e3,await new Promise(e=>setTimeout(e,t)),document.querySelector("#headerSearchBtn").click()}async function confirmRelKeyword(t){try{var r=(n=await(a=await fetch("https://www.coupang.com/n-api/web-adapter/search?keyword="+t+"&_=1747668595224",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=1, i","sec-ch-ua":'"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.coupang.com/np/search?q="+encodeURI(t),referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()).map(e=>e.keyword)}catch(e){var a=await fetch("https://www.coupang.com/np/search/autoComplete?callback=jQuery111104777436103598398_1683352433937&keyword="+encodeURI(t)+"&_=1683352433940",{headers:{accept:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,zh;q=0.5","sec-ch-ua":'"Chromium";v="112", "Google Chrome";v="112", "Not:A-Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.coupang.com/np/search?q="+encodeURI(t),referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}),n=(console.log(a),await a.text()),t=JSON.parse(n.slice(n.search("{")-1,-1)),r=(console.log(t),t.map(e=>e.keyword));console.log(r)}return r}async function collecttrackingproduct(e){var t={cnt:0,msg:""},e=await importtracking(e);if(console.log(e),e&&0!=e.length){Date.now();var r,a=[];for(r of e)r.productinfo&&!1===r.productinfo.invalid&&r.productinfo.title&&a.push(r),await sleep(10);console.log(a);var e=await collecttrackingfrom(a),n=await regtracking(e);"success"!==n.ìš”ì²­ê²°ê³¼?(console.log(n.ìš”ì²­ê²°ê³¼),console.log(n),t.msg="ë“±ë¡ì‹¤íŒ¨"):(t.msg=e.length+"ê°œ ìƒí’ˆ ìˆ˜ì§‘ì™„ë£Œ",console.log(t.msg),t.cnt=e.length)}else t.msg="ì¶”ê°€ëœ ê²½ìŸì‚¬ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.",console.log("ì¶”ê°€ëœ ê²½ìŸì‚¬ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.");return t}async function importtracking(e){e=await(await fetch(domain+"api/analysis/gettracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyid:e})}).catch(e=>{console.log(e)})).json();return console.log(e),e}async function collecttrackingfrom(e){var t,r=await chrome.tabs.query({}),a=(console.log(r),r.find(e=>1==e.active));return console.log(a),r.find(e=>e.url.includes("https://www.coupang.com/"))?(t=r.find(e=>e.url.includes("https://www.coupang.com/")),console.log(t),await collecttrackingfromvii(e,!0,t,a)):(r=await getCoupangUrl(),t=await chrome.tabs.create({url:r,active:!1}),await chrome.tabs.update(t.id,{autoDiscardable:!1}),r=await collecttrackingfromvii(e,!0,t,a),chrome.tabs.remove(t.id),r)}async function collecttrackingfromvii(e,t,r,a){var n,o=Date.now(),s=[],c=0;console.log(e);for(n of e){console.log(n);var i=await fetchtrackinginfo(n,r);if(i){var l={},u="";if(i.options)for(var d of i.options.optionRows)u+=""==u?d.attributes.find(e=>e.selected).name:", "+d.attributes.find(e=>e.selected).name;else u="ë‹¨ì¼ìƒí’ˆ";p=i.quantityBase?i.quantityBase?.[0]?.moduleData?.[0]?.detailPriceBundle?.finalPrice?.price?i.quantityBase[0].moduleData[0].detailPriceBundle.finalPrice.price:i.quantityBase[0].price.salePrice?parseInt(i.quantityBase[0].price.salePrice.replaceAll(",","")):parseInt(i.quantityBase[0].price.originPrice.replaceAll(",","")):0;var p,h=!1;0<(l={productinfo:i,productId:i.productId,itemId:i.itemId,vendorItemId:i.vendorItemId,vendorName:n.vendorName||(i.vendor?i.vendor.name:""),vendorId:n.vendorId||(i.vendor?i.vendor.id:""),optionName:u,type:n.type||(i.vendor?"wing":"rocket"),list:[{d:o,s:i.buyableQuantity||0,p:p,rp:i.ratingAveragePercentage/20,rq:parseInt(i.ratingCount.replaceAll(",","")),b:i.quantityBase?i.quantityBase[0].delivery.badgeUrl:""}]}).list[0].s&&(await sleep(3e3),chrome.tabs.sendMessage(a.id,{msg:"trackingratio",ratio:c/e.length}),"nothing"==(p=await fetchstock(l.productId,l.vendorItemId,l.itemId,r)).vendorId&&0==p.price?h=!0:(""==l.vendorName&&("A00010028"==p.vendorId?(l.vendorName="ì¿ íŒ¡",l.type="rocket"):(""==l.vendorName&&(i=await getvendorinfo(p.vendorId,r))&&i.vendorName&&(l.vendorName=i.vendorName),l.type="rocketgrowth")),l.vendorId=p.vendorId,l.list[0].s=parseInt(p.stock))),h||s.push(deepClone(l))}else console.log("error807"),console.log(url),console.log(r);c++}return s}async function fetchtrackinginfo(e,t){console.log(t);t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e){function t(t){var e=t.indexOf('"stickBanners":');if(-1===e)return t;let r=0,a=e+15;for(let e=a;e<t.length;e++)if("["===t[e]&&r++,"]"===t[e]&&r--,0===r){a=e+1;break}return t.slice(0,e)+'"stickBanners":[]'+t.slice(a)}var r="https://www.coupang.com/vp/products/"+e.productId+"?itemId="+e.itemId+"&vendorItemId="+e.vendorItemId+"&isAddedCart=";console.log(r);var r=await(await fetch(r,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),a=(await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(r)).querySelectorAll("script"),n="",o=null;if(r.includes("exports.sdp")){a.forEach(e=>{e.innerHTML.includes("exports.sdp")&&(n=e.innerHTML)}),console.log(n);var s=n.indexOf("exports.sdpIssueTypes"),c=(-1==s&&(s=n.indexOf("exports.disableCSR")),n.lastIndexOf(";",s)),i=(n=n.substring(0,c)).slice(n.search("exports.sdp")+14);console.log(i);try{o=JSON.parse(i)}catch(e){console.log(e),i=t(i),o=JSON.parse(i)}console.log(o)}else if(r.includes("exports.product")){a.forEach(e=>{e.innerHTML.includes("exports.product")&&(n=e.innerHTML)}),console.log(n),-1==(s=n.indexOf("exports.sdpIssueTypes"))&&(s=n.indexOf("exports.disableCSR")),c=n.lastIndexOf(";",s),n=n.substring(0,c),i=n.slice(n.search("exports.product")+18),console.log(i);try{o=JSON.parse(i)}catch(e){console.log(e),i=t(i),o=JSON.parse(i)}console.log(o)}else r.includes("atfData")&&(i=function(t){if(console.log("--- í•¨ìˆ˜ ì‹œì‘ ---"),"string"!=typeof t||null===t)return console.error("ì…ë ¥ í…ìŠ¤íŠ¸ê°€ ìœ íš¨í•œ ë¬¸ìì—´ì´ ì•„ë‹™ë‹ˆë‹¤."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`ì‹œì‘ ë§ˆì»¤ "${e}" (ë˜ëŠ” ë‹¤ë¥¸ ì£¼ìš” ë§ˆì»¤)ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),null;console.log(`ë§ˆì»¤ "${e}" ì°¾ìŒ. ì¸ë±ìŠ¤: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("ê°ì²´ ì‹œì‘ '{' ì°¾ìŒ. ì¸ë±ìŠ¤:",n);break}if(e>a+5&&" "!==t[e])return console.error("ë§ˆì»¤ ë’¤ì—ì„œ '{'ë¥¼ ì ì ˆí•œ ìœ„ì¹˜ì—ì„œ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."),null}if(-1===n)return console.error("ê°ì²´ ì‹œì‘ '{'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("ê°ì²´ ë '}' ì°¾ìŒ. ì¸ë±ìŠ¤:",s);break}if(-1===s)return console.error("ê°ì²´ì˜ ì§ì´ ë§ëŠ” '}'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),null;let c=t.substring(a,s+1);console.log("ì¶”ì¶œëœ ë¬¸ìì—´ (ì›ë³¸):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("ìµœì¢… ì²˜ë¦¬ í›„ ë¬¸ìì—´ (íŒŒì‹± ì‹œë„):",c.substring(0,200)+"..."),0===c.length)return console.error("ìµœì¢… ì²˜ë¦¬ í›„ ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤."),null;try{return JSON.parse(c),console.log("JSON íŒŒì‹± ì„±ê³µ!"),c}catch(e){return console.error("JSON íŒŒì‹± ì‹¤íŒ¨:",e.message),console.error("íŒŒì‹± ì‹œë„í•œ ë¬¸ìì—´ (ì „ì²´):\n",c),null}}(r),o=JSON.parse(i),console.log(o));return o},args:[e]});return console.log(t[0].result),t[0].result}async function getvendorinfo(e,t){t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e){e=await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(await(await fetch("https://store.coupang.com/vp/vendors/"+e+"/products",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text());return{vendorName:e.querySelector("#store-wrapper").dataset.vendorName,vendorId:e.querySelector("#store-wrapper").dataset.vendorId,storeTitle:e.querySelector("#store-wrapper").dataset.storeTitle}},args:[e]});return console.log(t[0].result),t[0].result}async function regtracking(e){return await(await fetch(domain+"api/analysis/updatetracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result:e})}).catch(e=>{console.log("line759"),console.log(e),console.log("ìˆ˜ì§‘ì‹¤íŒ¨(760)")})).json()}async function getProductInfos(e,t){var r;for(r of e){var a=await getProductInfo("https://www.coupang.com/vp/products/"+r.productId+"?vendorItemId="+r.vendorItemId,t);console.log("getProductInfos : "),console.log(a),r.product=deepClone(a)}return e}async function getProductInfo(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(r){try{var a=await fetch(r,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});if(!a.ok)throw new Error("HTTP error! status: "+a.status);var n=await a.text();let e=function(e){var t=new DOMParser,t=t.parseFromString(e,"text/html"),e=t.querySelectorAll("script");let r=null;return e.forEach(e=>{if(e.textContent.includes("exports.sdp =")){e=e.textContent.match(/exports\.sdp = ({.*?});/s);if(e&&e[1])try{r=JSON.parse(e[1])}catch(e){console.error("Error parsing JSON:",e),r=null}}}),r}(n),t;return(e=e||function(e){var t=new DOMParser,t=t.parseFromString(e,"text/html"),e=t.querySelectorAll("script");let r=null;return e.forEach(e=>{if(e.textContent.includes("exports.product =")){e=e.textContent.match(/exports\.product = ({.*?});/s);if(e&&e[1])try{r=JSON.parse(e[1])}catch(e){console.error("Error parsing JSON:",e),r=null}}}),r}(n))||n.includes("atfData")&&(t=function(t){if(console.log("--- í•¨ìˆ˜ ì‹œì‘ ---"),"string"!=typeof t||null===t)return console.error("ì…ë ¥ í…ìŠ¤íŠ¸ê°€ ìœ íš¨í•œ ë¬¸ìì—´ì´ ì•„ë‹™ë‹ˆë‹¤."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`ì‹œì‘ ë§ˆì»¤ "${e}" (ë˜ëŠ” ë‹¤ë¥¸ ì£¼ìš” ë§ˆì»¤)ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),null;console.log(`ë§ˆì»¤ "${e}" ì°¾ìŒ. ì¸ë±ìŠ¤: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("ê°ì²´ ì‹œì‘ '{' ì°¾ìŒ. ì¸ë±ìŠ¤:",n);break}if(e>a+5&&" "!==t[e])return console.error("ë§ˆì»¤ ë’¤ì—ì„œ '{'ë¥¼ ì ì ˆí•œ ìœ„ì¹˜ì—ì„œ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."),null}if(-1===n)return console.error("ê°ì²´ ì‹œì‘ '{'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("ê°ì²´ ë '}' ì°¾ìŒ. ì¸ë±ìŠ¤:",s);break}if(-1===s)return console.error("ê°ì²´ì˜ ì§ì´ ë§ëŠ” '}'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),null;let c=t.substring(a,s+1);console.log("ì¶”ì¶œëœ ë¬¸ìì—´ (ì›ë³¸):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("ìµœì¢… ì²˜ë¦¬ í›„ ë¬¸ìì—´ (íŒŒì‹± ì‹œë„):",c.substring(0,200)+"..."),0===c.length)return console.error("ìµœì¢… ì²˜ë¦¬ í›„ ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤."),null;try{return JSON.parse(c),console.log("JSON íŒŒì‹± ì„±ê³µ!"),c}catch(e){return console.error("JSON íŒŒì‹± ì‹¤íŒ¨:",e.message),console.error("íŒŒì‹± ì‹œë„í•œ ë¬¸ìì—´ (ì „ì²´):\n",c),null}}(n),e=JSON.parse(t)),e}catch(e){return console.error("Error fetching page info:",e),null}},args:[e]}))[0].result}async function showPopupDiv(e){chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=document.createElement("div"),t=(e.className="popup_loading_spinner",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="rgba(255, 255, 255, 0.9",e.style.padding="30px",e.style.textAlign="center",e.style.fontWeight="bold",e.style.zIndex=9999,e.style.display="block",e.textContent="íŒë§¤ëŸ‰ ë¶„ì„ì¤‘",document.createElement("img"));t.src="https://wpamelia.com/wp-content/uploads/2018/11/ezgif-2-6d0b072c3d3f.gif",t.style.display="block",t.style.margin="0 auto",t.style.maxHeight="50px",e.appendChild(t),document.body.appendChild(e)}})}async function hidePopupDiv(e){chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){document.querySelector(".popup_loading_spinner").style.display="none"}})}async function getCurrentProducts(e){var t=[],e=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t={},r=document;if(r.querySelector("#productList")&&0<r.querySelector("#productList").children.length){var a=r.querySelector("#productList").children;console.log(a);for(var n=0;n<a.length;n++)(o=a[n]).className.includes("search-product")&&(c=o.children[0].href,i=JSON.parse(o.children[0].dataset.srpLog),s=o.querySelector(".search-product-wrap-img").src,t={rank:n+1,productName:o.querySelector(".name").innerText,type:o.innerHTML.includes("vendor_inventory")?o.innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",price:o.querySelector(".price-value")?parseInt(o.querySelector(".price-value").innerText.replaceAll(",","")):0,rating:o.querySelector(".rating")?parseFloat(o.querySelector(".rating").innerText):0,ratingcount:o.querySelector(".rating-total-count")?parseInt(o.querySelector(".rating-total-count").innerText.replaceAll("(","").replaceAll(")","")):0,product:i,ad:!!o.className.includes("search-product__ad-badge"),productId:i.productId,imgUrl:s,url:c},e.push(t))}if(r.querySelector("#product-list")&&0<r.querySelector("#product-list").children.length){a=r.querySelector("#product-list").children;console.log(a);for(var o,s,c,i,n=0;n<a.length;n++)(o=a[n]).className.includes("ProductUnit_productUnit__Qd6sv")&&(o.querySelector("IMG")&&(s=o.querySelector("IMG").src),i=function(t){try{var r=new URL(t),a=r.pathname.split("/");let e=null;3<a.length&&"vp"===a[1]&&"products"===a[2]&&(e=a[3]);var n=r.searchParams.get("itemId"),o=r.searchParams.get("vendorItemId");return e&&n&&o?{productId:e,itemId:n,vendorItemId:o}:(console.error("URLì—ì„œ ëª¨ë“  IDë¥¼ ì¶”ì¶œí•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."),e||console.error(" - productIdë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê²½ë¡œ í˜•ì‹ì„ í™•ì¸í•˜ì„¸ìš”:",r.pathname),n||console.error(" - itemId ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),o||console.error(" - vendorItemId ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),null)}catch(e){return console.error("ìœ íš¨í•˜ì§€ ì•Šì€ URLì…ë‹ˆë‹¤:",e.message),null}}(c=o.children[0].href),t={rank:n+1,productName:o.querySelector(".ProductUnit_productName__gre7e").innerText,type:o.innerHTML.includes("vendor_inventory")?o.innerHTML.includes("ë„ì°© ë³´ì¥")?"jet":"wing":"rocket",price:o.querySelector(".Price_priceValue__A4KOr")?parseInt(o.querySelector(".Price_priceValue__A4KOr").innerText.replaceAll(",","")):0,rating:o.querySelector(".ProductRating_star__RGSlV")?parseFloat(o.querySelector(".ProductRating_star__RGSlV").innerText):0,ratingcount:o.querySelector(".ProductRating_ratingCount__R0Vhz")?parseInt(o.querySelector(".ProductRating_ratingCount__R0Vhz").innerText.replaceAll("(","").replaceAll(")","")):0,product:i,ad:!!o.querySelector(".AdMark_adMark__KPMsC"),productId:i.productId,imgUrl:s,url:c},e.push(t))}return console.log(e),e}}),t=(console.log(e),t.concat(e[0].result));return console.log(t),t}async function getBestProducts(e){var t=[],e=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t=document;if(t.querySelector(".best-seller-carousel-item-list")&&0<t.querySelector(".best-seller-carousel-item-list").children.length){var r=t.querySelector(".best-seller-carousel-item-list").children;console.log(r);for(var a=0;a<r.length;a++){var n=r[a].querySelector("a").href;e.push({rank:a+1,url:n})}}return console.log(e),e}}),t=(console.log(e),t.concat(e[0].result));return console.log(t),t}async function getStoreProducts(e){var t,r=[],r=(e.url.includes("shop.coupang.com")&&(t=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t=document;if(t.querySelector(".products-list")&&0<t.querySelector(".products-list").children.length){var r=t.querySelector(".products-list").children;console.log(r);for(var a=0;a<r.length;a++){var n=r[a];n.className.includes("product-wrap")&&(n=n.querySelector("a").href,e.push({rank:a+1,url:n}))}}return console.log(e),e}})),e.url.includes("store.coupang.com")&&(t=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t=document;if(t.querySelector("#product-list")&&0<t.querySelector("#product-list").children.length){var r=t.querySelector("#product-list").children;console.log(r);for(var a=0;a<r.length;a++){var n=r[a].querySelector("a").href;e.push({rank:a+1,url:n})}}return console.log(e),e}})),console.log(t),r.concat(t[0].result));return console.log(r),r}async function getreviews(e,t,r,a){e=e.productId;a=(await chrome.scripting.executeScript({target:{tabId:a.id},function:async function(e,t){var r=[e+"&viRoleCode=2",e+"&viRoleCode=3"];let a;for(var n=0;n<r.length;n++)try{console.log("Trying URL:",r[n]);var o=await fetch(r[n],{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="116", "Not)A;Brand";v="24", "Google Chrome";v="116"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://www.coupang.com/vp/products/"+t+"?isAddedCart=",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});break}catch(e){a=e,console.log(`Attempt ${n+1} failed:`,e),n<r.length-1&&await async function(t){return new Promise(e=>setTimeout(e,t))}(1e3)}if(!o)return console.log("All attempts failed:",a),[[],0,a,"error",0];if(e=await o.text(),console.log("content:"),console.log(e),e.includes("ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒ")||e.includes("Access Denied"))return[[],0,e,"ì•Œìˆ˜ì—†ëŠ”ì˜¤ë¥˜ ë˜ëŠ” Access Denied",0];var s=(new DOMParser).parseFromString(e,"text/html");if(console.log(s),!s.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")||!s.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")[0].dataset)return[[],0,e,"ë¦¬ë·°ê²°ê³¼ì—†ìŒ : https://www.coupang.com/vp/products/"+t,0];if(console.log(s.body.innerHTML),0==(e=s.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")[0].dataset.totalCount))return[[],0,"ok","ë¦¬ë·°ê²°ê³¼ì—†ìŒ : https://www.coupang.com/vp/products/"+t,0];for(var c=s.getElementsByClassName("js_reviewArticleHiddenValue")[4].dataset.count,i=(console.log(e,c),{}),l=[],n=0;n<s.getElementsByClassName("js_reviewArticleReviewList").length;n++){var u,d,p,h,m,g,f,y,v,w,b=s.getElementsByClassName("js_reviewArticleReviewList")[n];b.getElementsByClassName("js_reviewArticleRatingValue")[0].dataset&&(u=b.getElementsByClassName("sdp-review__article__list__attachment__list").length,d=b.getElementsByClassName("sdp-review__article__list__info__user")[0].children[0].dataset.memberId,p=b.getElementsByClassName("sdp-review__article__list__info__user")[0].children[0].textContent,h=b.getElementsByClassName("js_reviewArticleRatingValue")[0].dataset.rating,m=b.getElementsByClassName("sdp-review__article__list__info__product-info__reg-date")[0].textContent,g=b.getElementsByClassName("sdp-review__article__list__info__product-info__seller_name")[0].textContent,f=b.getElementsByClassName("sdp-review__article__list__info__product-info__name")[0].textContent,y=b.getElementsByClassName("sdp-review__article__list__headline")[0]?b.getElementsByClassName("sdp-review__article__list__headline")[0].textContent:"",v=b.getElementsByClassName("js_reviewArticleContent")[0]?b.getElementsByClassName("js_reviewArticleContent")[0].textContent:"",w=!!b.getElementsByClassName("js_reviewArticleAdventureBtn")[0],b=b.getElementsByClassName("js_reviewArticleHelpfulContainer")[0]?b.getElementsByClassName("js_reviewArticleHelpfulContainer")[0].dataset.count:"",i={"ë¦¬ë·°ì–´ë²ˆí˜¸":d,"ì´ë¦„":p,"í‰ì ":h,"ì‘ì„±ì¼":m,"íŒë§¤ì":g.replaceAll("\n","").trim(),"ìƒí’ˆì˜µì…˜ëª…":f,"ë¦¬ë·°ì œëª©":y.replaceAll("\n","").trim(),"ë¦¬ë·°ë‚´ìš©":v.replaceAll("\n","").trim(),"ë„ì›€ëœì¸ì›ìˆ˜":b,"ì‚¬ì§„ìˆ˜":u,"ì²´í—˜ë‹¨":w},console.log(i),l.push(i))}return console.log(l),console.log(e),[l,e,"ok","OK",c]},args:["https://www.coupang.com/vp/product/reviews?productId="+e+"&page="+(t+1)+"&size="+r+"&sortBy=DATE_DESC&ratings=&q=&ratingSummary=true",e]}))[0].result;return console.log(a),"ok"!==a[2]&&(console.log("ë¦¬ë·°ë¶„ì„ì—ëŸ¬ : "),console.log("================================================"),console.log("================================================"),console.log(a[2]),console.log(a[3]),console.log("================================================"),console.log("================================================")),a}async function doSecretOn(){console.log("doSecretOn");var e=await secretOn(),[t]=(console.log(e),await chrome.tabs.query({active:!0,currentWindow:!0}));console.log(t),showAlertModal(e,t),await sleep(1e3),hideAlertModal(t)}async function showAlertModal(e,t){chrome.scripting.executeScript({target:{tabId:t.id},function:async function(e){var t=document.createElement("div");t.className="popup_alert",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(255, 255, 0, 0.8",t.style.padding="30px",t.style.textAlign="center",t.style.fontWeight="bold",t.style.zIndex=9999,t.style.display="block",t.style.borderRadius=t.textContent=e,document.body.appendChild(t)},args:[e]})}async function hideAlertModal(e){chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){document.querySelector(".popup_alert").style.display="none"}})}async function secretOnNaver(){var e,t=await chrome.cookies.getAll({});console.log(t);for(e of t)e.domain.includes("smartstore.naver.com")&&(await chrome.cookies.remove({name:e.name,url:"https://smartstore.naver.com"}),await chrome.cookies.remove({name:e.name,url:"https://brand.naver.com"}));return console.log("secret On"),"ì‹œí¬ë¦¿ ëª¨ë“œ On"}async function secretOn(){var e;for(e of await chrome.cookies.getAll({}))e.domain.includes("coupang.com")&&(await chrome.cookies.remove({name:e.name,url:"https://www.coupang.com"}),await chrome.cookies.remove({name:e.name,url:"https://shop.coupang.com"}),await chrome.cookies.remove({name:e.name,url:"https://store.coupang.com"}),await chrome.cookies.remove({name:e.name,url:"https://m.coupang.com"})),e.domain.includes("smartstore.naver.com")&&(await chrome.cookies.remove({name:e.name,url:"https://smartstore.naver.com"}),await chrome.cookies.remove({name:e.name,url:"https://brand.naver.com"}));return console.log("secret On"),"ì‹œí¬ë¦¿ ëª¨ë“œ On"}async function fetchstock(e,t,r,a){for(var n,o=await chrome.scripting.executeScript({target:{tabId:a.id},func:i,args:[e,t,r]}),s=(console.log(o),o[0].result),c=0;!s.resultContents[0];)await sleep(1e4),c++,s=(await chrome.scripting.executeScript({target:{tabId:a.id},func:i,args:[e,t,r]}))[0].result,5==c&&(s={resultContents:[{vendorItemId:"nothing",cartId:"nothing"}]});return"nothing"==s.resultContents[0].vendorItemId?{stock:0,vendorId:"nothing",price:0}:(t=s.resultContents[0].vendorItemId,o=s.resultContents[0].cartId,n=(await chrome.scripting.executeScript({target:{tabId:a.id},func:async function(e){var t=await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(await(await fetch("https://cart.coupang.com/cartView.pang",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text()),r=e.toString();console.log(t.body),console.log(t.querySelectorAll(".option-item"));for(var a=0;a<t.querySelectorAll(".option-item").length;a++)if(t.querySelectorAll(".option-item")[a].id===r){var n=t.querySelectorAll(".option-item")[a];break}console.log(n);e=parseInt(n.parentElement.parentElement.querySelector(".unit-total-sale-price").innerText.replaceAll(",","").replaceAll("ì›",""))/n.dataset.quantity;return{stock:n.dataset.quantity,vendorId:n.dataset.vendorId,price:e}},args:[t]}))[0].result,await chrome.scripting.executeScript({target:{tabId:a.id},func:async function(e){e=await fetch("https://cart.coupang.com/api/anonymousCartItem/deleteItems?cartItemIds[]="+e+"&itemStatus=CHECKED",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://cart.coupang.com/cartView.pang",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"POST",mode:"cors",credentials:"include"});console.log(e)},args:[o]}),console.log(n),n);async function i(e,t,r){t=await(await fetch("https://www.coupang.com/vp/cart/"+e+"/items",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:"items%5B%5D="+t+"%3A+999999&clickProductId="+e+"&landProductId="+e+"&clickItemId=&cartItemId="+r+"&sdpVisitKey=&q=&searchId=",method:"POST",mode:"cors",credentials:"include"})).text();return await JSON.parse(t)}}async function categoryAnalysis(e){localsuppliercode=e.suppliercode;var t=await chrome.tabs.query({}),r=(await secretOn(),await getCoupangUrl()),r=await chrome.tabs.create({url:r,active:!1}),a=(await chrome.tabs.update(r.id,{autoDiscardable:!1}),t.find(e=>e.active&&"couplus"==e.title)),t=t.find(e=>e.url.includes("wing.coupang.com"));console.log(a),console.log(t),!t||!1===await confirmSupplierCode(localsuppliercode,t)?alertPage(a,"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”."):(t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:getCategoryInfoV2,args:[e.info.keyword]}))[0].result,console.log(t),chrome.tabs.sendMessage(a.id,{msg:"getCategoryAnalysis",res:"success",categories:t}),chrome.tabs.remove(r.id,function(e){console.log(e)}))}async function getCategoryStats(e){var t=await chrome.tabs.query({}),r=t.find(e=>e.active&&"couplus"==e.title),t=t.find(e=>e.url.includes("wing.coupang.com"));t?(t=(await chrome.scripting.executeScript({target:{tabId:t.id},function:getSingleCategoryStats,args:[e.categoryCode,e.categoryName]}))[0].result,console.log(t),chrome.tabs.sendMessage(r.id,{msg:"getCategoryStats",res:"success",categoryStats:t})):alertPage(r,"ìƒˆíƒ­ì— ì¿ íŒ¡ìœ™ì„ ë¡œê·¸ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.")}async function getCategoryInfoV2(e){console.log(e);let t=0;for(;t<3;)try{var r=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1],a=await(await fetch("https://wing.coupang.com/tenants/seller-web/pre-matching/search",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-xsrf-token":r},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({keyword:e,excludedProductIds:[],searchPage:0,searchOrder:"DEFAULT",sortType:"DEFAULT"}),method:"POST",mode:"cors",credentials:"include"})).json();if(console.log(a),a.result&&0<a.result.length){var n,o=[];for(let t of a.result)t.displayCategoryInfo[0]&&((n=o.find(e=>e.category===t.displayCategoryInfo[0].categoryHierarchy))?n.cnt++:o.push({cnt:1,categoryCode:t.displayCategoryInfo[0].leafCategoryCode,category:t.displayCategoryInfo[0].categoryHierarchy,categoryId:t.categoryId}));return console.log(o),o}return[]}catch(e){if(console.log(`Retry ${t+1}/3: Error occurred, retrying after 1 second...`,e),!(++t<3))return[];await(t=>new Promise(e=>setTimeout(e,t)))(1e4)}}async function getSingleCategoryStats(a,e){if(console.log("DEBUG: Starting getSingleCategoryStats"),console.log("DEBUG: Input categoryCode:",a,`(type: ${typeof a})`),console.log("DEBUG: Input categoryName:",e,`(type: ${typeof e})`),!a)return console.error("DEBUG: Invalid categoryCode:",a),null;if(!e)return console.error("DEBUG: Invalid categoryName:",e),null;var t=e.split(">").pop().trim();function u(e){return console.log("DEBUG (getSharedBaseHeaders): Creating headers with token:",e),{accept:"application/json, text/plain, */*","accept-language":"ko,en-US;q=0.9,en;q=0.8",priority:"u=1, i","sec-ch-ua":'"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-xsrf-token":e}}console.log("DEBUG: Processed categoryName (last part):",t),console.log(`Function getSingleCategoryStats started for ${e} (${a})`);var r=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];if(!r)return console.error("CRITICAL (single): XSRF-TOKEN not found."),null;console.log("INFO (single): Using XSRF-TOKEN:",r);var n="https://wing.coupang.com/",o=(console.log(`INFO (single): Fetching price summary with actualCategoryName: ${t}...`),await async function(t,e,r,a){console.log(`DEBUG: fetchSharedPriceSummary called with categoryName: ${e}, categoryCode: `+t),console.log(`Attempting to fetch price summary for: ${e} (Code: ${t})`);try{var n,o,s=u(r),c=(console.log(`DEBUG: fetchSharedPriceSummary (${t}) - Request Headers:`,JSON.stringify(s)),await fetch(`https://wing.coupang.com/tenants/rfm-ss/api/trends/summary?input=${t}&inputType=DISPLAY_CATEGORY_CODE`,{headers:s,referrer:a,referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}));return(console.log(`DEBUG: fetchSharedPriceSummary (${t}) - Response Status: `+c.status),c.ok)?(o=await c.json(),console.log(`SUCCESS: Fetched price summary for ${t}. Data:`,JSON.stringify(o)),o):(n=await c.text(),console.warn(`WARNING: Price summary not found or error for ${t} (${e}). Status: ${c.status}, Body: `+n.slice(0,500)),null)}catch(e){return console.error(`EXCEPTION: Error in fetchSharedPriceSummary for ${t}:`,e),null}}(a,t,r,n)),t=(console.log(`INFO (single): Fetching product stats with actualCategoryName: ${t}...`),await async function(r,e,t,a){console.log(`DEBUG: fetchSharedProductStats called with categoryName: ${e}, categoryCode: `+r),console.log(`Attempting to fetch product stats for: ${e} (Code: ${r})`);try{var n,o={...u(t),"content-type":"application/json","x-cp-pt-locale":"ko"},s=(console.log(`DEBUG: fetchSharedProductStats (${r}) - Request Headers:`,JSON.stringify(o)),e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')),c=`{"searchCondition":{"start":0,"limit":100,"query":"${s}","sort":["BEST_SELLING"],"filter":{"INTERNAL_CATEGORY":{"generalFilterType":"Filters","operator":"AND","generalFilters":[{"generalFilterType":"DefaultFilter","field":"INTERNAL_CATEGORY","values":["${String(r)}"],"operator":"AND","exclude":false}]}},"context":{"bundleId":62,"ip":"127.0.0.1","viewType":"WEB","sourcePage":"Srp","pcid":"unknown","channel":"unknown","userNo":0,"uuid":"","osType":"PC","appVersion":"1.0.0","abTests":null,"engineParams":{},"filteredAbTests":null,"swapSet":null}}}`,i=(console.log(`DEBUG: fetchSharedProductStats (${r}) - Request Body:`,c),await fetch("https://wing.coupang.com/tenants/rfm-ss/api/trends/search",{headers:o,referrer:a,referrerPolicy:"strict-origin-when-cross-origin",body:c,method:"POST",mode:"cors",credentials:"include"}));if(console.log(`DEBUG: fetchSharedProductStats (${r}) - Response Status: `+i.status),i.ok)return"0"===i.headers.get("content-length")?(console.warn(`WARNING: Product stats response body is empty for ${r} (${e}). Content-Length: 0.`),null):(n=await i.json(),console.log(`SUCCESS: Fetched product stats for ${r}. Full Response:`,JSON.stringify(n)),console.log(`DEBUG: Has searchItems: ${!(!n||!n.searchItems)}, searchItems length: `+(n?.searchItems?.length||0)),n);{let t=`WARNING: Product stats API request failed for ${r} (${e}). Status: `+i.status;try{var l=await i.text();t+=`, Body: ${l.slice(0,500)}...`}catch(e){t+=". Could not read error response body."}return console.warn(t),null}}catch(e){return console.error(`EXCEPTION: Error in fetchSharedProductStats for ${r}:`,e),null}}(a,t,r,n)),r=(console.log(`INFO (single): Fetching related keywords for categoryCode: ${a}...`),await async function(t,e,r){console.log("DEBUG: fetchSharedRelatedKeywords called with categoryCode: "+t),console.log("Attempting to fetch related keywords for categoryCode: "+t);try{var a,n,o=u(e),s=(console.log(`DEBUG: fetchSharedRelatedKeywords (${t}) - Request Headers:`,JSON.stringify(o)),await fetch("https://wing.coupang.com/tenants/rfm-ss/api/trends/category/top-keywords?categoryCode="+t,{headers:o,referrer:r,referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}));return(console.log(`DEBUG: fetchSharedRelatedKeywords (${t}) - Response Status: `+s.status),s.ok)?(n=await s.json(),console.log(`SUCCESS: Fetched related keywords for ${t}. Data:`,JSON.stringify(n)),Array.isArray(n)?n:[]):(a=await s.text(),console.warn(`WARNING: Related keywords not found or error for ${t}. Status: ${s.status}, Body: `+a.slice(0,500)),[])}catch(e){return console.error(`EXCEPTION: Error in fetchSharedRelatedKeywords for ${t}:`,e),[]}}(a,r,n)),n=o?.avgSalesPrice?.amount||0;console.log(`DEBUG (single) (${a}): Price Summary Avg: ${n}, RelatedKeywords Count: `+r.length),console.log(`DEBUG (single) (${a}): Full priceSummary:`,JSON.stringify(o)),console.log(`DEBUG (single) (${a}): Full productStatsData keys:`,Object.keys(t||{})),console.log(`DEBUG (single) (${a}): Related Keywords:`,JSON.stringify(r));let s=0,c=0,i=0,l=0,d=0,p=0;t&&t.searchItems&&Array.isArray(t.searchItems)?(p=t.searchItems.length,console.log(`DEBUG (single) (${a}): Found ${p} items in searchItems.`),t.searchItems.forEach((t,r)=>{if(console.log(`DEBUG (single) (${a}): Processing item ${r}:`,JSON.stringify(t)),null!==t.upperPvLast28d&&isFinite(t.upperPvLast28d)){let e=0;null!==t.lowerPvLast28d&&isFinite(t.lowerPvLast28d)&&0<=t.lowerPvLast28d?e=t.lowerPvLast28d<=t.upperPvLast28d?(t.lowerPvLast28d+t.upperPvLast28d)/2:t.upperPvLast28d:(null===t.lowerPvLast28d||t.lowerPvLast28d<0)&&(e=t.upperPvLast28d),!isNaN(e)&&isFinite(e)&&0<=e&&(s+=e,l++,console.log(`DEBUG (single) (${a}): Item ${r} viewValue: `+e))}null!==t.ratingCount&&isFinite(t.ratingCount)&&0<t.ratingCount&&null!==t.rating&&isFinite(t.rating)&&(c+=t.ratingCount,i+=t.rating*t.ratingCount,d+=t.ratingCount,console.log(`DEBUG (single) (${a}): Item ${r} ratingCount: ${t.ratingCount}, rating: `+t.rating))})):(console.log(`DEBUG (single) (${a}): No searchItems found or productStatsData is null/invalid.`),console.log(`DEBUG (single) (${a}): productStatsData type:`,typeof t),console.log(`DEBUG (single) (${a}): productStatsData:`,t));var t=0<l?s/l:0,h=0<p?c/p:0,m=0<d?i/d:0,g=n*t*.03;return console.log(`DEBUG (single) (${a}): Final calculations - AvgViews: ${t.toFixed(2)}, EstSales: `+g.toFixed(2)),console.log(`DEBUG (single) (${a}): totalProductViews: ${s}, validProductsForViews: `+l),{categoryCode:a,categoryName:e,minPrice:o?.minSalesPrice?.amount,maxPrice:o?.maxSalesPrice?.amount,avgPrice:n,avgViews:parseFloat(t.toFixed(2)),avgReviews:parseFloat(h.toFixed(2)),avgRating:parseFloat(m.toFixed(2)),estimatedAvgSales:parseFloat(g.toFixed(2)),itemCountInSearch:p,relatedKeywords:r}}function deepClone(e){if(null===e||"object"!=typeof e)return e;var t,r=Array.isArray(e)?[]:{};for(t of Object.keys(e))r[t]=deepClone(e[t]);return r}
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};function make_xlsx_lib(e){e.version="0.20.3";var q,_=1200,E=1252,r=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},a=function(e){-1!=r.indexOf(e)&&(E=N[0]=e)};var j=function(e){a(_=e)};function m(){j(1200),a(1252)}function n(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function o(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function s(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var i=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?o(e.slice(2)):254==t&&255==r?s(e.slice(2)):65279==t?e.slice(1):e},u=function(e){return String.fromCharCode(e)},l=function(e){return String.fromCharCode(e)};var de=null,d=!0,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Q(e){for(var t,r,a,n,o="",s=0,c=0,i=0;i<e.length;)a=(t=e.charCodeAt(i++))>>2,n=(3&t)<<4|(t=e.charCodeAt(i++))>>4,s=(15&t)<<2|(r=e.charCodeAt(i++))>>6,c=63&r,isNaN(t)?s=c=64:isNaN(r)&&(c=64),o+=p.charAt(a)+p.charAt(n)+p.charAt(s)+p.charAt(c);return o}function pe(e){var t,r,a="";e=(e="data:"==e.slice(0,5)&&-1<(n=e.slice(0,1024).indexOf(";base64,"))?e.slice(n+8):e).replace(/[^\w\+\/\=]/g,"");for(var n=0;n<e.length;)t=p.indexOf(e.charAt(n++)),r=p.indexOf(e.charAt(n++)),a+=String.fromCharCode(t<<2|r>>4),64!==(t=p.indexOf(e.charAt(n++)))&&(a+=String.fromCharCode((15&r)<<4|t>>2)),64!==(r=p.indexOf(e.charAt(n++)))&&(a+=String.fromCharCode((3&t)<<6|r));return a}var ue="undefined"!=typeof Buffer&&!1,he=function(){if("undefined"==typeof Buffer)return function(){};var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch(e){t=!0}return t?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}(),h="undefined"!=typeof Buffer&&!!(Ze=he([65,0]))&&1==Ze.toString("utf16le").length;function me(e){return ue?Buffer.alloc?Buffer.alloc(e):new Buffer(e):new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)}function ge(e){return ue?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)}var fe=function(e){return ue?he(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function g(e){if("undefined"==typeof ArrayBuffer)return fe(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function A(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function f(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return f(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ye=ue?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:he(e)}))}:function(e){if("undefined"==typeof Uint8Array)return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}));for(var t=0,r=0,t=0;t<e.length;++t)r+=e[t].length;for(var a,n=new Uint8Array(r),r=t=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):"string"==typeof e[t]?n.set(new Uint8Array(fe(e[t])),r):n.set(new Uint8Array(e[t]),r);return n};var ve=/\u0000/g,we=/[\u0001-\u0006]/g;function T(e){for(var t="",r=e.length-1;0<=r;)t+=e.charAt(r--);return t}function P(e,t){e=""+e;return t<=e.length?e:S("0",t-e.length)+e}function O(e,t){e=""+e;return t<=e.length?e:S(" ",t-e.length)+e}function F(e,t){e=""+e;return t<=e.length?e:e+S(" ",t-e.length)}var y=Math.pow(2,32);function V(e,t){var r,a;return y<e||e<-y?(a=e,r=t,a=""+Math.round(a),r<=a.length?a:S("0",r-a.length)+a):(r=Math.round(e),(a=t)<=(e=""+(e=r)).length?e:S("0",a-e.length)+e)}function X(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var be=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Se=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var W={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},v={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},w={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ke(e,t,r){var a,n=e<0?-1:1,o=e*n,s=0,c=1,i=0,l=1,u=0,d=0;for(Math.floor(o);u<t&&(i=(a=Math.floor(o))*c+s,d=a*u+l,!(o-a<5e-8));)o=1/(o-a),s=c,c=i,l=u,u=d;return t<d&&(i=t<u?(d=l,s):(d=u,c)),r?[e=Math.floor(n*i/d),n*i-e*d,d]:[0,n*i,d]}function xe(e,t,r){var a,n,o,s,c;return 2958465<e||e<0?null:(s=[],c={D:n=0|(e=-1<(n=(n=e).toPrecision(16)).indexOf("e")?(a=-1<(a=n.slice(0,n.indexOf("e"))).indexOf(".")?a.slice(0,"0."==a.slice(0,2)?17:16):a.slice(0,15)+S("0",a.length-15))+n.slice(n.indexOf("e")):(a=-1<n.indexOf(".")?n.slice(0,"0."==n.slice(0,2)?17:16):n.slice(0,15)+S("0",n.length-15),Number(a))),T:o=Math.floor(86400*(e-n)),u:86400*(e-n)-o,y:e=0,m:0,d:0,H:0,M:0,S:0,q:0},Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),.9999<c.u&&(c.u=0,86400==++o)&&(c.T=o=0,++n,++c.D),60===n?(s=r?[1317,10,29]:[1900,2,29],e=3):0===n?(s=r?[1317,8,29]:[1900,1,0],e=6):(60<n&&--n,(t=new Date(1900,0,1)).setDate(t.getDate()+n-1),s=[t.getFullYear(),t.getMonth()+1,t.getDate()],e=t.getDay(),n<60&&(e=(e+6)%7),r&&(e=function(e,t){t[0]-=581;t=e.getDay();e<60&&(t=(t+6)%7);return t}(t,s))),c.y=s[0],c.m=s[1],c.d=s[2],c.S=o%60,o=Math.floor(o/60),c.M=o%60,o=Math.floor(o/60),c.H=o,c.q=e,c)}function Ie(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ce(e){var t,r,a,n;return isFinite(e)?(n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a=-4<=n&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?(t=(a=e)<0?12:11,(r=Ie(a.toFixed(12))).length<=t||(r=a.toPrecision(10)).length<=t?r:a.toExponential(5)):10===n?e.toFixed(10).substr(0,12):(r=Ie((t=e).toFixed(11))).length>(t<0?12:11)||"0"===r||"-0"===r?t.toPrecision(6):r,Ie(-1==(n=a.toUpperCase()).indexOf("E")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))):isNaN(e)?"#NUM!":"#DIV/0!"}function Ae(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Ce(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Ge(14,Z(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Te(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(0<r.length?",":"")+e.substr(t,3);return r}var _e=/%/g;var De=/# (\?+)( ?)\/( ?)(\d+)/;var Ee=/^#*0*\.([0#]+)/,Re=/\)[^)]*[0#]/,Ne=/\(###\) ###\\?-####/;function b(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Pe(e,t){t=Math.pow(10,t);return""+Math.round(e*t)/t}function Oe(e,t){var e=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function Fe(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Re))return a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=r?Fe("n",a,r):"("+Fe("n",a,-r)+")";if(44===t.charCodeAt(t.length-1)){for(var a=e,n=t,o=r,s=n.length-1;44===n.charCodeAt(s-1);)--s;return Me(a,n.substr(0,s),o/Math.pow(10,3*(n.length-s)))}if(-1!==t.indexOf("%"))return o=e,l=r,i=(u=t).replace(_e,""),u=u.length-i.length,Me(o,i,l*Math.pow(10,2*u))+S("%",u);if(-1!==t.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var o=t.indexOf("."),s=(-1===o&&(o=t.indexOf("E")),Math.floor(Math.log(r)*Math.LOG10E)%o);if(s<0&&(s+=o),-1===(a=(r/Math.pow(10,s)).toPrecision(1+n+(o+s)%o)).indexOf("e")){var c=Math.floor(Math.log(r)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(c-a.length+s):a+="E+"+(c-s);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,o)+"."+a.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(o+s)%o)+"."+a.substr(s)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),(a=t.match(/E\-/)&&a.match(/e\+/)?a.replace(/e\+/,"e"):a).replace("e","E")}(t,r);if(36===t.charCodeAt(0))return"$"+Fe(e,t.substr(" "==t.charAt(1)?2:1),r);var c,i,l,u,d,p=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+V(p,t.length);if(t.match(/^[#?]+$/))return(m="0"===(m=V(r,0))?"":m).length>t.length?m:b(t.substr(0,t.length-m.length))+m;if(c=t.match(De))return i=c,l=p,u=h,v=parseInt(i[4],10),l=Math.round(l*v),d=Math.floor(l/v),u+(0===d?"":""+d)+" "+(0==(l=l-d*v)?S(" ",i[1].length+1+i[4].length):O(l,i[1].length)+i[2]+"/"+i[3]+P(v,i[4].length));if(t.match(/^#+0+$/))return h+V(p,t.length-t.indexOf("0"));if(c=t.match(Ee))return m=Pe(r,c[1].length).replace(/^([^\.]+)$/,"$1."+b(c[1])).replace(/\.$/,"."+b(c[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+S("0",b(c[1]).length-t.length)}),-1!==t.indexOf("0.")?m:m.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),c=t.match(/^(0*)\.(#*)$/))return h+Pe(p,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=t.match(/^#{1,3},##0(\.?)$/))return h+Te(V(p,0));if(c=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fe(e,t,-r):Te(""+(Math.floor(r)+((d=c[1].length)<(""+Math.round((r-Math.floor(r))*Math.pow(10,d))).length?1:0)))+"."+P(Oe(r,c[1].length),c[1].length);if(c=t.match(/^#,#*,#0/))return Fe(e,t.replace(/^#,#*,/,""),r);if(c=t.match(/^([0#]+)(\\?-([0#]+))+$/))return m=T(Fe(e,t.replace(/[\\-]/g,""),r)),g=0,T(T(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return g<m.length?m.charAt(g++):"0"===e?"0":""}));if(t.match(Ne))return"("+(m=Fe(e,"##########",r)).substr(0,3)+") "+m.substr(3,3)+"-"+m.substr(6);var m,g,f,y,v="";if(c=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(c[4].length,7),y=ke(p,Math.pow(10,g)-1,!1),m=h," "==(v=Me("n",c[1],y[1])).charAt(v.length-1)&&(v=v.substr(0,v.length-1)+"0"),m+=v+c[2]+"/"+c[3],(v=F(y[2],g)).length<c[4].length&&(v=b(c[4].substr(c[4].length-v.length))+v),m+=v;if(c=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(c[1].length,c[4].length),7),h+((y=ke(p,Math.pow(10,g)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?O(y[1],g)+c[2]+"/"+c[3]+F(y[2],g):S(" ",2*g+1+c[2].length+c[3].length));if(c=t.match(/^[#0?]+$/))return m=V(r,0),t.length<=m.length?m:b(t.substr(0,t.length-m.length))+m;if(c=t.match(/^([#0?]+)\.([#0]+)$/))return g=(m=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),y=t.indexOf(".")-g,f=t.length-m.length-y,b(t.substr(0,y)+m+t.substr(t.length-f));if(c=t.match(/^00,000\.([#0]*0)$/))return g=Oe(r,c[1].length),r<0?"-"+Fe(e,t,-r):Te((y=r)<2147483647&&-2147483648<y?""+(0<=y?0|y:y-1|0):""+Math.floor(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?P(0,3-e.length):"")+e})+"."+P(g,c[1].length);switch(t){case"###,##0.00":return Fe(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=Te(V(p,0));return"0"!==w?h+w:"";case"###,###.00":return Fe(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Fe(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function qe(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Re))return a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=r?qe("n",a,r):"("+qe("n",a,-r)+")";if(44===t.charCodeAt(t.length-1)){for(var a=e,n=t,o=r,s=n.length-1;44===n.charCodeAt(s-1);)--s;return Me(a,n.substr(0,s),o/Math.pow(10,3*(n.length-s)))}if(-1!==t.indexOf("%"))return o=e,i=r,l=(f=t).replace(_e,""),f=f.length-l.length,Me(o,l,i*Math.pow(10,2*f))+S("%",f);if(-1!==t.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var o,s=t.indexOf("."),c=(-1===s&&(s=t.indexOf("E")),Math.floor(Math.log(r)*Math.LOG10E)%s);c<0&&(c+=s),(a=(r/Math.pow(10,c)).toPrecision(1+n+(s+c)%s)).match(/[Ee]/)||(o=Math.floor(Math.log(r)*Math.LOG10E),-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+c):a+="E+"+(o-c),a=a.replace(/\+-/,"-")),a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+c)%s)+"."+a.substr(c)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),(a=t.match(/E\-/)&&a.match(/e\+/)?a.replace(/e\+/,"e"):a).replace("e","E")}(t,r);if(36===t.charCodeAt(0))return"$"+qe(e,t.substr(" "==t.charAt(1)?2:1),r);var c,i,l,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+P(u,t.length);if(t.match(/^[#?]+$/))return(p=0===r?"":""+r).length>t.length?p:b(t.substr(0,t.length-p.length))+p;if(c=t.match(De))return d+(0===(l=u)?"":""+l)+S(" ",(i=c)[1].length+2+i[4].length);if(t.match(/^#+0+$/))return d+P(u,t.length-t.indexOf("0"));if(c=t.match(Ee))return p=(p=(""+r).replace(/^([^\.]+)$/,"$1."+b(c[1])).replace(/\.$/,"."+b(c[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+S("0",b(c[1]).length-t.length)}),-1!==t.indexOf("0.")?p:p.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),c=t.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=t.match(/^#{1,3},##0(\.?)$/))return d+Te(""+u);if(c=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qe(e,t,-r):Te(""+r)+"."+S("0",c[1].length);if(c=t.match(/^#,#*,#0/))return qe(e,t.replace(/^#,#*,/,""),r);if(c=t.match(/^([0#]+)(\\?-([0#]+))+$/))return p=T(qe(e,t.replace(/[\\-]/g,""),r)),h=0,T(T(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return h<p.length?p.charAt(h++):"0"===e?"0":""}));if(t.match(Ne))return"("+(p=qe(e,"##########",r)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var p,h,m,g,f="";if(c=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),m=ke(u,Math.pow(10,h)-1,!1),p=d," "==(f=Me("n",c[1],m[1])).charAt(f.length-1)&&(f=f.substr(0,f.length-1)+"0"),p+=f+c[2]+"/"+c[3],(f=F(m[2],h)).length<c[4].length&&(f=b(c[4].substr(c[4].length-f.length))+f),p+=f;if(c=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d+((m=ke(u,Math.pow(10,h)-1,!0))[0]||(m[1]?"":"0"))+" "+(m[1]?O(m[1],h)+c[2]+"/"+c[3]+F(m[2],h):S(" ",2*h+1+c[2].length+c[3].length));if(c=t.match(/^[#0?]+$/))return p=""+r,t.length<=p.length?p:b(t.substr(0,t.length-p.length))+p;if(c=t.match(/^([#0]+)\.([#0]+)$/))return h=(p=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),m=t.indexOf(".")-h,g=t.length-p.length-m,b(t.substr(0,m)+p+t.substr(t.length-g));if(c=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+qe(e,t,-r):Te(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?P(0,3-e.length):"")+e})+"."+P(0,c[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Te(""+u);return"0"!==y?d+y:"";default:if(t.match(/\.[0#?]*$/))return qe(e,t.slice(0,t.lastIndexOf(".")),r)+b(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Me(e,t,r){return((0|r)===r?qe:Fe)(e,t,r)}var Le=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Be(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":X(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("ä¸Šåˆ/ä¸‹åˆ"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(Le))return!0;break;case".":case"0":case"#":for(;t<e.length&&(-1<"0#?.,E+-%".indexOf(r=e.charAt(++t))||"\\"==r&&"-"==e.charAt(t+1)&&-1<"0#".indexOf(e.charAt(t+2))););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&-1<"0123456789".indexOf(e.charAt(++t)););break;default:++t}return!1}function Ue(e,t,r,a){for(var n,o,s,c=[],i="",l=0,u="",d="t",p="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!X(e,l))throw new Error("unrecognized character "+u+" in "+e);c[c.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";34!==(s=e.charCodeAt(++l))&&l<e.length;)i+=String.fromCharCode(s);c[c.length]={t:"t",v:i},++l;break;case"\\":var h=e.charAt(++l);c[c.length]={t:"("===h||")"===h?h:"t",v:h},++l;break;case"_":c[c.length]={t:"t",v:" "},l+=2;break;case"@":c[c.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==n&&null==(n=xe(t,r,"2"===e.charAt(l+1))))return"";c[c.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=xe(t,r)))return"";for(i=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)i+=u;"h"===(u="m"===u&&"h"===d.toLowerCase()?"M":u)&&(u=p),c[c.length]={t:u,v:i},d=u;break;case"A":case"a":case"ä¸Š":h={t:u,v:u};if(null==n&&(n=xe(t,r)),"A/P"===e.substr(l,3).toUpperCase()?(null!=n&&(h.v=12<=n.H?e.charAt(l+2):u),h.t="T",p="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=n&&(h.v=12<=n.H?"PM":"AM"),h.t="T",l+=5,p="h"):"ä¸Šåˆ/ä¸‹åˆ"===e.substr(l,5).toUpperCase()?(null!=n&&(h.v=12<=n.H?"ä¸‹åˆ":"ä¸Šåˆ"),h.t="T",l+=5,p="h"):(h.t="t",++l),null==n&&"T"===h.t)return"";c[c.length]=h,d=u;break;case"[":for(i=u;"]"!==e.charAt(l++)&&l<e.length;)i+=e.charAt(l);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(Le)){if(null==n&&null==(n=xe(t,r)))return"";c[c.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else-1<i.indexOf("$")&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Be(e)||(c[c.length]={t:"t",v:i}));break;case".":if(null!=n){for(i=u;++l<e.length&&"0"===(u=e.charAt(l));)i+=u;c[c.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++l<e.length&&-1<"0#?.,E+-%".indexOf(u=e.charAt(l));)i+=u;c[c.length]={t:"n",v:i};break;case"?":for(i=u;e.charAt(++l)===u;)i+=u;c[c.length]={t:u,v:i},d=u;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":c[c.length]={t:1===a?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;l<e.length&&-1<"0123456789".indexOf(e.charAt(++l));)i+=e.charAt(l);c[c.length]={t:"D",v:i};break;case" ":c[c.length]={t:u,v:u},++l;break;case"$":c[c.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);c[c.length]={t:"t",v:u},++l}var m,g,f=0,y=0;for(l=c.length-1,d="t";0<=l;--l)switch(c[l].t){case"h":case"H":c[l].t=p,d="h",f<1&&(f=1);break;case"s":(m=c[l].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1),f=4),f<3&&(f=3);case"d":case"y":case"e":d=c[l].t;break;case"M":d=c[l].t,f<2&&(f=2);break;case"m":"s"===d&&(c[l].t="M",f<2)&&(f=2);break;case"X":break;case"Z":(f=(f=f<1&&c[l].v.match(/[Hh]/)?1:f)<2&&c[l].v.match(/[Mm]/)?2:f)<3&&c[l].v.match(/[Ss]/)&&(f=3)}switch(f){case 0:break;case 1:case 2:case 3:.5<=n.u&&(n.u=0,++n.S),60<=n.S&&(n.S=0,++n.M),60<=n.M&&(n.M=0,++n.H),24<=n.H&&(n.H=0,++n.D,(g=xe(n.D)).u=n.u,g.S=n.S,g.M=n.M,g.H=n.H,n=g);break;case 4:switch(y){case 1:n.u=Math.round(10*n.u)/10;break;case 2:n.u=Math.round(100*n.u)/100;break;case 3:n.u=Math.round(1e3*n.u)/1e3}1<=n.u&&(n.u=0,++n.S),60<=n.S&&(n.S=0,++n.M),60<=n.M&&(n.M=0,++n.H),24<=n.H&&(n.H=0,++n.D,(g=xe(n.D)).u=n.u,g.S=n.S,g.M=n.M,g.H=n.H,n=g)}var v="";for(l=0;l<c.length;++l)switch(c[l].t){case"t":case"T":case" ":case"D":break;case"X":c[l].v="",c[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[l].v=function(e,t,r,a){var n,o="",s=0,c=0,i=r.y,l=0;switch(e){case 98:i=r.y+543;case 121:switch(t.length){case 1:case 2:n=i%100,l=2;break;default:n=i%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:n=r.m,l=t.length;break;case 3:return Se[r.m-1][1];case 5:return Se[r.m-1][0];default:return Se[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=r.d,l=t.length;break;case 3:return be[r.q][0];default:return be[r.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(60*(c=2<=a?3===a?1e3:100:1===a?10:1)<=(s=Math.round(c*(r.S+r.u)))&&(s=0),"s"===t?0===s?"0":""+s/c:(o=P(s,2+a),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):P(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":n=24*r.D+r.H;break;case"[m]":case"[mm]":n=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":n=60*(60*(24*r.D+r.H)+r.M)+(0==a?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:n=i,l=1}return 0<l?P(n,l):""}(c[l].t.charCodeAt(0),c[l].v,n,y),c[l].t="t";break;case"n":case"?":for(k=l+1;null!=c[k]&&("?"===(u=c[k].t)||"D"===u||(" "===u||"t"===u)&&null!=c[k+1]&&("?"===c[k+1].t||"t"===c[k+1].t&&"/"===c[k+1].v)||"("===c[l].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===c[k].v||" "===c[k].v&&null!=c[k+1]&&"?"==c[k+1].t));)c[l].v+=c[k].v,c[k]={v:"",t:";"},++k;v+=c[l].v,l=k-1;break;case"G":c[l].t="t",c[l].v=Ae(t,r)}var w,b,S="";if(0<v.length){40==v.charCodeAt(0)?(w=t<0&&45===v.charCodeAt(0)?-t:t,b=Me("n",v,w)):(b=Me("n",v,w=t<0&&1<a?-t:t),w<0&&c[0]&&"t"==c[0].t&&(b=b.substr(1),c[0].v="-"+c[0].v));for(var k=b.length-1,x=c.length,l=0;l<c.length;++l)if(null!=c[l]&&"t"!=c[l].t&&-1<c[l].v.indexOf(".")){x=l;break}var I=c.length;if(x===c.length&&-1===b.indexOf("E")){for(l=c.length-1;0<=l;--l)null!=c[l]&&-1!=="n?".indexOf(c[l].t)&&(k>=c[l].v.length-1?(k-=c[l].v.length,c[l].v=b.substr(k+1,c[l].v.length)):k<0?c[l].v="":(c[l].v=b.substr(0,k+1),k=-1),c[l].t="t",I=l);0<=k&&I<c.length&&(c[I].v=b.substr(0,k+1)+c[I].v)}else if(x!==c.length&&-1===b.indexOf("E")){for(k=b.indexOf(".")-1,l=x;0<=l;--l)if(null!=c[l]&&-1!=="n?".indexOf(c[l].t)){for(o=-1<c[l].v.indexOf(".")&&l===x?c[l].v.indexOf(".")-1:c[l].v.length-1,S=c[l].v.substr(o+1);0<=o;--o)0<=k&&("0"===c[l].v.charAt(o)||"#"===c[l].v.charAt(o))&&(S=b.charAt(k--)+S);c[l].v=S,c[l].t="t",I=l}for(0<=k&&I<c.length&&(c[I].v=b.substr(0,k+1)+c[I].v),k=b.indexOf(".")+1,l=x;l<c.length;++l)if(null!=c[l]&&(-1!=="n?(".indexOf(c[l].t)||l===x)){for(o=-1<c[l].v.indexOf(".")&&l===x?c[l].v.indexOf(".")+1:0,S=c[l].v.substr(0,o);o<c[l].v.length;++o)k<b.length&&(S+=b.charAt(k++));c[l].v=S,c[l].t="t",I=l}}}for(l=0;l<c.length;++l)null!=c[l]&&-1<"n?".indexOf(c[l].t)&&(w=1<a&&t<0&&0<l&&"-"===c[l-1].v?-t:t,c[l].v=Me(c[l].t,c[l].v,w),c[l].t="t");var C="";for(l=0;l!==c.length;++l)null!=c[l]&&(C+=c[l].v);return C}var je=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function We(e,t){if(null!=t){var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return 1;break;case">":if(r<e)return 1;break;case"<":if(e<r)return 1;break;case"<>":if(e!=r)return 1;break;case">=":if(r<=e)return 1;break;case"<=":if(e<=r)return 1}}}function $e(e,t){var r=function(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),e=r.length,a=r[e-1].indexOf("@");if(e<4&&-1<a&&--e,4<r.length)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||-1<a?r[r.length-1]:"@"];switch("number"!=typeof t||isFinite(t)||(t=0),r.length){case 1:r=-1<a?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=-1<a?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=-1<a?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var n,o,s=0<t?r[0]:t<0?r[1]:r[2];return!(-1===r[0].indexOf("[")&&-1===r[1].indexOf("[")||null==r[0].match(/\[[=<>]/)&&null==r[1].match(/\[[=<>]/))?(n=r[0].match(je),o=r[1].match(je),We(t,n)?[e,r[0]]:We(t,o)?[e,r[1]]:[e,r[null!=n&&null!=o?2:1]]):[e,s]}function Ge(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:W)[e])?r.table&&r.table[v[e]]||W[v[e]]:a)&&(a=w[e]||"General")}if(X(a,0))return Ae(t,r);var n=$e(a,t=t instanceof Date?Z(t,r.date1904):t);if(X(n[1]))return Ae(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else{if(""===t||null==t)return"";if(isNaN(t)&&-1<n[1].indexOf("0"))return"#NUM!";if(!isFinite(t)&&-1<n[1].indexOf("0"))return"#DIV/0!"}return Ue(n[1],t,r,n[0])}function ze(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null==W[r])t<0&&(t=r);else if(W[r]==e){t=r;break}t<0&&(t=391)}return W[t]=e,t}function Ke(e){for(var t=0;392!=t;++t)void 0!==e[t]&&ze(e[t],t)}function He(){var e;(e=e||{})[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',W=e}var Ve={format:Ge,load:ze,_table:W,load_table:Ke,parse_date_code:xe,is_date:Be,get_table:function(){return Ve._table=W}},Xe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Je=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ye={"d.m":"d\\.m"};function Qe(e,t){ze(Ye[e]||e,t)}(Ze={}).version="1.2.0",c=function(){for(var e,t=new Array(256),r=0;256!=r;++r)t[e=r]=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&e?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),t=function(e){for(var t=0,r=0,a=0,n=new("undefined"!=typeof Int32Array?Int32Array:Array)(4096),a=0;256!=a;++a)n[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=n[t]=r>>>8^e[255&r];var o=[];for(a=1;16!=a;++a)o[a-1]="undefined"!=typeof Int32Array&&"function"==typeof n.subarray?n.subarray(256*a,256*a+256):n.slice(256*a,256*a+256);return o}(c),et=t[0],tt=t[1],rt=t[2],at=t[3],nt=t[4],ot=t[5],st=t[6],ct=t[7],it=t[8],lt=t[9],ut=t[10],dt=t[11],pt=t[12],ht=t[13],mt=t[14],Ze.table=c,Ze.bstr=function(e,t){for(var r=-1^t,a=0,n=e.length;a<n;)r=r>>>8^c[255&(r^e.charCodeAt(a++))];return~r},Ze.buf=function(e,t){for(var r=-1^t,a=e.length-15,n=0;n<a;)r=mt[e[n++]^255&r]^ht[e[n++]^r>>8&255]^pt[e[n++]^r>>16&255]^dt[e[n++]^r>>>24]^ut[e[n++]]^lt[e[n++]]^it[e[n++]]^ct[e[n++]]^st[e[n++]]^ot[e[n++]]^nt[e[n++]]^at[e[n++]]^rt[e[n++]]^tt[e[n++]]^et[e[n++]]^c[e[n++]];for(a+=15;n<a;)r=r>>>8^c[255&(r^e[n++])];return~r},Ze.str=function(e,t){for(var r,a=-1^t,n=0,o=e.length,s=0;n<o;)a=(s=e.charCodeAt(n++))<128?a>>>8^c[255&(a^s)]:s<2048?(a=a>>>8^c[255&(a^(192|s>>6&31))])>>>8^c[255&(a^(128|63&s))]:55296<=s&&s<57344?(s=64+(1023&s),r=1023&e.charCodeAt(n++),(a=(a=(a=a>>>8^c[255&(a^(240|s>>8&7))])>>>8^c[255&(a^(128|s>>2&63))])>>>8^c[255&(a^(128|r>>6&15|(3&s)<<4))])>>>8^c[255&(a^(128|63&r))]):(a=(a=a>>>8^c[255&(a^(224|s>>12&15))])>>>8^c[255&(a^(128|s>>6&63))])>>>8^c[255&(a^(128|63&s))];return~a};var Ze,c,et,tt,rt,at,nt,ot,st,ct,it,lt,ut,dt,pt,ht,mt,gt,ft=Ze,J=function(){var n,e={};function h(e){var t;return"/"==e.charAt(e.length-1)?-1===e.slice(0,-1).indexOf("/")?e:h(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(0,t+1)}function m(e){var t;return"/"==e.charAt(e.length-1)?m(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(t+1)}function A(e){ia(e,0);for(var t={};e.l<=e.length-4;){var r=e._R(2),a=e._R(2),n=e.l+a,o={};switch(r){case 21589:1&(s=e._R(1))&&(o.mtime=e._R(4)),5<a&&(2&s&&(o.atime=e._R(4)),4&s)&&(o.ctime=e._R(4)),o.mtime&&(o.mt=new Date(1e3*o.mtime));break;case 1:var s=e._R(4),c=e._R(4);o.usz=c*Math.pow(2,32)+s,s=e._R(4),c=e._R(4),o.csz=c*Math.pow(2,32)+s}e.l=n,t[r]=o}return t}function o(){n=n||gt}function s(e,t){if(80==e[0]&&75==e[1])return le(e,t);if(109==(32|e[0])&&105==(32|e[1])){var r=e,a=t;if("mime-version:"!=se(r.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=a&&a.root||"",o=(ue&&Buffer.isBuffer(r)?r.toString("binary"):se(r)).split("\r\n"),s=0,c="";for(s=0;s<o.length;++s)if(c=o[s],/^Content-Location:/i.test(c)&&(c=c.slice(c.indexOf("file")),n=n||c.slice(0,c.lastIndexOf("/")+1),c.slice(0,n.length)!=n))for(;0<n.length&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),c.slice(0,n.length)!=n););if(!(a=(o[1]||"").match(/boundary="(.*?)"/)))throw new Error("MAD cannot find boundary");var q="--"+(a[1]||""),i={FileIndex:[],FullPaths:[]};ae(i);var M,L=0;for(s=0;s<o.length;++s){var B=o[s];B!==q&&B!==q+"--"||(L++&&!function(e,t,r){for(var a,n="",o="",s="",c=0;c<10;++c){var i=t[c];if(!i||i.match(/^\s*$/))break;var l=i.match(/^([^:]*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":n=l[2].trim();break;case"content-type":s=l[2].trim();break;case"content-transfer-encoding":o=l[2].trim()}}switch(++c,o.toLowerCase()){case"base64":a=fe(pe(t.slice(c).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return fe(t.join("\r\n"))}(t.slice(c));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}e=ce(e,n.slice(r.length),a,{unsafe:!0});s&&(e.ctype=s)}(i,o.slice(M,s),n),M=s)}return i}if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var l,u=512,d=[],p=e.slice(0,512),U=(ia(p,0),function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(ie,"Header Signature: "),e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}(p));switch(l=U[0]){case 3:u=512;break;case 4:u=4096;break;case 0:if(0==U[1])return le(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+l)}512!==u&&ia(p=e.slice(0,u),28);var r=e.slice(0,u),a=p,j=l,h=9;switch(a.l+=2,h=a._R(2)){case 9:if(3!=j)throw new Error("Sector Shift: Expected 9 saw "+h);break;case 12:if(4!=j)throw new Error("Sector Shift: Expected 12 saw "+h);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+h)}a.chk("0600","Mini Sector Shift: "),a.chk("000000000000","Reserved: ");var m=p._R(4,"i");if(3===l&&0!==m)throw new Error("# Directory Sectors: Expected 0 saw "+m);p.l+=4,m=p._R(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: ");for(var W,g=p._R(4,"i"),$=p._R(4,"i"),f=p._R(4,"i"),y=p._R(4,"i"),v=0;v<109&&!((W=p._R(4,"i"))<0);++v)d[v]=W;for(var w,b=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],n=1;n<r;++n)a[n-1]=e.slice(n*t,(n+1)*t);return a[r-1]=e.slice(r*t),a}(e,u),f=(!function e(t,r,a,n,o){var s=oe;if(t===oe){if(0!==r)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var c=a[t],i=(n>>>2)-1;if(c){for(var l=0;l<i&&(s=ea(c,4*l))!==oe;++l)o.push(s);1<=r&&e(ea(c,n-4),r-1,a,n,o)}}}(f,y,b,u,d),function(e,t,r,a){var n=e.length,o=[],s=[],c=[],i=[],l=a-1,u=0,d=0,p=0,h=0;for(u=0;u<n;++u)if(c=[],n<=(p=u+t)&&(p-=n),!s[p]){i=[];var m=[];for(d=p;0<=d;){s[d]=m[d]=!0,c[c.length]=d,i.push(e[d]);var g=r[Math.floor(4*d/a)];if(a<4+(h=4*d&l))throw new Error("FAT boundary crossed: "+d+" 4 "+a);if(!e[g])break;if(d=ea(e[g],h),m[d])break}o[p]={nodes:c,data:Ur([i])}}return o}(b,m,d,u)),y=(m<f.length&&(f[m].name="!Directory"),0<$&&g!==oe&&(f[g].name="!MiniFAT"),f[d[0]].name="!FAT",f.fat_addrs=d,f.ssz=u,[]),S=[],G=[],k=f,z=b,K=y,H=$,V={},X=S,J=g,x=0,Y=K.length?2:0,Q=k[m].data,I=0,Z=0;I<Q.length;I+=128){var C=Q.slice(I,I+128),A=(ia(C,64),Z=C._R(2),w=jr(C,0,Z-Y),K.push(w),{name:w,type:C._R(1),color:C._R(1),L:C._R(4,"i"),R:C._R(4,"i"),C:C._R(4,"i"),clsid:C._R(16),state:C._R(4,"i"),start:0,size:0});0!==C._R(2)+C._R(2)+C._R(2)+C._R(2)&&(A.ct=re(C,C.l-8)),0!==C._R(2)+C._R(2)+C._R(2)+C._R(2)&&(A.mt=re(C,C.l-8)),A.start=C._R(4,"i"),A.size=C._R(4,"i"),A.size<0&&A.start<0&&(A.size=A.type=0,A.start=oe,A.name=""),5===A.type?(x=A.start,0<H&&x!==oe&&(k[x].name="!StreamData")):4096<=A.size?(A.storage="fat",void 0===k[A.start]&&(k[A.start]=function(e,t,r,a,n){var o=[],s=[];n=n||[];var c=a-1,i=0,l=0;for(i=t;0<=i;){n[i]=!0,o[o.length]=i,s.push(e[i]);var u=r[Math.floor(4*i/a)];if(a<4+(l=4*i&c))throw new Error("FAT boundary crossed: "+i+" 4 "+a);if(!e[u])break;i=ea(e[u],l)}return{nodes:o,data:Ur([s])}}(z,A.start,k.fat_addrs,k.ssz)),k[A.start].name=A.name,A.content=k[A.start].data.slice(0,A.size)):(A.storage="minifat",A.size<0?A.size=0:x!==oe&&A.start!==oe&&k[x]&&(A.content=function(e,t,r){var a=e.start,n=e.size,o=[],s=a;for(;r&&0<n&&0<=s;)o.push(t.slice(s*ne,s*ne+ne)),n-=ne,s=ea(r,4*s);return 0===o.length?la(0):ye(o).slice(0,e.size)}(A,k[x].data,(k[J]||{}).data))),A.content&&ia(A.content,0),V[w]=A,X.push(A)}for(var T=S,_=G,ee=y,D=0,E=0,R=0,te=0,N=0,P=ee.length,O=[],F=[];D<P;++D)O[D]=F[D]=D,_[D]=ee[D];for(;N<F.length;++N)E=T[D=F[N]].L,R=T[D].R,te=T[D].C,O[D]===D&&(-1!==E&&O[E]!==E&&(O[D]=O[E]),-1!==R)&&O[R]!==R&&(O[D]=O[R]),-1!==te&&(O[te]=D),-1!==E&&D!=O[D]&&(O[E]=O[D],F.lastIndexOf(E)<N)&&F.push(E),-1!==R&&D!=O[D]&&(O[R]=O[D],F.lastIndexOf(R)<N)&&F.push(R);for(D=1;D<P;++D)O[D]===D&&(-1!==R&&O[R]!==R?O[D]=O[R]:-1!==E&&O[E]!==E&&(O[D]=O[E]));for(D=1;D<P;++D)if(0!==T[D].type){if((N=D)!=O[N])for(;N=O[N],_[D]=_[N]+"/"+_[D],0!==N&&-1!==O[N]&&N!=O[N];);O[D]=-1}for(_[0]+="/",D=1;D<P;++D)2!==T[D].type&&(_[D]+="/");y.shift();f={FileIndex:S,FullPaths:G};return t&&t.raw&&(f.raw={header:r,sectors:b}),f}function re(e,t){return new Date(1e3*(Y(e,t+4)/1e7*Math.pow(2,32)+Y(e,t)/1e7-11644473600))}function ae(e,t){var t=t||{},r=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),r=e,t="Sh33tJ5",J.find(r,"/"+t)||((e=la(4))[0]=55,e[1]=e[3]=50,e[2]=54,r.FileIndex.push({name:t,type:2,content:e,size:4,L:69,R:69,C:69}),r.FullPaths.push(r.FullPaths[0]+t),G(r))}function G(e,t){ae(e);for(var r=!1,a=!1,n=e.FullPaths.length-1;0<=n;--n){var o=e.FileIndex[n];switch(o.type){case 0:a?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(r=!0),-1<o.R&&-1<o.L&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||t){for(var s=new Date(1987,1,19),c=0,i=Object.create?Object.create(null):{},l=[],n=0;n<e.FullPaths.length;++n)i[e.FullPaths[n]]=!0,0!==e.FileIndex[n].type&&l.push([e.FullPaths[n],e.FileIndex[n]]);for(n=0;n<l.length;++n)for(var u=h(l[n][0]),a=i[u];!a;){for(;h(u)&&!i[h(u)];)u=h(u);l.push([u,{name:m(u).replace("/",""),type:1,clsid:g,ct:s,mt:s,content:null}]),i[u]=!0,a=i[u=h(l[n][0])]}for(l.sort(function(e,t){for(var r,e=e[0],t=t[0],a=e.split("/"),n=t.split("/"),o=0,s=Math.min(a.length,n.length);o<s;++o){if(r=a[o].length-n[o].length)return r;if(a[o]!=n[o])return a[o]<n[o]?-1:1}return a.length-n.length}),e.FullPaths=[],e.FileIndex=[],n=0;n<l.length;++n)e.FullPaths[n]=l[n][0],e.FileIndex[n]=l[n][1];for(n=0;n<l.length;++n){var d=e.FileIndex[n],p=e.FullPaths[n];if(d.name=m(p).replace("/",""),d.L=d.R=d.C=-(d.color=1),d.size=d.content?d.content.length:0,d.start=0,d.clsid=d.clsid||g,0===n)d.C=1<l.length?1:-1,d.size=0,d.type=5;else if("/"==p.slice(-1)){for(c=n+1;c<l.length&&h(e.FullPaths[c])!=p;++c);for(d.C=l.length<=c?-1:c,c=n+1;c<l.length&&h(e.FullPaths[c])!=h(p);++c);d.R=l.length<=c?-1:c,d.type=1}else h(e.FullPaths[n+1]||"")==h(p)&&(d.R=n+1),d.type=2}}}function a(e,t){var r=t||{};if("mad"==r.fileType){for(var a=e,q=r||{},n=q.boundary||"SheetJS",o=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],M=a.FullPaths[0],s=M,c=a.FileIndex[0],i=1;i<a.FullPaths.length;++i)if(s=a.FullPaths[i].slice(M.length),(c=a.FileIndex[i]).size&&c.content&&"Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var l=c.content,u=ue&&Buffer.isBuffer(l)?l.toString("binary"):se(l),L=0,B=Math.min(1024,u.length),U=0,d=0;d<=B;++d)32<=(U=u.charCodeAt(d))&&U<128&&++L;l=4*B/5<=L;o.push(n),o.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+s),o.push("Content-Transfer-Encoding: "+(l?"quoted-printable":"base64")),o.push("Content-Type: "+function(e,t){if(e.ctype)return e.ctype;var e=e.name||"",r=e.match(/\.([^\.]+)$/);if(r&&H[r[1]])return H[r[1]];if(t&&(r=(e=t).match(/[\.\\]([^\.\\])+$/))&&H[r[1]])return H[r[1]];return"application/octet-stream"}(c,s)),o.push(""),o.push((l?function(e){e=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){e=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==e.length?"0"+e:e)});"\n"==(e=e.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(e="=0D"+e.slice(1));e=e.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A");for(var t=[],r=e.split("\r\n"),a=0;a<r.length;++a){var n=r[a];if(0==n.length)t.push("");else for(var o=0;o<n.length;){var s=76,c=n.slice(o,o+s);"="==c.charAt(s-1)?s--:"="==c.charAt(s-2)?s-=2:"="==c.charAt(s-3)&&(s-=3),c=n.slice(o,o+s),(o+=s)<n.length&&(c+="="),t.push(c)}}return t.join("\r\n")}:function(e){for(var t=Q(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"})(u))}return o.push(n+"--\r\n"),o.join("\r\n")}if(G(e),"zip"===r.fileType){var p=e,t=(t=r)||{},h=[],m=[],g=la(1),f=t.compression?8:0,y=0,v=0,w=0,b=0,S=0,j=p.FullPaths[0],k=j,x=p.FileIndex[0],I=[],W=0;for(v=1;v<p.FullPaths.length;++v)if(k=p.FullPaths[v].slice(j.length),(x=p.FileIndex[v]).size&&x.content&&(!Array.isArray(x.content)||0!=x.content.length)&&"Sh33tJ5"!=k){var $=b,C=la(k.length);for(w=0;w<k.length;++w)C._W(1,127&k.charCodeAt(w));C=C.slice(0,C.l),I[S]="string"==typeof x.content?ft.bstr(x.content,0):ft.buf(x.content,0);var A="string"==typeof x.content?fe(x.content):x.content;8==f&&(A=function(e){return z?z.deflateRawSync(e):X(e)}(A)),(g=la(30))._W(4,67324752),g._W(2,20),g._W(2,y),g._W(2,f),x.mt?function(e,t){var r;r=((t="string"==typeof t?new Date(t):t).getHours()<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e._W(2,r),r=(t.getFullYear()-1980<<4|t.getMonth()+1)<<5|t.getDate(),e._W(2,r)}(g,x.mt):g._W(4,0),g._W(-4,8&y?0:I[S]),g._W(4,8&y?0:A.length),g._W(4,8&y?0:x.content.length),g._W(2,C.length),g._W(2,0),b+=g.length,h.push(g),b+=C.length,h.push(C),b+=A.length,h.push(A),8&y&&((g=la(12))._W(-4,I[S]),g._W(4,A.length),g._W(4,x.content.length),b+=g.l,h.push(g)),(g=la(46))._W(4,33639248),g._W(2,0),g._W(2,20),g._W(2,y),g._W(2,f),g._W(4,0),g._W(-4,I[S]),g._W(4,A.length),g._W(4,x.content.length),g._W(2,C.length),g._W(2,0),g._W(2,0),g._W(2,0),g._W(2,0),g._W(4,0),g._W(4,$),W+=g.l,m.push(g),W+=C.length,m.push(C),++S}return(g=la(22))._W(4,101010256),g._W(2,0),g._W(2,0),g._W(2,S),g._W(2,S),g._W(4,W),g._W(4,b),g._W(2,0),ye([ye(h),ye(m),g])}for(var T=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];n.content&&0<(n=n.content.length)&&(n<4096?t+=n+63>>6:r+=n+511>>9)}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,c=(t+7>>3)+r+o+s,i=c+127>>7,l=i<=109?0:Math.ceil((i-109)/127);i<c+i+l+127>>7;)l=++i<=109?0:Math.ceil((i-109)/127);s=[1,l,i,s,o,r,t,0];return e.FileIndex[0].size=t<<6,s[7]=(e.FileIndex[0].start=s[0]+s[1]+s[2]+s[3]+s[4]+s[5])+(s[6]+7>>3),s}(e),_=la(T[7]<<9),D=0,E=0,D=0;D<8;++D)_._W(1,V[D]);for(D=0;D<8;++D)_._W(2,0);for(_._W(2,62),_._W(2,3),_._W(2,65534),_._W(2,9),_._W(2,6),D=0;D<3;++D)_._W(2,0);for(_._W(4,0),_._W(4,T[2]),_._W(4,T[0]+T[1]+T[2]+T[3]-1),_._W(4,0),_._W(4,4096),_._W(4,T[3]?T[0]+T[1]+T[2]-1:oe),_._W(4,T[3]),_._W(-4,T[1]?T[0]-1:oe),_._W(4,T[1]),D=0;D<109;++D)_._W(-4,D<T[2]?T[1]+D:-1);if(T[1])for(E=0;E<T[1];++E){for(;D<236+127*E;++D)_._W(-4,D<T[2]?T[1]+D:-1);_._W(-4,E===T[1]-1?oe:E+1)}function R(e){for(E+=e;D<E-1;++D)_._W(-4,D+1);e&&(++D,_._W(-4,oe))}E=D=0;for(E+=T[1];D<E;++D)_._W(-4,K.DIFSECT);for(E+=T[2];D<E;++D)_._W(-4,K.FATSECT);R(T[3]),R(T[4]);for(var N=0,P=0,O=e.FileIndex[0];N<e.FileIndex.length;++N)!(O=e.FileIndex[N]).content||(P=O.content.length)<4096||(O.start=E,R(P+511>>9));for(R(T[6]+7>>3);511&_.l;)_._W(-4,K.ENDOFCHAIN);for(N=E=D=0;N<e.FileIndex.length;++N)!(O=e.FileIndex[N]).content||!(P=O.content.length)||4096<=P||(O.start=E,R(P+63>>6));for(;511&_.l;)_._W(-4,K.ENDOFCHAIN);for(D=0;D<T[4]<<2;++D){var F=e.FullPaths[D];if(F&&0!==F.length){O=e.FileIndex[D],0===D&&(O.start=O.size?O.start-1:oe);F=0===D&&r.root||O.name;if(31<F.length&&(console.error("Name "+F+" will be truncated to "+F.slice(0,31)),F=F.slice(0,31)),P=2*(F.length+1),_._W(64,F,"utf16le"),_._W(2,P),_._W(1,O.type),_._W(1,O.color),_._W(-4,O.L),_._W(-4,O.R),_._W(-4,O.C),O.clsid)_._W(16,O.clsid,"hex");else for(N=0;N<4;++N)_._W(4,0);_._W(4,O.state||0),_._W(4,0),_._W(4,0),_._W(4,0),_._W(4,0),_._W(4,O.start),_._W(4,O.size),_._W(4,0)}else{for(N=0;N<17;++N)_._W(4,0);for(N=0;N<3;++N)_._W(4,-1);for(N=0;N<12;++N)_._W(4,0)}}for(D=1;D<e.FileIndex.length;++D)if(4096<=(O=e.FileIndex[D]).size)if(_.l=O.start+1<<9,ue&&Buffer.isBuffer(O.content))O.content.copy(_,_.l,0,O.size),_.l+=O.size+511&-512;else{for(N=0;N<O.size;++N)_._W(1,O.content[N]);for(;511&N;++N)_._W(1,0)}for(D=1;D<e.FileIndex.length;++D)if(0<(O=e.FileIndex[D]).size&&O.size<4096)if(ue&&Buffer.isBuffer(O.content))O.content.copy(_,_.l,0,O.size),_.l+=O.size+63&-64;else{for(N=0;N<O.size;++N)_._W(1,O.content[N]);for(;63&N;++N)_._W(1,0)}if(ue)_.l=_.length;else for(;_.l<_.length;)_._W(1,0);return _}e.version="1.2.2";var z,ne=64,oe=-2,ie="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],g="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:oe,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:g,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];for(var t,C="undefined"!=typeof Uint8Array,T=C?new Uint8Array(256):[],r=0;r<256;++r)T[r]=255&((t=139536&((t=r)<<1|t<<11)|558144&(t<<5|t<<15))>>16|t>>8|t);function _(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=5?0:e[1+t]<<8))>>>r&7}function N(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=3?0:e[1+t]<<8))>>>r&31}function P(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=1?0:e[1+t]<<8))>>>r&127}function f(e,t,r){var a=7&t,t=t>>>3,n=(1<<r)-1,o=e[t]>>>a;return r<8-a||(o|=e[1+t]<<8-a,r<16-a)||(o|=e[2+t]<<16-a,r<24-a)||(o|=e[3+t]<<24-a),o&n}function O(e,t,r){var a=7&t,n=t>>>3;return a<=5?e[n]|=(7&r)<<a:(e[n]|=r<<a&255,e[1+n]=(7&r)>>8-a),t+3}function I(e,t,r){var a=t>>>3;return e[a]|=255&(r<<=7&t),e[1+a]=r>>>=8,t+8}function F(e,t,r){var a=t>>>3;e[a]|=255&(r<<=7&t),e[1+a]=255&(r>>>=8),e[2+a]=r>>>8}function y(e,t){var r=e.length,a=t<2*r?2*r:t+5,n=0;if(!(t<=r)){if(ue){var o=ge(a);if(e.copy)e.copy(o);else for(;n<e.length;++n)o[n]=e[n];return o}if(C){var s=new Uint8Array(a);if(s.set)s.set(e);else for(;n<r;++n)s[n]=e[n];return s}e.length=a}return e}function D(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function E(e,t,r){for(var a,n=1,o=0,s=0,c=0,i=e.length,l=C?new Uint16Array(32):D(32),o=0;o<32;++o)l[o]=0;for(o=i;o<r;++o)e[o]=0;var i=e.length,u=C?new Uint16Array(i):D(i);for(o=0;o<i;++o)l[a=e[o]]++,n<a&&(n=a),u[o]=0;for(l[0]=0,o=1;o<=n;++o)l[o+16]=c=c+l[o-1]<<1;for(o=0;o<i;++o)0!=(c=e[o])&&(u[o]=l[c+16]++);var d,p,h,m;for(o=0;o<i;++o)if(0!=(d=e[o]))for(p=u[o],h=n,m=void 0,m=T[255&p],c=(h<=8?m>>>8-h:(m=m<<8|T[p>>8&255],h<=16?m>>>16-h:(m<<8|T[p>>16&255])>>>24-h))>>n-d,s=(1<<n+4-d)-1;0<=s;--s)t[c|s<<d]=15&d|o<<4;return n}var v=C?new Uint16Array(512):D(512),w=C?new Uint16Array(32):D(32);if(!C){for(var c=0;c<512;++c)v[c]=0;for(c=0;c<32;++c)w[c]=0}for(var u=[],i=0;i<32;i++)u.push(5);E(u,w,32);for(var l=[],i=0;i<=143;i++)l.push(8);for(;i<=255;i++)l.push(9);for(;i<=279;i++)l.push(7);for(;i<=287;i++)l.push(8);E(l,v,288);var d=function(){for(var b=C?new Uint8Array(32768):[],e=0,t=0;e<x.length-1;++e)for(;t<x[e+1];++t)b[t]=e;for(;t<32768;++t)b[t]=29;for(var S=C?new Uint8Array(259):[],e=0,t=0;e<k.length-1;++e)for(;t<k[e+1];++t)S[t]=e;return function(e,t){if(e.length<8){for(var r=e,a=t,n=0;n<r.length;){var o=Math.min(65535,r.length-n),s=n+o==r.length;for(a._W(1,+s),a._W(2,o),a._W(2,65535&~o);0<o--;)a[a.l++]=r[n++]}return a.l}for(var c,i=e,l=t,u=0,d=0,p=C?new Uint16Array(32768):[];d<i.length;){var h=Math.min(65535,i.length-d);if(h<10){for(7&(u=O(l,u,+!(d+h!=i.length)))&&(u+=8-(7&u)),l.l=u/8|0,l._W(2,h),l._W(2,65535&~h);0<h--;)l[l.l++]=i[d++];u=8*l.l}else{for(var u=O(l,u,+!(d+h!=i.length)+2),m=0;0<h--;){var g=i[d],m=32767&(m<<5^g),f=-1,y=0;if((f=p[m])&&(d<(f|=-32768&d)&&(f-=32768),f<d))for(;i[f+y]==i[d+y]&&y<250;)++y;if(2<y){(g=S[y])<=22?u=I(l,u,T[g+1]>>1)-1:(I(l,u,3),I(l,u+=5,T[g-23]>>5),u+=3);var v=g<8?0:g-4>>2,v=(0<v&&(F(l,u,y-k[g]),u+=v),g=b[d-f],u=I(l,u,T[g]>>3),u-=3,g<4?0:g-2>>1);0<v&&(F(l,u,d-f-x[g]),u+=v);for(var w=0;w<y;++w)p[m]=32767&d,m=32767&(m<<5^i[d]),++d;h-=y-1}else g<=143?g+=48:(v=1,l[(c=u)>>>3]|=v=(1&v)<<(7&c),u=c+1),u=I(l,u,T[g]),p[m]=32767&d,++d}u=I(l,u,0)-1}}return l.l=(u+7)/8|0,l.l}}();function X(e){var t=la(50+Math.floor(1.1*e.length)),e=d(e,t);return t.slice(0,e)}var q=C?new Uint16Array(32768):D(32768),M=C?new Uint16Array(32768):D(32768),L=C?new Uint16Array(128):D(128),B=1,U=1;function p(e,t){if(3==e[0]&&!(3&e[1]))return[me(t),2];for(var r=0,a=0,n=ge(t||1<<18),o=0,s=n.length>>>0,c=0,i=0;0==(1&a);)if(a=_(e,r),r+=3,a>>>1==0){7&r&&(r+=8-(7&r));var l=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,0<l)for(!t&&s<o+l&&(s=(n=y(n,o+l)).length);0<l--;)n[o++]=e[r>>>3],r+=8}else for(i=a>>1==1?(c=9,5):(r=function(e,t){for(var r,a,n,o=N(e,t)+257,s=N(e,t+=5)+1,c=(a=t+=5,n=7&t,4+(((r=e)[a=t>>>3]|(n<=4?0:r[1+a]<<8))>>>n&15)),i=(t+=4,0),l=C?new Uint8Array(19):D(19),u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=1,p=C?new Uint8Array(8):D(8),h=C?new Uint8Array(8):D(8),m=l.length,g=0;g<c;++g)l[R[g]]=i=_(e,t),d<i&&(d=i),p[i]++,t+=3;var f=0;for(p[0]=0,g=1;g<=d;++g)h[g]=f=f+p[g-1]<<1;for(g=0;g<m;++g)0!=(f=l[g])&&(u[g]=h[f]++);for(var y,g=0;g<m;++g)if(0!=(y=l[g]))for(var f=T[u[g]]>>8-y,v=(1<<7-y)-1;0<=v;--v)L[f|v<<y]=7&y|g<<3;for(var w,b,S,k=[],d=1;k.length<o+s;)switch(f=L[P(e,t)],t+=7&f,f>>>=3){case 16:for(i=3+(S=void 0,S=7&(b=t),((w=e)[b=t>>>3]|(S<=6?0:w[1+b]<<8))>>>S&3),t+=2,f=k[k.length-1];0<i--;)k.push(f);break;case 17:for(i=3+_(e,t),t+=3;0<i--;)k.push(0);break;case 18:for(i=11+P(e,t),t+=7;0<i--;)k.push(0);break;default:k.push(f),d<f&&(d=f)}var x=k.slice(0,o),I=k.slice(o);for(g=o;g<286;++g)x[g]=0;for(g=s;g<30;++g)I[g]=0;return B=E(x,q,286),U=E(I,M,30),t}(e,r),c=B,U);;){!t&&s<o+32767&&(s=(n=y(n,o+32767)).length);var u=f(e,r,c),d=(a>>>1==1?v:q)[u];if(r+=15&d,0==((d>>>=4)>>>8&255))n[o++]=d;else{if(256==d)break;var p=(d-=257)<8?0:d-4>>2,h=(5<p&&(p=0),o+k[d]),p=(0<p&&(h+=f(e,r,p),r+=p),u=f(e,r,i),r+=15&(d=(a>>>1==1?w:M)[u]),(d>>>=4)<4?0:d-2>>1),m=x[d];for(0<p&&(m+=f(e,r,p),r+=p),!t&&s<h&&(s=(n=y(n,h+100)).length);o<h;)n[o]=n[o-m],++o}}return t?[n,r+7>>>3]:[n.slice(0,o),r+7>>>3]}function j(e,t){t=p(e.slice(e.l||0),t);return e.l+=t[1],t[0]}function W(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function le(e,t){for(var r=e,a=(ia(r,0),{FileIndex:[],FullPaths:[]}),n=(ae(a,{root:t.root}),r.length-4);(80!=r[n]||75!=r[n+1]||5!=r[n+2]||6!=r[n+3])&&0<=n;)--n;r.l=n+4,r.l+=4;var o=r._R(2),e=(r.l+=6,r._R(4));for(r.l=e,n=0;n<o;++n){r.l+=20;var s=r._R(4),c=r._R(4),i=r._R(2),l=r._R(2),u=r._R(2),d=(r.l+=8,r._R(4)),p=A(r.slice(r.l+i,r.l+i+l)),i=(r.l+=i+l+u,r.l),h=(r.l=d+4,p&&p[1]&&((p[1]||{}).usz&&(c=p[1].usz),(p[1]||{}).csz)&&(s=p[1].csz),I=C=x=k=S=b=w=v=y=f=g=m=d=u=l=h=void 0,r),l=s,u=c,d=a,m=p,g=(h.l+=2,h._R(2)),f=h._R(2),y=function(e){var t=65535&e._R(2),e=65535&e._R(2),r=new Date,a=31&e,n=15&(e>>>=5),e=(e>>>=4,r.setMilliseconds(0),r.setFullYear(1980+e),r.setMonth(n-1),r.setDate(a),31&t),n=63&(t>>>=5);return r.setHours(t>>>=6),r.setMinutes(n),r.setSeconds(e<<1),r}(h);if(8257&g)throw new Error("Unsupported ZIP encryption");h._R(4);for(var v=h._R(4),w=h._R(4),b=h._R(2),S=h._R(2),k="",x=0;x<b;++x)k+=String.fromCharCode(h[h.l++]);S&&(((C=A(h.slice(h.l,h.l+S)))[21589]||{}).mt&&(y=C[21589].mt),(C[1]||{}).usz&&(w=C[1].usz),(C[1]||{}).csz&&(v=C[1].csz),m)&&((m[21589]||{}).mt&&(y=m[21589].mt),(m[1]||{}).usz&&(w=m[1].usz),(m[1]||{}).csz)&&(v=m[1].csz),h.l+=S;var I=h.slice(h.l,h.l+v);switch(f){case 8:I=function(e,t){var r,a;return z?(a=(r=new z.InflateRaw)._processChunk(e.slice(e.l),r._finishFlushFlag),e.l+=r.bytesRead,a):j(e,t)}(h,w);break;case 0:h.l+=v;break;default:throw new Error("Unsupported ZIP Compression method "+f)}var C=!1;8&g&&(134695760==h._R(4)&&(h._R(4),C=!0),v=h._R(4),w=h._R(4)),v!=l&&W(C,"Bad compressed size: "+l+" != "+v),w!=u&&W(C,"Bad uncompressed size: "+u+" != "+w),ce(d,k,I,{unsafe:!0,mt:y}),r.l=i}return a}var H={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ce(e,t,r,a){var n,o=a&&a.unsafe,s=(o||ae(e),!o&&J.find(e,t));return s||(n=e.FullPaths[0],n=t.slice(0,n.length)==n?t:("/"!=n.slice(-1)&&(n+="/"),(n+t).replace("//","/")),s={name:m(t),type:2},e.FileIndex.push(s),e.FullPaths.push(n),o)||J.utils.cfb_gc(e),s.content=r,s.size=r?r.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct)&&(s.ct=a.ct),s}return e.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),n=!1,o=(47===t.charCodeAt(0)?(n=!0,t=r[0].slice(0,-1)+t):n=-1!==t.indexOf("/"),t.toUpperCase()),s=(!0===n?r:a).indexOf(o);if(-1!==s)return e.FileIndex[s];var c=!o.match(we),o=o.replace(ve,"");for(c&&(o=o.replace(we,"!")),s=0;s<r.length;++s){if((c?r[s].replace(we,"!"):r[s]).replace(ve,"")==o)return e.FileIndex[s];if((c?a[s].replace(we,"!"):a[s]).replace(ve,"")==o)return e.FileIndex[s]}return null},e.read=function(e,t){var r,a=t&&t.type;switch(a||ue&&Buffer.isBuffer(e)&&(a="buffer"),a||"base64"){case"file":return r=t,o(),s(n.readFileSync(e),r);case"base64":return s(fe(pe(e)),t);case"binary":return s(fe(e),t)}return s(e,t)},e.parse=s,e.write=function(e,t){var r=a(e,t);switch(t&&t.type||"buffer"){case"file":return o(),n.writeFileSync(t.filename,r),r;case"binary":return"string"==typeof r?r:se(r);case"base64":return Q("string"==typeof r?r:se(r));case"buffer":if(ue)return Buffer.isBuffer(r)?r:he(r);case"array":return"string"==typeof r?fe(r):r}return r},e.writeFile=function(e,t,r){o(),e=a(e,r),n.writeFileSync(t,e)},e.utils={cfb_new:function(e){var t={};return ae(t,e),t},cfb_add:ce,cfb_del:function(e,t){ae(e);var r=J.find(e,t);if(r)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1},cfb_mov:function(e,t,r){ae(e);var a=J.find(e,t);if(a)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==a)return e.FileIndex[n].name=m(r),e.FullPaths[n]=r,!0;return!1},cfb_gc:function(e){G(e,!0)},ReadShift:ra,CheckField:ca,prep_blob:ia,bconcat:ye,use_zlib:function(e){try{var t=new e.InflateRaw;if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");z=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:X,_inflateRaw:j,consts:K},e}();function yt(e){if("string"==typeof e)return g(e);if(Array.isArray(e)){var t=e;if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}return e}function vt(e,t,r){if(void 0!==gt&&gt.writeFileSync)return r?gt.writeFileSync(e,t,r):gt.writeFileSync(e,t);if("undefined"!=typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=g(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a="utf8"==r?vr(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(a,e);if("undefined"!=typeof Blob){var n=new Blob([yt(a)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var n=document.createElement("a");if(null!=n.download)return n.download=e,n.href=o,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}else if("undefined"!=typeof URL&&!URL.createObjectURL&&"object"==typeof chrome)return n="data:application/octet-stream;base64,"+function(e){for(var t,r,a,n,o="",s=0,c=0,i=0;i<e.length;)a=(t=e[i++])>>2,n=(3&t)<<4|(t=e[i++])>>4,s=(15&t)<<2|(r=e[i++])>>6,c=63&r,isNaN(t)?s=c=64:isNaN(r)&&(c=64),o+=p.charAt(a)+p.charAt(n)+p.charAt(s)+p.charAt(c);return o}(new Uint8Array(yt(a))),chrome.downloads.download({url:n,filename:e,saveAs:!0})}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=A(t)),s.write(t),s.close(),t}catch(e){if(!e.message||-1==e.message.indexOf("onstruct"))throw e}throw new Error("cannot save file "+e)}function R(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function wt(e){for(var t=[],r=R(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function bt(e){for(var t=[],r=R(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}var St=Date.UTC(1899,11,30,0,0,0),kt=Date.UTC(1899,11,31,0,0,0),xt=Date.UTC(1904,0,1,0,0,0);function Z(e,t){e=(e.getTime()-St)/864e5;return t?(e-=1462)<-1402?e-1:e:e<60?e-1:e}function It(e){var t;return 60<=e&&e<61?e:((t=new Date).setTime(24*(60<e?e:e+1)*60*60*1e3+St),t)}var Ct=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,At=/^(\d+)-(\d+)-(\d+)$/,Tt=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function ee(e,t){var r;return e instanceof Date?e:(r=e.match(Ct))?new Date((t?xt:kt)+1e3*(60*(60*parseInt(r[1],10)+parseInt(r[2],10))+(r[3]?parseInt(r[3].slice(1),10):0))+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0)):(r=e.match(At))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0)):(r=e.match(Tt))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0)):new Date(e)}function _t(t,e){if(ue&&Buffer.isBuffer(t)){if(e&&h){if(255==t[0]&&254==t[1])return vr(t.slice(2).toString("utf16le"));if(254==t[1]&&255==t[2])return vr(s(t.slice(2).toString("binary")))}return t.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(e){if(255==t[0]&&254==t[1])return vr(new TextDecoder("utf-16le").decode(t.slice(2)));if(254==t[0]&&255==t[1])return vr(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"â‚¬":"Â€","â€š":"Â‚","Æ’":"Âƒ","â€":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰","Å ":"ÂŠ","â€¹":"Â‹","Å’":"ÂŒ","Å½":"Â","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™","Å¡":"Âš","â€º":"Â›","Å“":"Âœ","Å¾":"Â","Å¸":"ÂŸ"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[â‚¬â€šÆ’â€â€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(e){return r[e]||e})}catch(e){}var a=[],n=0;try{for(n=0;n<t.length-65536;n+=65536)a.push(String.fromCharCode.apply(0,t.slice(n,n+65536)));a.push(String.fromCharCode.apply(0,t.slice(n)))}catch(e){try{for(;n<t.length-16384;n+=16384)a.push(String.fromCharCode.apply(0,t.slice(n,n+16384)));a.push(String.fromCharCode.apply(0,t.slice(n)))}catch(e){for(;n!=t.length;++n)a.push(String.fromCharCode(t[n]))}}return a.join("")}function te(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t,r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=te(e[t]));return r}function S(e,t){for(var r="";r.length<t;)r+=e;return r}function Dt(e){var r,t=Number(e);return isNaN(t)?!/\d/.test(e)||(r=1,e=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""}),isNaN(t=Number(e))&&(e=e.replace(/[(]([^()]*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(e))))?t:t/r:isFinite(t)?t:NaN}var Et=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,Rt=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,Nt=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,Pt=-177984e5==new Date("6/9/69 00:00 UTC").valueOf();var Ot=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ft(e){if(Nt.test(e))return-1==e.indexOf("Z")?Mt(new Date(e)):new Date(e);var t,r=e.toLowerCase(),a=r.replace(/\s+/g," ").trim(),n=a.match(Et);if(n)return(t=n)[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1]%12+("p"==t[7]?12:0),+t[2],+t[4],1e3*parseFloat(t[3]))):new Date(Date.UTC(1899,11,31,"p"==t[7]?12:0,+t[1],+t[2],1e3*parseFloat(t[3]))):t[5]?new Date(Date.UTC(1899,11,31,+t[1]%12+("p"==t[7]?12:0),+t[2],+t[5],t[6]?1e3*parseFloat(t[6]):0)):new Date(Date.UTC(1899,11,31,+t[1]%12+("p"==t[7]?12:0),+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1]%12+("p"==t[7]?12:0),0,0,0));if(n=a.match(Rt))return(t=n)[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[4],1e3*parseFloat(t[3]))):new Date(Date.UTC(1899,11,31,0,+t[1],+t[2],1e3*parseFloat(t[3]))):t[5]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[5],t[6]?1e3*parseFloat(t[6]):0)):new Date(Date.UTC(1899,11,31,+t[1],+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1],0,0,0));if(n=a.match(Tt))return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(Pt&&-1==e.indexOf("UTC")?e+" UTC":e),n=new Date(NaN),o=a.getYear(),s=(a.getMonth(),a.getDate());if(isNaN(s))return n;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&-1==Ot.indexOf(r))return n}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return n;return o<0||8099<o||e.match(/[^-0-9:,\/\\\ ]/)?n:a}"abacaba".split(/(:?b)/i).length;function qt(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function Mt(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function Lt(e){var t,r=e.slice(0,1024).indexOf("<!DOCTYPE");return-1!=r&&(t=e.match(/<[\w]/))?e.slice(0,r)+e.slice(t.index):e}function Bt(e,t,r){for(var a=[],n=e.indexOf(t);-1<n;){var o=e.indexOf(r,n+t.length);if(-1==o)break;a.push(e.slice(n,o+r.length)),n=e.indexOf(t,o+r.length)}return 0<a.length?a:null}function Ut(e,t,r){var a=[],n=0,o=e.indexOf(t);if(-1==o)return e;for(;-1<o;){a.push(e.slice(n,o));var s=e.indexOf(r,o+t.length);if(-1==s)break;-1==(o=e.indexOf(t,n=s+r.length))&&a.push(e.slice(n))}return a.join("")}var jt={" ":1,"\t":1,"\r":1,"\n":1,">":1};function Wt(e,t){for(var r,a,n,o=e.indexOf("<"+t),s=t.length+1,c=e.length;0<=o&&o<=c-s&&!jt[e.charAt(o+s)];)o=e.indexOf("<"+t,o+1);return-1===o||-1===(r=e.indexOf(">",o+t.length))||-1==(n=e.indexOf(a="</"+t+">",r))?null:[e.slice(o,n+a.length),e.slice(r+1,n)]}$t={};var $t,Gt,zt,G=function(e,t){var r,a,n=$t[t],t=(n||($t[t]=n=[new RegExp("<(?:\\w+:)?"+t+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+t+">","g")]),n[0].lastIndex=n[1].lastIndex=0,n[0].exec(e));return t&&(r=t.index,a=n[0].lastIndex,n[1].lastIndex=n[0].lastIndex,t=n[1].exec(e))?(t=t.index,n=n[1].lastIndex,[e.slice(r,n),e.slice(a,t)]):null},Kt=(Gt={},function(e,t){var r=[],a=Gt[t];for(a||(Gt[t]=a=[new RegExp("<(?:\\w+:)?"+t+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+t+">","g")]),a[0].lastIndex=a[1].lastIndex=0;n=a[0].exec(e);){var n=n.index;if(a[1].lastIndex=a[0].lastIndex,!a[1].exec(e))return null;var o=a[1].lastIndex;r.push(e.slice(n,o)),a[0].lastIndex=a[1].lastIndex}return 0==r.length?null:r}),Ht=(zt={},function(e,t){for(var r,a=[],n=zt[t],o=(n||(zt[t]=n=[new RegExp("<(?:\\w+:)?"+t+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+t+">","g")]),n[0].lastIndex=n[1].lastIndex=0,0);r=n[0].exec(e);){if(r=r.index,a.push(e.slice(o,r)),o=r,n[1].lastIndex=n[0].lastIndex,!n[1].exec(e))return null;o=n[1].lastIndex,n[0].lastIndex=n[1].lastIndex}return a.push(e.slice(o)),0==a.length?"":a.join("")});function Vt(e){return e?e.content&&e.type?_t(e.content,!0):e.data?i(e.data):e.asNodeBuffer&&ue?i(e.asNodeBuffer().toString("binary")):e.asBinary?i(e.asBinary()):e._data&&e._data.getContent?i(_t(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Xt(e){var t;return e?e.data?n(e.data):e.asNodeBuffer&&ue?e.asNodeBuffer():e._data&&e._data.getContent?"string"==typeof(t=e._data.getContent())?n(t):Array.prototype.slice.call(t):e.content&&e.type?e.content:null:null}function Jt(e,t){for(var r=e.FullPaths||R(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),o=0;o<r.length;++o){var s=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function Yt(e,t){e=Jt(e,t);if(null==e)throw new Error("Cannot find file "+t+" in zip");return e}function M(e,t,r){if(!r)return((r=Yt(e,t))&&".bin"===r.name.slice(-4)?Xt:Vt)(r);if(!t)return null;try{return M(e,t)}catch(e){return null}}function Qt(e,t,r){if(!r)return Vt(Yt(e,t));if(!t)return null;try{return Qt(e,t)}catch(e){return null}}function Zt(e){for(var t=e.FullPaths||R(e.files),r=[],a=0;a<t.length;++a)"/"!=t[a].slice(-1)&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function L(e,t,r){if(e.FullPaths){var a;if("string"==typeof(r=Array.isArray(r)&&"string"==typeof r[0]?r.join(""):r))return a=(ue?he:function(e){for(var t=[],r=0,a=e.length+250,n=me(e.length+255),o=0;o<e.length;++o){var s,c=e.charCodeAt(o);c<128?n[r++]=c:c<2048?(n[r++]=192|c>>6&31,n[r++]=128|63&c):55296<=c&&c<57344?(c=64+(1023&c),s=1023&e.charCodeAt(++o),n[r++]=240|c>>8&7,n[r++]=128|c>>2&63,n[r++]=128|s>>6&15|(3&c)<<4,n[r++]=128|63&s):(n[r++]=224|c>>12&15,n[r++]=128|c>>6&63,n[r++]=128|63&c),a<r&&(t.push(n.slice(0,r)),r=0,n=me(65535),a=65530)}return t.push(n.slice(0,r)),ye(t)})(r),J.utils.cfb_add(e,t,a);J.utils.cfb_add(e,t,r)}else e.file(t,r)}function er(){return J.utils.cfb_new()}function tr(e,t){if("/"==e.charAt(0))return e.slice(1);for(var r=t.split("/"),a=("/"!=t.slice(-1)&&r.pop(),e.split("/"));0!==a.length;){var n=a.shift();".."===n?r.pop():"."!==n&&r.push(n)}return r.join("/")}var k='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',rr=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,t=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/gm,B=k.match(t)?t:/<[^<>]*>/g,ar=/<\w*:/,nr=/<(\/?)\w+:/;function re(e,t,r){for(var a={},n=0,o=0;n!==e.length&&32!==(o=e.charCodeAt(n))&&10!==o&&13!==o;++n);if(t||(a[0]=e.slice(0,n)),n!==e.length){var s,c,i=e.match(rr),l=0,u=0,d="",p="";if(i)for(u=0;u!=i.length;++u){for(p=i[u].slice(1),o=0;o!=p.length&&61!==p.charCodeAt(o);++o);for(d=p.slice(0,o).trim();32==p.charCodeAt(o+1);)++o;for(s=34==(n=p.charCodeAt(o+1))||39==n?1:0,s=p.slice(o+1+s,p.length-s),l=0;l!=d.length&&58!==d.charCodeAt(l);++l);l===d.length?(a[d=0<d.indexOf("_")?d.slice(0,d.indexOf("_")):d]=s,r||(a[d.toLowerCase()]=s)):a[c=(5===l&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(l+1)]&&"ext"==d.slice(l-3,l)||(a[c]=s,r)||(a[c.toLowerCase()]=s)}}return a}function or(e){return e.replace(nr,"<$1")}var sr,cr,ir={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lr=wt(ir),ae=(sr=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,cr=/_x([\da-fA-F]{4})_/gi,function(e,t){e=function e(t){var r,t=t+"",a=t.indexOf("<![CDATA[");return-1==a?t.replace(sr,function(e,t){return ir[e]||String.fromCharCode(parseInt(t,-1<e.indexOf("x")?16:10))||e}).replace(cr,function(e,t){return String.fromCharCode(parseInt(t,16))}):(r=t.indexOf("]]>"),e(t.slice(0,a))+t.slice(a+9,r)+e(t.slice(r+3)))}(e);return t?e.replace(/\r\n/g,"\n"):e}),ur=/[&<>'"]/g,dr=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function I(e){return(e+"").replace(ur,function(e){return lr[e]}).replace(dr,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}var pr=/[\u0000-\u001f]/g;function hr(e){return(e+"").replace(ur,function(e){return lr[e]}).replace(/\n/g,"<br/>").replace(pr,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function ne(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function mr(e){for(var t,r,a,n="",o=0,s=0;o<e.length;)(a=e.charCodeAt(o++))<128?n+=String.fromCharCode(a):(t=e.charCodeAt(o++),191<a&&a<224?(s=(31&a)<<6,s|=63&t,n+=String.fromCharCode(s)):(r=e.charCodeAt(o++),a<240?n+=String.fromCharCode((15&a)<<12|(63&t)<<6|63&r):(a=((7&a)<<18|(63&t)<<12|(63&r)<<6|63&(s=e.charCodeAt(o++)))-65536,n=(n+=String.fromCharCode(55296+(a>>>10&1023)))+String.fromCharCode(56320+(1023&a)))));return n}function gr(e){for(var t,r,a=me(2*e.length),n=1,o=0,s=0,c=0;c<e.length;c+=n)n=1,(r=e.charCodeAt(c))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(c+1)),n=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(c+1))+(63&e.charCodeAt(c+2)),n=3):(n=4,t=262144*(7&r)+4096*(63&e.charCodeAt(c+1))+64*(63&e.charCodeAt(c+2))+(63&e.charCodeAt(c+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(a[o++]=255&s,a[o++]=s>>>8,s=0),a[o++]=t%256,a[o++]=t>>>8;return a.slice(0,o).toString("ucs2")}function fr(e){return he(e,"binary").toString("utf8")}var yr,t="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",z=ue&&(fr(t)==mr(t)?fr:gr(t)==mr(t)&&gr)||mr,vr=ue?function(e){return he(e,"utf8").toString("binary")}:function(e){for(var t,r=[],a=0,n=0;a<e.length;)switch(!0){case(n=e.charCodeAt(a++))<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(63&n)));break;case 55296<=n&&n<57344:n-=55296,t=e.charCodeAt(a++)-56320+(n<<10),r.push(String.fromCharCode(240+(t>>18&7))),r.push(String.fromCharCode(144+(t>>12&63))),r.push(String.fromCharCode(128+(t>>6&63))),r.push(String.fromCharCode(128+(63&t)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(63&n)))}return r.join("")},wr=(yr=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^<>]*>/g,""),r=0;r<yr.length;++r)t=t.replace(yr[r][0],yr[r][1]);return t}),br=/<\/?(?:vt:)?variant>/g,Sr=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function kr(e,t){var r=re(e),e=Kt(e,r.baseType)||[],a=[];if(e.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+e.length+" != "+r.size)}else e.forEach(function(e){e=e.replace(br,"").match(Sr);e&&a.push({v:z(e[2]),t:e[1]})});return a}var xr=/(^\s|\s$|\n)/;function Ir(e,t){return"<"+e+(t.match(xr)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cr(t){return R(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function C(e,t,r){return"<"+e+(null!=r?Cr(r):"")+(null!=t?(t.match(xr)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ar(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Tr(e){if(ue&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return z(A(f(e)));throw new Error("Bad input format: expected Buffer or string")}var oe=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/gm,U={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_r=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Dr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Er(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,n=e[0][r].length;a<n;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t}function Rr(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Qr(e,n)));return a.join("").replace(ve,"")}function Nr(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")}function Pr(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Yr(e,n)));return a.join("")}function Or(e,t){var r=Y(e,t);return 0<r?$r(e,t+4,t+4+r-1):""}function Fr(e,t){var r=Y(e,t);return 0<r?$r(e,t+4,t+4+r-1):""}function qr(e,t){var r=2*Y(e,t);return 0<r?$r(e,t+4,t+4+r-1):""}function Mr(e,t){var r=Y(e,t);return 0<r?jr(e,t+4,t+4+r):""}function Lr(e,t){var r=Y(e,t);return 0<r?$r(e,t+4,t+4+r):""}function Br(e,t){for(var r=e,a=t,e=1-2*(r[a+7]>>>7),t=((127&r[a+7])<<4)+(r[a+6]>>>4&15),n=15&r[a+6],o=5;0<=o;--o)n=256*n+r[a+o];return 2047==t?0==n?1/0*e:NaN:(0==t?t=-1022:(t-=1023,n+=Math.pow(2,52)),e*Math.pow(2,t-52)*n)}var Ur=ue?function(e){return 0<e[0].length&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:he(e)})):Er(e)}:Er,jr=ue?function(e,t,r){return Buffer.isBuffer(e)&&h?e.toString("utf16le",t,r).replace(ve,""):Rr(e,t,r)}:Rr,Wr=ue?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Nr(e,t,r)}:Nr,$r=ue?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Pr(e,t,r)}:Pr,Gr=Or,zr=Fr,Kr=qr,Hr=Mr,Vr=Lr,Xr=Br;function Jr(){jr=function(e,t,r){return q.utils.decode(1200,e.slice(t,r)).replace(ve,"")},$r=function(e,t,r){return q.utils.decode(65001,e.slice(t,r))},Gr=function(e,t){var r=Y(e,t);return 0<r?q.utils.decode(E,e.slice(t+4,t+4+r-1)):""},zr=function(e,t){var r=Y(e,t);return 0<r?q.utils.decode(_,e.slice(t+4,t+4+r-1)):""},Kr=function(e,t){var r=2*Y(e,t);return 0<r?q.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Hr=function(e,t){var r=Y(e,t);return 0<r?q.utils.decode(1200,e.slice(t+4,t+4+r)):""},Vr=function(e,t){var r=Y(e,t);return 0<r?q.utils.decode(65001,e.slice(t+4,t+4+r)):""}}ue&&(Gr=function(e,t){var r;return Buffer.isBuffer(e)?0<(r=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+r-1):"":Or(e,t)},zr=function(e,t){var r;return Buffer.isBuffer(e)?0<(r=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+r-1):"":Fr(e,t)},Kr=function(e,t){var r;return Buffer.isBuffer(e)&&h?(r=2*e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+r-1)):qr(e,t)},Hr=function(e,t){var r;return Buffer.isBuffer(e)&&h?(r=e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+r)):Mr(e,t)},Vr=function(e,t){var r;return Buffer.isBuffer(e)?(r=e.readUInt32LE(t),e.toString("utf8",t+4,t+4+r)):Lr(e,t)},Xr=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Br(e,t)}),void 0!==q&&Jr();var Yr=function(e,t){return e[t]},Qr=function(e,t){return 256*e[t+1]+e[t]},Zr=function(e,t){e=256*e[t+1]+e[t];return e<32768?e:-1*(65535-e+1)},Y=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ea=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ta=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ra(e,t){var r,a,n,o,s,c,i="",l=[];switch(t){case"dbcs":if(c=this.l,ue&&Buffer.isBuffer(this)&&h)i=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)i+=String.fromCharCode(Qr(this,c)),c+=2;e*=2;break;case"utf8":i=$r(this,this.l,this.l+e);break;case"utf16le":i=jr(this,this.l,this.l+(e*=2));break;case"wstr":if(void 0===q)return ra.call(this,e,"dbcs");i=q.utils.decode(_,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":i=Gr(this,this.l),e=4+Y(this,this.l);break;case"lpstr-cp":i=zr(this,this.l),e=4+Y(this,this.l);break;case"lpwstr":i=Kr(this,this.l),e=4+2*Y(this,this.l);break;case"lpp4":e=4+Y(this,this.l),i=Hr(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Y(this,this.l),i=Vr(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,i="";0!==(n=Yr(this,this.l+e++));)l.push(u(n));i=l.join("");break;case"_wstr":for(e=0,i="";0!==(n=Qr(this,this.l+e));)l.push(u(n)),e+=2;e+=2,i=l.join("");break;case"dbcs-cont":for(i="",c=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(c))return n=Yr(this,c),this.l=c+1,o=ra.call(this,e-s,n?"dbcs-cont":"sbcs-cont"),l.join("")+o;l.push(u(Qr(this,c))),c+=2}i=l.join(""),e*=2;break;case"cpstr":if(void 0!==q){i=q.utils.decode(_,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(i="",c=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(c))return n=Yr(this,c),this.l=c+1,o=ra.call(this,e-s,n?"dbcs-cont":"sbcs-cont"),l.join("")+o;l.push(u(Yr(this,c))),c+=1}i=l.join("");break;default:switch(e){case 1:return r=Yr(this,this.l),this.l++,r;case 2:return r=("i"===t?Zr:Qr)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(r=(0<e?ea:ta)(this,this.l),this.l+=4,r):(a=Y(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return a=8==e?Xr(this,this.l):Xr([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:i=Wr(this,this.l,e)}}return this.l+=e,i}var aa=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},na=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},oa=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function sa(e,t,r){var a=0,n=0;if("dbcs"===r){for(n=0;n!=t.length;++n)oa(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if("sbcs"===r||"cpstr"==r)if(void 0!==q&&874==E){for(n=0;n!=t.length;++n){var o=q.utils.encode(E,t.charAt(n));this[this.l+n]=o[0]}a=t.length}else if(void 0!==q&&"cpstr"==r){if((o=q.utils.encode(_,t)).length==t.length)for(n=0;n<t.length;++n)0==o[n]&&0!=t.charCodeAt(n)&&(o[n]=95);if(o.length==2*t.length)for(n=0;n<t.length;++n)0==o[2*n]&&0==o[2*n+1]&&0!=t.charCodeAt(n)&&(o[2*n]=95);for(n=0;n<o.length;++n)this[this.l+n]=o[n];a=o.length}else{for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);a=t.length}else{if("hex"===r){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===r){for(var s=Math.min(this.l+e,this.length),n=0;n<Math.min(t.length,e);++n){var c=t.charCodeAt(n);this[this.l++]=255&c,this[this.l++]=c>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8);break;case 3:a=3,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8),this[this.l+2]=255&(t>>>=8);break;case 4:a=4,aa(this,t,this.l);break;case 8:if(a=8,"f"===r){var i=this,l=t,u=this.l,d=(l<0||1/l==-1/0?1:0)<<7,p=0,h=0,m=d?-l:l;isFinite(m)?0==m?p=h=0:(p=Math.floor(Math.log(m)/Math.LN2),h=m*Math.pow(2,52-p),p<=-1023&&(!isFinite(h)||h<Math.pow(2,52))?p=-1022:(h-=Math.pow(2,52),p+=1023)):(p=2047,h=isNaN(l)?26985:0);for(var g=0;g<=5;++g,h/=256)i[u+g]=255&h;i[u+6]=(15&p)<<4|15&h,i[u+7]=p>>4|d;break}case 16:break;case-4:a=4,na(this,t,this.l)}}return this.l+=a,this}function ca(e,t){var r=Wr(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ia(e,t){e.l=t,e._R=ra,e.chk=ca,e._W=sa}function la(e){e=me(e);return ia(e,0),e}function ua(){function t(e){return ia(e=la(e),0),e}function r(){o&&(o.l&&(o.length>o.l&&((o=o.slice(0,o.l)).l=o.length),0<o.length)&&e.push(o),o=null)}function a(e){return o&&e<o.length-o.l?o:(r(),o=t(Math.max(e+1,n)))}var e=[],n=ue?16384:2048,o=(ue&&la(n).copy,t(n));return{next:a,push:function(e){r(),null==(o=e).l&&(o.l=o.length),a(n)},end:function(){return r(),ye(e)},_bufs:e,end2:function(){return r(),e}}}function da(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function se(e){return""+(e+1)}function pa(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function ce(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function K(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);48<=n&&n<=57?t=10*t+(n-48):65<=n&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function ie(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ha(e){var t=e.indexOf(":");return-1==t?{s:K(e),e:K(e)}:{s:K(e.slice(0,t)),e:K(e.slice(t+1))}}function le(e,t){return void 0===t||"number"==typeof t?le(e.s,e.e):(e="string"!=typeof e?ie(e):e)==(t="string"!=typeof t?ie(t):t)?e:e+":"+t}function ma(e){e=ha(e);return"$"+ce(e.s.c)+"$"+se(e.s.r)+":$"+ce(e.e.c)+"$"+se(e.e.r)}function ga(e,t){if(e||t&&t.biff<=5&&2<=t.biff)return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e;throw new Error("empty sheet name")}function H(e){for(var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,o=e.length,r=0;a<o&&!((n=e.charCodeAt(a)-64)<1||26<n);++a)r=26*r+n;for(t.s.c=--r,r=0;a<o&&!((n=e.charCodeAt(a)-48)<0||9<n);++a)r=10*r+n;if(t.s.r=--r,a===o||10!=n)t.e.c=t.s.c,t.e.r=t.s.r;else{for(++a,r=0;a!=o&&!((n=e.charCodeAt(a)-64)<1||26<n);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=o&&!((n=e.charCodeAt(a)-48)<0||9<n);++a)r=10*r+n;t.e.r=--r}return t}function fa(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Ge(e.z,r?Z(t):t)}catch(e){}try{return e.w=Ge((e.XF||{}).numFmtId||(r?14:0),r?Z(t):t)}catch(e){return""+t}}function ya(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?ka[e.v]||e.v:fa(e,null==t?e.v:t))}function va(e,t){var t=t&&t.sheet?t.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function wa(e,t,r){for(var a=r||{},n=e?null!=e["!data"]:a.dense,o=(null!=de&&null==n&&(n=de),e||(n?{"!data":[]}:{})),s=(n&&!o["!data"]&&(o["!data"]=[]),0),c=0,i=(o&&null!=a.origin&&("number"==typeof a.origin?s=a.origin:(s=(r="string"==typeof a.origin?K(a.origin):a.origin).r,c=r.c)),{s:{c:1e7,r:1e7},e:{c:0,r:0}}),l=(o["!ref"]?(e=H(o["!ref"]),i.s.c=e.s.c,i.s.r=e.s.r,i.e.c=Math.max(i.e.c,e.e.c),i.e.r=Math.max(i.e.r,e.e.r),-1==s&&(i.e.r=s=o["!ref"]?e.e.r+1:0)):i.s.c=i.e.c=i.s.r=i.e.r=0,[]),u=!1,d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=s+d,h=(n&&(o["!data"][p]||(o["!data"][p]=[]),l=o["!data"][p]),t[d]),m=0;m!=h.length;++m)if(void 0!==h[m]){var g={v:h[m],t:""},f=c+m;if(i.s.r>p&&(i.s.r=p),i.s.c>f&&(i.s.c=f),i.e.r<p&&(i.e.r=p),i.e.c<f&&(i.e.c=f),u=!0,!h[m]||"object"!=typeof h[m]||Array.isArray(h[m])||h[m]instanceof Date)if(Array.isArray(g.v)&&(g.f=h[m][1],g.v=g.v[0]),null===g.v)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else{if(!a.sheetStubs)continue;g.t="z"}else"number"==typeof g.v?isFinite(g.v)?g.t="n":isNaN(g.v)?(g.t="e",g.v=15):(g.t="e",g.v=7):"boolean"==typeof g.v?g.t="b":g.v instanceof Date?(g.z=a.dateNF||W[14],a.UTC||(g.v=Mt(g.v)),a.cellDates?(g.t="d",g.w=Ge(g.z,Z(g.v,a.date1904))):(g.t="n",g.v=Z(g.v,a.date1904),g.w=Ge(g.z,g.v))):g.t="s";else g=h[m];n?(l[f]&&l[f].z&&(g.z=l[f].z),l[f]=g):(o[f=ce(f)+(p+1)]&&o[f].z&&(g.z=o[f].z),o[f]=g)}}return u&&i.s.c<104e5&&(o["!ref"]=le(i)),o}function ba(e,t){return wa(null,e,t)}var Sa=te([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),ka={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xa={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ia={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ca={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Aa(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ta(r,a,e){function t(e){r[e]&&0<r[e].length&&(s=r[e][0],i[i.length]=C("Override",null,{PartName:("/"==s[0]?"":"/")+s,ContentType:Ca[e][a.bookType]||Ca[e].xlsx}))}function n(t){(r[t]||[]).forEach(function(e){i[i.length]=C("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Ca[t][a.bookType]||Ca[t].xlsx})})}function o(t){(r[t]||[]).forEach(function(e){i[i.length]=C("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:c[t][0]})})}var s,c=function(e){for(var t=[],r=R(e),a=0;a!==r.length;++a)null==t[e[r[a]]]&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}(Ia),i=[];e||(i[i.length]=k,i[i.length]=C("Types",null,{xmlns:U.CT,"xmlns:xsd":U.xsd,"xmlns:xsi":U.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return C("Default",null,{Extension:e[0],ContentType:e[1]})})));return t("workbooks"),n("sheets"),n("charts"),o("themes"),["strs","styles"].forEach(t),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),n("metadata"),o("people"),!e&&2<i.length&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var D={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function _a(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Da(e,a){var n,o={"!id":{}};return e&&("/"!==a.charAt(0)&&(a="/"+a),n={},(e.match(B)||[]).forEach(function(e){var t,r,e=re(e);"<Relationship"===e[0]&&((t={}).Type=e.Type,t.Target=ae(e.Target),t.Id=e.Id,e.TargetMode&&(t.TargetMode=e.TargetMode),r="External"===e.TargetMode?e.Target:tr(e.Target,a),o[r]=t,n[e.Id]=t)}),o["!id"]=n),o}function Ea(t){var r=[k,C("Relationships",null,{xmlns:U.RELS})];return R(t["!id"]).forEach(function(e){r[r.length]=C("Relationship",null,t["!id"][e])}),2<r.length&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function x(e,t,r,a,n,o){if(n=n||{},e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,o?n.TargetMode=o:-1<[D.HLINK,D.XPATH,D.XMISS].indexOf(n.Type)&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var Ra="application/vnd.oasis.opendocument.spreadsheet";function Na(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Pa(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+e.version+"</meta:generator></office:meta></office:document-meta>"}var Oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Fa(e){var t={};e=z(e);for(var r=0;r<Oa.length;++r){var a=Oa[r],n=Wt(e,a[0]);null!=n&&0<n.length&&(t[a[1]]=ae(n[1])),"date"===a[2]&&t[a[1]]&&(t[a[1]]=ee(t[a[1]]))}return t}function qa(e,t,r,a,n){null==n[e]&&null!=t&&""!==t&&(t=I(n[e]=t),a[a.length]=r?C(e,t,r):Ir(e,t))}function Ma(e,t){var r=t||{},a=[k,C("cp:coreProperties",null,{"xmlns:cp":U.CORE_PROPS,"xmlns:dc":U.dc,"xmlns:dcterms":U.dcterms,"xmlns:dcmitype":U.dcmitype,"xmlns:xsi":U.xsi})],n={};if(e||r.Props){e&&(null!=e.CreatedDate&&qa("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:Ar(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),null!=e.ModifiedDate)&&qa("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:Ar(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n);for(var o=0;o!=Oa.length;++o){var s=Oa[o],c=r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e?e[s[1]]:null;!0===c?c="1":!1===c?c="0":"number"==typeof c&&(c=String(c)),null!=c&&qa(s[0],c,null,a,n)}2<a.length&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">"))}return a.join("")}var La=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Ba(a,n,e){var o={};if(n=n||{},a=z(a),La.forEach(function(e){var t=(G(a,e[0])||[])[1];switch(e[2]){case"string":t&&(n[e[1]]=ae(t));break;case"bool":n[e[1]]="true"===t;break;case"raw":var r=Wt(a,e[0]);r&&0<r.length&&(o[e[1]]=r[1])}}),o.HeadingPairs&&o.TitlesOfParts){var t=o.HeadingPairs,r=o.TitlesOfParts,s=n,c=[];if("string"==typeof t)c=kr(t,e);else for(var i=0;i<t.length;++i)c=c.concat(t[i].map(function(e){return{v:e}}));var l,u="string"==typeof r?kr(r,e).map(function(e){return e.v}):r,d=0;if(0<u.length)for(var p=0;p!==c.length;p+=2){switch(l=+c[p+1].v,c[p].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ğ›Ğ¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":s.Worksheets=l,s.SheetNames=u.slice(d,d+l);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":s.NamedRanges=l,s.DefinedNames=u.slice(d,d+l);break;case"Charts":case"Diagramme":s.Chartsheets=l,s.ChartNames=u.slice(d,d+l)}d+=l}}}function Ua(r){var a=[],n=C;return(r=r||{}).Application="SheetJS",a[a.length]=k,a[a.length]=C("Properties",null,{xmlns:U.EXT_PROPS,"xmlns:vt":U.vt}),La.forEach(function(e){if(void 0!==r[e[1]]){var t;switch(e[2]){case"string":t=I(String(r[e[1]]));break;case"bool":t=r[e[1]]?"true":"false"}void 0!==t&&(a[a.length]=n(e[0],t))}}),a[a.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=n("TitlesOfParts",n("vt:vector",r.SheetNames.map(function(e){return"<vt:lpstr>"+I(e)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),2<a.length&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var ja=/<[^<>]+>[^<]*/g;function Wa(t){var r,a=[k,C("Properties",null,{xmlns:U.CUST_PROPS,"xmlns:vt":U.vt})];return t&&(r=1,R(t).forEach(function(e){++r,a[a.length]=C("property",function(e,t){switch(typeof e){case"string":var r=C("vt:lpwstr",I(e));return r=t?r.replace(/&quot;/g,"_x0022_"):r;case"number":return C((0|e)==e?"vt:i4":"vt:r8",I(String(e)));case"boolean":return C("vt:bool",e?"true":"false")}if(e instanceof Date)return C("vt:filetime",Ar(e));throw new Error("Unable to serialize "+e)}(t[e],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:I(e)})}),2<a.length)&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var $a,Ga,za,Ka=[2,3,48,49,131,139,140,245],Ha=($a={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Ga=wt({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),za={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(e,t){try{var r=va(Va(e,t),t);return r.bookType="dbf",r}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:Va,from_sheet:function(e,t){if(!e["!ref"])throw new Error("Cannot export empty sheet to DBF");var r=_;if(0<=+(t=t||{}).codepage&&j(+t.codepage),"string"==t.type)throw new Error("Cannot write DBF to JS string");for(var a=ua(),n=(k=$s(e,{header:1,raw:!0,cellDates:!0}))[0],o=k.slice(1),s=e["!cols"]||[],c=0,i=0,l=0,u=1,c=0;c<n.length;++c)if(((s[c]||{}).DBF||{}).name)n[c]=s[c].DBF.name,++l;else if(null!=n[c]){if(++l,"number"==typeof n[c]&&(n[c]=n[c].toString(10)),"string"!=typeof n[c])throw new Error("DBF Invalid column name "+n[c]+" |"+typeof n[c]+"|");if(n.indexOf(n[c])!==c)for(i=0;i<1024;++i)if(-1==n.indexOf(n[c]+"_"+i)){n[c]+="_"+i;break}}var d=H(e["!ref"]),p=[],h=[],m=[];for(c=0;c<=d.e.c-d.s.c;++c){for(var g="",f="",y=0,v=[],i=0;i<o.length;++i)null!=o[i][c]&&v.push(o[i][c]);if(0==v.length||null==n[c])p[c]="?";else{for(i=0;i<v.length;++i){switch(typeof v[i]){case"number":f="B";break;case"string":f="C";break;case"boolean":f="L";break;case"object":f=v[i]instanceof Date?"D":"C";break;default:f="C"}y=Math.max(y,(void 0!==q&&"string"==typeof v[i]?q.utils.encode(E,v[i]):String(v[i])).length),g=g&&g!=f?"C":f}250<y&&(y=250),"C"==(f=((s[c]||{}).DBF||{}).type)&&s[c].DBF.len>y&&(y=s[c].DBF.len),"B"==g&&"N"==f&&(g="N",m[c]=s[c].DBF.dec,y=s[c].DBF.len),h[c]="C"==g||"N"==f?y:za[g]||0,u+=h[c],p[c]=g}}var w=a.next(32);for(w._W(4,318902576),w._W(4,o.length),w._W(2,296+32*l),w._W(2,u),c=0;c<4;++c)w._W(4,0);var b,S,k=+Ga[_]||3;for(w._W(4,0|k<<8),$a[k]!=+t.codepage&&(t.codepage&&console.error("DBF Unsupported codepage "+_+", using 1252"),_=1252),i=c=0;c<n.length;++c)null!=n[c]&&(b=a.next(32),S=(n[c].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),b._W(1,S,"sbcs"),b._W(1,"?"==p[c]?"C":p[c],"sbcs"),b._W(4,i),b._W(1,h[c]||za[p[c]]||0),b._W(1,m[c]||0),b._W(1,2),b._W(4,0),b._W(1,0),b._W(4,0),b._W(4,0),i+=h[c]||za[p[c]]||0);var x=a.next(264);for(x._W(4,13),c=0;c<65;++c)x._W(4,0);for(c=0;c<o.length;++c){var I=a.next(u);for(I._W(1,0),i=0;i<n.length;++i)if(null!=n[i])switch(p[i]){case"L":I._W(1,null==o[c][i]?63:o[c][i]?84:70);break;case"B":I._W(8,o[c][i]||0,"f");break;case"N":var C="0";for((C="number"==typeof o[c][i]?o[c][i].toFixed(m[i]||0):C).length>h[i]&&(C=C.slice(0,h[i])),l=0;l<h[i]-C.length;++l)I._W(1,32);I._W(1,C,"sbcs");break;case"D":o[c][i]?(I._W(4,("0000"+o[c][i].getFullYear()).slice(-4),"sbcs"),I._W(2,("00"+(o[c][i].getMonth()+1)).slice(-2),"sbcs"),I._W(2,("00"+o[c][i].getDate()).slice(-2),"sbcs")):I._W(8,"00000000","sbcs");break;case"C":var A=I.l,T=String(null!=o[c][i]?o[c][i]:"").slice(0,h[i]);for(I._W(1,T,"cpstr"),A+=h[i]-I.l,l=0;l<A;++l)I._W(1,32)}}return _=r,a.next(1)._W(1,26),a.end()}});function Va(e,t){t=t||{},t.dateNF||(t.dateNF="yyyymmdd"),e=ba(function(e,t){var r=[],a=me(1);switch(t.type){case"base64":a=fe(pe(e));break;case"binary":a=fe(e);break;case"buffer":case"array":a=e}ia(a,0);var n=a._R(1),o=!!(136&n),s=!1,c=!1;switch(n){case 2:case 3:break;case 48:case 49:o=s=!0;break;case 131:case 139:break;case 140:c=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+n.toString(16))}for(var i=0,l=521,u=(2==n&&(i=a._R(2)),a.l+=3,1048576<(i=2!=n?a._R(4):i)&&(i=1e6),2!=n&&(l=a._R(2)),a._R(2)),d=t.codepage||1252,p=(2!=n&&(a.l+=16,a._R(1),0!==a[a.l]&&(d=$a[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36),[]),h={},m=Math.min(a.length,2==n?521:l-10-(s?264:0)),g=c?32:11;a.l<m&&13!=a[a.l];)switch((h={}).name=(void 0!==q?q.utils.decode(d,a.slice(a.l,a.l+g)):A(a.slice(a.l,a.l+g))).replace(/[\u0000\r\n][\S\s]*$/g,""),a.l+=g,h.type=String.fromCharCode(a._R(1)),2==n||c||(h.offset=a._R(4)),h.len=a._R(1),2==n&&(h.offset=a._R(2)),h.dec=a._R(1),h.name.length&&p.push(h),2!=n&&(a.l+=c?13:14),h.type){case"B":s&&8==h.len||!t.WTF||console.log("Skipping "+h.name+":"+h.type);break;case"G":case"P":t.WTF&&console.log("Skipping "+h.name+":"+h.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+h.type)}if(13!==a[a.l]&&(a.l=l-1),13!==a._R(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=l;var f=0,y=0;for(r[0]=[],y=0;y!=p.length;++y)r[0][y]=p[y].name;for(;0<i--;)if(42===a[a.l])a.l+=u;else for(++a.l,r[++f]=[],y=y=0;y!=p.length;++y){var v=a.slice(a.l,a.l+p[y].len),w=(a.l+=p[y].len,ia(v,0),void 0!==q?q.utils.decode(d,v):A(v));switch(p[y].type){case"C":w.trim().length&&(r[f][y]=w.replace(/([^\s])\s+$/,"$1"));break;case"D":8===w.length?(r[f][y]=new Date(Date.UTC(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8),0,0,0,0)),t&&t.UTC||(r[f][y]=qt(r[f][y]))):r[f][y]=w;break;case"F":r[f][y]=parseFloat(w.trim());break;case"+":case"I":r[f][y]=c?2147483648^v._R(-4,"i"):v._R(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[f][y]=!0;break;case"N":case"F":r[f][y]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+n.toString(16));r[f][y]="##MEMO##"+(c?parseInt(w.trim(),10):v._R(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[f][y]=+w||0);break;case"@":r[f][y]=new Date(v._R(-8,"f")-621356832e5);break;case"T":var b=v._R(4),S=v._R(4);0==b&&0==S||(r[f][y]=new Date(864e5*(b-2440588)+S),t&&t.UTC)||(r[f][y]=qt(r[f][y]));break;case"Y":r[f][y]=v._R(4,"i")/1e4+v._R(4,"i")/1e4*Math.pow(2,32);break;case"O":r[f][y]=-v._R(-8,"f");break;case"B":if(s&&8==p[y].len){r[f][y]=v._R(8,"f");break}case"G":case"P":v.l+=p[y].len;break;case"0":if("_NullFlags"===p[y].name)break;default:throw new Error("DBF Unsupported data type "+p[y].type)}}if(2!=n&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return t&&t.sheetRows&&(r=r.slice(0,t.sheetRows)),t.DBF=p,r}(e,t),t);return e["!cols"]=t.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete t.DBF,e}var Xa=function(){var r={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"Ã",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},P=new RegExp("N("+R(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{P=new RegExp("N("+R(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch(e){}var O=function(e,t){t=r[t];return"number"==typeof t?l(t):t},F=function(e,t,r){t=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==t?e:l(t)},v=(r["|"]=254,function(e){return e.replace(/\n/g," :").replace(/\r/g," =")});function c(e,t){var r,a,n=e.split(/[\n\r]+/),o=-1,s=-1,c=0,i=0,l=[],u=[],d=null,e={},p=[],h=[],m=0,g={Workbook:{WBProps:{},Names:[]}};for(0<=+t.codepage&&j(+t.codepage);c!==n.length;++c){var f,y,m=0,v=n[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,F).replace(P,O),w=v.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),b=w[0];if(0<v.length)switch(b){case"ID":case"E":case"B":break;case"O":for(i=1;i<w.length;++i)"V"===w[i].charAt(0)&&1<=(y=parseInt(w[i].slice(1),10))&&y<=4&&(g.Workbook.WBProps.date1904=!0);break;case"W":break;case"P":"P"===w[1].charAt(0)&&u.push(v.slice(3).replace(/;;/g,";"));break;case"NN":for(var S={Sheet:0},i=1;i<w.length;++i)switch(w[i].charAt(0)){case"N":S.Name=w[i].slice(1);break;case"E":S.Ref=(t&&t.sheet||"Sheet1")+"!"+no(w[i].slice(1))}g.Workbook.Names.push(S);break;case"C":var k=!1,x=!1,I=!1,C=!1,A=-1,T=-1,_="",D="z",E="";for(i=1;i<w.length;++i)switch(w[i].charAt(0)){case"A":E=w[i].slice(1);break;case"X":s=parseInt(w[i].slice(1),10)-1,x=!0;break;case"Y":for(o=parseInt(w[i].slice(1),10)-1,x||(s=0),a=l.length;a<=o;++a)l[a]=[];break;case"K":'"'===(f=w[i].slice(1)).charAt(0)?(f=f.slice(1,f.length-1),D="s"):"TRUE"===f||"FALSE"===f?(f="TRUE"===f,D="b"):"#"==f.charAt(0)&&null!=xa[f]?(D="e",f=xa[f]):isNaN(Dt(f))||(f=Dt(f),D="n",null!==d&&Be(d)&&t.cellDates&&(D="number"==typeof(f=It(g.Workbook.WBProps.date1904?f+1462:f))?"n":"d")),void 0!==q&&"string"==typeof f&&"string"!=(t||{}).type&&(t||{}).codepage&&(f=q.utils.decode(t.codepage,f)),k=!0;break;case"E":C=!0,_=no(w[i].slice(1),{r:o,c:s});break;case"S":I=!0;break;case"G":break;case"R":A=parseInt(w[i].slice(1),10)-1;break;case"C":T=parseInt(w[i].slice(1),10)-1;break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+v)}if(k&&(l[o][s]?(l[o][s].t=D,l[o][s].v=f):l[o][s]={t:D,v:f},d&&(l[o][s].z=d),!1!==t.cellText&&d&&(l[o][s].w=Ge(l[o][s].z,l[o][s].v,{date1904:g.Workbook.WBProps.date1904})),d=null),I){if(C)throw new Error("SYLK shared formula cannot have own formula");var R=-1<A&&l[A][T];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");_=io(R[1],{r:o-A,c:s-T})}_&&(l[o][s]?l[o][s].f=_:l[o][s]={t:"n",f:_}),E&&(l[o][s]||(l[o][s]={t:"z"}),l[o][s].c=[{a:"SheetJSYLK",t:E}]);break;case"F":var N=0;for(i=1;i<w.length;++i)switch(w[i].charAt(0)){case"X":s=parseInt(w[i].slice(1),10)-1,++N;break;case"Y":for(o=parseInt(w[i].slice(1),10)-1,a=l.length;a<=o;++a)l[a]=[];break;case"M":m=parseInt(w[i].slice(1),10)/20;break;case"F":case"G":break;case"P":d=u[parseInt(w[i].slice(1),10)];break;case"S":case"D":case"N":break;case"W":for(r=w[i].slice(1).split(" "),a=parseInt(r[0],10);a<=parseInt(r[1],10);++a)m=parseInt(r[2],10),h[a-1]=0===m?{hidden:!0}:{wch:m};break;case"C":h[s=parseInt(w[i].slice(1),10)-1]||(h[s]={});break;case"R":p[o=parseInt(w[i].slice(1),10)-1]||(p[o]={}),0<m?(p[o].hpt=m,p[o].hpx=jn(m)):0===m&&(p[o].hidden=!0);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+v)}N<1&&(d=null);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+v)}}return 0<p.length&&(e["!rows"]=p),0<h.length&&(e["!cols"]=h),h.forEach(function(e){Ln(e)}),[l=t&&t.sheetRows?l.slice(0,t.sheetRows):l,e,g]}return{to_workbook:function(e,t){var r=(e=function(e,t){switch(t.type){case"base64":return c(pe(e),t);case"binary":return c(e,t);case"buffer":return c(ue&&Buffer.isBuffer(e)?e.toString("binary"):A(e),t);case"array":return c(_t(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t))[0],a=e[1],n=e[2],o=((e=te(t)).date1904=(((n||{}).Workbook||{}).WBProps||{}).date1904,ba(r,e)),s=(R(a).forEach(function(e){o[e]=a[e]}),va(o,t));return R(n).forEach(function(e){s[e]=n[e]}),s.bookType="sylk",s},from_sheet:function(e,t,r){(t=t||{})._formats=["General"];var a,n,o,s,c,i,l=["ID;PSheetJS;N;E"],u=[],d=H(e["!ref"]||"A1"),p=null!=e["!data"],h="\r\n",m=(((r||{}).Workbook||{}).WBProps||{}).date1904,g=(l.push("P;PGeneral"),d.s.r),f=d.s.c,y=[];if(e["!ref"])for(g=d.s.r;g<=d.e.r;++g)if(!p||e["!data"][g]){for(y=[],f=d.s.c;f<=d.e.c;++f)(s=p?e["!data"][g][f]:e[ce(f)+se(g)])&&s.c&&y.push((a=s.c,n="C;Y"+((n=g)+1)+";X"+(f+1)+";A",n+=v(a.map(function(e){return e.t}).join(""))));y.length&&u.push(y.join(h))}if(e["!ref"])for(g=d.s.r;g<=d.e.r;++g)if(!p||e["!data"][g]){for(y=[],f=d.s.c;f<=d.e.c;++f)(s=p?e["!data"][g][f]:e[ce(f)+se(g)])&&(null!=s.v||s.f&&!s.F)&&("General"!=(s.z||("d"==s.t?W[14]:"General"))&&(-1==(o=t._formats.indexOf(s.z))&&(t._formats.push(s.z),o=t._formats.length-1,l.push("P;P"+s.z.replace(/;/g,";;"))),y.push("F;P"+o+";Y"+(g+1)+";X"+(f+1))),y.push(function(e,t,r,a){var n="C;Y"+(t+1)+";X"+(r+1)+";K";switch(e.t){case"n":n+=isFinite(e.v)?e.v||0:ka[isNaN(e.v)?36:7],e.f&&!e.F&&(n+=";E"+co(e.f,{r:t,c:r}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||ka[e.v]||e.v;break;case"d":n+=Z(ee(e.v,a),a);break;case"s":n+='"'+(null==e.v?"":String(e.v)).replace(/"/g,"").replace(/;/g,";;")+'"'}return n}(s,g,f,m)));u.push(y.join(h))}return l.push("F;P0;DG0G8;M255"),e["!cols"]&&(c=l,e["!cols"].forEach(function(e,t){t="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?t+="0":("number"!=typeof e.width||e.wpx||(e.wpx=On(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Fn(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&c.push(t)})),e["!rows"]&&(i=l,e["!rows"].forEach(function(e,t){var r="F;";e.hidden?r+="M0;":e.hpt?r+="M"+20*e.hpt+";":e.hpx&&(r+="M"+20*Un(e.hpx)+";"),2<r.length&&i.push(r+"R"+(t+1))})),e["!ref"]&&l.push("B;Y"+(d.e.r-d.s.r+1)+";X"+(d.e.c-d.s.c+1)+";D"+[d.s.c,d.s.r,d.e.c,d.e.r].join(" ")),l.push("O;L;D;B"+(m?";V4":"")+";K47;G100 0.001"),delete t._formats,l.join(h)+h+u.join(h)+h+"E"+h}}}(),Ja={to_workbook:function(e,t){return(e=va(Qa(e,t),t)).bookType="dif",e},to_sheet:Qa,from_sheet:function(e){var t=d;if(!e["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var r=H(e["!ref"]),a=null!=e["!data"],n=['TABLE\r\n0,1\r\n"sheetjs"\r\n',"VECTORS\r\n0,"+(r.e.r-r.s.r+1)+'\r\n""\r\n',"TUPLES\r\n0,"+(r.e.c-r.s.c+1)+'\r\n""\r\n','DATA\r\n0,0\r\n""\r\n'],o=r.s.r;o<=r.e.r;++o){for(var s=a?e["!data"][o]:[],c="-1,0\r\nBOT\r\n",i=r.s.c;i<=r.e.c;++i){var l=a?s&&s[i]:e[ie({r:o,c:i})];if(null==l)c+='1,0\r\n""\r\n';else{switch(l.t){case"n":c+=t?null!=l.w?"0,"+l.w+"\r\nV":null!=l.v?Za(l.v,"V"):null==l.f||l.F?'1,0\r\n""':en("="+l.f):null==l.v?'1,0\r\n""':Za(l.v,"V");break;case"b":c+=l.v?Za(1,"TRUE"):Za(0,"FALSE");break;case"s":c+=en(!t||isNaN(+l.v)?l.v:'="'+l.v+'"');break;case"d":l.w||(l.w=Ge(l.z||W[14],Z(ee(l.v)))),c+=t?Za(l.w,"V"):en(l.w);break;default:c+='1,0\r\n""'}c+="\r\n"}}n.push(c)}return n.join("")+"-1,0\r\nEOD"}};function Ya(e,t){for(var r=e.split("\n"),a=-1,n=-1,o=0,s=[];o!==r.length;++o)if("BOT"===r[o].trim())s[++a]=[],n=0;else if(!(a<0)){for(var c=r[o].trim().split(","),i=c[0],l=c[1],u=r[++o]||"";1&(u.match(/["]/g)||[]).length&&o<r.length-1;)u+="\n"+r[++o];switch(u=u.trim(),+i){case-1:if("BOT"===u){s[++a]=[],n=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[a][n]=!0:"FALSE"===u?s[a][n]=!1:isNaN(Dt(l))?isNaN(Ft(l).getDate())?s[a][n]=l:(s[a][n]=ee(l),t&&t.UTC||(s[a][n]=qt(s[a][n]))):s[a][n]=Dt(l),++n;break;case 1:u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'),d&&u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[a][n++]=""!==u?u:null}if("EOD"===u)break}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}function Qa(e,t){return ba(function(e,t){switch(t.type){case"base64":return Ya(pe(e),t);case"binary":return Ya(e,t);case"buffer":return Ya(ue&&Buffer.isBuffer(e)?e.toString("binary"):A(e),t);case"array":return Ya(_t(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t)}function Za(e,t){return"0,"+String(e)+"\r\n"+t}function en(e){return'1,0\r\n"'+e.replace(/"/g,'""')+'"'}tn=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),rn=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",an=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),nn="--SocialCalcSpreadsheetControlSave--";var tn,rn,an,nn,on={to_workbook:function(e,t){return va(cn(e,t),t)},to_sheet:cn,from_sheet:function(e){return[tn,rn,an,rn,function(e){if(!e||!e["!ref"])return"";for(var t,r,a=[],n=[],o=ha(e["!ref"]),s=null!=e["!data"],c=o.s.r;c<=o.e.r;++c)for(var i=o.s.c;i<=o.e.c;++i)if(r=ie({r:c,c:i}),(t=s?(e["!data"][c]||[])[i]:e[r])&&null!=t.v&&"z"!==t.t){switch(n=["cell",r,"t"],t.t){case"s":n.push(sn(t.v));break;case"b":n[2]="vt"+(t.f?"f":"c"),n[3]="nl",n[4]=t.v?"1":"0",n[5]=sn(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var l=Z(ee(t.v));n[2]="vtc",n[3]="nd",n[4]=""+l,n[5]=t.w||Ge(t.z||W[14],l);break;case"n":isFinite(t.v)?t.f?(n[2]="vtf",n[3]="n",n[4]=t.v,n[5]=sn(t.f)):(n[2]="v",n[3]=t.v):(n[2]="vt"+(t.f?"f":"c"),n[3]="e"+ka[isNaN(t.v)?36:7],n[4]="0",n[5]=t.f||n[3].slice(1),n[6]="e",n[7]=n[3].slice(1));break;case"e":continue}a.push(n.join(":"))}return a.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}(e),nn].join("\n")}};function sn(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function cn(e,t){return ba(function(e,t){for(var r,a=e.split("\n"),n=-1,o=0,s=[];o!==a.length;++o){var c=a[o].trim().split(":");if("cell"===c[0]){var i=K(c[1]);if(s.length<=i.r)for(n=s.length;n<=i.r;++n)s[n]||(s[n]=[]);switch(n=i.r,r=i.c,c[2]){case"t":s[n][r]=c[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[n][r]=+c[3];break;case"vtf":var l=c[c.length-1];case"vtc":s[n][r]="nl"===c[3]?!!+c[4]:"#"==c[c.length-1].charAt(0)?{t:"e",v:xa[c[c.length-1]]}:+c[4],"vtf"==c[2]&&(s[n][r]=[s[n][r],l])}}}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}(e,t),t)}ln={44:",",9:"\t",59:";",124:"|"},un={44:3,9:2,59:1,124:0};var ln,un,dn={to_workbook:function(e,t){return va(fn(e,t),t)},to_sheet:fn,from_sheet:function(e){var t=[];if(!e["!ref"])return"";for(var r=H(e["!ref"]),a=null!=e["!data"],n=r.s.r;n<=r.e.r;++n){for(var o=[],s=r.s.c;s<=r.e.c;++s){var c=ie({r:n,c:s});if((c=a?(e["!data"][n]||[])[s]:e[c])&&null!=c.v){for(var i=(c.w||(ya(c),c.w)||"").slice(0,10);i.length<10;)i+=" ";o.push(i+(0===s?" ":""))}else o.push("          ")}t.push(o.join(""))}return t.join("\n")}};function pn(e,t,r,a,n){n.raw?t[r][a]=e:""!==e&&("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(Dt(e))?isNaN(Ft(e).getDate())?35==e.charCodeAt(0)&&null!=xa[e]?t[r][a]={t:"e",v:xa[e],w:e}:t[r][a]=e:t[r][a]=ee(e):t[r][a]=Dt(e))}function hn(e){for(var t={},r=!1,a=0,n=0;a<e.length;++a)34==(n=e.charCodeAt(a))?r=!r:!r&&n in ln&&(t[n]=(t[n]||0)+1);for(a in n=[],t)Object.prototype.hasOwnProperty.call(t,a)&&n.push([t[a],a]);if(!n.length)for(a in t=un)Object.prototype.hasOwnProperty.call(t,a)&&n.push([t[a],a]);return n.sort(function(e,t){return e[0]-t[0]||un[e[1]]-un[t[1]]}),ln[n.pop()[1]]||44}function mn(a,e){var n=e||{},e="",o=(null!=de&&null==n.dense&&(n.dense=de),{}),s=(n.dense&&(o["!data"]=[]),{s:{c:0,r:0},e:{c:0,r:0}}),c=("sep="==a.slice(0,4)?13==a.charCodeAt(5)&&10==a.charCodeAt(6)?(e=a.charAt(4),a=a.slice(7)):13==a.charCodeAt(5)||10==a.charCodeAt(5)?(e=a.charAt(4),a=a.slice(6)):e=hn(a.slice(0,1024)):e=n&&n.FS?n.FS:hn(a.slice(0,1024)),0),i=0,l=0,u=0,d=0,p=e.charCodeAt(0),t=!1,h=0,m=a.charCodeAt(0),g=null!=n.dateNF?(e=(e="number"==typeof(e=n.dateNF)?W[e]:e).replace(Je,"(\\d+)"),Je.lastIndex=0,new RegExp("^"+e+"$")):null;function r(){var e,t=a.slice(u,d),r={};if('"'==(t="\r"==t.slice(-1)?t.slice(0,-1):t).charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),!1!==n.cellText&&(r.w=t),0===t.length?r.t="z":n.raw||0===t.trim().length?(r.t="s",r.v=t):61==t.charCodeAt(0)?34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):(1!=t.length?(r.t="s",r.f=t.slice(1)):r.t="s",r.v=t):"TRUE"==t?(r.t="b",r.v=!0):"FALSE"==t?(r.t="b",r.v=!1):isNaN(l=Dt(t))?!isNaN((l=Ft(t)).getDate())||g&&t.match(g)?(r.z=n.dateNF||W[14],g&&t.match(g)?(e=function(e,a){var n=-1,o=-1,s=-1,c=-1,i=-1,l=-1;(e.match(Je)||[]).forEach(function(e,t){var r=parseInt(a[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=r;break;case"d":s=r;break;case"h":c=r;break;case"s":l=r;break;case"m":0<=c?i=r:o=r}}),(Je.lastIndex=0)<=l&&-1==i&&0<=o&&(i=o,o=-1);8==(e=7==(e=(""+(0<=n?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(1<=o?o:1)).slice(-2)+"-"+("00"+(1<=s?s:1)).slice(-2)).length?"0"+e:e).length&&(e="20"+e);var t=("00"+(0<=c?c:0)).slice(-2)+":"+("00"+(0<=i?i:0)).slice(-2)+":"+("00"+(0<=l?l:0)).slice(-2);return-1==c&&-1==i&&-1==l?e:-1==n&&-1==o&&-1==s?t:e+"T"+t}(n.dateNF,t.match(g)||[]),l=ee(e),n&&!1===n.UTC&&(l=qt(l))):n&&!1===n.UTC?l=qt(l):!1!==n.cellText&&n.dateNF&&(r.w=Ge(r.z,l)),n.cellDates?(r.t="d",r.v=l):(r.t="n",r.v=Z(l)),n.cellNF||delete r.z):35==t.charCodeAt(0)&&null!=xa[t]?(r.t="e",r.w=t,r.v=xa[t]):(r.t="s",r.v=t):(r.t="n",r.v=l),"z"!=r.t&&(n.dense?(o["!data"][c]||(o["!data"][c]=[]),o["!data"][c][i]=r):o[ie({c:i,r:c})]=r),u=d+1,m=a.charCodeAt(u),s.e.c<i&&(s.e.c=i),s.e.r<c&&(s.e.r=c),h!=p)return i=0,++c,!!(n.sheetRows&&n.sheetRows<=c);++i}e:for(;d<a.length;++d)switch(h=a.charCodeAt(d)){case 34:34===m&&(t=!t);break;case 13:if(t)break;10==a.charCodeAt(d+1)&&++d;case p:case 10:if(!t&&r())break e}return 0<d-u&&r(),o["!ref"]=le(s),o}function gn(e,t){return!t||!t.PRN||t.FS||"sep="==e.slice(0,4)||0<=e.indexOf("\t")||0<=e.indexOf(",")||0<=e.indexOf(";")?mn(e,t):ba(function(e,t){var r=t||{},a=[];if(e&&0!==e.length){for(var n=e.split(/[\r\n]/),o=n.length-1;0<=o&&0===n[o].length;)--o;for(var s=10,c=0,i=0;i<=o;++i)-1==(c=n[i].indexOf(" "))?c=n[i].length:c++,s=Math.max(s,c);for(i=0;i<=o;++i){a[i]=[];var l=0;for(pn(n[i].slice(0,s).trim(),a,i,l,r),l=1;l<=(n[i].length-s)/10+1;++l)pn(n[i].slice(s+10*(l-1),s+10*l).trim(),a,i,l,r)}r.sheetRows&&(a=a.slice(0,r.sheetRows))}return a}(e,t),t)}function fn(e,t){var r="",a="string"==t.type?[0,0,0,0]:Cs(e,t);switch(t.type){case"base64":r=pe(e);break;case"binary":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&void 0!==q?q.utils.decode(t.codepage,e):ue&&Buffer.isBuffer(e)?e.toString("binary"):A(e);break;case"array":r=_t(e);break;case"string":r=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]?r=z(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=z(r):"binary"==t.type&&void 0!==q&&t.codepage&&(r=q.utils.decode(t.codepage,q.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?on.to_sheet("string"==t.type?r:z(r),t):gn(r,t)}yn=/<(?:\w+:)?r>/g,vn=/<\/(?:\w+:)?r>/;var yn,vn,wn=function(e){return e.replace(yn,"").split(vn).map(bn).filter(function(e){return e.v})};function bn(e){var t=G(e,"t");return t?(t={t:"s",v:ae(t[1])},(e=G(e,"rPr"))&&(t.s=function(e){var t={},r=e.match(B),a=0,n=!1;if(r)for(;a!=r.length;++a){var o=re(r[a]);switch(o[0].replace(/<\w*:/g,"<")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":"1"!=o.val&&(t.cp=N[parseInt(o.val,10)]);break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==o[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+o[0])}}return t}(e[1])),t):{t:"s",v:""}}Sn=/(\r\n|\n)/g;var Sn,kn=function(e){return e.map(xn).join("")};function xn(e){var t,r,a,n=[[],e.v,[]];return e.v?(e.s&&(t=n[0],r=n[2],a=[],(e=e.s).u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),t.push('<span style="'+a.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>")),"superscript"==(a=e.valign||"")||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")),n[0].join("")+n[1].replace(Sn,"<br/>")+n[2].join("")):""}var In=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,Cn=/<(?:\w+:)?r\b[^<>]*>/;function An(e,t){var t=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ae(z(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),r.r=z(e),t&&(r.h=hr(r.t))):e.match(Cn)&&(r.r=z(e),r.t=ae(z((Ht(e,"rPh").match(In)||[]).join("").replace(B,"")),!0),t)&&(r.h=kn(wn(r.r))),r):{t:""}}var Tn=/<(?:\w+:)?(?:si|sstItem)>/g,_n=/<\/(?:\w+:)?(?:si|sstItem)>/;var Dn=/^\s|\s$|[\t\n\r]/;function En(e,t){if(0===t)return e;for(var e=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,e=Math.max(t,r,a),n=Math.min(t,r,a),o=e-n;if(0==o)return[0,0,t];var s=0,c=o/(1<(n=e+n)?2-n:n);switch(e){case t:s=((r-a)/o+6)%6;break;case r:s=(a-t)/o+2;break;case a:s=(t-r)/o+4}return[s/6,c,n/2]}((e=(e=e).slice("#"===e[0]?1:0).slice(0,6),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)])),r=(e[2]=t<0?e[2]*(1+t):1-(1-e[2])*(1-t),function(e){var t,r=e[0],a=e[1],n=2*a*((e=e[2])<.5?e:1-e),o=[e=e-n/2,e,e],s=6*r;if(0!==a)switch(0|s){case 0:case 6:t=n*s,o[0]+=n,o[1]+=t;break;case 1:o[0]+=t=n*(2-s),o[1]+=n;break;case 2:t=n*(s-2),o[1]+=n,o[2]+=t;break;case 3:o[1]+=t=n*(4-s),o[2]+=n;break;case 4:t=n*(s-4),o[2]+=n,o[0]+=t;break;case 5:o[2]+=t=n*(6-s),o[0]+=n}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(e)),a=0,n=1;3!=a;++a)n=256*n+(255<r[a]?255:r[a]<0?0:r[a]);return n.toString(16).toUpperCase().slice(1)}var Rn=15,Nn=1,Pn=6;function On(e){return Math.floor((e+Math.round(128/Pn)/256)*Pn)}function Fn(e){return Math.floor((e-5)/Pn*100+.5)/100}function qn(e){return Math.round((e*Pn+5)/Pn*256)/256}function Mn(e){return qn(Fn(On(e)))}function Ln(e){e.width?(e.wpx=On(e.width),e.wch=Fn(e.wpx),e.MDW=Pn):e.wpx?(e.wch=Fn(e.wpx),e.width=qn(e.wch),e.MDW=Pn):"number"==typeof e.wch&&(e.width=qn(e.wch),e.wpx=On(e.width),e.MDW=Pn),e.customWidth&&delete e.customWidth}var Bn=96;function Un(e){return 96*e/Bn}function jn(e){return e*Bn/96}var Wn=["numFmtId","fillId","fontId","borderId","xfId"],$n=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Gn=function(e,t,r){var a,n,o,s,c,i,l,u,d,p,h,m,g,f,y,v,w,b,S={};if(e){if(e=Lt(Ut(e,"\x3c!--","--\x3e")),a=G(e,"numFmts")){var k=a[0],x=S,I=r;x.NumberFmt=[];for(var C=R(W),A=0;A<C.length;++A)x.NumberFmt[C[A]]=W[C[A]];var T=k.match(B);if(T)for(A=0;A<T.length;++A){var _=re(T[A]);switch(or(_[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var D=ae(z(_.formatCode)),E=parseInt(_.numFmtId,10);if(x.NumberFmt[E]=D,0<E){if(392<E){for(E=392;60<E&&null!=x.NumberFmt[E];--E);x.NumberFmt[E]=D}Qe(D,E)}break;case"</numFmt>":break;default:if(I.WTF)throw new Error("unrecognized "+_[0]+" in numFmts")}}}(a=G(e,"fonts"))&&(k=a[0],o=t,s=r,(n=S).Fonts=[],i=!(c={}),(k.match(B)||[]).forEach(function(e){var t,r=re(e);switch(or(r[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(c),c={};break;case"<name":r.val&&(c.name=z(r.val));break;case"<name/>":case"</name>":break;case"<b":c.bold=r.val?ne(r.val):1;break;case"<b/>":c.bold=1;break;case"</b>":case"</b":break;case"<i":c.italic=r.val?ne(r.val):1;break;case"<i/>":c.italic=1;break;case"</i>":case"</i":break;case"<u":switch(r.val){case"none":c.underline=0;break;case"single":c.underline=1;break;case"double":c.underline=2;break;case"singleAccounting":c.underline=33;break;case"doubleAccounting":c.underline=34}break;case"<u/>":c.underline=1;break;case"</u>":case"</u":break;case"<strike":c.strike=r.val?ne(r.val):1;break;case"<strike/>":c.strike=1;break;case"</strike>":case"</strike":break;case"<outline":c.outline=r.val?ne(r.val):1;break;case"<outline/>":c.outline=1;break;case"</outline>":case"</outline":break;case"<shadow":c.shadow=r.val?ne(r.val):1;break;case"<shadow/>":c.shadow=1;break;case"</shadow>":case"</shadow":break;case"<condense":c.condense=r.val?ne(r.val):1;break;case"<condense/>":c.condense=1;break;case"</condense>":case"</condense":break;case"<extend":c.extend=r.val?ne(r.val):1;break;case"<extend/>":c.extend=1;break;case"</extend>":case"</extend":break;case"<sz":r.val&&(c.sz=+r.val);break;case"<sz/>":case"</sz>":case"</sz":break;case"<vertAlign":r.val&&(c.vertAlign=r.val);break;case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":break;case"<family":r.val&&(c.family=parseInt(r.val,10));break;case"<family/>":case"</family>":case"</family":break;case"<scheme":r.val&&(c.scheme=r.val);break;case"<scheme/>":case"</scheme>":case"</scheme":break;case"<charset":"1"!=r.val&&(r.codepage=N[parseInt(r.val,10)]);break;case"<charset/>":case"</charset>":case"</charset":break;case"<color":c.color||(c.color={}),r.auto&&(c.color.auto=ne(r.auto)),r.rgb?c.color.rgb=r.rgb.slice(-6):r.indexed?(c.color.index=parseInt(r.indexed,10),t=Sa[c.color.index],t=(t=81==c.color.index?Sa[1]:t)||Sa[1],c.color.rgb=t[0].toString(16)+t[1].toString(16)+t[2].toString(16)):r.theme&&(c.color.theme=parseInt(r.theme,10),r.tint&&(c.color.tint=parseFloat(r.tint)),r.theme)&&o.themeElements&&o.themeElements.clrScheme&&(c.color.rgb=En(o.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case"<color/>":case"</color>":case"</color":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":case"</AlternateContent":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+r[0]+" in fonts")}})),(a=G(e,"fills"))&&(t=a[0],u=r,(l=S).Fills=[],p=!(d={}),(t.match(B)||[]).forEach(function(e){var t=re(e);switch(or(t[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":d={},l.Fills.push(d);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":l.Fills.push(d),d={};break;case"<patternFill":case"<patternFill>":t.patternType&&(d.patternType=t.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":d.bgColor||(d.bgColor={}),t.indexed&&(d.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(d.bgColor.theme=parseInt(t.theme,10)),t.tint&&(d.bgColor.tint=parseFloat(t.tint)),t.rgb&&(d.bgColor.rgb=t.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":d.fgColor||(d.fgColor={}),t.theme&&(d.fgColor.theme=parseInt(t.theme,10)),t.tint&&(d.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(d.fgColor.rgb=t.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(u&&u.WTF&&!p)throw new Error("unrecognized "+t[0]+" in fills")}})),(a=G(e,"borders"))&&(t=a[0],m=r,(h=S).Borders=[],f=!(g={}),(t.match(B)||[]).forEach(function(e){var t=re(e);switch(or(t[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":g={},t.diagonalUp&&(g.diagonalUp=ne(t.diagonalUp)),t.diagonalDown&&(g.diagonalDown=ne(t.diagonalDown)),h.Borders.push(g);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(m&&m.WTF&&!f)throw new Error("unrecognized "+t[0]+" in borders")}})),(a=G(e,"cellXfs"))&&(t=a[0],v=r,b=!((y=S).CellXf=[]),(t.match(B)||[]).forEach(function(e){var t=re(e),r=0;switch(or(t[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(delete(w=t)[0],r=0;r<Wn.length;++r)w[Wn[r]]&&(w[Wn[r]]=parseInt(w[Wn[r]],10));for(r=0;r<$n.length;++r)w[$n[r]]&&(w[$n[r]]=ne(w[$n[r]]));if(y.NumberFmt&&392<w.numFmtId)for(r=392;60<r;--r)if(y.NumberFmt[w.numFmtId]==y.NumberFmt[r]){w.numFmtId=r;break}y.CellXf.push(w);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var a={};t.vertical&&(a.vertical=t.vertical),t.horizontal&&(a.horizontal=t.horizontal),null!=t.textRotation&&(a.textRotation=t.textRotation),t.indent&&(a.indent=t.indent),t.wrapText&&(a.wrapText=ne(t.wrapText)),w.alignment=a;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":b=!0;break;case"</AlternateContent>":b=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(v&&v.WTF&&!b)throw new Error("unrecognized "+t[0]+" in cellXfs")}}))}return S};function zn(e,t){var r,a,n,o,s=[k,C("styleSheet",null,{xmlns:_r[0],"xmlns:vt":U.vt})];return e.SSF&&null!=(a=e.SSF,n=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=a[t]&&(n[n.length]=C("numFmt",null,{numFmtId:t,formatCode:I(a[t])}))}),r=1===n.length?"":(n[n.length]="</numFmts>",n[0]=C("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join("")))&&(s[s.length]=r),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',e=t.cellXfs,(o=[])[o.length]="<cellXfs/>",e.forEach(function(e){o[o.length]=C("xf",null,e)}),o[o.length]="</cellXfs>",(r=2===o.length?"":(o[0]=C("cellXfs",null,{count:o.length-2}).replace("/>",">"),o.join("")))&&(s[s.length]=r),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<s.length&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}var Kn=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Hn(e,t,r){var a,n,o,s;if(t.themeElements={},!(a=Wt(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(a=a,o=r,(n=t).themeElements.clrScheme=[],s={},(a[0].match(B)||[]).forEach(function(e){var t=re(e);switch(t[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=t.val;break;case"</a:srgbClr>":break;case"<a:sysClr":s.rgb=t.lastClr;break;case"</a:sysClr>":break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===t[0].charAt(1)?(n.themeElements.clrScheme[Kn.indexOf(t[0])]=s,s={}):s.name=t[0].slice(3,t[0].length-1);break;default:if(o&&o.WTF)throw new Error("Unrecognized "+t[0]+" in clrScheme")}}),!Wt(e,"a:fontScheme"))throw new Error("fontScheme not found in themeElements");if(!Wt(e,"a:fmtScheme"))throw new Error("fmtScheme not found in themeElements")}function Vn(e,t){return t&&t.themeXLSX?t.themeXLSX:e&&"string"==typeof e.raw?e.raw:((t=[k])[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜é«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜é«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join(""))}function Xn(e,t,r,a){if(!e)return e;var n=a||{},o=!1,s=e,c=function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!t.T&&(!o||n.WTF))throw new Error("Unexpected record 0x"+r.toString(16))}},i=n;if(s){ia(s,s.l||0);for(var l=s.length,u=0;s.l<l;){128&(u=s._R(1))&&(u=(127&u)+((127&s._R(1))<<7));for(var d,p=XLSBRecordEnum[u]||XLSBRecordEnum[65535],h=127&(d=s._R(1)),m=1;m<4&&128&d;++m)h+=(127&(d=s._R(1)))<<7*m;var g=s.l+h,f=p.f&&p.f(s,h,i);if(s.l=g,c(f,p,u))return}}}function Jn(e,t){var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),o=[C("xml",null,{"xmlns:v":Dr.v,"xmlns:o":Dr.o,"xmlns:x":Dr.x,"xmlns:mv":Dr.mv}).replace(/\/>/,">"),C("o:shapelayout",C("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,e=t||[];return 0<e.length&&o.push(C("v:shapetype",[C("v:stroke",null,{joinstyle:"miter"}),C("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:r.join(","),"o:spt":202,path:a})),e.forEach(function(e){var t,r,a,n;++s,o.push((t=s,r=K((e=e)[0]),"gradient"==(a={color2:"#BEFF82",type:"gradient"}).type&&(a.angle="-180"),n="gradient"==a.type?C("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,n=C("v:fill",n,a),["<v:shape"+Cr({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",n,C("v:shadow",null,{on:"t",obscured:"t"}),C("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ir("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),Ir("x:AutoFill","False"),Ir("x:Row",String(r.r)),Ir("x:Column",String(r.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")))}),o.push("</xml>"),o.join("")}function Yn(o,e,s,c){var i,l=null!=o["!data"];e.forEach(function(e){var t=K(e.ref);if(!(t.r<0||t.c<0)){(i=l?(o["!data"][t.r]||(o["!data"][t.r]=[]),o["!data"][t.r][t.c]):o[e.ref])||(i={t:"z"},l?o["!data"][t.r][t.c]=i:o[e.ref]=i,(r=H(o["!ref"]||"BDWGO1000001:A1")).s.r>t.r&&(r.s.r=t.r),r.e.r<t.r&&(r.e.r=t.r),r.s.c>t.c&&(r.s.c=t.c),r.e.c<t.c&&(r.e.c=t.c),t=le(r),o["!ref"]=t),i.c||(i.c=[]);var r,a={a:e.author,t:e.t,r:e.r,T:s};e.h&&(a.h=e.h);for(var n=i.c.length-1;0<=n;--n){if(!s&&i.c[n].T)return;s&&!i.c[n].T&&i.c.splice(n,1)}if(s&&c)for(n=0;n<c.length;++n)if(a.a==c[n].id){a.a=c[n].name||a.a;break}i.c.push(a)}})}function Qn(e,o,s){var c=[k,C("ThreadedComments",null,{xmlns:U.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var n="";(a[1]||[]).forEach(function(e,t){var r;e.T?(e.a&&-1==o.indexOf(e.a)&&o.push(e.a),r={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"},0==t?n=r.id:r.parentId=n,e.ID=r.id,e.a&&(r.personId="{54EE7950-7262-4200-6969-"+("000000000000"+o.indexOf(e.a)).slice(-12)+"}"),c.push(C("threadedComment",Ir("text",e.t||""),r))):delete e.ID})}),c.push("</ThreadedComments>"),c.join("")}function Zn(e){var r=[k,C("personList",null,{xmlns:U.TCMNT,"xmlns:x":_r[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,t){r.push(C("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}var eo="application/vnd.ms-office.vbaProject";var to=["xlsb","xlsm","xlam","biff8","xla"];ro=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,ao={r:0,c:0};var ro,ao,no=function(e,t){return ao=t,e.replace(ro,oo)};function oo(e,t,r,a){var n=!1,o=!1,r=(0==r.length?o=!0:"["==r.charAt(0)&&(o=!0,r=r.slice(1,-1)),0==a.length?n=!0:"["==a.charAt(0)&&(n=!0,a=a.slice(1,-1)),0<r.length?0|parseInt(r,10):0),a=0<a.length?0|parseInt(a,10):0;return n?a+=ao.c:--a,o?r+=ao.r:--r,t+(n?"":"$")+ce(a)+(o?"":"$")+se(r)}var so=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{so=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch(e){}var co=function(e,s){return e.replace(so,function(e,t,r,a,n,o){a=pa(a)-(r?0:s.c),o=da(o)-(n?0:s.r);return t+"R"+("$"==n?1+o:0==o?"":"["+o+"]")+"C"+("$"==r?1+a:0==a?"":"["+a+"]")})};function io(e,s){return e.replace(so,function(e,t,r,a,n,o){return t+("$"==r?r+a:ce(pa(a)+s.c))+("$"==n?n+o:se(da(o)+s.r))})}function lo(e,t,r){t=ha(t).s,r=K(r);return io(e,{r:r.r-t.r,c:r.c-t.c})}function uo(e){return e.replace(/_xlfn\./g,"")}function po(e){return(e=(e=(e=(e=(e=(e=61==(e="of:"==e.slice(0,3)?e.slice(3):e).charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)?e.slice(1):e).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\$'([^']|'')+'/g,function(e){return e.slice(1)})).replace(/\$([^\]\. #$]+)/g,function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ho(e){e=(e=(e=e.replace(/\$'([^']|'')+'/g,function(e){return e.slice(1)})).replace(/\$([^\]\. #$]+)/g,function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t})).split(":");return[e[0].split(".")[0],e[0].split(".")[1]+(1<e.length?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function mo(e){return e.replace(/!/,".").replace(/:/,":.")}var go={},fo={},yo="undefined"!=typeof Map;function vo(e,t,r){var a=r.revssf[null!=t.z?t.z:"General"],n=60,o=e.length;if(null==a&&r.ssf)for(;n<392;++n)if(null==r.ssf[n]){Qe(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}for(n=0;n!=o;++n)if(e[n].numFmtId===a)return n;return e[o]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}var wo=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,bo=/<(?:\w+:)?hyperlink [^<>]*>/gm,So=/"(\w*:\w*)"/,ko=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,xo=/<(?:\w+:)?autoFilter[^>]*/g,Io=/<(?:\w+:)?pageMargins[^<>]*\/>/g,Co=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function Ao(e,t,r,a,n,o,s){if(!e)return e;a=a||{"!id":{}},null!=de&&null==t.dense&&(t.dense=de);var c,i,l={},u=(t.dense&&(l["!data"]=[]),{s:{r:2e6,c:2e6},e:{r:0,c:0}}),d="",p="",h=G(e,"sheetData"),e=(h?(d=e.slice(0,h.index),p=e.slice(h.index+h[0].length)):d=p=e,d.match(Co)),m=(e?To(e[0],0,n,r):(e=G(d,"sheetPr"))&&(e=e[0],c=l,i=n,r=r,To(e.slice(0,e.indexOf(">")),0,i,r)),(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index),r=(0<m&&(!(e=d.slice(m,m+50).match(So))||t&&t.nodim||(c=l,(i=H(i=e[1])).s.r<=i.e.r&&i.s.c<=i.e.c&&0<=i.s.r&&0<=i.s.c&&(c["!ref"]=le(i)))),G(d,"sheetViews"));if(r&&r[1]){var e=r[1],g=n;g.Views||(g.Views=[{}]),(e.match(Ro)||[]).forEach(function(e,t){e=re(e);g.Views[t]||(g.Views[t]={}),+e.zoomScale&&(g.Views[t].zoom=+e.zoomScale),e.rightToLeft&&ne(e.rightToLeft)&&(g.Views[t].RTL=!0)})}r=[];if(t.cellStyles){e=d.match(ko);if(e)for(var f=r,y=e,v=!1,w=0;w!=y.length;++w){var b=re(y[w],!0),S=(b.hidden&&(b.hidden=ne(b.hidden)),parseInt(b.min,10)-1),k=parseInt(b.max,10)-1;for(b.outlineLevel&&(b.level=+b.outlineLevel||0),delete b.min,delete b.max,b.width=+b.width,!v&&b.width&&(v=!0,function(e){var t=Math.abs(e-Mn(e)),r=Pn;if(.005<t)for(Pn=Nn;Pn<Rn;++Pn)Math.abs(e-Mn(e))<=t&&(t=Math.abs(e-Mn(e)),r=Pn);Pn=r}(b.width)),Ln(b);S<=k;)f[S++]=te(b)}}h&&Mo(h[1],l,t,u,o,s,n);var d=p.match(xo),x=(d&&(l["!autofilter"]={ref:(d[0].match(/ref="([^"]*)"/)||[])[1]}),[]),I=p.match(wo);if(I)for(m=0;m!=I.length;++m)x[m]=H(I[m].slice(I[m].indexOf("=")+2));var C,A,e=p.match(bo),h=(e&&!function(e,t,r){for(var a=null!=e["!data"],n=0;n!=t.length;++n){var o=re(z(t[n]),!0);if(!o.ref)return;for(var s=((r||{})["!id"]||[])[o.id],c=(s?(o.Target=s.Target,o.location&&(o.Target+="#"+ae(o.location))):(o.Target="#"+ae(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip),H(o.ref)),i=c.s.r;i<=c.e.r;++i)for(var l=c.s.c;l<=c.e.c;++l){var u=ce(l)+se(i);a?(e["!data"][i]||(e["!data"][i]=[]),e["!data"][i][l]||(e["!data"][i][l]={t:"z",v:void 0}),e["!data"][i][l].l=o):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=o)}}}(l,e,a),p.match(Io));return h&&(l["!margins"]=(C=re(h[0]),A={},["left","right","top","bottom","header","footer"].forEach(function(e){C[e]&&(A[e]=parseFloat(C[e]))}),A)),(o=p.match(/legacyDrawing r:id="(.*?)"/))&&(l["!legrel"]=o[1]),t&&t.nodim&&(u.s.c=u.s.r=0),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=le(u)),0<t.sheetRows&&l["!ref"]&&(s=H(l["!ref"]),t.sheetRows<=+s.e.r)&&(s.e.r=t.sheetRows-1,s.e.r>u.e.r&&(s.e.r=u.e.r),s.e.r<s.s.r&&(s.s.r=s.e.r),s.e.c>u.e.c&&(s.e.c=u.e.c),s.e.c<s.s.c&&(s.s.c=s.e.c),l["!fullref"]=l["!ref"],l["!ref"]=le(s)),0<r.length&&(l["!cols"]=r),0<x.length&&(l["!merges"]=x),a["!id"][l["!legrel"]]&&(l["!legdrawel"]=a["!id"][l["!legrel"]]),l}function To(e,t,r,a){e=re(e);r.Sheets[a]||(r.Sheets[a]={}),e.codeName&&(r.Sheets[a].CodeName=ae(z(e.codeName)))}var _o=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Do=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Eo(e,t){for(var r,a,n,o=["<cols>"],s=0;s!=t.length;++s)(a=t[s])&&(o[o.length]=C("col",null,(n=void 0,r={min:(r=s)+1,max:r+1},n=-1,(a=a).MDW&&(Pn=a.MDW),null!=a.width?r.customWidth=1:null!=a.wpx?n=Fn(a.wpx):null!=a.wch&&(n=a.wch),-1<n?(r.width=qn(n),r.customWidth=1):null!=a.width&&(r.width=a.width),a.hidden&&(r.hidden=!0),null!=a.level&&(r.outlineLevel=r.level=a.level),r)));return o[o.length]="</cols>",o.join("")}var Ro=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function No(e,t,r,a,n,o,s){if(e.c&&r["!comments"].push([t,e.c]),(void 0===e.v||"z"===e.t&&!(a||{}).sheetStubs)&&"string"!=typeof e.f&&void 0===e.z)return"";var c,i="",l=e.t,u=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=isNaN(e.v)?(e.t="e",ka[e.v=36]):isFinite(e.v)?""+e.v:(e.t="e",ka[e.v=7]);break;case"e":i=ka[e.v];break;case"d":a&&a.cellDates?(i=(c=ee(e.v,s)).toISOString(),c.getUTCFullYear()<1900&&(i=i.slice(i.indexOf("T")+1).replace("Z",""))):((e=te(e)).t="n",i=""+(e.v=Z(ee(e.v,s),s))),void 0===e.z&&(e.z=W[14]);break;default:i=e.v}var d="z"==e.t||null==e.v?"":Ir("v",I(i)),p={r:t},h=vo(a.cellXfs,e,a);switch(0!==h&&(p.s=h),e.t){case"n":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;case"z":break;default:if(null==e.v)delete e.t;else{if(32767<e.v.length)throw new Error("Text length must not exceed 32767 characters");a&&a.bookSST?(d=Ir("v",""+function(e,t,r){var a=0,n=e.length;if(r){if(yo?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var o=yo?r.get(t):r[t];a<o.length;++a)if(e[o[a]].t===t)return e.Count++,o[a]}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t:t},e.Count++,e.Unique++,r&&(yo?(r.has(t)||r.set(t,[]),r.get(t)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t])).push(n),n}(a.Strings,e.v,a.revStrings)),p.t="s"):p.t="str"}}return e.t!=l&&(e.t=l,e.v=u),"string"==typeof e.f&&e.f&&(h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null,d=C("f",I(e.f),h)+(null!=e.v?d:"")),e.l&&(e.l.display=I(i),r["!links"].push([t,e.l])),e.D&&(p.cm=1),C("c",d,p)}var Po,Oo,Fo,qo,Mo=function(q,e,t,r,M,a,L){for(var n,o,s,c,i=0,l="",u=[],d=[],p=0,h=0,m="",g=0,f=0,y=0,v=0,w=Array.isArray(a.CellXf),b=[],S=[],B=null!=e["!data"],k=[],x={},I=!1,C=!!t.sheetStubs,A=!!((L||{}).WBProps||{}).date1904,T=q.split(Oo),_=0,U=T.length;_!=U;++_){var D=(l=T[_].trim()).length;if(0!==D){var E=0;e:for(i=0;i<D;++i)switch(l[i]){case">":if("/"!=l[i-1]){++i;break e}if(t&&t.cellStyles){if(g=null!=(s=re(l.slice(E,i),!0)).r?parseInt(s.r,10):g+1,f=-1,t.sheetRows&&t.sheetRows<g)continue;I=!(x={}),s.ht&&(I=!0,x.hpt=parseFloat(s.ht),x.hpx=jn(x.hpt)),s.hidden&&ne(s.hidden)&&(x.hidden=I=!0),null!=s.outlineLevel&&(I=!0,x.level=+s.outlineLevel),I&&(k[g-1]=x)}break;case"<":E=i}if(i<=E)break;if(g=null!=(s=re(l.slice(E,i),!0)).r?parseInt(s.r,10):g+1,f=-1,!(t.sheetRows&&t.sheetRows<g)){t.nodim||(r.s.r>g-1&&(r.s.r=g-1),r.e.r<g-1&&(r.e.r=g-1)),t&&t.cellStyles&&(I=!(x={}),s.ht&&(I=!0,x.hpt=parseFloat(s.ht),x.hpx=jn(x.hpt)),s.hidden&&ne(s.hidden)&&(x.hidden=I=!0),null!=s.outlineLevel&&(I=!0,x.level=+s.outlineLevel),I)&&(k[g-1]=x);for(var u=l.slice(i).split(Po),R=0;R!=u.length&&"<"==u[R].trim().charAt(0);++R);for(u=u.slice(R),i=0;i!=u.length;++i)if(0!==(l=u[i].trim()).length){if(d=l.match(Fo),p=i,l="<c "+("<"==l.slice(h=0,1)?">":"")+l,null!=d&&2===d.length){for(m=d[1],h=p=0;h!=m.length&&!((n=m.charCodeAt(h)-64)<1||26<n);++h)p=26*p+n;f=--p}else++f;for(h=0;h!=l.length&&62!==l.charCodeAt(h);++h);if(++h,(s=re(l.slice(0,h),!0)).r||(s.r=ie({r:g-1,c:f})),m=l.slice(h),o={t:""},null!=(d=G(m,"v"))&&""!==d[1]&&(o.v=ae(d[1])),t.cellFormula){null!=(d=G(m,"f"))?""==d[1]?-1<d[0].indexOf('t="shared"')&&S[(N=re(d[0])).si]&&(o.f=lo(S[N.si][1],S[N.si][2],s.r)):(o.f=ae(z(d[1]),!0),t.xlfn||(o.f=uo(o.f)),-1<d[0].indexOf('t="array"')?(o.F=(m.match(qo)||[])[1],-1<o.F.indexOf(":")&&b.push([H(o.F),o.F])):-1<d[0].indexOf('t="shared"')&&(N=re(d[0]),F=ae(z(d[1])),t.xlfn||(F=uo(F)),S[parseInt(N.si,10)]=[N,F,s.r])):(d=m.match(/<f[^<>]*\/>/))&&S[(N=re(d[0])).si]&&(o.f=lo(S[N.si][1],S[N.si][2],s.r));for(var N,P=K(s.r),h=0;h<b.length;++h)P.r>=b[h][0].s.r&&P.r<=b[h][0].e.r&&P.c>=b[h][0].s.c&&P.c<=b[h][0].e.c&&(o.F=b[h][1])}if(null==s.t&&void 0===o.v)if(o.f||o.F)o.v=0,o.t="n";else{if(!C)continue;o.t="z"}else o.t=s.t||"n";switch(r.s.c>f&&(r.s.c=f),r.e.c<f&&(r.e.c=f),o.t){case"n":if(""==o.v||null==o.v){if(!C)continue;o.t="z"}else o.v=parseFloat(o.v);break;case"s":if(void 0===o.v){if(!C)continue;o.t="z"}else c=go[parseInt(o.v,10)],o.v=c.t,o.r=c.r,t.cellHTML&&(o.h=c.h);break;case"str":o.t="s",o.v=null!=o.v?ae(z(o.v),!0):"",t.cellHTML&&(o.h=hr(o.v));break;case"inlineStr":d=G(m,"is"),o.t="s",null!=d&&(c=An(d[1]))?(o.v=c.t,t.cellHTML&&(o.h=c.h)):o.v="";break;case"b":o.v=ne(o.v);break;case"d":t.cellDates?o.v=ee(o.v,A):(o.v=Z(ee(o.v,A),A),o.t="n");break;case"e":t&&!1===t.cellText||(o.w=o.v),o.v=xa[o.v]}var j,O,F,y=v=0;w&&void 0!==s.s&&null!=(F=a.CellXf[s.s])&&(null!=F.numFmtId&&(y=F.numFmtId),t.cellStyles)&&null!=F.fillId&&(v=F.fillId),!function(e,t,r,a,n,o,s){try{a.cellNF&&(e.z=W[t])}catch(e){if(a.WTF)throw e}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=ee(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==W[t]&&Qe(Xe[t]||"General",t),"e"===e.t)e.w=e.w||ka[e.v];else if(0===t)if("n"===e.t)e.w=(0|e.v)===e.v?e.v.toString(10):Ce(e.v);else if("d"===e.t){var c=Z(e.v,!!s);e.w=(0|c)===c?c.toString(10):Ce(c)}else{if(void 0===e.v)return;e.w=Ae(e.v,fo)}else e.w=Ge(t,"d"===e.t?Z(e.v,!!s):e.v,fo)}catch(e){if(a.WTF)throw e}if(a.cellStyles&&null!=r)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=En(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF)&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=En(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF)&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb)}catch(e){if(a.WTF&&o.Fills)throw e}}}(o,y,v,t,M,a,A),t.cellDates&&w&&"n"==o.t&&Be(W[y])&&(o.v=It(o.v+(A?1462:0)),o.t="number"==typeof o.v?"n":"d"),s.cm&&t.xlmeta&&(j=(t.xlmeta.Cell||[])[+s.cm-1])&&"XLDAPR"==j.type&&(o.D=!0),t.nodim&&(O=K(s.r),r.s.r>O.r&&(r.s.r=O.r),r.e.r<O.r)&&(r.e.r=O.r),B?(O=K(s.r),e["!data"][O.r]||(e["!data"][O.r]=[]),e["!data"][O.r][O.c]=o):e[s.r]=o}}}}0<k.length&&(e["!rows"]=k)};function Lo(e,t,r,a){var n=[k,C("worksheet",null,{xmlns:_r[0],"xmlns:r":U.r})],o=r.SheetNames[e],o=r.Sheets[o],s=(o=null==o?{}:o)["!ref"]||"A1",c=H(s);if(16383<c.e.c||1048575<c.e.r){if(t.WTF)throw new Error("Range "+s+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),s=le(c)}a=a||{},o["!comments"]=[];var i,l,c=[],u=o,d=r,p=e,h=t,m=n,g=!1,f={},y=null;if("xlsx"!==h.bookType&&d.vbaraw){h=d.SheetNames[p];try{d.Workbook&&(h=d.Workbook.Sheets[p].CodeName||h)}catch(e){}g=!0,f.codeName=vr(I(h))}u&&u["!outline"]&&(d={summaryBelow:1,summaryRight:1},u["!outline"].above&&(d.summaryBelow=0),u["!outline"].left&&(d.summaryRight=0),y=(y||"")+C("outlinePr",null,d)),(g||y)&&(m[m.length]=C("sheetPr",y,f)),n[n.length]=C("dimension",null,{ref:s}),n[n.length]=(p={workbookViewId:"0"},((((h=r)||{}).Workbook||{}).Views||[])[0]&&(p.rightToLeft=h.Workbook.Views[0].RTL?"1":"0"),C("sheetViews",C("sheetView",null,p),{})),t.sheetFormat&&(n[n.length]=C("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=o["!cols"]&&0<o["!cols"].length&&(n[n.length]=Eo(0,o["!cols"])),n[u=n.length]="<sheetData/>",o["!links"]=[],null!=o["!ref"]&&0<(d=function(e,t,r){var a,n=[],o=[],s=H(e["!ref"]),c=[],i=0,l=0,u=e["!rows"],d=null!=e["!data"],p=d?e["!data"]:[],h={r:""},m=-1,g=(((r||{}).Workbook||{}).WBProps||{}).date1904;for(l=s.s.c;l<=s.e.c;++l)c[l]=ce(l);for(i=s.s.r;i<=s.e.r;++i){for(var o=[],f=se(i),y=d?p[i]:[],l=s.s.c;l<=s.e.c;++l){var v=c[l]+f,w=d?y[l]:e[v];void 0!==w&&null!=(w=No(w,v,e,t,0,0,g))&&o.push(w)}(0<o.length||u&&u[i])&&(h={r:f},u&&u[i]&&((a=u[i]).hidden&&(h.hidden=1),m=-1,a.hpx?m=Un(a.hpx):a.hpt&&(m=a.hpt),-1<m&&(h.ht=m,h.customHeight=1),a.level)&&(h.outlineLevel=a.level),n[n.length]=C("row",o.join(""),h))}if(u)for(;i<u.length;++i)u&&u[i]&&(h={r:i+1},(a=u[i]).hidden&&(h.hidden=1),m=-1,a.hpx?m=Un(a.hpx):a.hpt&&(m=a.hpt),-1<m&&(h.ht=m,h.customHeight=1),a.level&&(h.outlineLevel=a.level),n[n.length]=C("row","",h));return n.join("")}(o,t,r)).length&&(n[n.length]=d),u+1<n.length&&(n[n.length]="</sheetData>",n[u]=n[u].replace("/>",">")),o["!protect"]&&(n[n.length]=(i=o["!protect"],l={sheet:1},_o.forEach(function(e){null!=i[e]&&i[e]&&(l[e]="1")}),Do.forEach(function(e){null==i[e]||i[e]||(l[e]="0")}),i.password&&(l.password=crypto_CreatePasswordVerifier_Method1(i.password).toString(16).toUpperCase()),C("sheetProtection",null,l))),null!=o["!autofilter"]&&(n[n.length]=function(e,t,r,a){var n="string"==typeof e.ref?e.ref:le(e.ref),o=(r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]),r.Workbook.Names);(e=ha(n)).s.r==e.e.r&&(e.e.r=ha(t["!ref"]).e.r,n=le(e));for(var s=0;s<o.length;++s){var c=o[s];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==a){c.Ref=ga(r.SheetNames[a])+"!"+ma(n);break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),C("autoFilter",null,{ref:n})}(o["!autofilter"],o,r,e)),null!=o["!merges"]&&0<o["!merges"].length&&(n[n.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+le(e[r])+'"/>';return t+"</mergeCells>"}(o["!merges"]));var v,w,b,S=-1;return 0<o["!links"].length&&(n[n.length]="<hyperlinks>",o["!links"].forEach(function(e){e[1].Target&&(w={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(S=x(a,-1,I(e[1].Target).replace(/#[\s\S]*$/,""),D.HLINK),w["r:id"]="rId"+S),-1<(v=e[1].Target.indexOf("#"))&&(w.location=I(e[1].Target.slice(v+1))),e[1].Tooltip&&(w.tooltip=I(e[1].Tooltip)),w.display=e[1].display,n[n.length]=C("hyperlink",null,w))}),n[n.length]="</hyperlinks>"),delete o["!links"],null!=o["!margins"]&&(n[n.length]=((m=g=o["!margins"])&&(b="xlml"==b?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],null==m.left&&(m.left=b[0]),null==m.right&&(m.right=b[1]),null==m.top&&(m.top=b[2]),null==m.bottom&&(m.bottom=b[3]),null==m.header&&(m.header=b[4]),null==m.footer)&&(m.footer=b[5]),C("pageMargins",null,g))),t&&!t.ignoreEC&&null!=t.ignoreEC||(n[n.length]=Ir("ignoredErrors",C("ignoredError",null,{numberStoredAsText:1,sqref:s}))),0<c.length&&(S=x(a,-1,"../drawings/drawing"+(e+1)+".xml",D.DRAW),n[n.length]=C("drawing",null,{"r:id":"rId"+S}),o["!drawing"]=c),0<o["!comments"].length&&(S=x(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",D.VML),n[n.length]=C("legacyDrawing",null,{"r:id":"rId"+S}),o["!legacy"]=S),1<n.length&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Bo(e,t,r,a,n,o){var s,c,i,l,u=o||{"!type":"chart"};return e?(i="A",l={s:{r:2e6,c:2e6},e:{r:c=s=0,c:0}},(Bt(e,"<c:numCache>","</c:numCache>")||[]).forEach(function(e){r=[],a=(e=e).match(/^<c:numCache>/),(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/gm)||[]).forEach(function(e){e=e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);e&&(r[+e[1]]=a?+e[2]:e[2])}),n=ae((Wt(e,"c:formatCode")||["","General"])[1]),(Bt(e,"<c:f>","</c:f>")||[]).forEach(function(e){t=e.replace(/<[^<>]*>/g,"")});var t,r,a,n,o=[r,n,t];l.s.r=l.s.c=0,l.e.c=s,i=ce(s),o[0].forEach(function(e,t){u["!data"]?(u["!data"][t]||(u["!data"][t]=[]),u["!data"][t][s]={t:"n",v:e,z:o[1]}):u[i+se(t)]={t:"n",v:e,z:o[1]},c=t}),l.e.r<c&&(l.e.r=c),++s}),0<s&&(u["!ref"]=le(l)),u):o}var Uo=[["allowRefreshQuery",!(qo=/ref=["']([^"']*)["']/),"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!(Fo=/r=["']([^"']*)["']/),"bool"],["checkCompatibility",!(Oo=/<\/(?:\w+:)?row>/),"bool"],["CodeName",""],["date1904",!(Po=/<(?:\w+:)?c[ \/>]/),"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jo=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Wo=[],$o=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Go(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var o=t[n];if(null==a[o[0]])a[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof a[o[0]]&&(a[o[0]]=ne(a[o[0]]));break;case"int":"string"==typeof a[o[0]]&&(a[o[0]]=parseInt(a[o[0]],10))}}}function zo(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=ne(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}var Ko=":][*?/\\".split("");function Ho(t,r){try{if(""==t)throw new Error("Sheet name cannot be blank");if(31<t.length)throw new Error("Sheet name cannot exceed 31 chars");if(39==t.charCodeAt(0)||39==t.charCodeAt(t.length-1))throw new Error("Sheet name cannot start or end with apostrophe (')");if("history"==t.toLowerCase())throw new Error("Sheet name cannot be 'History'");Ko.forEach(function(e){if(-1!=t.indexOf(e))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){if(r)return;throw e}}function Vo(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var o,s,c,e=n.Workbook&&n.Workbook.Sheets||[];o=n.SheetNames,s=e,c=!!n.vbaraw,o.forEach(function(e,t){Ho(e);for(var r=0;r<t;++r)if(e==o[r])throw new Error("Duplicate Sheet Name: "+e);if(c){var a=s&&s[t]&&s[t].CodeName||e;if(95==a.charCodeAt(0)&&22<a.length)throw new Error("Bad Code Name: Worksheet"+a)}});for(var t=0;t<n.SheetNames.length;++t){r=void 0;a=void 0;i=void 0;var r=n.Sheets[n.SheetNames[t]];n.SheetNames[t];var a=t;if(r&&r["!ref"]){var i=H(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+a+"): "+r["!ref"])}}n.SheetNames.forEach(function(e,t){var r,a=n.Sheets[e];a&&a["!autofilter"]&&(n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(e){"_xlnm._FilterDatabase"==e.Name&&e.Sheet==t&&(r=e)}),e=ga(e)+"!"+ma(a["!autofilter"].ref),r?r.Ref=e:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:t,Ref:e}))})}var Xo=/<\w+:workbook/;function Jo(a,n){if(!a)throw new Error("Could not find file");var e,o={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,c="xmlns",i={},l=0;if(a.replace(B,function(e,t){var r=re(e);switch(or(r[0])){case"<?xml":break;case"<workbook":e.match(Xo)&&(c="xmlns"+e.match(/<(\w+):/)[1]),o.xmlns=r[c];break;case"</workbook>":break;case"<fileVersion":delete r[0],o.AppVersion=r;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Uo.forEach(function(e){if(null!=r[e[0]])switch(e[2]){case"bool":o.WBProps[e[0]]=ne(r[e[0]]);break;case"int":o.WBProps[e[0]]=parseInt(r[e[0]],10);break;default:o.WBProps[e[0]]=r[e[0]]}}),r.codeName&&(o.WBProps.CodeName=z(r.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete r[0],o.WBView.push(r);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(r.state){case"hidden":r.Hidden=1;break;case"veryHidden":r.Hidden=2;break;default:r.Hidden=0}delete r.state,r.name=ae(z(r.name)),delete r[0],o.Sheets.push(r);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":(i={}).Name=z(r.name),r.comment&&(i.Comment=r.comment),r.localSheetId&&(i.Sheet=+r.localSheetId),ne(r.hidden||"0")&&(i.Hidden=!0),l=t+e.length;break;case"</definedName>":i.Ref=ae(z(a.slice(l,t))),o.Names.push(i);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete r[0],o.CalcPr=r;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+r[0]+" in workbook")}return e}),-1===_r.indexOf(o.xmlns))throw new Error("Unknown Namespace: "+o.xmlns);return zo((e=o).WBProps,Uo),zo(e.CalcPr,$o),Go(e.WBView,jo),Go(e.Sheets,Wo),fo.date1904=ne(e.WBProps.date1904),o}function Yo(e,t,r,a,n,o,s,c){if(".bin"===t.slice(-4))return parse_cs_bin(e,a,r,n,o,s,c);t=e,a=r,s=n,c=o;if(!t)return t;s=s||{"!id":{}};e={"!type":"chart","!drawel":null,"!rel":""},r=t.match(Co);return r&&To(r[0],0,c,a),(r=t.match(/drawing r:id="(.*?)"/))&&(e["!rel"]=r[1]),s["!id"][e["!rel"]]&&(e["!drawel"]=s["!id"][e["!rel"]]),e}function Qo(e,t,r){if(".bin"===t.slice(-4))return parse_sst_bin(e,r);var t=e,a=r,n=[],o="";if(t){t=G(t,"sst");if(t){for(var o=t[1].replace(Tn,"").split(_n),s=0;s!=o.length;++s){var c=An(o[s].trim(),a);null!=c&&(n[n.length]=c)}t=re(t[0].slice(0,t[0].indexOf(">"))),n.Count=t.count,n.Unique=t.uniqueCount}}return n}function Zo(e,t,r){return".bin"===t.slice(-4)?parse_comments_bin(e,r):(a=r,(t=e).match(/<(?:\w+:)?comments *\/>/)?[]:(n=[],o=[],(r=G(t,"authors"))&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(e){""!==e&&""!==e.trim()&&(e=e.match(/<(?:\w+:)?author[^<>]*>(.*)/))&&n.push(e[1])}),(r=G(t,"commentList"))&&r[1]&&r[1].split(/<\/\w*:?comment>/).forEach(function(e){var t,r;""!==e&&""!==e.trim()&&(r=e.match(/<(?:\w+:)?comment[^<>]*>/))&&(t={author:(r=re(r[0])).authorId&&n[r.authorId]||"sheetjsghost",ref:r.ref,guid:r.guid},r=K(r.ref),a.sheetRows&&a.sheetRows<=r.r||(e=!!(r=G(e,"text"))&&!!r[1]&&An(r[1])||{r:"",t:"",h:""},t.r=e.r,"<t></t>"==e.r&&(e.t=e.h=""),t.t=(e.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),a.cellHTML&&(t.h=e.h),o.push(t)))}),o));var a,n,o}function es(e,t,r){return".bin"===t.slice(-4)?parse_xlmeta_bin(e,t,r):(a=r,c={Types:[],Cell:[],Value:[]},(t=e)&&(n=!1,o=2,t.replace(B,function(e){var t=re(e);switch(or(t[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":c.Types.push({name:t.name});break;case"</metadataType>":break;case"<futureMetadata":for(var r=0;r<c.Types.length;++r)c.Types[r].name==t.name&&(s=c.Types[r]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":1==o?c.Cell.push({type:c.Types[t.t-1].name,index:+t.v}):0==o&&c.Value.push({type:c.Types[t.t-1].name,index:+t.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":s&&(s.offsets||(s.offsets=[]),s.offsets.push(+t.i));break;default:if(!n&&null!=a&&a.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),c);var a,n,o,s,c}function ts(e,t){var r=t||{},t=null!=r.header?r.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a=null!=r.footer?r.footer:"</body></html>",n=[t],o=ha(e["!ref"]||"A1");if(n.push((t=r,[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">")),e["!ref"])for(var s=o.s.r;s<=o.e.r;++s)n.push(function(e,t,r,a){for(var n=e["!merges"]||[],o=[],s={},c=null!=e["!data"],i=t.s.c;i<=t.e.c;++i){for(var l,u,d,p=0,h=0,m=0;m<n.length;++m)if(!(n[m].s.r>r||n[m].s.c>i||n[m].e.r<r||n[m].e.c<i)){if(n[m].s.r<r||n[m].s.c<i){p=-1;break}p=n[m].e.r-n[m].s.r+1,h=n[m].e.c-n[m].s.c+1;break}p<0||(l=ce(i)+se(r),d=(u=(u=c?(e["!data"][r]||[])[i]:e[l])&&"n"==u.t&&null!=u.v&&!isFinite(u.v)?isNaN(u.v)?{t:"e",v:36,w:ka[36]}:{t:"e",v:7,w:ka[7]}:u)&&null!=u.v&&(u.h||hr(u.w||(ya(u),u.w)||""))||"",s={},1<p&&(s.rowspan=p),1<h&&(s.colspan=h),a.editable?d='<span contenteditable="true">'+d+"</span>":u&&(s["data-t"]=u&&u.t||"z",null!=u.v&&(s["data-v"]=hr(u.v instanceof Date?u.v.toISOString():u.v)),null!=u.z&&(s["data-z"]=u.z),u.l)&&"#"!=(u.l.Target||"#").charAt(0)&&(d='<a href="'+hr(u.l.Target)+'">'+d+"</a>"),s.id=(a.id||"sjs")+"-"+l,o.push(C("td",d,s)))}return"<tr>"+o.join("")+"</tr>"}(e,o,s,r));return n.push("</table>"+a),n.join("")}function rs(e,t,r){var a=t.rows;if(!a)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var n,o=r||{},s=null!=e["!data"],c=0,i=0,l=(null!=o.origin&&("number"==typeof o.origin?c=o.origin:(c=(t="string"==typeof o.origin?K(o.origin):o.origin).r,i=t.c)),Math.min(o.sheetRows||1e7,a.length)),u={s:{r:0,c:0},e:{r:c,c:i}},d=(e["!ref"]&&(r=ha(e["!ref"]),u.s.r=Math.min(u.s.r,r.s.r),u.s.c=Math.min(u.s.c,r.s.c),u.e.r=Math.max(u.e.r,r.e.r),u.e.c=Math.max(u.e.c,r.e.c),-1==c)&&(u.e.r=c=r.e.r+1),[]),p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,g=0,f=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<a.length&&g<l;++m){var v=a[m];if(ns(v)){if(o.display)continue;h[g]={hidden:!0}}for(var w=v.cells,f=y=0;f<w.length;++f){var b=w[f];if(!o.display||!ns(b)){for(var S=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):wr(b.innerHTML),k=b.getAttribute("data-z")||b.getAttribute("z"),p=0;p<d.length;++p){var x=d[p];x.s.c==y+i&&x.s.r<g+c&&g+c<=x.e.r&&(y=x.e.c+1-i,p=-1)}n=+b.getAttribute("colspan")||1,(1<(I=+b.getAttribute("rowspan")||1)||1<n)&&d.push({s:{r:g+c,c:y+i},e:{r:g+c+(I||1)-1,c:y+i+(n||1)-1}});var I={t:"s",v:S},C=b.getAttribute("data-t")||b.getAttribute("t")||"",A=(null!=S&&(0==S.length?I.t=C||"z":o.raw||0==S.trim().length||"s"==C||("e"==C&&ka[+S]?I={t:"e",v:+S,w:ka[+S]}:"TRUE"===S?I={t:"b",v:!0}:"FALSE"===S?I={t:"b",v:!1}:isNaN(Dt(S))?isNaN(Ft(S).getDate())?35==S.charCodeAt(0)&&null!=xa[S]&&(I={t:"e",v:xa[S],w:S}):(I={t:"d",v:ee(S)},o.UTC&&(I.v=Mt(I.v)),(I=o.cellDates?I:{t:"n",v:Z(I.v)}).z=o.dateNF||W[14]):I={t:"n",v:Dt(S)})),void 0===I.z&&null!=k&&(I.z=k),""),T=b.getElementsByTagName("A");if(T&&T.length)for(var _=0;_<T.length&&(!T[_].hasAttribute("href")||"#"==(A=T[_].getAttribute("href")).charAt(0));++_);A&&"#"!=A.charAt(0)&&"javascript:"!=A.slice(0,11).toLowerCase()&&(I.l={Target:A}),s?(e["!data"][g+c]||(e["!data"][g+c]=[]),e["!data"][g+c][y+i]=I):e[ie({c:y+i,r:g+c})]=I,u.e.c<y+i&&(u.e.c=y+i),y+=n}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+c),e["!ref"]=le(u),l<=g&&(e["!fullref"]=le((u.e.r=a.length-m+g-1+c,u))),e}function as(e,t){var r={};return(t||{}).dense&&(r["!data"]=[]),rs(r,e,t)}function ns(e){var t="",r=(r=e).ownerDocument.defaultView&&"function"==typeof r.ownerDocument.defaultView.getComputedStyle?r.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null;return"none"===(t=(t=r?r(e).getPropertyValue("display"):t)||e.style&&e.style.display)}function os(e,t,r){var a=r||{},n=Tr(e);oe.lastIndex=0;for(var o,s,c,n=Lt(Ut(n,"\x3c!--","--\x3e")),i="",l="",u=0,d=-1,p="";o=oe.exec(n);)switch(o[3]=o[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":"/"===o[1]?("false"==s["truncate-on-overflow"]&&(i.match(/h/)?i=i.replace(/h+/,"[$&]"):i.match(/m/)?i=i.replace(/m+/,"[$&]"):i.match(/s/)&&(i=i.replace(/s+/,"[$&]"))),a[s.name]=i,i=""):"/"!==o[0].charAt(o[0].length-2)&&(s=re(o[0],!!(i="")));break;case"boolean-style":"/"===o[1]?(a[s.name]="General",i=""):"/"!==o[0].charAt(o[0].length-2)&&(s=re(o[0],!!(i="")));break;case"boolean":i+="General";break;case"text":"/"===o[1]?"%"==(p=n.slice(d,oe.lastIndex-o[0].length))&&"<number:percentage-style"==s[0]?i+="%":i+='"'+p.replace(/"/g,'""')+'"':"/"!==o[0].charAt(o[0].length-2)&&(d=oe.lastIndex);break;case"day":"short"===(c=re(o[0],!1)).style?i+="d":i+="dd";break;case"day-of-week":switch((c=re(o[0],!1)).style){case"short":i+="ddd";break;case"long":i+="dddd";break;default:i+="ddd"}break;case"era":"short"===(c=re(o[0],!1)).style?i+="ee":i+="eeee";break;case"hours":"short"===(c=re(o[0],!1)).style?i+="h":i+="hh";break;case"minutes":"short"===(c=re(o[0],!1)).style?i+="m":i+="mm";break;case"month":switch((c=re(o[0],!1)).textual&&(i+="mm"),c.style){case"short":i+="m";break;case"long":i+="mm";break;default:i+="m"}break;case"seconds":"short"===(c=re(o[0],!1)).style?i+="s":i+="ss",c["decimal-places"]&&(i+="."+S("0",+c["decimal-places"]));break;case"year":switch((c=re(o[0],!1)).style){case"short":i+="yy";break;case"long":i+="yyyy";break;default:i+="yy"}break;case"am-pm":i+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+o[3]);break;case"fill-character":"/"===o[1]?i+='"'+(p=n.slice(d,oe.lastIndex-o[0].length)).replace(/"/g,'""')+'"*':"/"!==o[0].charAt(o[0].length-2)&&(d=oe.lastIndex);break;case"scientific-number":i+="0."+S("0",+(c=re(o[0],!1))["min-decimal-places"]||+c["decimal-places"]||2)+S("?",+c["decimal-places"]-+c["min-decimal-places"]||0)+"E"+(ne(c["forced-exponent-sign"])?"+":"")+S("0",+c["min-exponent-digits"]||2);break;case"fraction":+(c=re(o[0],!1))["min-integer-digits"]?i+=S("0",+c["min-integer-digits"]):i+="#",i=(i=(i+=" ")+S("?",+c["min-numerator-digits"]||1)+"/")+(+c["denominator-value"]?c["denominator-value"]:S("?",+c["min-denominator-digits"]||1));break;case"currency-symbol":"/"===o[1]?i+='"'+n.slice(d,oe.lastIndex-o[0].length).replace(/"/g,'""')+'"':"/"!==o[0].charAt(o[0].length-2)?d=oe.lastIndex:i+="$";break;case"text-properties":switch(((c=re(o[0],!1)).color||"").toLowerCase().replace("#","")){case"ff0000":case"red":i="[Red]"+i}break;case"text-content":i+="@";break;case"map":c=re(o[0],!1),"value()>=0"==ae(c.condition)?i=a[c["apply-style-name"]]+";"+i:console.error("ODS number format may be incorrect: "+c.condition);break;case"number":"/"!==o[1]&&(l="",l+=S("0",+(c=re(o[0],!1))["min-integer-digits"]||1),ne(c.grouping)&&(l=Te(S("#",Math.max(0,4-l.length))+l)),(+c["min-decimal-places"]||+c["decimal-places"])&&(l+="."),+c["min-decimal-places"]&&(l+=S("0",+c["min-decimal-places"]||1)),+c["decimal-places"]-(+c["min-decimal-places"]||0)&&(l+=S("0",+c["decimal-places"]-(+c["min-decimal-places"]||0))),i+=l);break;case"embedded-text":"/"===o[1]?0==u?i+='"'+n.slice(d,oe.lastIndex-o[0].length).replace(/"/g,'""')+'"':i=i.slice(0,u)+'"'+n.slice(d,oe.lastIndex-o[0].length).replace(/"/g,'""')+'"'+i.slice(u):"/"!==o[0].charAt(o[0].length-2)&&(d=oe.lastIndex,u=-+re(o[0],!1).position||0)}return a}function ss(q,e,M){var t,L,r,a,n,o,s,c=e||{},i=(null!=de&&null==c.dense&&(c.dense=de),Tr(q)),l=[],B=0,U={},j=[],u={},d=(c.dense&&(u["!data"]=[]),{value:""}),W={},p="",h=0,$="",G=0,m=[],z=[],g=-1,f=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},v=0,K=M||{},w={},b=[],H={},S=0,k=0,x=[],I=1,C=1,A=[],T={Names:[],WBProps:{}},_={},D=["",""],E=[],R={},V="",X=0,J=!1,Y=!1,N=0;for(oe.lastIndex=0,i=Lt(Ut(i,"\x3c!--","--\x3e"));a=oe.exec(i);)switch(a[3]=a[3].replace(/_[\s\S]*$/,"")){case"table":case"å·¥ä½œè¡¨":"/"===a[1]?(y.e.c>=y.s.c&&y.e.r>=y.s.r?u["!ref"]=le(y):u["!ref"]="A1:A1",0<c.sheetRows&&c.sheetRows<=y.e.r&&(u["!fullref"]=u["!ref"],y.e.r=c.sheetRows-1,u["!ref"]=le(y)),b.length&&(u["!merges"]=b),x.length&&(u["!rows"]=x),r.name=r["åç§°"]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),j.push(r.name),U[r.name]=u,Y=!1):"/"!==a[0].charAt(a[0].length-2)&&(r=re(a[0],!1),g=f=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,u={},c.dense&&(u["!data"]=[]),b=[],x=[],Y=!0);break;case"table-row-group":"/"===a[1]?--v:++v;break;case"table-row":case"è¡Œ":if("/"===a[1])g+=I,I=1;else{if((P=re(a[0],!1))["è¡Œå·"]?g=P["è¡Œå·"]-1:-1==g&&(g=0),(I=+P["number-rows-repeated"]||1)<10)for(N=0;N<I;++N)0<v&&(x[g+N]={level:v});f=-1}break;case"covered-table-cell":if("/"!==a[1])if(++f,d=re(a[0],!1),C=parseInt(d["number-columns-repeated"]||"1",10)||1,c.sheetStubs){for(;0<C--;)c.dense?(u["!data"][g]||(u["!data"][g]=[]),u["!data"][g][f]={t:"z"}):u[ie({r:g,c:f})]={t:"z"},++f;--f}else f+=C-1;p="",m=[];break;case"table-cell":case"æ•°æ®":if("/"===a[0].charAt(a[0].length-2))++f,d=re(a[0],!1),C=parseInt(d["number-columns-repeated"]||"1",10)||1,n={t:"z",v:null},d.formula&&0!=c.cellFormula&&(n.f=po(ae(d.formula))),d["style-name"]&&w[d["style-name"]]&&(n.z=w[d["style-name"]]),"string"==(d["æ•°æ®ç±»å‹"]||d["value-type"])&&(n.t="s",n.v=ae(d["string-value"]||""),c.dense?(u["!data"][g]||(u["!data"][g]=[]),u["!data"][g][f]=n):u[ce(f)+se(g)]=n),f+=C-1;else if("/"!==a[1]){var p=$="",h=G=0,m=[],z=[],C=1,P=I?g+I-1:g;if(++f>y.e.c&&(y.e.c=f),f<y.s.c&&(y.s.c=f),g<y.s.r&&(y.s.r=g),P>y.e.r&&(y.e.r=P),d=re(a[0],!1),W=function(e,t,r){for(var a={},n=0,o=0;n!==e.length&&32!==(o=e.charCodeAt(n))&&10!==o&&13!==o;++n);if(t||(a[0]=e.slice(0,n)),n!==e.length){var s,c=e.match(rr),i=0,l="",u="";if(c)for(i=0;i!=c.length;++i){for(u=c[i].slice(1),o=0;o!=u.length&&61!==u.charCodeAt(o);++o);for(l=u.slice(0,o).trim();32==u.charCodeAt(o+1);)++o;s=34==(n=u.charCodeAt(o+1))||39==n?1:0,s=u.slice(o+1+s,u.length-s),a[l=0<l.indexOf("_")?l.slice(0,l.indexOf("_")):l]=s,r||(a[l.toLowerCase()]=s)}}return a}(a[0],!0),E=[],R={},n={t:d["æ•°æ®ç±»å‹"]||d["value-type"],v:null},d["style-name"]&&w[d["style-name"]]&&(n.z=w[d["style-name"]]),c.cellFormula)if(d.formula&&(d.formula=ae(d.formula)),d["number-matrix-columns-spanned"]&&d["number-matrix-rows-spanned"]&&(S=parseInt(d["number-matrix-rows-spanned"],10)||0,k=parseInt(d["number-matrix-columns-spanned"],10)||0,n.F=le(H={s:{r:g,c:f},e:{r:g+S-1,c:f+k-1}}),A.push([H,n.F])),d.formula)n.f=po(d.formula);else for(N=0;N<A.length;++N)g>=A[N][0].s.r&&g<=A[N][0].e.r&&f>=A[N][0].s.c&&f<=A[N][0].e.c&&(n.F=A[N][1]);switch((d["number-columns-spanned"]||d["number-rows-spanned"])&&1<(S=parseInt(d["number-rows-spanned"]||"1",10)||1)*(k=parseInt(d["number-columns-spanned"]||"1",10)||1)&&b.push(H={s:{r:g,c:f},e:{r:g+S-1,c:f+k-1}}),d["number-columns-repeated"]&&(C=parseInt(d["number-columns-repeated"],10)),n.t){case"boolean":n.t="b",n.v=ne(d["boolean-value"])||1<=+d["boolean-value"];break;case"float":n.t="n",n.v=parseFloat(d.value),c.cellDates&&n.z&&Be(n.z)&&(n.v=It(n.v+(T.WBProps.date1904?1462:0)),n.t="number"==typeof n.v?"n":"d");break;case"percentage":case"currency":n.t="n",n.v=parseFloat(d.value);break;case"date":n.t="d",n.v=ee(d["date-value"],T.WBProps.date1904),c.cellDates||(n.t="n",n.v=Z(n.v,T.WBProps.date1904)),n.z||(n.z="m/d/yy");break;case"time":n.t="n",n.v=function(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=n.length;++o)if(n[o]){switch(3<o&&(a=!0),n[o].slice(n[o].length-(r=1))){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[o].slice(n[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(n[o],10)}return t}(d["time-value"])/86400,c.cellDates&&(n.v=It(n.v),n.t="number"==typeof n.v?"n":"d"),n.z||(n.z="HH:MM:SS");break;case"number":n.t="n",n.v=parseFloat(d["æ•°æ®æ•°å€¼"]);break;default:if("string"!==n.t&&"text"!==n.t&&n.t)throw new Error("Unsupported value type "+n.t);n.t="s",null!=d["string-value"]&&(p=ae(d["string-value"]),m=[])}}else{if(J=!1,"error"==W["calcext:value-type"]&&null!=xa[p]&&(n.t="e",n.w=p,n.v=xa[p]),"s"===n.t&&(n.v=p||"",m.length&&(n.R=m),J=0==h),_.Target&&(n.l=_),0<E.length&&(n.c=E,E=[]),p&&!1!==c.cellText&&(n.w=p),J&&(n.t="z",delete n.v),(!J||c.sheetStubs)&&!(c.sheetRows&&c.sheetRows<=g))for(var O=0;O<I;++O){if(C=parseInt(d["number-columns-repeated"]||"1",10),c.dense)for(u["!data"][g+O]||(u["!data"][g+O]=[]),u["!data"][g+O][f]=0==O?n:te(n);0<--C;)u["!data"][g+O][f+C]=te(n);else for(u[ie({r:g+O,c:f})]=n;0<--C;)u[ie({r:g+O,c:f+C})]=te(n);y.e.c<=f&&(y.e.c=f)}f+=(C=parseInt(d["number-columns-repeated"]||"1",10))-1,C=0,n={},p="",m=[]}_={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===a[1]){if((t=l.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"annotation":if("/"===a[1]){if((t=l.pop())[0]!==a[3])throw"Bad state: "+t;R.t=p,m.length&&(R.R=m),R.a=V,E.push(R),p=$,h=G,m=z}else"/"!==a[0].charAt(a[0].length-2)&&(l.push([a[3],!1]),(o=re(a[0],!0)).display&&ne(o.display)||(E.hidden=!0),$=p,G=h,z=m,p="",h=0,m=[]);V="",X=0;break;case"creator":"/"===a[1]?V=i.slice(X,a.index):X=a.index+a[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===a[1]){if((t=l.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!1]);p="",h=0,m=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":"/"===a[1]?(o=oe.lastIndex,os(i.slice(L,oe.lastIndex),0,K),oe.lastIndex=o):"/"!==a[0].charAt(a[0].length-2)&&(L=oe.lastIndex-a[0].length);break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":var F=re(a[0],!1);"table-cell"==F.family&&K[F["data-style-name"]]&&(w[F.name]=K[F["data-style-name"]]);break;case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"number":case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":case"boolean":break;case"text":if("/>"!==a[0].slice(-2))if("/"===a[1])switch(l[l.length-1][0]){case"number-style":case"date-style":case"time-style":i.slice(B,a.index)}else B=a.index+a[0].length;break;case"named-range":var Q,D=ho((Q=re(a[0],!1))["cell-range-address"]),F={Name:Q.name,Ref:D[0]+"!"+D[1]};Y&&(F.Sheet=j.length),T.Names.push(F);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":break;case"null-date":"1904-01-01"===(Q=re(a[0],!1))["date-value"]&&(T.WBProps.date1904=!0);break;case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"æ–‡æœ¬ä¸²":-1<["master-styles"].indexOf(l[l.length-1][0])||("/"!==a[1]||d&&d["string-value"]?"/>"==a[0].slice(-2)?p+="\n":(re(a[0],!1),h=a.index+a[0].length):(s=(s=i.slice(h,a.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),s=[ae(s.replace(/<[^<>]*>/g,""))],p=(0<p.length?p+"\n":"")+s[0]));break;case"s":break;case"database-range":if("/"!==a[1])try{U[(D=ho(re(a[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(e){}break;case"date":case"object":break;case"title":case"æ ‡é¢˜":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"filter-set-item":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==a[1]){if(!(_=re(a[0],!1)).href)break;_.Target=ae(_.href),delete _.href,"#"==_.Target.charAt(0)&&-1<_.Target.indexOf(".")?(D=ho(_.Target.slice(1)),_.Target="#"+D[0]+"!"+D[1]):_.Target.match(/^\.\.[\\\/]/)&&(_.Target=_.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(a[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(c.WTF)throw new Error(a)}}e={Sheets:U,SheetNames:j,Workbook:T};return c.bookSheets&&delete e.Sheets,e}function cs(e,t){if(t=t||{},Jt(e,"META-INF/manifest.xml"))for(var r,a,n=M(e,"META-INF/manifest.xml"),o=t,s=Tr(n);r=oe.exec(s);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(a=re(r[0],!1)).path&&a.type!==Ra)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(o&&o.WTF)throw r}var n=Qt(e,"styles.xml"),c=n&&os(z(n)),i=Qt(e,"content.xml");if(i)return i=ss(z(i),t,c),Jt(e,"meta.xml")&&(i.Props=Fa(M(e,"meta.xml"))),i.bookType="ods",i;throw new Error("Missing content.xml in ODS / UOF file")}t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),is="<office:document-styles "+Cr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";var is,ls=function(){return k+is};function us(e,t,r){for(var a=[],n=0;n<e.length;++n){var o=e[n];o&&o.Sheet==(-1==r?null:r)&&a.push(o)}return a.length?"      <table:named-expressions>\n"+a.map(function(e){var t=(-1==r?"$":"")+mo(e.Ref);return"        "+C("table:named-range",null,{"table:name":e.Name,"table:cell-range-address":t,"table:base-cell-address":t.replace(/[\.][^\.]*$/,".$A$1")})}).join("\n")+"\n      </table:named-expressions>\n":""}ds=function(e,t){return I(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,t?"<text:line-break/>":"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},ps="          <table:table-cell />\n";var ds,ps,hs=function(e,t){var r=[k],a=Cr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),n=Cr({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"}),o=("fods"==t.bookType?(r.push("<office:document"+a+n+">\n"),r.push(Pa().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+"\n")):r.push("<office:document-content"+a+">\n"),gs(r,e));r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n"),((e.Workbook||{}).WBProps||{}).date1904&&r.push('      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">\n        <table:null-date table:date-value="1904-01-01"/>\n      </table:calculation-settings>\n');for(var s=0;s!=e.SheetNames.length;++s)r.push(ms(e.Sheets[e.SheetNames[s]],e,s,0,o,((e.Workbook||{}).WBProps||{}).date1904));return(e.Workbook||{}).Names&&r.push(us(e.Workbook.Names,0,-1)),r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")};function ms(e,t,r,a,n,o){var s=[],c=(s.push('      <table:table table:name="'+I(t.SheetNames[r])+'" table:style-name="ta1">\n'),0),i=0,l=ha(e["!ref"]||"A1"),u=e["!merges"]||[],d=0,p=null!=e["!data"];if(e["!cols"])for(i=0;i<=l.e.c;++i)s.push("        <table:table-column"+(e["!cols"][i]?' table:style-name="co'+e["!cols"][i].ods+'"':"")+"></table:table-column>\n");for(var h="",m=e["!rows"]||[],c=0;c<l.s.r;++c)h=m[c]?' table:style-name="ro'+m[c].ods+'"':"",s.push("        <table:table-row"+h+"></table:table-row>\n");for(;c<=l.e.r;++c){for(h=m[c]?' table:style-name="ro'+m[c].ods+'"':"",s.push("        <table:table-row"+h+">\n"),i=0;i<l.s.c;++i)s.push(ps);for(;i<=l.e.c;++i){for(var g=!1,f={},y="",d=0;d!=u.length;++d)if(!(u[d].s.c>i||u[d].s.r>c||u[d].e.c<i||u[d].e.r<c)){u[d].s.c==i&&u[d].s.r==c||(g=!0),f["table:number-columns-spanned"]=u[d].e.c-u[d].s.c+1,f["table:number-rows-spanned"]=u[d].e.r-u[d].s.r+1;break}if(g)s.push("          <table:covered-table-cell/>\n");else{var v=ie({r:c,c:i}),w=p?(e["!data"][c]||[])[i]:e[v];if(w&&w.f&&(f["table:formula"]=I(("of:="+w.f.replace(so,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),w.F)&&w.F.slice(0,v.length)==v&&(v=ha(w.F),f["table:number-matrix-columns-spanned"]=v.e.c-v.s.c+1,f["table:number-matrix-rows-spanned"]=v.e.r-v.s.r+1),w){switch(w.t){case"b":y=w.v?"TRUE":"FALSE",f["office:value-type"]="boolean",f["office:boolean-value"]=w.v?"true":"false";break;case"n":isFinite(w.v)?(y=w.w||String(w.v||0),f["office:value-type"]="float",f["office:value"]=w.v||0):(isNaN(w.v)?(y="#NUM!",f["table:formula"]="of:=#NUM!"):(y="#DIV/0!",f["table:formula"]="of:="+(w.v<0?"-":"")+"1/0"),f["office:string-value"]="",f["office:value-type"]="string",f["calcext:value-type"]="error");break;case"s":case"str":y=null==w.v?"":w.v,f["office:value-type"]="string";break;case"d":y=w.w||ee(w.v,o).toISOString(),f["office:value-type"]="date",f["office:date-value"]=ee(w.v,o).toISOString(),f["table:style-name"]="ce1";break;default:s.push(ps);continue}var v=ds(y),b=(w.l&&w.l.Target&&(v=C("text:a",v,{"xlink:href":(b="#"==(b="#"==(b=w.l.Target).charAt(0)?"#"+mo(b.slice(1)):b).charAt(0)||b.match(/^\w+:/)?b:"../"+b).replace(/&/g,"&amp;")})),n[w.z]&&(f["table:style-name"]="ce"+n[w.z].slice(1)),C("text:p",v,{}));if(w.c){for(var S="",k="",v={},x=0;x<w.c.length;++x)!S&&w.c[x].a&&(S=w.c[x].a),k+="<text:p>"+ds(w.c[x].t)+"</text:p>";w.c.hidden||(v["office:display"]=!0),b=C("office:annotation",k,v)+b}s.push("          "+C("table:table-cell",b,f)+"\n")}else s.push(ps)}}s.push("        </table:table-row>\n")}return(t.Workbook||{}).Names&&s.push(us(t.Workbook.Names,0,r)),s.push("      </table:table>\n"),s.join("")}function gs(c,t){c.push(" <office:automatic-styles>\n");var a=0,n=(t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(e){if(e&&e["!cols"])for(var t=0;t<e["!cols"].length;++t)if(e["!cols"][t]){var r=e["!cols"][t];if(null==r.width&&null==r.wpx&&null==r.wch)continue;Ln(r),r.ods=a;r=e["!cols"][t].wpx+"px";c.push('  <style:style style:name="co'+a+'" style:family="table-column">\n'),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+r+'"/>\n'),c.push("  </style:style>\n"),++a}}),0),i=(t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(e){if(e&&e["!rows"])for(var t,r=0;r<e["!rows"].length;++r)e["!rows"][r]&&(e["!rows"][r].ods=n,t=e["!rows"][r].hpx+"px",c.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+t+'"/>\n'),c.push("  </style:style>\n"),++n)}),c.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),c.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),c.push("  </style:style>\n"),c.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),c.push('   <number:month number:style="long"/>\n'),c.push("   <number:text>/</number:text>\n"),c.push('   <number:day number:style="long"/>\n'),c.push("   <number:text>/</number:text>\n"),c.push("   <number:year/>\n"),c.push("  </number:date-style>\n"),{}),l=69;return t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(e){if(e){var t=null!=e["!data"];if(e["!ref"])for(var r=ha(e["!ref"]),a=0;a<=r.e.r;++a)for(var n=0;n<=r.e.c;++n){var o,s=t?(e["!data"][a]||[])[n]:e[ie({r:a,c:n})];s&&s.z&&"general"!=s.z.toLowerCase()&&(i[s.z]||(o=function(e,t){var r="number",a="",n={"style:name":t},o="",s=0;e:if(-1<(e=e.replace(/"[$]"/g,"$")).indexOf(";")&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),"@"==e)r="text",a="<number:text-content/>";else{if(-1<e.indexOf(/\$/)&&(r="currency"),'"'==e[s]){for(o="";'"'!=e[++s]||'"'==e[++s];)o+=e[s];"*"==e[--s+1]?(s++,a+="<number:fill-character>"+I(o.replace(/""/g,'"'))+"</number:fill-character>"):a+="<number:text>"+I(o.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var c=e.match(/# (\?+)\/(\?+)/);if(c)a+=C("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":c[1].length,"number:max-denominator-value":Math.max(+c[1].replace(/./g,"9"),+c[2].replace(/./g,"9"))});else if(c=e.match(/# (\?+)\/(\d+)/))a+=C("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":c[1].length,"number:denominator-value":+c[2]});else if(c=e.match(/\b(\d+)(|\.\d+)%/))r="percentage",a+=C("number:number",null,{"number:decimal-places":c[2]&&c.length-1||0,"number:min-decimal-places":c[2]&&c.length-1||0,"number:min-integer-digits":c[1].length})+"<number:text>%</number:text>";else{var i=!1;if(-1<["y","m","d"].indexOf(e[0])){r="date";t:for(;s<e.length;++s)switch(o=e[s].toLowerCase()){case"h":case"s":i=!0,--s;break t;case"m":r:for(var l=s+1;l<e.length;++l)switch(e[l]){case"y":case"d":break r;case"h":case"s":i=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==o[0];)o+=o[0];switch(--s,o){case"y":case"yy":a+="<number:year/>";break;case"yyy":case"yyyy":a+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":a+='<number:month number:style="'+(o.length%2?"short":"long")+'" number:textual="'+(3<=o.length?"true":"false")+'"/>';break;case"d":case"dd":a+='<number:day number:style="'+(o.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":a+='<number:day-of-week number:style="'+(o.length%2?"short":"long")+'"/>'}break;case'"':for(;'"'!=e[++s]||'"'==e[++s];)o+=e[s];--s,a+="<number:text>"+I(o.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":a+="<number:text>"+I(o=e[++s])+"</number:text>";break;case"/":case":":a+="<number:text>"+I(o)+"</number:text>";break;default:console.error("unrecognized character "+o+" in ODF format "+e)}if(!i)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/))for("number"==r&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),n["number:truncate-on-overflow"]="false");s<e.length;++s)switch(o=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==o[0];)o+=o[0];switch(--s,o){case"h":case"hh":a+='<number:hours number:style="'+(o.length%2?"short":"long")+'"/>';break;case"m":case"mm":a+='<number:minutes number:style="'+(o.length%2?"short":"long")+'"/>';break;case"s":case"ss":if("."==e[s+1])for(;o+=e[s+1],"0"==e[++s+1];);a+='<number:seconds number:style="'+(o.match("ss")?"long":"short")+'"'+(o.match(/\./)?' number:decimal-places="'+(o.match(/0+/)||[""])[0].length+'"':"")+"/>"}break;case'"':for(;'"'!=e[++s]||'"'==e[++s];)o+=e[s];--s,a+="<number:text>"+I(o.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":a+="<number:text>"+I(o)+"</number:text>";break;case"a":if("a/p"==e.slice(s,s+3).toLowerCase()){a+="<number:am-pm/>",s+=2;break}if("am/pm"==e.slice(s,s+5).toLowerCase()){a+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+o+" in ODF format "+e)}else{if(-1<e.indexOf(/\$/)&&(r="currency"),"$"==e[0]&&(a+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),'"'==e[s=0]){for(;'"'!=e[++s]||'"'==e[++s];)o+=e[s];"*"==e[--s+1]?(s++,a+="<number:fill-character>"+I(o.replace(/""/g,'"'))+"</number:fill-character>"):a+="<number:text>"+I(o.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var u,c=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(c&&c[0]?(u=c[1].replace(/,/g,""),a+="<number:"+(c[3]?"scientific-":"")+'number number:min-integer-digits="'+(-1==u.indexOf("0")?"0":u.length-u.indexOf("0"))+'"'+(-1<c[0].indexOf(",")?' number:grouping="true"':"")+(c[2]&&' number:decimal-places="'+(c[2].length-1)+'"'||' number:decimal-places="0"')+(c[3]&&-1<c[3].indexOf("+")?' number:forced-exponent-sign="true"':"")+(c[3]?' number:min-exponent-digits="'+c[3].match(/0+/)[0].length+'"':"")+"></number:"+(c[3]?"scientific-":"")+"number>",s=c.index+c[0].length):console.error("Could not find numeric part of "+e),'"'==e[s]){for(o="";'"'!=e[++s]||'"'==e[++s];)o+=e[s];--s,a+="<number:text>"+I(o.replace(/""/g,'"'))+"</number:text>"}}}}return a?C("number:"+r+"-style",a,n):(console.error("Could not generate ODS number format for |"+e+"|"),"")}(s.z,"N"+l))&&(i[s.z]="N"+l,++l,c.push(o+"\n")))}}}),c.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),R(i).forEach(function(e){c.push('<style:style style:name="ce'+i[e].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+i[e]+'"/>\n')}),c.push(" </office:automatic-styles>\n"),i}function fs(e,t){var r,a,n,o;return"fods"==t.bookType?hs(e,t):(o="",a=[],n=[],L(r=er(),o="mimetype","application/vnd.oasis.opendocument.spreadsheet"),L(r,o="content.xml",hs(e,t)),a.push([o,"text/xml"]),n.push([o,"ContentFile"]),L(r,o="styles.xml",ls(e,t)),a.push([o,"text/xml"]),n.push([o,"StylesFile"]),L(r,o="meta.xml",k+Pa()),a.push([o,"text/xml"]),n.push([o,"MetadataFile"]),L(r,o="manifest.rdf",function(e){var t=[k];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(Na(e[r][0],e[r][1])),t.push(['  <rdf:Description rdf:about="">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[r][0]+'"/>\n',"  </rdf:Description>\n"].join(""));return t.push(Na("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(n)),a.push([o,"application/rdf+xml"]),L(r,o="META-INF/manifest.xml",function(e){var t=[k];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),r)}function ys(a){return function(e){for(var t=0;t!=a.length;++t){var r=a[t];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}}}function vs(e){ys([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ws(t,e){if(!t)return 0;try{t=e.map(function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,(e=t["!id"][e.id].Type,-1<D.WS.indexOf(e)?"sheet":D.CS&&e==D.CS?"chart":D.DS&&e==D.DS?"dialog":D.MS&&e==D.MS?"macro":e&&e.length?e:"sheet")]})}catch(e){return null}return t&&0!==t.length?t:null}function bs(e,t,r,a,n,o,s,c){var l,u,d;e&&e["!legdrawel"]&&(r=Qt(r,tr(e["!legdrawel"].Target,a),!0))&&(a=z(r),l=e,u=c||[],d=0,(Kt(a,"shape")||[]).forEach(function(a){var e,n="",o=!0,s=-1,c=-1,i=-1;a.replace(B,function(e,t){var r=re(e);switch(or(r[0])){case"<ClientData":r.ObjectType&&(n=r.ObjectType);break;case"<Visible":case"<Visible/>":o=!1;break;case"<Row":case"<Row>":s=t+e.length;break;case"</Row>":c=+a.slice(s,t).trim();break;case"<Column":case"<Column>":s=t+e.length;break;case"</Column>":i=+a.slice(s,t).trim()}return""}),"Note"===n&&((e=Vs(l,0<=c&&0<=i?ie({r:c,c:i}):u[d].ref)).c&&(e.c.hidden=o),++d)}))}function Ss(r,l,e,u,t,d,a,n,p,o,s,c){try{d[u]=Da(Qt(r,e,!0),l);var i,h,m,g,f,y=M(r,l);switch(n){case"sheet":k=y,x=t,I=p,C=d[u],A=o,T=s,_=c,f=(".bin"===l.slice(-4)?parse_ws_bin:Ao)(k,I,x,C,A,T,_);break;case"chart":(f=Yo(y,l,t,p,d[u],o,s,c))&&f["!drawel"]&&(h=_a(i=tr(f["!drawel"].Target,l)),b=Qt(r,i,!0),S=Da(Qt(r,h,!0),i),g=_a(m=tr(b?(b=(b.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1],S["!id"][b].Target):"??",i)),f=Bo(Qt(r,m,!0),0,0,Da(Qt(r,g,!0),m),0,f));break;case"macro":l.slice(-4),f={"!type":"macro"};break;case"dialog":l.slice(-4),f={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+n)}a[u]=f;var v=[],w=[];d&&d[u]&&R(d[u]).forEach(function(e){var a,n,o,s,c,i,t="";if(d[u][e].Type==D.CMNT){if(t=tr(d[u][e].Target,l),!(v=Zo(M(r,t,!0),t,p))||!v.length)return;Yn(f,v,!1)}d[u][e].Type==D.TCMNT&&(t=tr(d[u][e].Target,l),w=w.concat((a=M(r,t,!0),n=p,s=!(o=[]),c={},i=0,a.replace(B,function(e,t){var r=re(e);switch(or(r[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":c={author:r.personId,guid:r.id,ref:r.ref,T:1};break;case"</threadedComment>":null!=c.t&&o.push(c);break;case"<text>":case"<text":i=t+e.length;break;case"</text>":c.t=a.slice(i,t).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e}),o)))}),w&&w.length&&Yn(f,w,!0,p.people||[]),bs(f,0,r,l,0,0,0,v)}catch(e){if(p.WTF)throw e}var b,S,k,x,I,C,A,T,_}function ks(e){return"/"==e.charAt(0)?e.slice(1):e}function xs(n,o){var t;if(He(),ys([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(o=o||{}),Jt(n,"META-INF/manifest.xml"))return cs(n,o);if(Jt(n,"objectdata.xml"))return cs(n,o);if(Jt(n,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if("undefined"!=typeof parse_numbers_iwa)return n.FileIndex?parse_numbers_iwa(n,o):(t=J.utils.cfb_new(),Zt(n).forEach(function(e){L(t,e,function e(t,r,a){if(!a)return Xt(Yt(t,r));if(!r)return null;try{return e(t,r)}catch(e){return null}}(n,e))}),parse_numbers_iwa(t,o));throw new Error("Unsupported NUMBERS file")}if(!Jt(n,"[Content_Types].xml")){if(Jt(n,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Jt(n,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var e=J.find(n,"Index.zip");if(e)return delete(o=te(o)).type,"string"==typeof e.content&&(o.type="binary"),"undefined"!=typeof Bun&&Buffer.isBuffer(e.content)?Rs(new Uint8Array(e.content),o):Rs(e.content,o);throw new Error("Unsupported ZIP file")}var e=Zt(n),r=function(e){var r=Aa();if(e&&e.match){var a={};if((e.match(B)||[]).forEach(function(e){var t=re(e);switch(t[0].replace(ar,"<")){case"<?xml":break;case"<Types":r.xmlns=t["xmlns"+(t[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[t.Extension.toLowerCase()]=t.ContentType;break;case"<Override":void 0!==r[Ia[t.ContentType]]&&r[Ia[t.ContentType]].push(t.PartName)}}),r.xmlns!==U.CT)throw new Error("Unknown Namespace: "+r.xmlns);r.calcchain=0<r.calcchains.length?r.calcchains[0]:"",r.sst=0<r.strs.length?r.strs[0]:"",r.style=0<r.styles.length?r.styles[0]:"",r.defaults=a,delete r.calcchains}return r}(Qt(n,"[Content_Types].xml")),a=!1;if(0===r.workbooks.length&&M(n,s="xl/workbook.xml",!0)&&r.workbooks.push(s),0===r.workbooks.length){if(!M(n,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");r.workbooks.push(s),a=!0}"bin"==r.workbooks[0].slice(-3)&&(a=!0);var s,c={},i={};if(!o.bookSheets&&!o.bookProps){if(go=[],r.sst)try{go=Qo(M(n,ks(r.sst)),r.sst,o)}catch(e){if(o.WTF)throw e}o.cellStyles&&r.themes.length&&(c=function(e,t){var r,a={};if(r=Wt(e=e&&0!==e.length?e:Vn(),"a:themeElements"))return Hn(r[0],a,t),a.raw=e,a;throw new Error("themeElements not found in theme")}(Qt(n,r.themes[0].replace(/^\//,""),!0)||"",o)),r.style&&(s=M(n,ks(r.style)),l=r.style,u=c,d=o,i=(".bin"===l.slice(-4)?parse_sty_bin:Gn)(s,u,d))}r.links.map(function(e){try{Da(Qt(n,_a(ks(e))),e);var t=M(n,ks(e)),r=e,a=o;if(".bin"===r.slice(-4))return Xn(t,0,0,a)}catch(e){}});l=M(n,ks(r.workbooks[0])),u=r.workbooks[0],d=o;var l,u,d,p=(".bin"===u.slice(-4)?parse_wb_bin:Jo)(l,d),h={},m="",g=(r.coreprops.length&&((m=M(n,ks(r.coreprops[0]),!0))&&(h=Fa(m)),0!==r.extprops.length)&&(m=M(n,ks(r.extprops[0]),!0))&&Ba(m,h,o),{}),f=(o.bookSheets&&!o.bookProps||0!==r.custprops.length&&(m=Qt(n,ks(r.custprops[0]),!0))&&(g=function(e,t){var r={},a="",n=e.match(ja);if(n)for(var o=0;o!=n.length;++o){var s=n[o],c=re(s);switch(or(c[0])){case"<?xml":case"<Properties":break;case"<property":a=ae(c.name);break;case"</property>":a=null;break;default:if(0===s.indexOf("<vt:")){var i=s.split(">"),l=i[0].slice(4),u=i[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[a]=ae(u);break;case"bool":r[a]=ne(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=ee(u);break;case"cy":case"error":r[a]=ae(u);break;default:"/"!=l.slice(-1)&&t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,l,i)}}else if("</"!==s.slice(0,2)&&t.WTF)throw new Error(s)}}return r}(m,o)),{});if(!o.bookSheets&&!o.bookProps||(p.Sheets?b=p.Sheets.map(function(e){return e.name}):h.Worksheets&&0<h.SheetNames.length&&(b=h.SheetNames),o.bookProps&&(f.Props=h,f.Custprops=g),o.bookSheets&&void 0!==b&&(f.SheetNames=b),o.bookSheets?!f.SheetNames:!o.bookProps)){var y,v,w,b={},m={},S=(o.bookDeps&&r.calcchain&&(E=M(n,ks(r.calcchain)),C=r.calcchain,y=o,m=(".bin"===C.slice(-4)?parse_cc_bin:parse_cc_xml)(E,C,y)),0),k={},x=p.Sheets;h.Worksheets=x.length,h.SheetNames=[];for(var I=0;I!=x.length;++I)h.SheetNames[I]=x[I].name;for(var C,A,T,_,D=a?"bin":"xml",E=r.workbooks[0].lastIndexOf("/"),R=(r.workbooks[0].slice(0,E+1)+"_rels/"+r.workbooks[0].slice(E+1)+".rels").replace(/^\//,""),N=(Jt(n,R)||(R="xl/_rels/workbook."+D+".rels"),Da(Qt(n,R,!0),R.replace(/_rels.*/,"s5s"))),q=(1<=(r.metadata||[]).length&&(o.xlmeta=es(M(n,ks(r.metadata[0])),r.metadata[0],o)),1<=(r.people||[]).length&&(o.people=(C=M(n,ks(r.people[0])),A=o,_=!(T=[]),C.replace(B,function(e){var t;switch(or((t=re(e))[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":T.push({name:t.displayname,id:t.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;default:if(!_&&A.WTF)throw new Error("unrecognized "+t[0]+" in threaded comments")}return e}),T)),N=N&&ws(N,p.Sheets),M(n,"xl/worksheets/sheet.xml",!0)?1:0),S=0;S!=h.Worksheets;++S){var P="sheet";if(N&&N[S]?(v="xl/"+N[S][1].replace(/[\/]?xl\//,""),Jt(n,v)||(v=N[S][1]),Jt(n,v)||(v=R.replace(/_rels\/[\S\s]*$/,"")+N[S][1]),P=N[S][2]):v=(v="xl/worksheets/sheet"+(S+1-q)+"."+D).replace(/sheet0\./,"sheet."),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),o&&null!=o.sheets)switch(typeof o.sheets){case"number":if(S!=o.sheets)continue;break;case"string":if(h.SheetNames[S].toLowerCase()!=o.sheets.toLowerCase())continue;break;default:if(Array.isArray&&Array.isArray(o.sheets)){for(var O=!1,F=0;F!=o.sheets.length;++F)"number"==typeof o.sheets[F]&&o.sheets[F]==S&&(O=1),"string"==typeof o.sheets[F]&&o.sheets[F].toLowerCase()==h.SheetNames[S].toLowerCase()&&(O=1);if(!O)continue}}Ss(n,v,w,h.SheetNames[S],S,k,b,P,o,p,c,i)}f={Directory:r,Workbook:p,Props:h,Custprops:g,Deps:m,Sheets:b,SheetNames:h.SheetNames,Strings:go,Styles:i,Themes:c,SSF:te(W)},o&&o.bookFiles&&(n.files?(f.keys=e,f.files=n.files):(f.keys=[],f.files={},n.FullPaths.forEach(function(e,t){e=e.replace(/^Root Entry[\/]/,""),f.keys.push(e),f.files[e]=n.FileIndex[t]}))),o&&o.bookVBA&&(0<r.vba.length?f.vbaraw=M(n,ks(r.vba[0]),!0):r.defaults&&r.defaults.bin===eo&&(f.vbaraw=M(n,"xl/vbaProject.bin",!0))),f.bookType=a?"xlsb":"xlsx"}return f}function Is(e,t){e&&!e.SSF&&(e.SSF=te(W)),e&&e.SSF&&(He(),Ke(e.SSF),t.revssf=bt(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,yo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=-1<to.indexOf(t.bookType),n=Aa(),o=(vs(t=t||{}),er()),s="",c=0;if(t.cellXfs=[],vo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),L(o,s="docProps/core.xml",Ma(e.Props,t)),n.coreprops.push(s),x(t.rels,2,s,D.CORE_PROPS),s="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var i=[],l=0;l<e.SheetNames.length;++l)2!=(e.Workbook.Sheets[l]||{}).Hidden&&i.push(e.SheetNames[l]);e.Props.SheetNames=i}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,L(o,s,Ua(e.Props)),n.extprops.push(s),x(t.rels,3,s,D.EXT_PROPS),e.Custprops!==e.Props&&0<R(e.Custprops||{}).length&&(L(o,s="docProps/custom.xml",Wa(e.Custprops)),n.custprops.push(s),x(t.rels,4,s,D.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var d,p,h,m,g={"!id":{}},f=e.Sheets[e.SheetNames[c-1]];(f||{})["!type"];L(o,s="xl/worksheets/sheet"+c+"."+r,Lo(c-1,t,e,g)),n.sheets.push(s),x(t.wbrels,-1,"worksheets/sheet"+c+"."+r,D.WS[0]),f&&(p=!1,h="",(d=f["!comments"])&&0<d.length&&(m=!1,d.forEach(function(e){e[1].forEach(function(e){1==e.T&&(m=!0)})}),m&&(L(o,h="xl/threadedComments/threadedComment"+c+".xml",Qn(d,u,t)),n.threadedcomments.push(h),x(g,-1,"../threadedComments/threadedComment"+c+".xml",D.TCMNT)),L(o,h="xl/comments"+c+"."+r,function(e){var s=[k,C("comments",null,{xmlns:_r[0]})],c=[];return s.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var t=I(e.a);-1==c.indexOf(t)&&(c.push(t),s.push("<author>"+t+"</author>")),e.T&&e.ID&&-1==c.indexOf("tc="+e.ID)&&(c.push("tc="+e.ID),s.push("<author>tc="+e.ID+"</author>"))})}),0==c.length&&(c.push("SheetJ5"),s.push("<author>SheetJ5</author>")),s.push("</authors>"),s.push("<commentList>"),e.forEach(function(t){var r=0,a=[],n=0;if(t[1][0]&&t[1][0].T&&t[1][0].ID&&(r=c.indexOf("tc="+t[1][0].ID)),t[1].forEach(function(e){e.a&&(r=c.indexOf(I(e.a))),e.T&&++n,a.push(null==e.t?"":I(e.t))}),0===n)t[1].forEach(function(e){s.push('<comment ref="'+t[0]+'" authorId="'+c.indexOf(I(e.a))+'"><text>'),s.push(Ir("t",null==e.t?"":I(e.t))),s.push("</text></comment>")});else{t[1][0]&&t[1][0].T&&t[1][0].ID&&(r=c.indexOf("tc="+t[1][0].ID)),s.push('<comment ref="'+t[0]+'" authorId="'+r+'"><text>');for(var e="Comment:\n    "+a[0]+"\n",o=1;o<a.length;++o)e+="Reply:\n    "+a[o]+"\n";s.push(Ir("t",I(e))),s.push("</text></comment>")}}),s.push("</commentList>"),2<s.length&&(s[s.length]="</comments>",s[1]=s[1].replace("/>",">")),s.join("")}(d)),n.comments.push(h),x(g,-1,"../comments"+c+"."+r,D.CMNT),p=!0),f["!legacy"]&&p&&L(o,"xl/drawings/vmlDrawing"+c+".vml",Jn(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]),g["!id"].rId1&&L(o,_a(s),Ea(g))}return null!=t.Strings&&0<t.Strings.length&&(L(o,s="xl/sharedStrings.xml",function(e,t){if(!t.bookSST)return"";var r=[k];r[r.length]=C("sst",null,{xmlns:_r[0],count:e.Count,uniqueCount:e.Unique});for(var a,n,o=0;o!=e.length;++o)null!=e[o]&&(n="<si>",(a=e[o]).r?n+=a.r:(n+="<t",a.t||(a.t=""),"string"!=typeof a.t&&(a.t=String(a.t)),a.t.match(Dn)&&(n+=' xml:space="preserve"'),n+=">"+I(a.t)+"</t>"),r[r.length]=n+="</si>");return 2<r.length&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}(t.Strings,t)),n.strs.push(s),x(t.wbrels,-1,"sharedStrings.xml",D.SST)),L(o,s="xl/workbook.xml",function(t){var r=[k],e=(r[r.length]=C("workbook",null,{xmlns:_r[0],"xmlns:r":U.r}),t.Workbook&&0<(t.Workbook.Names||[]).length),a={codeName:"ThisWorkbook"},n=(t.Workbook&&t.Workbook.WBProps&&(Uo.forEach(function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(a[e[0]]=t.Workbook.WBProps[e[0]])}),t.Workbook.WBProps.CodeName)&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName),r[r.length]=C("workbookPr",null,a),t.Workbook&&t.Workbook.Sheets||[]),o=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=t.SheetNames.length&&n[o]&&n[o].Hidden;++o);o==t.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var s={name:I(t.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),n[o])switch(n[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}r[r.length]=C("sheet",null,s)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(r[r.length]=C("definedName",I(e.Ref),t))}),r[r.length]="</definedNames>"),2<r.length&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}(e)),n.workbooks.push(s),x(t.rels,1,s,D.WB),L(o,s="xl/theme/theme1.xml",Vn(e.Themes,t)),n.themes.push(s),x(t.wbrels,-1,"theme/theme1.xml",D.THEME),L(o,s="xl/styles.xml",zn(e,t)),n.styles.push(s),x(t.wbrels,-1,"styles.xml",D.STY),e.vbaraw&&a&&(L(o,s="xl/vbaProject.bin",e.vbaraw),n.vba.push(s),x(t.wbrels,-1,"vbaProject.bin",D.VBA)),L(o,s="xl/metadata.xml",((a=[k]).push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),a.join(""))),n.metadata.push(s),x(t.wbrels,-1,"metadata.xml",D.XLMETA),1<u.length&&(L(o,s="xl/persons/person.xml",Zn(u)),n.people.push(s),x(t.wbrels,-1,"persons/person.xml",D.PEOPLE)),L(o,"[Content_Types].xml",Ta(n,t)),L(o,"_rels/.rels",Ea(t.rels)),L(o,"xl/_rels/workbook.xml.rels",Ea(t.wbrels)),delete t.revssf,delete t.ssf,o}function Cs(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=pe(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function As(e,t){if(J.find(e,"EncryptedPackage")){var r=e,a=(a=t)||{},n="Workbook",o=J.find(r,n);try{if(n="/!DataSpaces/Version",!(o=J.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(o.content),n="/!DataSpaces/DataSpaceMap",!(o=J.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=parse_DataSpaceMap(o.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(o=J.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=parse_DataSpaceDefinition(o.content);if(1!=c.length||"StrongEncryptionTransform"!=c[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(o=J.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(o.content)}catch(e){}if(!(o=J.find(r,n="/EncryptionInfo"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s=parse_EncryptionInfo(o.content),n="/EncryptedPackage",!(o=J.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==s[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(s[1],o.content,a.password||"",a);if(2==s[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(s[1],o.content,a.password||"",a);throw new Error("File is password-protected")}return parse_xlscfb(e,t)}function Ts(e,t){var r=e,t=t||{};return t.type||(t.type=ue&&Buffer.isBuffer(e)?"buffer":"base64"),xs(function(e,t){switch(t.type){case"base64":return J.read(e,{type:"base64"});case"binary":return J.read(e,{type:"binary"});case"buffer":case"array":return J.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}(r,t),t)}function _s(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return parse_xlml(e.slice(r),t);default:break e}return dn.to_workbook(e,t)}function Ds(e,t){var r=e;return"base64"==t.type&&(r=pe(r)),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&(r=new Uint8Array(e)),r=void 0!==q?q.utils.decode(1200,r.slice(2),"str"):ue&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):"undefined"!=typeof Uint8Array&&r instanceof Uint8Array?"undefined"!=typeof TextDecoder?new TextDecoder("utf-16le").decode(r.slice(2)):function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e[2*r]+(e[2*r+1]<<8));return t.join("")}(r.slice(2)):o(r.slice(2)),t.type="binary",_s(r,t)}function Es(e,t,r,a){return a?(r.type="string",dn.to_workbook(e,r)):dn.to_workbook(t,r)}function Rs(e,t){m();var r=t||{};if(r.codepage&&void 0===q&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Rs(new Uint8Array(e),((r=te(r)).type="array",r));if("undefined"!=typeof Int8Array&&e instanceof Int8Array)return Rs(new Uint8Array(e.buffer,e.byteOffset,e.length),r);"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!=typeof Deno?"buffer":"array");var a,n=e,o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),fo={},r.dateNF&&(fo.dateNF=r.dateNF),r.type||(r.type=ue&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=ue?"buffer":"binary",n=function(e){if(void 0!==gt)return gt.readFileSync(e);if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e),r=(t.open("r"),t.encoding="binary",t.read());return t.close(),r}catch(e){if(!e.message||-1==e.message.indexOf("onstruct"))throw e}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||ue||(r.type="array")),"string"==r.type&&(o=!0,r.type="binary",r.codepage=65001,n=(t=e).match(/[^\x00-\x7F]/)?vr(t):t),"array"==r.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){t=new ArrayBuffer(3),t=new Uint8Array(t);if(t.foo="bar",!t.foo)return(r=te(r)).type="array",Rs(f(n),r)}switch((a=Cs(n,r))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return As(J.read(n,r),r);break;case 9:if(a[1]<=8)return parse_xlscfb(n,r);break;case 60:return parse_xlml(n,r);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68!==a[1])break;var s=n,c=r,i=c||{},l=!!i.WTF;i.WTF=!0;try{var u=Xa.to_workbook(s,i);return i.WTF=l,u}catch(e){if(i.WTF=l,-1==e.message.indexOf("SYLK bad record ID")&&l)throw e;return dn.to_workbook(s,c)}return;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return Ja.to_workbook(n,r);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?Ts(n,r):Es(e,n,r,o);case 239:return 60===a[3]?parse_xlml(n,r):Es(e,n,r,o);case 255:if(254===a[1])return Ds(n,r);if(0===a[1]&&2===a[2]&&0===a[3])return WK_.to_workbook(n,r);break;case 0:if(0===a[1]){if(2<=a[2]&&0===a[3])return WK_.to_workbook(n,r);if(0===a[2]&&(8===a[3]||9===a[3]))return WK_.to_workbook(n,r)}break;case 3:case 131:case 139:case 140:return Ha.to_workbook(n,r);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return rtf_to_workbook(n,r);break;case 10:case 13:case 32:var d=n,p=r,h="",u=Cs(d,p);switch(p.type){case"base64":h=pe(d);break;case"binary":h=d;break;case"buffer":h=d.toString("binary");break;case"array":h=_t(d);break;default:throw new Error("Unrecognized type "+p.type)}return 239==u[0]&&187==u[1]&&191==u[2]&&(h=z(h)),p.type="binary",_s(h,p);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(231===a[1])throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(236===a[1])throw new Error("Unsupported Multiplan 2.x file!");if(237===a[1])throw new Error("Unsupported Multiplan 3.x file!")}return-1<Ka.indexOf(a[0])&&a[2]<=12&&a[3]<=31?Ha.to_workbook(n,r):Es(e,n,r,o)}function Ns(e,t){t=t||{};return t.type="file",Rs(e,t)}function Ps(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return vt(t.file,J.write(e,{type:ue?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return J.write(e,t)}function Os(e,t){switch(t.bookType){case"ods":return fs(e,t);case"numbers":return write_numbers_iwa(e,t);case"xlsb":var r=e,a=t,n=(r&&!r.SSF&&(r.SSF=te(W)),r&&r.SSF&&(He(),Ke(r.SSF),a.revssf=bt(r.SSF),a.revssf[r.SSF[65535]]=0,a.ssf=r.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,yo?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo),"bin"),o=Aa(),s=(vs(a=a||{}),er()),c="",i=0;if(a.cellXfs=[],vo(a.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),L(s,c="docProps/core.xml",Ma(r.Props,a)),o.coreprops.push(c),x(a.rels,2,c,D.CORE_PROPS),c="docProps/app.xml",!r.Props||!r.Props.SheetNames)if(r.Workbook&&r.Workbook.Sheets){for(var l=[],u=0;u<r.SheetNames.length;++u)2!=(r.Workbook.Sheets[u]||{}).Hidden&&l.push(r.SheetNames[u]);r.Props.SheetNames=l}else r.Props.SheetNames=r.SheetNames;r.Props.Worksheets=r.Props.SheetNames.length,L(s,c,Ua(r.Props)),o.extprops.push(c),x(a.rels,3,c,D.EXT_PROPS),r.Custprops!==r.Props&&0<R(r.Custprops||{}).length&&(L(s,c="docProps/custom.xml",Wa(r.Custprops)),o.custprops.push(c),x(a.rels,4,c,D.CUST_PROPS));var d=["SheetJ5"];for(a.tcid=0,i=1;i<=r.SheetNames.length;++i){var p,h,m,g,f={"!id":{}},y=r.Sheets[r.SheetNames[i-1]];(y||{})["!type"];L(s,c="xl/worksheets/sheet"+i+"."+n,write_ws_bin(i-1,a,r,f)),o.sheets.push(c),x(a.wbrels,-1,"worksheets/sheet"+i+"."+n,D.WS[0]),y&&(h=!1,m="",(p=y["!comments"])&&0<p.length&&(g=!1,p.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(L(s,m="xl/threadedComments/threadedComment"+i+".xml",Qn(p,d,a)),o.threadedcomments.push(m),x(f,-1,"../threadedComments/threadedComment"+i+".xml",D.TCMNT)),L(s,m="xl/comments"+i+"."+n,write_comments_bin(p,a)),o.comments.push(m),x(f,-1,"../comments"+i+"."+n,D.CMNT),h=!0),y["!legacy"]&&h&&L(s,"xl/drawings/vmlDrawing"+i+".vml",Jn(i,y["!comments"])),delete y["!comments"],delete y["!legacy"]),f["!id"].rId1&&L(s,_a(c),Ea(f))}return null!=a.Strings&&0<a.Strings.length&&(L(s,c="xl/sharedStrings.bin",write_sst_bin(a.Strings,a)),o.strs.push(c),x(a.wbrels,-1,"sharedStrings.bin",D.SST)),L(s,c="xl/workbook.bin",write_wb_bin(r,a)),o.workbooks.push(c),x(a.rels,1,c,D.WB),L(s,c="xl/theme/theme1.xml",Vn(r.Themes,a)),o.themes.push(c),x(a.wbrels,-1,"theme/theme1.xml",D.THEME),L(s,c="xl/styles.bin",write_sty_bin(r,a)),o.styles.push(c),x(a.wbrels,-1,"styles.bin",D.STY),r.vbaraw&&(L(s,c="xl/vbaProject.bin",r.vbaraw),o.vba.push(c),x(a.wbrels,-1,"vbaProject.bin",D.VBA)),L(s,c="xl/metadata.bin",write_xlmeta_bin()),o.metadata.push(c),x(a.wbrels,-1,"metadata.bin",D.XLMETA),1<d.length&&(L(s,c="xl/persons/person.xml",Zn(d)),o.people.push(c),x(a.wbrels,-1,"persons/person.xml",D.PEOPLE)),L(s,"[Content_Types].xml",Ta(o,a)),L(s,"_rels/.rels",Ea(a.rels)),L(s,"xl/_rels/workbook.bin.rels",Ea(a.wbrels)),delete a.revssf,delete a.ssf,s;default:return Is(e,t)}}function Fs(e,t){var r={},a=ue?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}e=e.FullPaths?J.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!=typeof Deno&&"string"==typeof e){if("binary"==t.type||"base64"==t.type)return e;e=new Uint8Array(g(e))}return t.password&&"undefined"!=typeof encrypt_agile?Ps(encrypt_agile(e,t.password),t):"file"===t.type?vt(t.file,e):"string"==t.type?z(e):e}function qs(e,t,r){var a=(r=r||"")+e;switch(t.type){case"base64":return Q(vr(a));case"binary":return vr(a);case"string":return e;case"file":return vt(t.file,a,"utf8");case"buffer":return ue?he(a,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(a):qs(a,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ms(e,t){switch(t.type){case"base64":for(var r,a,n=e,o="",s=0,c=0,i=0,l=0,u=0,d=0;d<n.length;)r=(s=255<(s=n.charCodeAt(d++))?95:s)>>2,a=(3&s)<<4|(c=255<(c=n.charCodeAt(d++))?95:c)>>4,l=(15&c)<<2|(i=255<(i=n.charCodeAt(d++))?95:i)>>6,u=63&i,isNaN(c)?l=u=64:isNaN(i)&&(u=64),o+=p.charAt(r)+p.charAt(a)+p.charAt(l)+p.charAt(u);return o;case"binary":case"string":return e;case"file":return vt(t.file,e,"binary");case"buffer":return ue?he(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ls(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return"base64"==t.type?Q(r):"string"==t.type?z(r):r;case"file":return vt(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Bs(e,t){m(),Vo(e);var r,t=te(t||{});return t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type?(t.type="binary",r=Bs(e,t),t.type="array",g(r)):(r=e,e=te((e=t)||{}),Fs(Is(r,e),e))}function Us(e,t){m(),Vo(e);var r=te(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type)return r.type="binary",t=Us(e,r),r.type="array",g(t);var a,n,o=0;if(r.sheet&&(o="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qs(write_xlml(e,r),r);case"slk":case"sylk":return qs(Xa.from_sheet(e.Sheets[e.SheetNames[o]],r,e),r);case"htm":case"html":return qs(ts(e.Sheets[e.SheetNames[o]],r),r);case"txt":return Ms(Ks(e.Sheets[e.SheetNames[o]],r),r);case"csv":return qs(zs(e.Sheets[e.SheetNames[o]],r),r,"\ufeff");case"dif":return qs(Ja.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"dbf":return Ls(Ha.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"prn":return qs(dn.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"rtf":return qs(sheet_to_rtf(e.Sheets[e.SheetNames[o]],r),r);case"eth":return qs(on.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"fods":return qs(fs(e,r),r);case"wk1":return Ls(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[o]],r),r);case"wk3":return Ls(WK_.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ls(write_biff_buf(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),n=(n=r)||{},Ps(write_xlscfb(e,n),n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return n=e,a=te((a=r)||{}),Fs(Os(n,a),a);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function js(e){var t;e.bookType||((t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType)}function Ws(e,t,r){r=r||{};return r.type="file",r.file=t,js(r),Us(e,r)}function $s(e,t){if(null==e||null==e["!ref"])return[];var r,a={t:"n",v:0},n=0,o=1,s=[],c="",i={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?n=1:"A"===l.header?n=2:Array.isArray(l.header)?n=3:null==l.header&&(n=0),typeof u){case"string":i=H(u);break;case"number":(i=H(e["!ref"])).s.r=u;break;default:i=u}0<n&&(o=0);for(var d,p=se(i.s.r),h=[],m=[],g=0,f=0,y=null!=e["!data"],v=i.s.r,w=0,b={},S=(y&&!e["!data"][v]&&(e["!data"][v]=[]),l.skipHidden&&e["!cols"]||[]),k=l.skipHidden&&e["!rows"]||[],w=i.s.c;w<=i.e.c;++w)if(!(S[w]||{}).hidden)switch(h[w]=ce(w),a=y?e["!data"][v][w]:e[h[w]+p],n){case 1:s[w]=w-i.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=l.header[w-i.s.c];break;default:if(c=r=ya(a=null==a?{w:"__EMPTY",t:"s"}:a,null,l),f=b[r]||0){for(;b[c=r+"_"+f++];);b[r]=f,b[c]=1}else b[r]=1;s[w]=c}for(v=i.s.r+o;v<=i.e.r;++v)!(k[v]||{}).hidden&&(!1===(d=function(e,t,r,a,n,o,s){var c=se(r),i=s.defval,l=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),u=!0,d=null!=e["!data"],p=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch(e){p.__rowNum__=r}else p.__rowNum__=r;if(!d||e["!data"][r])for(var h=t.s.c;h<=t.e.c;++h){var m=d?(e["!data"][r]||[])[h]:e[a[h]+c];if(null==m||void 0===m.t)void 0!==i&&null!=o[h]&&(p[o[h]]=i);else{var g=m.v;switch(m.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"b":case"n":if(!m.z||!Be(m.z))break;if("number"==typeof(g=It(g)))break;case"d":s&&(s.UTC||!1===s.raw)||(g=qt(new Date(g)));break;default:throw new Error("unrecognized type "+m.t)}if(null!=o[h]){if(null==g)if("e"==m.t&&null===g)p[o[h]]=null;else if(void 0!==i)p[o[h]]=i;else{if(!l||null!==g)continue;p[o[h]]=null}else p[o[h]]=("n"===m.t&&"boolean"==typeof s.rawNumbers?s.rawNumbers:l)?g:ya(m,g,s);null!=g&&(u=!1)}}}return{row:p,isempty:u}}(e,i,v,h,n,s,l)).isempty||(1===n?!1!==l.blankrows:l.blankrows))&&(m[g++]=d.row);return m.length=g,m}var Gs=/"/g;function zs(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var n,o=H(e["!ref"]),s=void 0!==a.FS?a.FS:",",c=s.charCodeAt(0),i=void 0!==a.RS?a.RS:"\n",l=i.charCodeAt(0),u=[],d=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],h=o.s.c;h<=o.e.c;++h)(d[h]||{}).hidden||(u[h]=ce(h));for(var m=0,g=o.s.r;g<=o.e.r;++g)(p[g]||{}).hidden||null==(n=function(e,t,r,a,n,o,s,c,i){for(var l=!0,u=[],d="",p=se(r),h=null!=e["!data"],m=h&&e["!data"][r]||[],g=t.s.c;g<=t.e.c;++g)if(a[g]){var f=h?m[g]:e[a[g]+p];if(null==f)d="";else if(null!=f.v){for(var y,l=!1,d=""+(i.rawNumbers&&"n"==f.t?f.v:ya(f,null,i)),v=0;v!==d.length;++v)if((y=d.charCodeAt(v))===n||y===o||34===y||i.forceQuotes){d='"'+d.replace(Gs,'""')+'"';break}"ID"==d&&0==c&&0==u.length&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,0<=(d="="+f.f).indexOf(",")&&(d='"'+d.replace(Gs,'""')+'"'));u.push(d)}if(i.strip)for(;""===u[u.length-1];)--u.length;return!1===i.blankrows&&l?null:u.join(s)}(e,o,g,u,c,l,s,m,a))||!n&&!1===a.blankrows||r.push((m++?i:"")+n);return r.join("")}function Ks(e,t){(t=t||{}).FS="\t",t.RS="\n";e=zs(e,t);return void 0===q||"string"==t.type?e:(t=q.utils.encode(1200,e,"str"),String.fromCharCode(255)+String.fromCharCode(254)+t)}function Hs(e,t,r){var c=r||{},i=e?null!=e["!data"]:c.dense,l=(null!=de&&null==i&&(i=de),+!c.skipHeader),u=e||{},d=(!e&&i&&(u["!data"]=[]),0),p=0,e=(u&&null!=c.origin&&("number"==typeof c.origin?d=c.origin:(r="string"==typeof c.origin?K(c.origin):c.origin,d=r.r,p=r.c)),{s:{c:0,r:0},e:{c:p,r:d+t.length-1+l}}),h=(u["!ref"]?(r=H(u["!ref"]),e.e.c=Math.max(e.e.c,r.e.c),e.e.r=Math.max(e.e.r,r.e.r),-1==d&&(d=r.e.r+1,e.e.r=d+t.length-1+l)):-1==d&&(d=0,e.e.r=t.length-1+l),c.header||[]),m=0,g=[],a=(t.forEach(function(o,s){i&&!u["!data"][d+s+l]&&(u["!data"][d+s+l]=[]),i&&(g=u["!data"][d+s+l]),R(o).forEach(function(e){-1==(m=h.indexOf(e))&&(h[m=h.length]=e);var e=o[e],t="z",r="",a=i?"":ce(p+m)+se(d+s+l),n=i?g[p+m]:u[a];!e||"object"!=typeof e||e instanceof Date?("number"==typeof e?t="n":"boolean"==typeof e?t="b":"string"==typeof e?t="s":e instanceof Date?(t="d",c.UTC||(e=Mt(e)),c.cellDates||(t="n",e=Z(e)),r=null!=n&&n.z&&Be(n.z)?n.z:c.dateNF||W[14]):null===e&&c.nullError&&(t="e",e=0),n?(n.t=t,n.v=e,delete n.w,delete n.R,r&&(n.z=r)):i?g[p+m]=n={t:t,v:e}:u[a]=n={t:t,v:e},r&&(n.z=r)):i?g[p+m]=e:u[a]=e})}),e.e.c=Math.max(e.e.c,p+h.length-1),se(d));if(i&&!u["!data"][d]&&(u["!data"][d]=[]),l)for(m=0;m<h.length;++m)i?u["!data"][d][m+p]={t:"s",v:h[m]}:u[ce(m+p)+a]={t:"s",v:h[m]};return u["!ref"]=le(e),u}function Vs(e,t,r){var a;return"string"==typeof t?null!=e["!data"]?(a=K(t),e["!data"][a.r]||(e["!data"][a.r]=[]),e["!data"][a.r][a.c]||(e["!data"][a.r][a.c]={t:"z"})):e[t]||(e[t]={t:"z"}):Vs(e,"number"!=typeof t?ie(t):ce(r||0)+se(t))}function Xs(e,t){var r={SheetNames:[],Sheets:{}};return e&&Js(r,e,t||"Sheet1"),r}function Js(e,t,r,a){var n=1;if(!r)for(;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||65535<=e.SheetNames.length)throw new Error("Too many worksheets");if(a&&0<=e.SheetNames.indexOf(r)&&r.length<32){var a=r.match(/\d+$/),n=a&&+a[0]||0,o=a&&r.slice(0,a.index)||r;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(r=o+n);++n);}if(Ho(r),0<=e.SheetNames.indexOf(r))throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Ys(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}t={encode_col:ce,encode_row:se,encode_cell:ie,encode_range:le,decode_col:pa,decode_row:da,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:K,decode_range:ha,format_cell:ya,sheet_new:function(e){var t={};return(e||{}).dense&&(t["!data"]=[]),t},sheet_add_aoa:wa,sheet_add_json:Hs,sheet_add_dom:rs,aoa_to_sheet:ba,json_to_sheet:function(e,t){return Hs(null,e,t)},table_to_sheet:as,table_to_book:function(e,t){return va(as(e,t),t)},sheet_to_csv:zs,sheet_to_txt:Ks,sheet_to_json:$s,sheet_to_html:ts,sheet_to_formulae:function(e,t){var r,a="",n="";if(null==e||null==e["!ref"])return[];for(var o,s=H(e["!ref"]),c=[],i=[],l=null!=e["!data"],u=s.s.c;u<=s.e.c;++u)c[u]=ce(u);for(var d=s.s.r;d<=s.e.r;++d)for(o=se(d),u=s.s.c;u<=s.e.c;++u)if(a=c[u]+o,n="",void 0!==(r=l?(e["!data"][d]||[])[u]:e[a])){if(null!=r.F){if(a=r.F,!r.f)continue;n=r.f,-1==a.indexOf(":")&&(a=a+":"+a)}if(null!=r.f)n=r.f;else{if(t&&!1===t.values)continue;if("z"==r.t)continue;if("n"==r.t&&null!=r.v)n=""+r.v;else if("b"==r.t)n=r.v?"TRUE":"FALSE";else if(void 0!==r.w)n="'"+r.w;else{if(void 0===r.v)continue;n="s"==r.t?"'"+r.v:""+r.v}}i[i.length]=a+"="+n}return i},sheet_to_row_object_array:$s,sheet_get_cell:Vs,book_new:Xs,book_append_sheet:Js,book_set_sheet_visibility:function(e,t,r){switch(e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]),t=function(e,t){if("number"==typeof t){if(0<=t&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"!=typeof t)throw new Error("Cannot find sheet |"+t+"|");if(-1<(e=e.SheetNames.indexOf(t)))return e;throw new Error("Cannot find sheet name |"+t+"|")}(e,t),e.Workbook.Sheets[t]||(e.Workbook.Sheets[t]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[t].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Ys,cell_set_internal_link:function(e,t,r){return Ys(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,a){for(var n="string"!=typeof t?t:H(t),o="string"==typeof t?t:le(t),s=n.s.r;s<=n.e.r;++s)for(var c=n.s.c;c<=n.e.c;++c){var i=Vs(e,s,c);i.t="n",i.F=o,delete i.v,s==n.s.r&&c==n.s.c&&(i.f=r,a)&&(i.D=!0)}return(t=ha(e["!ref"])).s.r>n.s.r&&(t.s.r=n.s.r),t.s.c>n.s.c&&(t.s.c=n.s.c),t.e.r<n.e.r&&(t.e.r=n.e.r),t.e.c<n.e.c&&(t.e.c=n.e.c),e["!ref"]=le(t),e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};if("undefined"!=typeof parse_xlscfb&&(e.parse_xlscfb=parse_xlscfb),e.parse_zip=xs,e.read=Rs,e.readFile=Ns,e.readFileSync=Ns,e.write=Us,e.writeFile=Ws,e.writeFileSync=Ws,e.writeFileAsync=function(e,t,r,a){var n=r||{};return n.type="file",n.file=e,js(n),n.type="buffer",a instanceof Function||(a=r),gt.writeFile(e,Us(t,n),a)},e.utils=t,e.writeXLSX=Bs,e.writeFileXLSX=function(e,t,r){return(r=r||{}).type="file",r.file=t,js(r),Bs(e,r)},e.set_fs=function(e){gt=e},e.set_cptable=function(e){q=e,j=function(e){a(_=e)},i=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?q.utils.decode(1200,n(e.slice(2))):e},u=function(e){return 1200===_?String.fromCharCode(e):q.utils.decode(_,[255&e,e>>8])[0]},l=function(e){return q.utils.decode(E,[e])[0]},Jr()},e.SSF=Ve,"undefined"!=typeof __stream&&(e.stream=__stream),void 0!==J&&(e.CFB=J),"undefined"!=typeof require){!{}.Readable||set_readable((void 0).Readable);try{gt=void 0}catch(e){}}}if("undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define("xlsx",function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX}):make_xlsx_lib(XLSX),"undefined"!=typeof window&&!window.XLSX)try{window.XLSX=XLSX}catch(e){}