var domain="http://localhost:8080/",trackingstatus=!1,addskustatus=!1,mv=0,playstatus=!1,intervaltime=36e5,searchinfo={},localcompanyid="",localsuppliercode="";let popupDiv;var goSales=!1,sstab=null,bstab=null;const genAI=null,aiModel=null;var salesInfos=[];function checkAndOpenNegotiationModal(){chrome.tabs.query({active:!0,currentWindow:!0},function(e){const t=e[0];t&&t.url?t.url.startsWith("https://air.1688.com/app/ocms-fusion-components-1688/def_cbu_web_im/index.html")?chrome.storage.local.get("geminiApiKey",e=>{e=e.geminiApiKey||"";openNegotiationModal(t.id,e)}):alert("알리왕왕 채팅창에서 실행해주세요."):alert("현재 탭의 URL을 확인할 수 없습니다.")})}function openNegotiationModal(t,e){let r=document.getElementById("negotiationModal");r||((r=document.createElement("div")).id="negotiationModal",r.className="modal fade",r.tabIndex="-1",r.setAttribute("aria-hidden","true"),r.innerHTML=`
        <div class="modal-dialog modal-xl" 
             style="width:90vw; max-width:1200px; min-height:80vh;">
          <div class="modal-content">
            
            <!-- 모달 헤더 -->
            <div class="modal-header">
              <h5 class="modal-title" id="negotiationModalLabel">1688 협상 요청사항</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <!-- 모달 바디 -->
            <div class="modal-body">
              <form id="negotiationForm">
                
                <!-- 안내 문구 -->
                <p class="text-secondary">
                  1688 판매자에게 문의할 사항을 체크하거나, 필요한 정보를 입력하세요.
                  체크된 항목만 자동으로 문의할 수 있습니다.
                </p>
  
                <!-- 1. 재고 / 바로 발송 가능 여부 -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="inStockCheck" checked>
                      <label class="form-check-label fw-bold" for="inStockCheck">
                        재고/바로 발송 여부
                      </label>
                    </div>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      재고가 충분한지, 결제가 완료되면 곧바로 발송할 수 있는지 문의합니다.
                    </small>
                  </div>
                </div>
  
                <!-- 2. MOQ별 가격 할인 -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="moqCheck" checked>
                      <label class="form-check-label fw-bold" for="moqCheck">
                        MOQ(최소 주문 수량) & 가격 할인
                      </label>
                    </div>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      구매 수량에 따른 가격 할인을 받을 수 있는지 문의합니다. 예: 200개 이상 구매 시 단가가 낮아지는지 등.
                    </small>
                    <div class="mt-2 input-group">
                      <span class="input-group-text">예상 구매 수량</span>
                      <input type="number" class="form-control" id="moqQuantity" value="200" min="1">
                      <span class="input-group-text">개</span>
                    </div>
                  </div>
                </div>
  
                <!-- 3. 하루 생산량 -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="dailyProdCheck" checked>
                      <label class="form-check-label fw-bold" for="dailyProdCheck">
                        하루 생산량
                      </label>
                    </div>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      대량 주문 시 하루에 얼마나 생산이 가능한지 확인합니다.
                    </small>
                  </div>
                </div>
  
                <!-- 4. 배송비 (목적지에 따른) -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="shippingFeeCheck" checked>
                      <label class="form-check-label fw-bold" for="shippingFeeCheck">
                        배송비 문의
                      </label>
                    </div>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      어떤 지역(목적지)로 발송할 예정인지 기입 후, 해당 지역까지의 배송비를 문의합니다.
                    </small>
                    <div class="mt-2 input-group">
                      <span class="input-group-text">목적지</span>
                      <input type="text" class="form-control" id="destinationInput" value="위해">
                    </div>
                  </div>
                </div>
  
                <!-- 5. 박스 포장 관련 -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="boxInfoCheck" checked>
                      <label class="form-check-label fw-bold" for="boxInfoCheck">
                        박스 포장 정보
                      </label>
                    </div>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      한 박스에 몇 개씩 들어가는지, 개별 포장박스(내부) 사이즈나 무게가 어떻게 되는지, 혹은 사진을 받을 수 있는지 문의합니다.
                    </small>
                    <div class="form-check mt-2">
                      <input class="form-check-input" type="checkbox" id="boxPhotoCheck" checked>
                      <label class="form-check-label" for="boxPhotoCheck">
                        개별 포장박스 사진 요청
                      </label>
                    </div>
                  </div>
                </div>
  
                <!-- 6. 제품 재질/중량 등 구체 정보 -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="materialCheck" checked>
                      <label class="form-check-label fw-bold" for="materialCheck">
                        제품 재질/중량 등 구체 정보
                      </label>
                    </div>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      제품의 재질, 중량, 안전인증 등 필요한 상세 정보를 체크하고 문의합니다.
                    </small>
                  </div>
                </div>
  
                <!-- 7. 추가 요청사항 -->
                <div class="card mb-3">
                  <div class="card-header p-2">
                    <label for="additionalRequests" class="form-label fw-bold mb-0">
                      추가 요청사항
                    </label>
                  </div>
                  <div class="card-body p-2">
                    <small class="text-muted">
                      로고 인쇄, 색상 변경, OEM 여부 등 개별적으로 문의하고 싶은 사항을 입력해 주세요.
                    </small>
                    <textarea class="form-control mt-2" id="additionalRequests" rows="2" 
                              placeholder="예: 로고 인쇄 가능 시 MOQ와 추가 비용을 알고 싶습니다."></textarea>
                  </div>
                </div>
  
                <!-- Gemini API Key 입력 섹션 -->
                <div class="card mb-3">
                    <div class="card-header p-2">
                    <label for="geminiApiKey" class="form-label fw-bold mb-0">
                        Gemini API Key
                    </label>
                    </div>
                    <div class="card-body p-2">
                    <small class="text-muted">
                        <a href="https://aistudio.google.com/app/apikey" target="_blank">
                        Gemini API 발급 링크
                        </a>  
                        에서 Key를 발급받으신 뒤 아래에 입력하세요.
                        <br>*Gemini API Key는 현재 브라우저에만 저장됩니다*
                    </small>
                    <input class="form-control mt-2" 
                            type="text" 
                            id="geminiApiKey" 
                            placeholder="Enter your Gemini API Key here" />
                    </div>
                </div>
  
              </form>
            </div>
            
            <!-- 모달 푸터 -->
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
              <button type="button" class="btn btn-primary" id="startNegotiationBtn">협상 시작</button>
            </div>
  
          </div>
        </div>
      `,document.body.appendChild(r));const a=new bootstrap.Modal(r),n=(a.show(),document.body.classList.add("extended-body"),r.addEventListener("hidden.bs.modal",function e(){document.body.classList.remove("extended-body"),r.removeEventListener("hidden.bs.modal",e)}),document.getElementById("geminiApiKey")),o=(n.value=e||"",document.getElementById("startNegotiationBtn"));o.dataset.handlerAdded||(o.addEventListener("click",()=>{var e={geminiApiKey:n.value.trim(),checkItems:{inStock:{checked:document.getElementById("inStockCheck")?.checked,message:"재고 확인 및 즉시 발송 가능 여부"},moq:{checked:document.getElementById("moqCheck")?.checked,quantity:document.getElementById("moqQuantity")?.value.trim(),message:document.getElementById("moqQuantity")?.value.trim()+"개 구매 시 가격 할인 가능 여부"},dailyProduction:{checked:document.getElementById("dailyProdCheck")?.checked,message:"일일 최대 생산 가능 수량"},shipping:{checked:document.getElementById("shippingFeeCheck")?.checked,destination:document.getElementById("destinationInput")?.value.trim(),message:document.getElementById("destinationInput")?.value.trim()+"까지의 배송비"},packaging:{checked:document.getElementById("boxInfoCheck")?.checked,photoRequired:document.getElementById("boxPhotoCheck")?.checked,message:"포장 방식, 박스 크기, 포장 사진"},material:{checked:document.getElementById("materialCheck")?.checked,message:"제품 재질, 중량, 인증 정보"}},additionalRequests:document.getElementById("additionalRequests")?.value.trim(),negotiationStyle:{tone:"professional",language:"formal",priority:"price"}};console.log("협상 요청 데이터:",e),chrome.storage.local.set({geminiApiKey:e.geminiApiKey},()=>{console.log("Gemini API Key 저장 완료")}),chrome.tabs.sendMessage(t,{action:"openSidePanel",negotiationData:e}),o.blur(),a.hide()}),o.dataset.handlerAdded="true")}async function preventDiscardAllTabs(){try{var e;for(e of await chrome.tabs.query({}))e.autoDiscardable&&await chrome.tabs.update(e.id,{autoDiscardable:!1})}catch(e){console.error("에러 발생: "+e.message)}}async function keywordBrandAnalysis(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0});console.log(e),e.url.includes("https://www.coupang.com/np/search")?(console.log("start"),chrome.scripting.executeScript({target:{tabId:e.id},func:async function(){var e;for(e of Array.from(document.querySelector("#searchBrandFilter").children[0].children)){var t=e.children[0].value,r=window.location.href,r=new URL(window.location.href);function a(e,t){r.searchParams.set(e,t)}a("brand",t),a("sorter","saleCountDesc");var t=r.toString(),t=(console.log(t),await async function(e){try{var t=await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","cache-control":"max-age=0",priority:"u=0, i","sec-ch-ua":'"Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text()),r=t.getElementsByName("searchProductCount")?parseInt(t.getElementsByName("searchProductCount")[0].value):"",a=t.querySelector("#productList")?t.querySelector("#productList").children.length:0;if(0==(a=10<=a?10:a))var n=0;else{for(var o=0,s=0;s<a;s++){var c=t.querySelector("#productList").children[s];o+=c.querySelector(".rating-total-count")?parseInt(c.querySelector(".rating-total-count").innerText.replace("(","").replace(")","")):0,console.log(c.querySelector(".name").innerText),console.log(c.querySelector(".rating-total-count")?c.querySelector(".rating-total-count").innerText:"")}n=parseInt(o/a)}return{reviewAverage:n,totalCnt:r}}catch(c){return null}}(t)),n=e.children[1].innerText;e.children[1].innerText=n+" ("+t.reviewAverage+"/"+t.totalCnt+")"}}})):alert("키워드를 검색한 후 분석해 주세요")}async function openCoubnam(){var e=await confirmlg();console.log(e),e.min?new bootstrap.Modal(document.getElementById("coubnamPage")).show():alert("쿠프남 수강생 전용 기능입니다.")}async function openCalculation(){var e=await getPageInfo(),t=(e&&(t=e.quantityBase?e.quantityBase?.[0]?.moduleData?.[0]?.detailPriceBundle?.finalPrice?.price?e.quantityBase[0].moduleData[0].detailPriceBundle.finalPrice.price:e.quantityBase[0].price.salePrice?parseInt(e.quantityBase[0].price.salePrice.replaceAll(",","")):parseInt(e.quantityBase[0].price.originPrice.replaceAll(",","")):0,e.trackMeta&&e.trackMeta.q&&(document.querySelector("#targetKeyword").value=e.trackMeta.q),document.querySelector("#sellingPrice").value=t,e.leafCategoryInfo?document.querySelector(".calculate").dataset.categoryId=e.leafCategoryInfo.categoryId:document.querySelector(".calculate").dataset.categoryId=null),document.getElementById("collapseExample"));new bootstrap.Collapse(t,{toggle:!0})}async function getPageInfo(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),t=void 0;if(e.url.includes("https://www.coupang.com/vp/products/")&&(t=e.url),e.url.includes("https://www.coupang.com/np/search")&&(t=(await chrome.scripting.executeScript({target:{tabId:e.id},func:getPageInformation}))[0].result,console.log(t)),t)return await getProductInfo(t,e)}async function getPageInformation(){if(document.querySelector("#productList")){for(var e=document.querySelector("#productList"),t=(console.log(e),""),r=0;r<e.children.length;r++)if(console.log(e.children[r].className),!e.children[r].className.includes("ad-badge")){t=e.children[r].children[0].href;break}}else for(e=document.querySelector("#product-list"),t=(console.log(e),""),r=0;r<e.children.length;r++)if(!e.querySelector(".AdMark_adMark__KPMsC")){t=e.children[r].children[0].href;break}return console.log(t),t}async function calculateMargin(){document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!0,e.innerText="계산중..."});var e=await chrome.tabs.query({}),t=(e.find(e=>e.url.includes("www.coupang.com"))?f=e.find(e=>e.url.includes("www.coupang.com")):(f=await chrome.tabs.create({url:"https://www.coupang.com",active:!1}),await chrome.tabs.update(f.id,{autoDiscardable:!1})),e.find(e=>e.url.includes("m.coupang.com"))?t=e.find(e=>e.url.includes("m.coupang.com")):(t=await chrome.tabs.create({url:"https://m.coupang.com",active:!1}),await chrome.tabs.update(t.id,{autoDiscardable:!1})),e.find(e=>e.url.includes("wing.coupang.com")));if(t){e=parseInt(document.querySelector("#sellingPrice").value);if(e){var r=parseInt(document.querySelector("#costPrice").value);if(r){var a=document.querySelector("#targetKeyword").value;if(a){var n=parseFloat(document.querySelector("#width").value),o=parseFloat(document.querySelector("#length").value),s=parseFloat(document.querySelector("#height").value),c=parseFloat(document.querySelector("#weight").value),l=parseInt(document.querySelector("#salesCnt").value),i=parseInt(document.querySelector("#cntPerSales").value),u=parseFloat(document.querySelector("#returnRate").value);if(n&&o&&s&&c){if(document.querySelector(".calculate").dataset&&document.querySelector(".calculate").dataset.categoryId)var d=document.querySelector(".calculate").dataset.categoryId;else{a=await fetchkeywordmAPI(a,1);console.log(a);var a=a.productlists[0],h=a.vendorItemId,a=await getProductInfo("https://www.coupang.com/vp/products/"+a.productId+"?vendorItemId="+h,f);if(!a.leafCategoryInfo)return d=null,void alert("카테고리가 확인되지 않습니다.");d=a.leafCategoryInfo.categoryId}var h={x:n,y:o,z:s,w:c,categoryId:d,price:e},f=(i<1&&(i=1,document.querySelector("#cntPerSales").value=1),0),a=(h.x=h.x||100,h.y=h.y||100,h.z=h.z||100,h.w=h.w||100,await getSizeName(h,t)),p=await getfulfillmentfee(t,h,a),m=l*(1-.01*u),g=m/i,y=(p=parseInt(p))*g,v=await getwarehousefee(t,h,a),v=parseInt(v),b=(console.log(v),await getSalesFee(t,h)),w=(console.log(b),halfRoundUp25(p)),x=w*g*u*.01;console.log(w);var k,w=getReInputFee(h)*l*u*.01,n=(console.log(p),"LARGE2"==a||"XLARGE"==a?(f=p*(i-1)*g,console.log(f),y+=Math.round(f)):1<i&&(n<=o?n<=s?n*=i:s*=i:o<=s?o*=i:s*=i,(2500<(h={x:n,y:o,z:s,w:c,categoryId:d,price:e*i}).x+h.y+h.z||3e4<h.w)&&(f=1e3*(parseInt((2500-(h.x+h.y+h.z))/900)+1)>1e3*(parseInt((3e4-h.w)/1e4)+1)?1e3*(parseInt((2500-(h.x+h.y+h.z))/900)+1):1e3*(parseInt((3e4-h.w)/1e4)+1),h.x=1e3,h.y=1e3,h.z=500,h.w=3e4),u=await getfulfillmentfee(t,h,a=await getSizeName(h,t)),y=(parseInt(u)+f)*g),"MINI"==a&&(k="극소형"),"SMALL"==a&&(k="소형"),"MEDIUM"==a&&(k="중형"),"LARGE1"==a&&(k="대형1"),"LARGE2"==a&&(k="대형2"),"XLARGE"==a&&(k="특대형"),Math.round(10*e/11-v-p-b*e*.01-10*r/11)),o=Math.round(n/e*100),s=Math.round(10*e/11*m-v*l-y-x-w-b*e*.01*m-10*r/11*m),c=Math.round(s/(e*m)*100);document.querySelector("#handlingFee").innerText=Math.round(1.1*v),document.querySelector("#shippingFee").innerText=Math.round(1.1*p),document.querySelector("#sellingFee").innerText=Math.round(b*e*1.1*.01),document.querySelector("#sellingRate").innerText=Math.round(1.1*b*100)/100,document.querySelector("#margin").innerText=n,document.querySelector("#marginRate").innerText=o,document.querySelector("#roi").innerText=Math.round(n/r*100),document.querySelector("#roas").innerText=Math.round(e/n*100*1.1),document.querySelector("#sizeName").innerText=k,document.querySelector("#handlingFeeTotal").innerText=Math.round(v*m*1.1),document.querySelector("#shippingFeeTotal").innerText=Math.round(1.1*y),document.querySelector("#returnFeeTotal").innerText=Math.round(1.1*x),document.querySelector("#reInputFeeTotal").innerText=Math.round(1.1*w),document.querySelector("#marginTotal").innerText=s,document.querySelector("#marginRateTotal").innerText=c,document.querySelector("#roiTotal").innerText=Math.round(s/(r*m)*100),document.querySelector("#roasTotal").innerText=Math.round(e*m/s*100*1.1),document.querySelector("#salesTotal").innerText=Math.round(e*m),document.querySelector("#sellingFeeTotal").innerText=Math.round(b*e*1.1*.01*m),document.querySelector("#sellingRateTotal").innerText=Math.round(1.1*b*100)/100,document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!1,e.innerText="계산하기"})}else alert("사이즈,무게,건당판매갯수,반품율 정보를 입력해 주세요."),document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!1,e.innerText="계산하기"})}else alert("타겟키워드를 입력해 주세요."),document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!1,e.innerText="계산하기"})}else alert("매입가를 입력해 주세요."),document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!1,e.innerText="계산하기"})}else alert("판매가를 입력해 주세요."),document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!1,e.innerText="계산하기"})}else alert("새탭에 쿠팡 wing을 로그인한 후 다시 시도해 주세요."),document.querySelectorAll(".calculate").forEach(e=>{e.disabled=!1,e.innerText="계산하기"})}function halfRoundUp25(e){return e=parseInt(e),25*Math.ceil(e/2/25)}function getReInputFee(e){var t=e.price,r=[{minPrice:0,maxPrice:4999,normalFee:600,promotionFee:300},{minPrice:5e3,maxPrice:9999,normalFee:800,promotionFee:400},{minPrice:1e4,maxPrice:14999,normalFee:1200,promotionFee:600},{minPrice:15e3,maxPrice:19999,normalFee:1600,promotionFee:800},{minPrice:2e4,maxPrice:null,normalFee:2e3,promotionFee:1e3}];for(let e=0;e<r.length;e++){var{minPrice:a,maxPrice:n,promotionFee:o}=r[e];if(a<=t&&(null===n||t<=n))return o}return 0}async function getfulfillmentfee(e,t,r){if(t.categoryId)var a=t.categoryId;else{if(!t.salesInfo.productInfo.leafCategoryInfo)return 0;a=t.salesInfo.productInfo.leafCategoryInfo.categoryId}var n=t.price||t.salesInfo.price;return console.log(a,n,r,t),(await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(e,t,r,a){var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return console.log(e,t,r,a),console.log('{"agreementScope":"PRODUCTION","capacityType":"'+r+'","kanCategoryId":'+e+',"amount":"'+t+'","length":'+a.x+',"width":'+a.y+',"height":'+a.z+',"weight":'+a.w+',"quantity":1}'),(await(await fetch("https://wing.coupang.com/tenants/rfm/api/accounting/revamp/fulfillment-fee",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/rfm/settlements/fee-information?utm_source=winghome",referrerPolicy:"strict-origin-when-cross-origin",body:'{"agreementScope":"PRODUCTION","capacityType":"'+r+'","kanCategoryId":'+e+',"amount":"'+t+'","length":'+a.x+',"width":'+a.y+',"height":'+a.z+',"weight":'+a.w+',"quantity":1}',method:"POST",mode:"cors",credentials:"include"})).json()).calculatedFeeDetails.finalTotalAmount.amount},args:[a,n,r,t]}))[0].result}async function getwarehousefee(e,t,r){if(t.categoryId)var a=t.categoryId;else{if(!t.salesInfo.productInfo.leafCategoryInfo)return 0;a=t.salesInfo.productInfo.leafCategoryInfo.categoryId}var n=t.price||t.salesInfo.price;return(await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(e,t,r,a){var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await(await fetch("https://wing.coupang.com/tenants/rfm/api/accounting/revamp/warehousing-fee",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/rfm/settlements/fee-information?utm_source=winghome",referrerPolicy:"strict-origin-when-cross-origin",body:'{"agreementScope":"PRODUCTION","capacityType":"'+r+'","kanCategoryId":'+e+',"amount":"'+t+'","length":'+a.x+',"width":'+a.y+',"height":'+a.z+',"weight":'+a.w+',"quantity":1}',method:"POST",mode:"cors",credentials:"include"})).json()).calculatedFeeDetails.finalTotalAmount.amount},args:[a,n,r,t]}))[0].result}async function getSalesFee(e,t){t=t.categoryId;return(await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(e){var t=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return(await(await fetch("https://wing.coupang.com/tenants/seller-web/v2/vendor-inventory/commission?categoryId="+e,{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="118", "Google Chrome";v="118", "Not=A?Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":t},referrer:"https://wing.coupang.com/tenants/seller-web/vendor-inventory/formV2",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).json()).serviceFeeRatio},args:[t]}))[0].result}async function getSizeName(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},function:async function(e,t,r,a){var n=document.cookie.split("; ").find(e=>e.includes("XSRF-TOKEN"))?.split("=")[1];return console.log(e,t,r,a),(await fetch("https://wing.coupang.com/tenants/rfm/api/accounting/revamp/vendor-item-capacity-type-by-quantity",{headers:{accept:"application/json, text/plain, */*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",withcredentials:"true","x-xsrf-token":n},referrer:"https://wing.coupang.com/tenants/rfm/settlements/fee-information?utm_source=winghome",referrerPolicy:"strict-origin-when-cross-origin",body:'{"length":'+e+',"width":'+t+',"height":'+r+',"weight":'+a+',"quantity":1}',method:"POST",mode:"cors",credentials:"include"})).text()},args:[e.x,e.y,e.z,e.w]}))[0].result}async function downloadCalculation(){var e=document.querySelector("#sellingPrice").value,t=document.querySelector("#costPrice").value,r=document.querySelector("#targetKeyword").value,a=document.querySelector("#width").value,n=document.querySelector("#length").value,o=document.querySelector("#height").value,s=document.querySelector("#weight").value,c=document.querySelector("#handlingFee").innerText,l=document.querySelector("#shippingFee").innerText,i=document.querySelector("#sellingFee").innerText,u=document.querySelector("#sellingRate").innerText,d=document.querySelector("#margin").innerText,h=document.querySelector("#marginRate").innerText,f=document.querySelector("#roi").innerText,r=[{"키워드":r,"판매가":e,"매입가":t,"마진":d,"마진율":h,"손익기준ROAS":document.querySelector("#roas").innerText,ROI:f,"입출고비":c,"배송비":l,"판매수수료":i,"판매수수료율":u,"가로(mm)":a,"세로(mm)":n,"높이(mm)":o,"무게(g)":s}],e=XLSX.utils.book_new(),t=XLSX.utils.json_to_sheet(r);XLSX.utils.book_append_sheet(e,t,"마진계산결과"),XLSX.writeFile(e,"로켓그로스 마진계산.xlsx")}function keywordExceptionEnable(){document.querySelector("#keywordException").checked?document.querySelector("#keywordExcept").className="d-flex justify-content-between":document.querySelector("#keywordExcept").className="d-flex justify-content-between d-none"}async function gostorelink(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),t=await chrome.scripting.executeScript({target:{tabId:e.id},func:async function(e){function t(t){var e=t.indexOf('"stickBanners":');if(-1===e)return t;let r=0,a=e+15;for(let e=a;e<t.length;e++)if("["===t[e]&&r++,"]"===t[e]&&r--,0===r){a=e+1;break}return t.slice(0,e)+'"stickBanners":[]'+t.slice(a)}e=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text();console.log(e);var r=(await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(e)).querySelectorAll("script"),a="",n=null;if(e.includes("exports.sdp")){r.forEach(e=>{e.innerHTML.includes("exports.sdp")&&(a=e.innerHTML)}),console.log(a);var o=a.indexOf("exports.sdpIssueTypes"),s=(-1==o&&(o=a.indexOf("exports.disableCSR")),a.lastIndexOf(";",o)),c=(a=a.substring(0,s)).slice(a.search("exports.sdp")+14);console.log(c);try{n=JSON.parse(c)}catch(e){console.log(e),c=t(c),n=JSON.parse(c)}console.log(n)}else if(e.includes("exports.product")){r.forEach(e=>{e.innerHTML.includes("exports.product")&&(a=e.innerHTML)}),console.log(a),-1==(o=a.indexOf("exports.sdpIssueTypes"))&&(o=a.indexOf("exports.disableCSR")),s=a.lastIndexOf(";",o),a=a.substring(0,s),c=a.slice(a.search("exports.product")+18),console.log(c);try{n=JSON.parse(c)}catch(e){console.log(e),c=t(c),n=JSON.parse(c)}console.log(n)}else e.includes("atfData")&&(c=function(t){if(console.log("--- 함수 시작 ---"),"string"!=typeof t||null===t)return console.error("입력 텍스트가 유효한 문자열이 아닙니다."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`시작 마커 "${e}" (또는 다른 주요 마커)를 찾을 수 없습니다.`),null;console.log(`마커 "${e}" 찾음. 인덱스: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("객체 시작 '{' 찾음. 인덱스:",n);break}if(e>a+5&&" "!==t[e])return console.error("마커 뒤에서 '{'를 적절한 위치에서 찾지 못했습니다."),null}if(-1===n)return console.error("객체 시작 '{'를 찾을 수 없습니다."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("객체 끝 '}' 찾음. 인덱스:",s);break}if(-1===s)return console.error("객체의 짝이 맞는 '}'를 찾을 수 없습니다."),null;let c=t.substring(a,s+1);console.log("추출된 문자열 (원본):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("최종 처리 후 문자열 (파싱 시도):",c.substring(0,200)+"..."),0===c.length)return console.error("최종 처리 후 문자열이 비어있습니다."),null;try{return JSON.parse(c),console.log("JSON 파싱 성공!"),c}catch(e){return console.error("JSON 파싱 실패:",e.message),console.error("파싱 시도한 문자열 (전체):\n",c),null}}(e),n=JSON.parse(c),console.log(n));return n},args:[e.url]});t[0].result?(t=await collecttrackingfromvii([t[0].result],!1,e),console.log(t),e="https://store.coupang.com/vp/vendors/"+t[0].vendorId+"/products",console.log(e),window.open(e,"_blank")):alert("쿠팡상품페이지에서 수집해주세요")}async function getProductInfo(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e){function t(t){var e=t.indexOf('"stickBanners":');if(-1===e)return t;let r=0,a=e+15;for(let e=a;e<t.length;e++)if("["===t[e]&&r++,"]"===t[e]&&r--,0===r){a=e+1;break}return t.slice(0,e)+'"stickBanners":[]'+t.slice(a)}e=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text();console.log(e);var r=(await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(e)).querySelectorAll("script"),a="",n=null;if(e.includes("exports.sdp")){r.forEach(e=>{e.innerHTML.includes("exports.sdp")&&(a=e.innerHTML)}),console.log(a);var o=a.indexOf("exports.sdpIssueTypes"),s=(-1==o&&(o=a.indexOf("exports.disableCSR")),a.lastIndexOf(";",o)),c=(a=a.substring(0,s)).slice(a.search("exports.sdp")+14);console.log(c);try{n=JSON.parse(c)}catch(e){console.log(e),c=t(c),n=JSON.parse(c)}console.log(n)}else if(e.includes("exports.product")){r.forEach(e=>{e.innerHTML.includes("exports.product")&&(a=e.innerHTML)}),console.log(a),-1==(o=a.indexOf("exports.sdpIssueTypes"))&&(o=a.indexOf("exports.disableCSR")),s=a.lastIndexOf(";",o),a=a.substring(0,s),c=a.slice(a.search("exports.product")+18),console.log(c);try{n=JSON.parse(c)}catch(e){console.log(e),c=t(c),n=JSON.parse(c)}console.log(n)}else e.includes("atfData")&&(c=function(t){if(console.log("--- 함수 시작 ---"),"string"!=typeof t||null===t)return console.error("입력 텍스트가 유효한 문자열이 아닙니다."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`시작 마커 "${e}" (또는 다른 주요 마커)를 찾을 수 없습니다.`),null;console.log(`마커 "${e}" 찾음. 인덱스: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("객체 시작 '{' 찾음. 인덱스:",n);break}if(e>a+5&&" "!==t[e])return console.error("마커 뒤에서 '{'를 적절한 위치에서 찾지 못했습니다."),null}if(-1===n)return console.error("객체 시작 '{'를 찾을 수 없습니다."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("객체 끝 '}' 찾음. 인덱스:",s);break}if(-1===s)return console.error("객체의 짝이 맞는 '}'를 찾을 수 없습니다."),null;let c=t.substring(a,s+1);console.log("추출된 문자열 (원본):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("최종 처리 후 문자열 (파싱 시도):",c.substring(0,200)+"..."),0===c.length)return console.error("최종 처리 후 문자열이 비어있습니다."),null;try{return JSON.parse(c),console.log("JSON 파싱 성공!"),c}catch(e){return console.error("JSON 파싱 실패:",e.message),console.error("파싱 시도한 문자열 (전체):\n",c),null}}(e),n=JSON.parse(c),console.log(n));return n},args:[e]}))[0].result}async function showPopupDiv(e,t){!async function(e){var t=document.createElement("div");t.className="popup_loading_spinner",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(255, 255, 255, 0.9",t.style.padding="30px",t.style.textAlign="center",t.style.fontWeight="bold",t.style.zIndex=9999,t.style.display="block",t.textContent=e||"판매량 분석중";e=document.createElement("img");e.src="https://wpamelia.com/wp-content/uploads/2018/11/ezgif-2-6d0b072c3d3f.gif",e.style.display="block",e.style.margin="0 auto",e.style.maxHeight="50px",t.appendChild(e),document.body.appendChild(t)}(t)}async function hidePopupDiv(e){!async function(){document.querySelectorAll(".popup_loading_spinner").forEach(e=>{e.style.display="none"})}()}async function getCurrentProducts(e){var t=[],e=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t={},r=document;if(r.querySelector("#productList")&&0<r.querySelector("#productList").children.length){var a=r.querySelector("#productList").children;console.log(a);for(var n=0;n<a.length;n++)((o=a[n]).className.includes("search-product")||o.className.includes("baby-product"))&&(s=(o.querySelector(".search-product-wrap-img")?o.querySelector(".search-product-wrap-img"):o.querySelector("IMG")).src,c=o.children[0].href,l=o.children[0].dataset.srpLog?JSON.parse(o.children[0].dataset.srpLog):o.children[0].dataset,t={rank:n+1,productName:o.querySelector(".name").innerText,type:o.innerHTML.includes("vendor_inventory")?o.innerHTML.includes("도착 보장")?"jet":"wing":"rocket",price:o.querySelector(".price-value")?parseInt(o.querySelector(".price-value").innerText.replaceAll(",","")):0,rating:o.querySelector(".rating")?parseFloat(o.querySelector(".rating").innerText):0,ratingcount:o.querySelector(".rating-total-count")?parseInt(o.querySelector(".rating-total-count").innerText.replaceAll("(","").replaceAll(")","")):0,product:l,ad:!!o.className.includes("search-product__ad-badge"),productId:l.productId,imgUrl:s,url:c},e.push(t))}if(r.querySelector("#product-list")&&0<r.querySelector("#product-list").children.length){a=r.querySelector("#product-list").children;console.log(a);for(var o,s,c,l,i,n=0;n<a.length;n++)(o=a[n]).className.includes("ProductUnit_productUnit__Qd6sv")&&(o.querySelector("IMG")&&(s=o.querySelector("IMG").src),l=function(t){try{var r=new URL(t),a=r.pathname.split("/");let e=null;3<a.length&&"vp"===a[1]&&"products"===a[2]&&(e=a[3]);var n=r.searchParams.get("itemId"),o=r.searchParams.get("vendorItemId");return e&&n&&o?{productId:e,itemId:n,vendorItemId:o}:(console.error("URL에서 모든 ID를 추출하지 못했습니다."),e||console.error(" - productId를 찾을 수 없습니다. 경로 형식을 확인하세요:",r.pathname),n||console.error(" - itemId 쿼리 파라미터를 찾을 수 없습니다."),o||console.error(" - vendorItemId 쿼리 파라미터를 찾을 수 없습니다."),null)}catch(e){return console.error("유효하지 않은 URL입니다:",e.message),null}}(c=o.children[0].href),i="",i=(o.querySelector(".ProductUnit_productName__gre7e")?o.querySelector(".ProductUnit_productName__gre7e"):o.querySelector(".ProductUnit_productNameV2__cV9cw")).innerText,t={rank:n+1,productName:i,type:o.innerHTML.includes("vendor_inventory")?o.innerHTML.includes("도착 보장")?"jet":"wing":"rocket",price:o.querySelector(".Price_priceValue__A4KOr")?parseInt(o.querySelector(".Price_priceValue__A4KOr").innerText.replaceAll(",","")):0,rating:o.querySelector(".ProductRating_star__RGSlV")?parseFloat(o.querySelector(".ProductRating_star__RGSlV").innerText):0,ratingcount:o.querySelector(".ProductRating_ratingCount__R0Vhz")?parseInt(o.querySelector(".ProductRating_ratingCount__R0Vhz").innerText.replaceAll("(","").replaceAll(")","")):0,product:l,ad:!!o.querySelector(".AdMark_adMark__KPMsC"),productId:l.productId,imgUrl:s,url:c},e.push(t))}return console.log(e),e}}),t=(console.log(e),t.concat(e[0].result));return console.log(t),t}async function getBestProducts(e){var t=[],e=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t=document;if(t.querySelector(".best-seller-carousel-item-list")&&0<t.querySelector(".best-seller-carousel-item-list").children.length){var r=t.querySelector(".best-seller-carousel-item-list").children;console.log(r);for(var a=0;a<r.length;a++){var n=r[a].querySelector("a").href;e.push({rank:a+1,url:n})}}return console.log(e),e}}),t=(console.log(e),t.concat(e[0].result));return console.log(t),t}async function getStoreProducts(e){var t,r=[],r=(e.url.includes("shop.coupang.com")&&(t=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t=document;if(t.querySelector(".products-list")&&0<t.querySelector(".products-list").children.length){var r=t.querySelector(".products-list").children;console.log(r);for(var a=0;a<r.length;a++){var n=r[a];n.className.includes("product-wrap")&&(n=n.querySelector("a").href,e.push({rank:a+1,url:n}))}}return console.log(e),e}})),e.url.includes("store.coupang.com")&&(t=await chrome.scripting.executeScript({target:{tabId:e.id},function:async function(){var e=[],t=document;if(t.querySelector("#product-list")&&0<t.querySelector("#product-list").children.length){var r=t.querySelector("#product-list").children;console.log(r);for(var a=0;a<r.length;a++){var n=r[a].querySelector("a").href;e.push({rank:a+1,url:n})}}return console.log(e),e}})),console.log(t),r.concat(t[0].result));return console.log(r),r}function loadImage(r){return new Promise(e=>{const t=new Image;t.crossOrigin="anonymous",t.onload=()=>e(t),t.src=r})}function createpage(){chrome.tabs.create({url:chrome.runtime.getURL("page.html"),selected:!0},e=>{chrome.scripting.executeScript({target:{tabId:e.id},files:["pagescript.js"],code:"showAlert();"})})}function handleFileUpload(e){var e=e.target.files[0],t=new FileReader;t.onload=function(e){var e=new Uint8Array(e.target.result),e=XLSX.read(e,{type:"array"}),t=e.SheetNames[0],e=e.Sheets[t],t=XLSX.utils.sheet_to_json(e);console.log(t),searchinfo.uploadkeyword=[],searchinfo.exceptkeyword=[],t.forEach(e=>{e.키워드&&searchinfo.uploadkeyword.push(e.키워드),e.제외키워드&&searchinfo.exceptkeyword.push(e.제외키워드)}),console.log(searchinfo)},t.readAsArrayBuffer(e)}function keywordExceptionUpload(e){var e=e.target.files[0],t=new FileReader;t.onload=function(e){var e=new Uint8Array(e.target.result),e=XLSX.read(e,{type:"array"}),t=e.SheetNames[0],e=e.Sheets[t],t=XLSX.utils.sheet_to_json(e);console.log(t),searchinfo.exceptkeyword=[],searchinfo.exceptCategoryKeyword=[],searchinfo.categoryList=[],t.forEach(e=>{e.제외키워드&&searchinfo.exceptkeyword.push(e.제외키워드),e.제외카테고리키워드&&searchinfo.exceptCategoryKeyword.push(e.제외카테고리키워드),e.지정카테고리번호&&searchinfo.categoryList.push(e.지정카테고리번호)})},t.readAsArrayBuffer(e)}function downloadtemplate(){var e=XLSX.utils.book_new(),t=XLSX.utils.json_to_sheet([{"키워드":"양말","제외키워드":"루이비통"},{"키워드":"실내화","제외키워드":"브랜드명"},{"키워드":"남자양말","제외키워드":"상표권있는이름"},{"키워드":"캐리어","제외키워드":"쿠플러스"},{"키워드":"페이크삭스"},{"키워드":"안전화"}]);XLSX.utils.book_append_sheet(e,t,"Keywords"),XLSX.writeFile(e,"keywords.xlsx")}function downloadKEtemplate(){var e=XLSX.utils.book_new(),t=XLSX.utils.json_to_sheet([{"제외키워드":"루이비통","제외카테고리키워드":"도서","지정카테고리번호":"50003307"},{"제외키워드":"나이키","제외카테고리키워드":"면세점","지정카테고리번호":"50003308"},{"제외키워드":"쿠플러스","제외카테고리키워드":"여가/생활편의","지정카테고리번호":"50003309"},{"제외키워드":"브랜드명","제외카테고리키워드":"식품","지정카테고리번호":"50003314"},{"제외키워드":"상표권있는이름","제외카테고리키워드":"디지털/가전","지정카테고리번호":"50003310"}]);XLSX.utils.book_append_sheet(e,t,"키워드및카테고리지정"),XLSX.writeFile(e,"키워드및카테고리지정.xlsx")}async function getreviews(e,t,r,a){e=e.productId;a=(await chrome.scripting.executeScript({target:{tabId:a.id},function:async function(e,r){var a=[e+"&viRoleCode=2",e+"&viRoleCode=3"];let n;for(let t=0;t<a.length;t++)try{console.log("Trying URL:",a[t]);var o=await fetch(a[t],{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="116", "Not)A;Brand";v="24", "Google Chrome";v="116"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://www.coupang.com/vp/products/"+r+"?isAddedCart=",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});break}catch(e){n=e,console.log(`Attempt ${t+1} failed:`,e),t<a.length-1&&await async function(t){return new Promise(e=>setTimeout(e,t))}(1e3)}if(!o)return console.log("All attempts failed:",n),[[],0,n,"error",0];if(e=await o.text(),console.log("content:"),console.log(e),e.includes("알 수 없는 오류가 발생")||e.includes("Access Denied"))return[[],0,e,"알수없는오류 또는 Access Denied",0];var t=(new DOMParser).parseFromString(e,"text/html");if(console.log(t),!t.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")||!t.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")[0].dataset)return[[],0,e,"리뷰결과없음 : https://www.coupang.com/vp/products/"+r,0];console.log(t.body.innerHTML);var s=t.getElementsByClassName("js_reviewArticleTotalCountHiddenValue")[0].dataset.totalCount;if(0==s)return[[],0,e,"리뷰결과없음 : https://www.coupang.com/vp/products/"+r,0];for(var e=t.getElementsByClassName("js_reviewArticleHiddenValue")[4].dataset.count,c=(console.log(s,e),{}),l=[],i=0;i<t.getElementsByClassName("js_reviewArticleReviewList").length;i++){var u,d,h,f,p,m,g,y,v,b,w=t.getElementsByClassName("js_reviewArticleReviewList")[i];w.getElementsByClassName("js_reviewArticleRatingValue")[0].dataset&&(u=w.getElementsByClassName("sdp-review__article__list__attachment__list").length,d=w.getElementsByClassName("sdp-review__article__list__info__user")[0].children[0].dataset.memberId,h=w.getElementsByClassName("sdp-review__article__list__info__user")[0].children[0].textContent,f=w.getElementsByClassName("js_reviewArticleRatingValue")[0].dataset.rating,p=w.getElementsByClassName("sdp-review__article__list__info__product-info__reg-date")[0].textContent,m=w.getElementsByClassName("sdp-review__article__list__info__product-info__seller_name")[0].textContent,g=w.getElementsByClassName("sdp-review__article__list__info__product-info__name")[0].textContent,y=w.getElementsByClassName("sdp-review__article__list__headline")[0]?w.getElementsByClassName("sdp-review__article__list__headline")[0].textContent:"",v=w.getElementsByClassName("js_reviewArticleContent")[0]?w.getElementsByClassName("js_reviewArticleContent")[0].textContent:"",b=!!w.getElementsByClassName("js_reviewArticleAdventureBtn")[0],w=w.getElementsByClassName("js_reviewArticleHelpfulContainer")[0]?w.getElementsByClassName("js_reviewArticleHelpfulContainer")[0].dataset.count:"",c={"리뷰어번호":d,"이름":h,"평점":f,"작성일":p,"판매자":m.replaceAll("\n","").trim(),"상품옵션명":g,"리뷰제목":y.replaceAll("\n","").trim(),"리뷰내용":v.replaceAll("\n","").trim(),"도움된인원수":w,"사진수":u,"체험단":b},console.log(c),l.push(c))}return console.log(l),console.log(s),[l,s,"ok","OK",e]},args:["https://www.coupang.com/vp/product/reviews?productId="+e+"&page="+(t+1)+"&size="+r+"&sortBy=DATE_DESC&ratings=&q=&ratingSummary=true",e]}))[0].result;return"ok"!==a[2]&&(console.log("리뷰분석에러 : "),console.log("================================================"),console.log("================================================"),console.log(a[2]),console.log(a[3]),console.log("================================================"),console.log("================================================")),a}async function doSecretOn(){console.log("doSecretOn");var e=await secretOn(),[t]=(console.log(e),await chrome.tabs.query({active:!0,currentWindow:!0}));console.log(t),showAlertModal(e,t),await sleep(1e3),hideAlertModal(t)}async function showAlertModal(e,t){console.log(t),async function(e){var t=document.createElement("div");t.className="popup_alert",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(255, 255, 0, 0.8",t.style.padding="30px",t.style.textAlign="center",t.style.fontWeight="bold",t.style.zIndex=9999,t.style.display="block",t.style.borderRadius=t.textContent=e,document.body.appendChild(t)}(e)}async function hideAlertModal(e){console.log(e),async function(){document.querySelector(".popup_alert").style.display="none"}()}async function getrelatedkeywords(e,t,r){for(var a=[],n=await getrelfromcoupang(e,t),o=await getrelfromnaver(e,r),s=0;s<n.relatedkeywords.length;s++)a.includes(n.relatedkeywords[s])||a.push(n.relatedkeywords[s]);for(s=0;s<o.relatedkeywords.length;s++)a.includes(o.relatedkeywords[s])||a.push(o.relatedkeywords[s]);return a}async function getrelfromnaver(e,t){return{relatedkeywords:(await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchnaverrelatedkeyword,args:[e]}))[0].result.relatedkeywords}}async function fetchnaverrelatedkeyword(e){var e=await(await fetch("https://search.shopping.naver.com/search/all?query="+e+"&prevQuery="+e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://search.shopping.naver.com/search/all?query="+e,referrerPolicy:"unsafe-url",body:null,method:"GET",mode:"cors",credentials:"include"}).catch(console.log)).text(),e=(new DOMParser).parseFromString(e,"text/html"),t=[];if(Array.from(e.getElementsByClassName("relatedTags_relation_srh__YG9s7"))){var r=Array.from(e.getElementsByClassName("relatedTags_relation_srh__YG9s7"));if(0<r.length)for(var a=0;a<r[0].children[1].children.length;a++){var n=r[0].children[1].children[a].innerText;t.includes(n)||t.push(n)}}if(Array.from(e.querySelectorAll(".filter_finder_col__k6BKF")).find(e=>e.innerText.includes("키워드추천"))){console.log(Array.from(e.querySelectorAll(".filter_finder_col__k6BKF")).find(e=>e.innerText.includes("키워드추천")).children[1].children[0].children[0]);var o=Array.from(e.querySelectorAll(".filter_finder_col__k6BKF")).find(e=>e.innerText.includes("키워드추천")).children[1].children[0].children[0];if(0<o.length)for(a=0;a<o.children.length;a++)n=o.children[a].innerText,t.includes(n)||t.push(n)}return{relatedkeywords:t}}async function getrelfromcoupang(e,t){t=await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchrelatedkeyword,args:[e]});return t[0].result&&t[0].result.relatedkeywords?{relatedkeywords:t[0].result.relatedkeywords}:{relatedkeywords:[]}}async function fetchrelatedkeyword(e){var e="https://www.coupang.com/np/search?rocketAll=false&q="+encodeURI(e)+"&brand=&offerCondition=&filter=&availableDeliveryFilter=&filterType=&isPriceRange=false&priceRange=&minPrice=&maxPrice=&page=1&trcid=&traid=&filterSetByUser=true&channel=user&backgroundColor=&component=&rating=0&sorter=scoreDesc&listSize=36",e=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),t=(new DOMParser).parseFromString(e,"text/html"),r=[];if(t.querySelector(".search-related-keyword")&&0<t.querySelector(".search-related-keyword").children[1].children.length)for(i=0;i<t.querySelector(".search-related-keyword").children[1].children.length;i++)element=t.querySelector(".search-related-keyword").children[1].children[i],r.push(element.innerText);if(t.querySelector(".srp_relatedKeywords__DJiuK")&&0<t.querySelector(".srp_relatedKeywords__DJiuK").children.length)for(i=1;i<t.querySelector(".srp_relatedKeywords__DJiuK").children.length;i++)element=t.querySelector(".srp_relatedKeywords__DJiuK").children[i],r.push(element.innerText);return{relatedkeywords:r}}async function totalTrackingRank(){let e=await chrome.tabs.query({}),[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),r=e.find(e=>e.url.includes("wing.coupang.com"));showPopupDiv(t,"랭킹수집중"),console.log(domain+"api/analysis/getranking");var a=await(await fetch(domain+"api/analysis/getranking",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line2626"),console.log(e),alert("수집할 내역이 없습니다."),hidePopupDiv(t)})).json();0<a.length?gettrackingrank(a,t,r):(console.log("line2647"),alert("수집할 내역이 없습니다."),hidePopupDiv(t))}async function gettrackingrank(e,t,r){for(var a=new Date,n=a.getFullYear()+"-"+("0"+(1+a.getMonth())).slice(-2)+"-"+("0"+a.getDate()).slice(-2),o=(console.log(e),0),s=0,c=0,l="",i=0;i<e.length;i++){var u=e[i],d=(showStatus(t,"랭킹수집 중 ("+(i+1)+"/"+e.length+")"),"("+(i+1)+"/"+e.length+")"),d=(await secretOn(),await fetchProductRank(u.keyword,u.productId,t,d)),h=r?(h=await chrome.scripting.executeScript({target:{tabId:r.id},function:getImpressionsProduct,args:[u.productId,u.itemId]}),console.log(h),h[0].result):null;u.ranklist.find(e=>e.date==n)?(u.ranklist.find(e=>e.date==n).rank=d.rank,u.ranklist.find(e=>e.date==n).totalrank=d.totalrank,u.ranklist.find(e=>e.date==n).click=h):u.ranklist.push({date:n,rank:d.rank,totalrank:d.totalrank,click:h}),100<=u.ranklist.length&&(u.ranklist=u.ranklist.slice(u.ranklist.length-100,u.ranklist.length));d=await(await fetch(domain+"api/analysis/updaterankingall",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([u])}).catch(e=>{console.log(e),c++,l+=u.productId+"("+u.keyword+")\n"})).json();o+=d.cnt,s+=d.cnt_update,d.cnt&&d.cnt_update&&(o+=d.cnt,s+=d.cnt_update)}""!==l?alert("요청결과\n수집건수 : "+o+"\n업데이트건수 : "+s+"\n수집오류건수 : "+c+"\n수집오류 : "+l):alert("요청결과\n수집건수 : "+o+"\n업데이트건수 : "+s),hidePopupDiv(t)}function showStatus(e,t){hidePopupDiv(e),showPopupDiv(e,t)}async function secretOnNaver(){var e,t=await chrome.cookies.getAll({});console.log(t);for(e of t)e.domain.includes("smartstore.naver.com")&&(await chrome.cookies.remove({name:e.name,url:"https://smartstore.naver.com"}),await chrome.cookies.remove({name:e.name,url:"https://brand.naver.com"}));return console.log("secret On"),"시크릿 모드 On"}async function secretOn(){var e,t=await chrome.cookies.getAll({});console.log(t);for(e of t)e.domain.includes("coupang.com")&&(await chrome.cookies.remove({name:e.name,url:"https://www.coupang.com"}),await chrome.cookies.remove({name:e.name,url:"https://shop.coupang.com"}),await chrome.cookies.remove({name:e.name,url:"https://store.coupang.com"}),await chrome.cookies.remove({name:e.name,url:"https://m.coupang.com"}));return console.log("secret On"),"시크릿 모드 On"}async function confirmloginstatus(){console.log(domain+"api/addpolist/confirmlogin");var e=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line94"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();return"로그인성공"==e.loginstatus?(searchinfo.auth=e.auth,!0):(alert(e.loginstatus),!1)}function newproduct(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line94"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();"로그인성공"==e.loginstatus?(searchinfo.auth=e.auth,0==mv&&0==(mv=await getmv())?alert("쿠플러스 로그인 상태를 확인해 주세요"):await functionnp()):(alert(e.loginstatus),console.log("line108"+e.loginstatus))}()}async function getmv(){var e=await(await fetch(domain+"api/category/getmv",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line138"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();return parseInt(e.mv)}async function functionnp(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=await chrome.scripting.executeScript({target:{tabId:e.id},func:async function(e){{if(document.getElementById("productList")&&document.getElementById("productList").children){for(var t=0;t<document.getElementById("productList").children.length;t++){var r=document.getElementById("productList").children[t];parseInt(r.dataset.vendorItemId)>e&&(r.children[0].style.backgroundColor="LightGreen")}return{alert:"done"}}return{alert:"쿠팡 검색화면에서 조회해 주세요"}}},args:[mv]});console.log(e[0].result),"done"!=e[0].result.alert&&alert(e[0].result.alert)}function functionwj(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line94"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();"로그인성공"==e.loginstatus?(searchinfo.auth=e.auth,await functionwingandjet()):(alert(e.loginstatus),console.log("line108"+e.loginstatus))}()}async function functionwingandjet(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=await chrome.scripting.executeScript({target:{tabId:e.id},func:async function(){{if(document.getElementById("productList")&&document.getElementById("productList").children){for(var e=0;e<document.getElementById("productList").children.length;e++){var t=document.getElementById("productList").children[e];t.innerHTML.includes("vendor_inventory")&&t.innerHTML.includes("도착 보장")&&(t.children[0].style.backgroundColor="LightPink")}return{alert:"done"}}return{alert:"쿠팡 키워드 검색 화면에서 조회해 주세요"}}}});console.log(e[0].result),"done"!=e[0].result.alert&&alert(e[0].result.alert)}function addtrackingproduct(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e,t=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line94"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();"로그인성공"==t.loginstatus?(searchinfo.auth=t.auth,(e=await fetchtracking())&&e[0]?e[0].productId&&(console.log(e[0]),savetracking(e)):alert("수집실패")):(alert(t.loginstatus),console.log("line108"+t.loginstatus))}()}function addtrackingrank(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e,t=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line94"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();"로그인성공"==t.loginstatus?(searchinfo.auth=t.auth,0==(e=confirmkeywords()).length?alert("랭킹을 추적할 키워드를 1개 이상 입력해 주세요"):(await secretOn(),(e=await fetchtrackingrank(e)).keywords&&e.keywords[0]?e.obj.productId&&e.obj.vendorItemId&&savetrackingrank(e):alert("수집실패"))):(alert(t.loginstatus),console.log("line108"+t.loginstatus))}()}function confirmkeywords(){var t=[];return document.querySelector("#keyword1").value.split(",").forEach(e=>{e.trim()&&t.push(e.trim())}),t}function collecttrackingproduct(){!async function(){trackingstatus=!0;var e={cnt:0},t=(console.log(domain+"api/addpolist/confirmlogin"),await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line94"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json());if(console.log(t),"로그인성공"==t.loginstatus){searchinfo.auth=t.auth;var r=await importtracking(t.companyid);if(!r||0==r.length)return alert("추가된 경쟁사 상품이 없습니다."),document.querySelector("#collecttrackingsales").value="경쟁사 판매현황 수집",e;var a,n=Date.now(),o=[];for(a of r)console.log(a.list.filter(e=>e.d>n-36e5).length),0<a.list.filter(e=>e.d>n-36e5).length&&(console.log(a.list.length),0<a.list.length)||o.push(a),await sleep(10);if(o.length<r.length)return alert("잦은 수집으로 인한 차단방지를 위해 수집된지 1시간이 경과한 제품만 수집됩니다. 수집가능 상품 "+o.length+"개"),e.msg="잦은 수집으로 인한 차단방지를 위해 수집된지 1시간이 경과한 제품만 수집됩니다. 수집가능 상품 "+o.length+"개",document.querySelector("#collecttrackingsales").value="경쟁사 판매현황 수집",e;document.querySelector("#collecttrackingsales").value="경쟁사 판매현황 수집 중 (0%)";var r=await collecttrackingfrom(o),s=await regtracking(r);if("success"!==s.요청결과)return alert(s.요청결과),console.log(s),document.querySelector("#collecttrackingsales").value="경쟁사 판매현황 수집",e;alert(r.length+"개 상품 수집완료"),e.cnt=r.length,document.querySelector("#collecttrackingsales").value="경쟁사 판매현황 수집완료"}else alert(t.loginstatus),console.log("line108"+t.loginstatus);return trackingstatus=!1,e}()}async function fetchtrackingrank(e){console.log(e);var[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e){function t(t){var e=t.indexOf('"stickBanners":');if(-1===e)return t;let r=0,a=e+15;for(let e=a;e<t.length;e++)if("["===t[e]&&r++,"]"===t[e]&&r--,0===r){a=e+1;break}return t.slice(0,e)+'"stickBanners":[]'+t.slice(a)}var r=document.documentElement.outerHTML,a=Array.from(document.querySelectorAll("script")),n="",o=null;if(r.includes("exports.sdp")){a.forEach(e=>{e.innerHTML.includes("exports.sdp")&&(n=e.innerHTML)}),console.log(n);var s=n.indexOf("exports.sdpIssueTypes"),c=(-1==s&&(s=n.indexOf("exports.disableCSR")),n.lastIndexOf(";",s)),l=(n=n.substring(0,c)).slice(n.search("exports.sdp")+14);console.log(l);try{o=JSON.parse(l)}catch(e){console.log(e),l=t(l),o=JSON.parse(l)}console.log(o)}else if(r.includes("exports.product")){a.forEach(e=>{e.innerHTML.includes("exports.product")&&(n=e.innerHTML)}),console.log(n),-1==(s=n.indexOf("exports.sdpIssueTypes"))&&(s=n.indexOf("exports.disableCSR")),c=n.lastIndexOf(";",s),n=n.substring(0,c),l=n.slice(n.search("exports.product")+18),console.log(l);try{o=JSON.parse(l)}catch(e){console.log(e),l=t(l),o=JSON.parse(l)}console.log(o)}else r.includes("atfData")&&(l=function(t){if(console.log("--- 함수 시작 ---"),"string"!=typeof t||null===t)return console.error("입력 텍스트가 유효한 문자열이 아닙니다."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`시작 마커 "${e}" (또는 다른 주요 마커)를 찾을 수 없습니다.`),null;console.log(`마커 "${e}" 찾음. 인덱스: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("객체 시작 '{' 찾음. 인덱스:",n);break}if(e>a+5&&" "!==t[e])return console.error("마커 뒤에서 '{'를 적절한 위치에서 찾지 못했습니다."),null}if(-1===n)return console.error("객체 시작 '{'를 찾을 수 없습니다."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("객체 끝 '}' 찾음. 인덱스:",s);break}if(-1===s)return console.error("객체의 짝이 맞는 '}'를 찾을 수 없습니다."),null;let c=t.substring(a,s+1);console.log("추출된 문자열 (원본):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("최종 처리 후 문자열 (파싱 시도):",c.substring(0,200)+"..."),0===c.length)return console.error("최종 처리 후 문자열이 비어있습니다."),null;try{return JSON.parse(c),console.log("JSON 파싱 성공!"),c}catch(e){return console.error("JSON 파싱 실패:",e.message),console.error("파싱 시도한 문자열 (전체):\n",c),null}}(r),o=JSON.parse(l),console.log(o));return o},args:[t.url]});if(console.log(t[0].result),t[0].result){var r=await confirmtrackingrank(t[0].result,e);if(console.log(r),"fail"==r.요청결과)alert("요청실패"),console.log(r.error);else if(r.remainslot<0)alert("추가 가능한 수량을 초과하였습니다. (추가 가능 키워드수 : "+(e.length+r.remainslot)+"개)");else{if(0!=r.regKeywords.length){r.regKeywords.length<e.length&&alert(r.regKeywords.length+"개의 키워드만 등록됩니다."),document.querySelector("#collectrank").className="d-none",document.querySelector("#rankstatus").className="btn btn-outline-primary fw-bold",await sleep(8e3);for(var e=new Date,a=e.getFullYear()+"-"+("0"+(1+e.getMonth())).slice(-2)+"-"+("0"+e.getDate()).slice(-2),n=[],o=(r.regKeywords.forEach(e=>{n.push({date:a,keyword:e,rank:"27페이지 이상",totalrank:1e3})}),console.log(t[0].result.productId),t[0].result.productId),s=0;s<n.length;s++){var c=n[s],l=(document.querySelector("#rankrate").innerText=(s/n.length*100).toFixed(0),await fetchrank(c.keyword,o));console.log(l),c.totalrank=l.totalrank,c.rank=l.rank}return[].push(t[0].result),document.querySelector("#collectrank").className="btn btn-outline-primary fw-bold",document.querySelector("#rankstatus").className="d-none",{obj:t[0].result,keywords:n}}alert("해당 키워드는 이미 등록되었습니다.")}}else alert("쿠팡상품페이지에서 수집해주세요")}async function fetchProductRank(e,t,r,a){for(var n=!1,o="30페이지 이상",s=1e3,c=e,l=(console.log(e,t),30),i=0;i<l;i++){await sleep(500),console.log(i+1+"page / "+l);var u=await fetchkeywordmAPI(c,i+1);if(u&&u.lastpage&&u.lastpage<30&&(l=u.lastpage),console.log(l),showStatus(r,"랭킹수집 중 "+a+"\n("+(i+1)+"page / "+l+"page scan...)"),console.log(u),null===u||!u.productlists)break;if(u.productlists.some(e=>{if(console.log(e.productId,t),parseInt(e.productId)==parseInt(t))return s=i*u.productlists.length+parseInt(e.rank),o=i+1+"p/"+e.rank,n=!0}),console.log(o),n)break}return{rank:o,totalrank:s}}async function fetchrank(e,t){for(var r=!1,a="30페이지 이상",n=1e3,o=e,s=(console.log(e,t),30),c=0;c<s;c++){await sleep(500);var l=await fetchkeywordmAPI(o,c+1);if(console.log(l),!(l&&l.domCheck||(await sleep(2e3),l=await fetchkeywordmAPI(o,c+1),console.log(l),l.domCheck)))return console.log("domcheck fail"),{rank:a,totalrank:n};if(l&&l.lastpage&&l.lastpage<30&&(s=l.lastpage),console.log(c+1+"page / "+s+"page scan..."+l?.productlists?.length+"개 상품 중"),null===l||!l.productlists)break;if(l.productlists.some(e=>{if(parseInt(e.productId)==parseInt(t))return n=c*l.productlists.length+parseInt(e.rank),a=c+1+"p/"+e.rank,r=!0}),r)break}return console.log(a),{rank:a,totalrank:n}}async function waitForRefresh(o){return new Promise((a,e)=>{function n(e,t,r){e===o&&"complete"===t.status&&(chrome.tabs.reload(o,()=>{a(r)}),chrome.tabs.onUpdated.removeListener(n))}chrome.tabs.onUpdated.addListener(n),chrome.tabs.reload(o),setTimeout(()=>{e(new Error("Timeout: Tab did not load in time.")),chrome.tabs.onUpdated.removeListener(n)},15e3)})}chrome.tabs.query({},e=>{e.find(e=>e.url.includes("couplus.co.kr"))&&(e=e.find(e=>e.url.includes("couplus.co.kr")).url,domain=e.slice(0,e.search("kr")+2)+"/")}),document.addEventListener("DOMContentLoaded",async function(){await preventDiscardAllTabs(),document.querySelector("#addpo").addEventListener("click",select),document.querySelector("#addsku").addEventListener("click",addsku),document.querySelector("#addsales").addEventListener("click",addsales),document.querySelector("#collectproduct").addEventListener("click",collectproduct),document.querySelector("#trackingsales").addEventListener("click",addtrackingproduct),document.querySelector("#trackingrank").addEventListener("click",addtrackingrank),document.querySelector("#wingandjet").addEventListener("click",functionwj),document.querySelector("#newproducts").addEventListener("click",newproduct),document.querySelector("#reviewdownload").addEventListener("click",getreviewdownload),document.querySelector("#reviewfulldownload").addEventListener("click",getreviewdownloadwith),document.querySelector("#capture").addEventListener("click",captureplay),document.querySelector("#stop").addEventListener("click",capturestop),document.querySelector("#seconds").addEventListener("change",changecaptureinterval),document.querySelector("#secretOn").addEventListener("click",doSecretOn),document.querySelector("#storelink").addEventListener("click",gostorelink),document.querySelector("#calcollapse").addEventListener("click",openCalculation),document.querySelectorAll(".calculate").forEach(e=>{e.addEventListener("click",calculateMargin)}),document.querySelector("#calculateDownload").addEventListener("click",downloadCalculation),document.querySelector("#coubnamBtn").addEventListener("click",openCoubnam),document.querySelector("#keywordBrandAnalysis").addEventListener("click",keywordBrandAnalysis),document.getElementById("agentButton1688").addEventListener("click",checkAndOpenNegotiationModal)}),document.addEventListener("keydown",async function(e){(e.metaKey||e.ctrlKey)&&e.shiftKey&&"Y"===e.key&&(console.log("secretOn"),doSecretOn()),(e.metaKey||e.ctrlKey)&&e.shiftKey&&"L"===e.key&&confirm("전체상품의 랭킹을 업데이트 하시겠습니까?\nip차단 방지를 위해 반드시 휴대폰테더링으로 접속해 주세요.")&&totalTrackingRank()}),chrome.runtime.onMessage.addListener(async function(e,t,r){console.log(e),"sales"==e.target&&(document.querySelector("#addsalesstatus").innerText=e.content),"sku"==e.target&&(document.querySelector("#addskustatus").innerText=e.content)});let keywordSessions=new Map,keywordPageCache=new Map,lastProcessedKeyword=null;function initializeSessionConfig(e){var t;return keywordSessions.has(e)||(t={osVersion:"13",appVersion:"7.8.2",accessToken:"",gcmRegisterId:"",uuid:generateUUID(),isCoupangAutoLogin:!1,deviceModel:"SM-S918N",androidIdMD5:generateMD5Hash(t=generateUUID().replace(/-/g,"")),googleAid:"",resolution:"1080x2340",pcid:t.substring(0,32),bValue:0,memberSrl:"",activeNetworkType:"WIFI",ddpResolution:"",sessionKey:"",updateToken:"",timeZoneId:Intl.DateTimeFormat().resolvedOptions().timeZone,sid:"",accessTokenSecret:"",deviceWidth:1080,deviceDpi:420,signalLevel:-80,fontScale:1,webpSupported:!0},keywordSessions.set(e,t)),keywordSessions.get(e)}function generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function generateMD5Hash(t){let r=0;if(0===t.length)return r.toString(16);for(let e=0;e<t.length;e++){var a=t.charCodeAt(e);r=(r<<5)-r+a,r&=r}return Math.abs(r).toString(16).padStart(8,"0").repeat(4).substring(0,32)}function generateCoupangUserAgent(e){var t=[];return t.push("COUPANG|Android"),t.push(e.osVersion),t.push(e.appVersion),t.push(e.accessToken),t.push(e.gcmRegisterId),t.push(e.uuid),t.push(e.isCoupangAutoLogin?"Y":"N"),t.push(e.deviceModel),t.push(e.androidIdMD5),t.push(e.googleAid),t.push(e.resolution),t.push(e.pcid),t.push(""),t.push(""),t.push(e.bValue),t.push(e.memberSrl),t.push(e.activeNetworkType),t.push(e.ddpResolution),t.push(e.sessionKey),t.push(e.updateToken),t.push(e.timeZoneId),t.push(e.sid),t.push(e.accessTokenSecret),t.push(e.deviceWidth),t.push(e.deviceDpi),t.push(e.signalLevel),t.push(e.fontScale),t.push(e.webpSupported),t.join("|")}async function searchCoupangProductsAPI(r,a=null,n=null){for(let t=1;t<=3;t++)try{let e="filter=KEYWORD:"+encodeURIComponent(r);e=(e=(e=(e+="&channel="+encodeURIComponent("app_search"))+("&selectedViewType="+encodeURIComponent("LIST")))+("&resultType="+encodeURIComponent("default")))+("&extraQueryParams="+encodeURIComponent("sort=RANK"))+"&preventingRedirection=false",a&&(e+="&nextPageKey="+encodeURIComponent(a)),n&&(e+="&nextPageParams="+encodeURIComponent(n));var o="https://cmapi.coupang.com/v3/products?"+e,s=initializeSessionConfig(r),c={"coupang-app":generateCoupangUserAgent(s),"run-mode":"production","X-COUPANG-ACCEPT-LANGUAGE":"ko-KR","X-COUPANG-ORIGIN-REGION":"KR","X-COUPANG-TARGET-MARKET":"KR","X-COUPANG-APP-NAME":"coupang","X-COUPANG-FONT-SCALE":"1.0","x-view-name":"SRP","x-cp-app-req-time":Date.now().toString(),"X-COUPANG-APP-REQUEST":"true",Accept:"application/json, text/plain, */*","X-Coupang-App-Version":"7.8.2","X-Coupang-Device-Id":s.uuid};const d=new AbortController;var l,i=setTimeout(()=>d.abort(),1e4),u=await fetch(o,{method:"GET",headers:c,signal:d.signal});if(clearTimeout(i),u.ok)return(l=await u.json())&&l.rData&&l.rData.entityList&&Array.isArray(l.rData.entityList)?{products:l.rData.entityList,nextPageKey:l.rData.nextPageKey,nextPageParams:l.rData.nextPageParams,pageUUID:l.rData.pageUUID,totalCount:l.rData.totalCount,hasNextPage:!!l.rData.nextPageKey}:{products:[],nextPageKey:null,nextPageParams:null,pageUUID:null,totalCount:0,hasNextPage:!1};throw new Error("HTTP error! Status: "+u.status)}catch(e){if(console.error(`API 호출 실패 ${t}/3 - 키워드: `+r,e),!(t<3))throw console.error("API 호출 최종 실패 - 키워드: "+r),new Error("API 호출 실패 (3회 시도): "+e.message);console.log("3초 후 재시도..."),await sleep(3e3)}}async function fetchkeywordmAPI(e,t){lastProcessedKeyword&&lastProcessedKeyword!==e&&(r=keywordSessions.size,o=keywordPageCache.size,keywordSessions.clear(),keywordPageCache.clear(),console.log(`키워드가 "${lastProcessedKeyword}"에서 "${e}"로 변경되어 모든 캐시를 초기화했습니다. (세션: ${r}개, 페이지캐시: ${o}개)`));for(var r=lastProcessedKeyword=e,a=(keywordPageCache.has(r)||keywordPageCache.set(r,{pages:[]}),keywordPageCache.get(r));a.pages.length<t;){var n=a.pages.length,n=await searchCoupangProductsAPI(e,0===n?null:a.pages[n-1].nextPageKey,0===n?null:a.pages[n-1].nextPageParams);if(!n||!n.products||0===n.products.length)break;if(a.pages.push(n),!n.hasNextPage)break}if(a.pages.length<t)return{lastpage:t-1,productlists:[],productqty:0,adlists:[],domCheck:!0};for(var o=a.pages[t-1],s=o.products,c=[],l=[],i=0,u=0;u<s.length;u++){var d=s[u];let t=null;if(d.entity&&d.entity.displayItem?t=d.entity.displayItem:d.displayItem&&(t=d.displayItem),t){var h,d=!("PRODUCT_BANNER"!==d.type&&!t.sponsoredText);d||i++;let e=0;t.salesPrice&&Array.isArray(t.salesPrice)&&(f=t.salesPrice[0])&&(e=parseInt(f.replace(/[^0-9]/g,""))||0),t.deliveryBadgeIcon?.caption?t.deliveryBadgeIcon.caption.includes("MERCHANT")?h="jet":t.deliveryBadgeIcon.caption.includes("ROCKET")&&(h="rocket"):h="wing";var f={rank:d?null:i,type:h,productName:t.title||"",price:e,rating:parseFloat(t.ratingAverage)||0,ratingcount:t?.ratingCount?parseInt(t?.ratingCount?.replaceAll(")","")?.replaceAll("(","")?.replaceAll(",","")):0,vendorItemId:t.vendorItemId||null,productId:t.id||null,itemId:t.itemId||null,ad:d,imgUrl:t.thumbnailSquare||""};(d?c:l).push(deepClone(f))}}return{lastpage:o.hasNextPage&&a.pages.length>=t?t+1:t,productlists:l,productqty:l.length+c.length,adlists:c,domCheck:!0}}async function fetchKeywordW(e,t=1){var e=await async function(e,t=1){var r=encodeURIComponent(e),e=encodeURIComponent(JSON.stringify(["",{children:["srp",{children:[`__PAGE__?{"component":"","q":"${e}","channel":"user"}`,{},`/np/search?component=&q=${r}&channel=user`,"refresh"]}]},null,null,!0])),r=await fetch("https://www.coupang.com/np/search"+`?q=${r}&channel=user&page=${t}&_rsc=4togz`,{method:"GET",mode:"cors",credentials:"include",referrer:"https://www.coupang.com",referrerPolicy:"strict-origin-when-cross-origin",headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","next-router-state-tree":e,"next-url":"/srp",priority:"u=1, i",rsc:"1","sec-ch-ua":'"Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"}}),t=(console.log(r),r.headers.get("content-type")||""),e=await r.text();if(console.log(e),t.includes("text/x-component"))return r=e.split("\n").map(e=>{var t=e.indexOf(":");if(-1===t)return null;try{return JSON.parse(e.slice(t+1))}catch{return null}}).filter(Boolean).at(-1),console.log(r),r?.[0]?.[0]?.[3]?.children?.[1]?.[3]?.children?.[0]?.[3]?.children?.[1]?.[3]?.children?.[2]?.[3]?.children?.[0]?.[3]?.products??[];if(t.includes("text/html"))return r=(new DOMParser).parseFromString(e,"text/html"),Array.from(r.querySelectorAll("#productList > li.search-product")).map(e=>{var t=e.className.includes("search-product__ad-badge")||e.className.includes("search-product__cmg-badge"),r=e.querySelector(".badge.rocket img"),a=r?.src||"",r=!!r||"true"===e.dataset.isRocket,n=e.querySelector(".price-value")?.textContent.replace(/[,₩]/g,"")||"0";return{adBadgeArea:{sponsored:t},rocketArea:{show:r,badgeImage:{iconUrl:a}},imageAndTitleArea:{title:e.querySelector(".name,.title")?.textContent.trim()??"",defaultUrl:"https:"+(e.querySelector("img")?.getAttribute("src")??"")},priceArea:{price:n,i18nSalesPrice:{amount:n}},reviewArea:{ratingAverage:parseFloat(e.querySelector(".rating")?.textContent)||0,ratingCount:parseInt(e.querySelector(".rating-total-count")?.textContent.replace(/[(),]/g,""))||0},vendorItemId:e.dataset.vendorItemId??null,legacyProductId:e.dataset.productId??null,index:{itemId:e.dataset.itemId??null}}});try{return JSON.parse(e)}catch{return[]}}(e,t),r=(console.log(e),[]),a=[];let n=0;for(const l of e){var o=!!l.adBadgeArea?.sponsored;let e;e=l.rocketArea?.show?l.rocketArea.badgeImage?.iconUrl?.includes("logoRocketMerchant")?"jet":"rocket":"wing";var s=l.priceArea?.i18nSalesPrice?parseInt(l.priceArea.i18nSalesPrice.amount):parseInt((l.priceArea?.price||"0").replaceAll(",","")),c=l.imageAndTitleArea?.defaultUrl?l.imageAndTitleArea.defaultUrl.startsWith("//")?"https:"+l.imageAndTitleArea.defaultUrl:l.imageAndTitleArea.defaultUrl:"",s={rank:o?null:++n,type:e,productName:l.imageAndTitleArea?.title||"",price:s,rating:l.reviewArea?.ratingAverage??0,ratingcount:l.reviewArea?.ratingCount??0,vendorItemId:l.vendorItemId??null,productId:l.legacyProductId??null,itemId:l.index?.itemId??null,ad:o,imgUrl:c};(o?r:a).push(function e(t){if(null===t||"object"!=typeof t)return t;var r=Array.isArray(t)?[]:{};for(const a of Object.keys(t))r[a]=e(t[a]);return r}(s))}return{lastpage:0===e.length?t:t+1,productlists:a,productqty:a.length+r.length,adlists:r,domCheck:!0}}async function fetchkeywordm(e,t){function a(e){if(null===e||"object"!=typeof e)return e;var t,r=Array.isArray(e)?[]:{};for(t of Object.keys(e))r[t]=a(e[t]);return r}e="https://m.coupang.com/nm/search?q="+encodeURI(e)+"&page="+t;console.log("current url : "),console.log(e),console.log("current page : "+t+"page");try{var r=await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",priority:"u=0, i","sec-ch-ua":'"Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:e,referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});console.log(r)}catch(e){return console.log(e),{lastpage:l,productlists:s,productqty:c,adlists:o,domCheck:!1}}var n,e=await r.text(),r=(new DOMParser).parseFromString(e,"text/html"),o=(console.log(r),[]),s=[],c=0;if(!r.querySelector("#goodsList"))return{lastpage:l,productlists:s,productqty:c,adlists:o,domCheck:!1};if(!r.querySelector("#productList"))return{lastpage:l=t,productlists:s,productqty:c,adlists:o,domCheck:!0};var l=t+1;if(console.log(r.querySelector("#pagination")),r.querySelector("#pagination")&&(parseInt(r.querySelector("#pagination").getAttribute("count"))&&(c=parseInt(r.querySelector("#pagination").getAttribute("count"))),"page next dim"==r.querySelector("#pagination").children[0].children[r.querySelector("#pagination").children[0].children.length-1].className)&&(l=t),console.log(c),console.log(l),console.log(r.querySelector("#productList")),r.querySelector("#productList")&&0<r.querySelector("#productList").children.length)for(var i=Array.from(r.querySelector("#productList").children),u=(console.log(i),0),d=0;d<i.length;d++)console.log(i[d]),console.log(i[d].querySelector(".title")),i[d].querySelector(".title")&&(console.log(i[d].className.includes("search-product__cmg-badge")),i[d].className.includes("search-product__cmg-badge")||u++,console.log(u),console.log(i[d].innerHTML.includes("vendor_inventory")),console.log(i[d].querySelector(".title ").innerText),console.log(i[d].querySelector(".discount-price ")),console.log(parseInt(i[d].querySelector(".discount-price ").children[0].innerText.replaceAll(",",""))),console.log(i[d].querySelector(".rating")),console.log(i[d].querySelector(".rating-total-count")),console.log(i[d].dataset.vendorItemId,i[d].dataset.productId,i[d].dataset.itemId),console.log(i[d].querySelector(".thumbnail").children[0].src),n={rank:u,type:i[d].innerHTML.includes("vendor_inventory")?i[d].innerHTML.includes("도착 보장")?"jet":"wing":"rocket",productName:i[d].querySelector(".title ").innerText,price:i[d].querySelector(".discount-price ")?parseInt(i[d].querySelector(".discount-price ").children[0].innerText.replaceAll(",","")):0,rating:i[d].querySelector(".rating")?parseFloat(i[d].querySelector(".rating").innerText):0,ratingcount:i[d].querySelector(".rating-total-count")?parseInt(i[d].querySelector(".rating-total-count").innerText.replaceAll(",","").replaceAll("(","").replaceAll(")","")):0,vendorItemId:i[d].dataset.vendorItemId,productId:i[d].dataset.productId,itemId:i[d].dataset.itemId,ad:i[d].className.includes("search-product__cmg-badge"),imgUrl:i[d].querySelector(".thumbnail").children[0].src},console.log(n),(i[d].className.includes("search-product__cmg-badge")?o:s).push(a(n)),console.log(o,s)),console.log("i:",d);return console.log(o),console.log(s),console.log(l),console.log(c),{lastpage:l,productlists:s,productqty:c,adlists:o,domCheck:!0}}async function fetchtracking(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),t=await chrome.scripting.executeScript({target:{tabId:e.id},func:async function(e){function t(t){var e=t.indexOf('"stickBanners":');if(-1===e)return t;let r=0,a=e+15;for(let e=a;e<t.length;e++)if("["===t[e]&&r++,"]"===t[e]&&r--,0===r){a=e+1;break}return t.slice(0,e)+'"stickBanners":[]'+t.slice(a)}e=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text();console.log(e);var r=(await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(e)).querySelectorAll("script"),a="",n=null;if(e.includes("exports.sdp")){r.forEach(e=>{e.innerHTML.includes("exports.sdp")&&(a=e.innerHTML)}),console.log(a);var o=a.indexOf("exports.sdpIssueTypes"),s=(-1==o&&(o=a.indexOf("exports.disableCSR")),a.lastIndexOf(";",o)),c=(a=a.substring(0,s)).slice(a.search("exports.sdp")+14);console.log(c);try{n=JSON.parse(c)}catch(e){console.log(e),c=t(c),n=JSON.parse(c)}console.log(n)}else if(e.includes("exports.product")){r.forEach(e=>{e.innerHTML.includes("exports.product")&&(a=e.innerHTML)}),console.log(a),-1==(o=a.indexOf("exports.sdpIssueTypes"))&&(o=a.indexOf("exports.disableCSR")),s=a.lastIndexOf(";",o),a=a.substring(0,s),c=a.slice(a.search("exports.product")+18),console.log(c);try{n=JSON.parse(c)}catch(e){console.log(e),c=t(c),n=JSON.parse(c)}console.log(n)}else e.includes("atfData")&&(c=function(t){if(console.log("--- 함수 시작 ---"),"string"!=typeof t||null===t)return console.error("입력 텍스트가 유효한 문자열이 아닙니다."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`시작 마커 "${e}" (또는 다른 주요 마커)를 찾을 수 없습니다.`),null;console.log(`마커 "${e}" 찾음. 인덱스: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("객체 시작 '{' 찾음. 인덱스:",n);break}if(e>a+5&&" "!==t[e])return console.error("마커 뒤에서 '{'를 적절한 위치에서 찾지 못했습니다."),null}if(-1===n)return console.error("객체 시작 '{'를 찾을 수 없습니다."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("객체 끝 '}' 찾음. 인덱스:",s);break}if(-1===s)return console.error("객체의 짝이 맞는 '}'를 찾을 수 없습니다."),null;let c=t.substring(a,s+1);console.log("추출된 문자열 (원본):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("최종 처리 후 문자열 (파싱 시도):",c.substring(0,200)+"..."),0===c.length)return console.error("최종 처리 후 문자열이 비어있습니다."),null;try{return JSON.parse(c),console.log("JSON 파싱 성공!"),c}catch(e){return console.error("JSON 파싱 실패:",e.message),console.error("파싱 시도한 문자열 (전체):\n",c),null}}(e),n=JSON.parse(c),console.log(n));return n},args:[e.url]});if(t[0].result){var r,a=await confirmtracking(t[0].result);if(0<a.cnt)alert("이미 등록된 상품입니다.");else{if(!(a.limit<=a.totalcnt))return(r=[]).push(t[0].result),await collecttrackingfromvii(r,!1,e);alert("추가 가능한 상품수량을 초과하였습니다. (최대 : "+a.limit+"개)")}}else alert("쿠팡상품페이지에서 수집해주세요")}async function confirmtrackingrank(e,t){return await(await fetch(domain+"api/analysis/confirmtrackingrank",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({obj:e,keywords:t})}).catch(e=>{console.log("line167"),console.log(e),alert("수집확인실패(168)")})).json()}async function savetrackingrank(e){console.log(e);e=await(await fetch(domain+"api/analysis/addtrackingrank",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch(e=>{console.log("line109"),console.log(e),alert("수집실패(110)")})).json();e&&alert("요청결과 : "+e["요청결과"]+"\n수집 : "+e.cnt+"\n등록 : "+e.cnt)}async function confirmtracking(e){return await(await fetch(domain+"api/analysis/confirmtracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch(e=>{console.log("line167"),console.log(e),alert("수집확인실패(168)")})).json()}async function savetracking(e){console.log(e);e=await(await fetch(domain+"api/analysis/addtracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result:e})}).catch(e=>{console.log("line109"),console.log(e),alert("수집실패(110)")})).json();e&&alert("요청결과 : "+e["요청결과"]+"\n수집 : "+e.cnt+"\n등록 : "+e.cnt_reg+"\n상품중복(미등록) : "+(parseInt(e.cnt)-parseInt(e.cnt_reg)).toString()+"\n")}function collectproduct(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e,t=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line82"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();"로그인성공"==t.loginstatus?(searchinfo.auth=t.auth,"lite"==t.version?alert("프리미엄 버전에서 이용 가능합니다."):(e=await collecting()).productnum?(console.log(e),savecollecting(e)):alert("수집실패")):(alert(t.loginstatus),console.log("line91"+t.loginstatus))}()}async function savecollecting(e){var t,r,a=[];a.push({date:(t=new Date,n=t.getFullYear(),r=("0"+(1+t.getMonth())).slice(-2),t=("0"+t.getDate()).slice(-2),n+"-"+r+"-"+t),productnum:e.productnum,options:e.options});var n=await(await fetch(domain+"api/collectproduct/saveproductdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result:a})}).catch(e=>{console.log("line109"),console.log(e),alert("수집실패(110)")})).json();n&&alert("요청결과 : "+n["요청결과"]+"\n수집 : "+n.cnt+"\n등록 : "+n.cnt_reg+"\n상품중복(미등록) : "+(parseInt(n.cnt)-parseInt(n.cnt_reg)).toString()+"\n")}async function collecting(){return await fetchproductinfo()}async function fetchproductinfo(){var e,[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t.url.includes("1688.com/offer/"))return e=await chrome.scripting.executeScript({target:{tabId:t.id},function:fetchpageinfo}),{productnum:t.url.slice(t.url.search("offer/")+6,t.url.search(".html")),options:e[0].result};alert("1688 상품페이지에서 수집해 주세요")}async function fetchpageinfo(){var e,t=[],r=[],a=[],n=[],o={};if(document.querySelector("body").innerHTML.search("widget-custom-container")<0&&document.querySelector("body").innerHTML.search("J_UlThumb")<0){for(i=0;i<document.querySelectorAll("script").length;i++)0<document.querySelectorAll("script")[i].innerHTML.search("window.__GLOBAL_DADA")&&(e=document.querySelectorAll("script")[i].innerHTML);var s=e.search("window.__INIT_DATA"),s=e.slice(s+19,e.length),s=JSON.parse(s),c=(console.log(s),s.globalData.skuModel.skuProps),l=s.globalData.skuModel.skuInfoMap,o=s,u={};if(c){for(i=0;i<c[0].value.length;i++)u=Object.keys(c[0].value[i]).includes("imageUrl")?{name:c[0].value[i].name,imageUrl:c[0].value[i].imageUrl}:{name:c[0].value[i].name,imageUrl:""},t.push(u);if(1<c.length){for(i=0;i<c[1].value.length;i++)u=Object.keys(c[1].value[i]).includes("imageUrl")?{name:c[1].value[i].name,imageUrl:c[1].value[i].imageUrl}:{name:c[1].value[i].name,imageUrl:""},r.push(u);console.log(r)}if(1<c.length)for(i=0;i<c[0].value.length;i++)for(j=0;j<c[1].value.length;j++)a.push(c[0].value[i].name+"&"+c[1].value[j].name),l&&(l[c[0].value[i].name+"&gt;"+c[1].value[j].name]?n.push(l[c[0].value[i].name+"&gt;"+c[1].value[j].name].canBookCount):n.push(0));else for(i=0;i<c[0].value.length;i++)a.push(c[0].value[i].name),l&&(l[c[0].value[i].name]?n.push(l[c[0].value[i].name].canBookCount):n.push(0));console.log(a),console.log(n)}}else if(document.querySelector("body").innerHTML.search("J_UlThumb")<0){var s=document.getElementsByClassName("widget-custom-container")[0].innerHTML,d=s.search("var iDetailData ="),h=s.search("iDetailData.allTagIds ="),s=s.slice(d,h),d=(s=(s=(s=s.trim()).replace(/ /gi,"")).replace('"skuProps"',"skuProps").replace('"skuMap"',"skuMap").replace('},"end"',"end")).search("skuProps"),h=s.search("skuMap");endtext2=s.search("end:0"),data1=s.slice(d+9,h-2),data2=s.slice(h+7,endtext2-2);const c=JSON.parse(data1),l=JSON.parse(data2);for(i=0;i<c[0].value.length;i++)u=Object.keys(c[0].value[i]).includes("imageUrl")?{name:c[0].value[i].name,imageUrl:c[0].value[i].imageUrl}:{name:c[0].value[i].name,imageUrl:""},t.push(u);if(1<c.length)for(i=0;i<c[1].value.length;i++)u=Object.keys(c[1].value[i]).includes("imageUrl")?{name:c[1].value[i].name,imageUrl:c[1].value[i].imageUrl}:{name:c[1].value[i].name,imageUrl:""},r.push(u);if(1<c.length)for(i=0;i<c[0].value.length;i++)for(j=0;j<c[1].value.length;j++)a.push(c[0].value[i].name+"&"+c[1].value[j].name),l[c[0].value[i].name+"&gt;"+c[1].value[j].name]?n.push(l[c[0].value[i].name+"&gt;"+c[1].value[j].name].canBookCount):n.push(0);else for(i=0;i<c[0].value.length;i++)a.push(c[0].value[i].name),l[c[0].value[i].name]?n.push(l[c[0].value[i].name].canBookCount):n.push(0)}else{for(i=0;i<document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[0].children[0].children.length;i++)t.push(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[0].children[0].children[i].children[0].children[0].innerText.replace("已选中",""));if(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].parentElement.innerHTML.search("数量")<0)for(i=0;i<document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].children[0].children.length;i++)r.push(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].children[0].children[i].children[0].children[0].innerText.replace("已选中",""));if(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].parentElement.innerHTML.search("数量")<0)for(i=0;i<t.length;i++)for(j=0;j<r.length;j++)a.push(t[i]+"&"+r[j]),n.push("");else for(i=0;i<t.length;i++)a.push(t[i]),n.push("")}d={option1array:t,option2array:r,optioncomb:a,optionstock:n,totalinfo:o};return console.log(d),d}function dbupdate(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line46"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();console.log(e),"로그인성공"==e.loginstatus?(searchinfo.auth=e.auth,pdbupdate()):alert(e.loginstatus)}()}function pdbupdate(){async function r(){var t=document.querySelector(".mod-order-list"),o=[],s={"상품명":"","옵션1":"","옵션2":"","상태":""};for(e of Array.from(t.children))await new Promise(e=>setTimeout(e,1)),"zone-order"==e.className&&Array.from(e.children[0].children).forEach(e=>{var t,r,a,n;"offer-list"==e.className&&(s={"상품명":"","옵션1":"","옵션2":"","상태":""},t=e.children[0].children[0].innerText,r=e.children[0].children[1].children[0].innerText.trim().split(",")[0],a=e.children[0].children[1].children[0].innerText.trim().split(",")[1],"关联失败"===e.children[1].innerText?(s.상품명=t,s.옵션1=r,s.옵션2=a,s.상태="단종",o.push(s)):(n=e.children[2].children[0].children[1].children[0].children[1].children[0].innerText.trim().split("：")[1],e=e.children[2].children[0].children[1].children[0].children[1].children[1].innerText.trim().split("：")[1],r==n&&a==e||(s.상품명=t,s.옵션1=n,s.옵션2=e,s.상태="변경",o.push(s))))});return console.log(o),o}!async function(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=await chrome.scripting.executeScript({target:{tabId:e.id},func:r});{var t;console.log(e[0].result),0<e[0].result.length?(t=await(await fetch(domain+"api/addproduct/updateproductdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e[0].result)})).json(),alert(e[0].result.length+"개 상품DB "+t.요청결과)):alert("변경할 상품DB가 없습니다.")}}()}async function importtracking(e){e=await(await fetch(domain+"api/analysis/gettracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyid:e})}).catch(e=>{console.log(e)})).json();return console.log(e),e}async function collecttrackingfrom(r){var e=await chrome.tabs.query({});return e.find(e=>e.url.includes("https://www.coupang.com/"))?(e=e.find(e=>e.url.includes("https://www.coupang.com/")),console.log(e),await collecttrackingfromvii(r,!0,e)):(url="https://www.coupang.com/",await chrome.tabs.create({url:url,active:!1},async e=>{console.log(e);var t=await collecttrackingfromvii(r,!0,e);return chrome.tabs.remove(e.id,function(e){console.log(e)}),t}))}async function collecttrackingfromvii(e,t,r){var a,n=Date.now(),o=[],s=0;console.log(e);for(a of e){t&&(document.querySelector("#collecttrackingsales").value="경쟁사 판매현황 수집 중 ("+(s/e.length*100).toFixed(0)+"%)"),console.log(a);var c=await fetchtrackinginfo(a,r);if(c){var l,i,u={},d="";if(c.options)for(var h of c.options.optionRows)d+=""==d?h.attributes.find(e=>e.selected).name:", "+h.attributes.find(e=>e.selected).name;else d="단일상품";i=c.quantityBase?(l=c.quantityBase?.[0]?.moduleData?.[0]?.detailPriceBundle?.finalPrice?.price?c.quantityBase[0].moduleData[0].detailPriceBundle.finalPrice.price:c.quantityBase[0].price.salePrice?parseInt(c.quantityBase[0].price.salePrice.replaceAll(",","")):parseInt(c.quantityBase[0].price.originPrice.replaceAll(",","")),c.quantityBase[0].delivery.badgeUrl||(c.quantityBase[0].delivery.type.includes("ROCKET")?"https://image7.coupangcdn.com/image/coupang/rds/logo/iphone_2x/logoRocketMerchantLargeV3R3@2x.png":"")):(l=0,""),0<(u={productinfo:c,productId:c.productId,itemId:c.itemId,vendorItemId:c.vendorItemId,vendorName:a.vendorName||(c.vendor?c.vendor.name:""),vendorId:a.vendorId||(c.vendor?c.vendor.id:""),optionName:d,type:a.type||(c.vendor?"wing":"rocket"),list:[{d:n,s:c.buyableQuantity||0,p:l,rp:c.ratingAveragePercentage/20,rq:parseInt(c.ratingCount.replaceAll(",","")),b:i}]}).list[0].s&&(c=await fetchstock(u.productId,u.vendorItemId,u.itemId,r),""==u.vendorName&&("A00010028"==c.vendorId?(u.vendorName="쿠팡",u.type="rocket"):(""==u.vendorName&&(i=await getvendorinfo(c.vendorId,r))&&i.vendorName&&(u.vendorName=i.vendorName),u.type="rocketgrowth")),u.vendorId=c.vendorId,u.list[0].s=parseInt(c.stock)),console.log(u),o.push(deepClone(u))}else console.log("error807"),console.log(url),console.log(r);s++}return o}async function collecttracking(e,t){var r,a=Date.now(),n=[];for(r of e){var o=await fetchtrackinginfo(r,t);if(o){var s,c,l=[],i={},u={};if(o.options){o.options.optionRows.forEach(e=>{e.attributes.forEach(e=>{u[e.valueId]=e.name})});for(var d of Object.keys(o.options.attributeVendorItemMap)){console.log(d);var h="",f=(d.split(":").forEach(e=>{h+=""==h?u[e]:", "+u[e]}),0),f=o.options.attributeVendorItemMap[d].quantityBase[0].price.salePrice?parseInt(o.options.attributeVendorItemMap[d].quantityBase[0].price.salePrice.replaceAll(",","")):parseInt(o.options.attributeVendorItemMap[d].quantityBase[0].price.originPrice.replaceAll(",","")),i={itemId:o.options.attributeVendorItemMap[d].itemId,vendorItemId:o.options.attributeVendorItemMap[d].vendorItemId,vendorName:"",vendorId:"",optionName:h,valueId:d,stock:o.options.attributeVendorItemMap[d].buyableQuantity?parseInt(o.options.attributeVendorItemMap[d].buyableQuantity):0,price:f};(p=await othervendorinfo(o.productId,i.vendorItemId,i.itemId)).items?p.items.forEach(e=>{i.vendorItemId=e.vendorItemId,i.vendorName=e.vendorName,i.price=parseInt(e.price.replaceAll(",","")),l.push(deepClone(i))}):(o.vendor?i.vendorName=o.vendor.name:i.vendorName="",l.push(deepClone(i)))}}else{var p,h="옵션없음";f=o.quantityBase?o.quantityBase?.[0]?.moduleData?.[0]?.detailPriceBundle?.finalPrice?.price?o.quantityBase[0].moduleData[0].detailPriceBundle.finalPrice.price:parseInt(o.quantityBase[0].price.originPrice.replaceAll(",","")):0,i={itemId:o.itemId,vendorItemId:o.vendorItemId,vendorName:"",vendorId:"",optionName:h,valueId:"",stock:o.buyableQuantity?parseInt(o.buyableQuantity.replaceAll(",","")):0,price:f},(p=await othervendorinfo(o.productId,i.vendorItemId,i.itemId)).items?p.items.forEach(e=>{i.vendorItemId=e.vendorItemId,i.vendorName=e.vendorName,i.price=parseInt(e.price.replaceAll(",","")),l.push(deepClone(i))}):(o.vendor?i.vendorName=o.vendor.name:i.vendorName="",l.push(deepClone(i)))}console.log(l);for(s of l)0<s.stock&&(console.log(s),c=await fetchstock(o.productId,s.vendorItemId,s.itemId,t),s.vendorId=c.vendorId,s.stock=parseInt(c.stock),9<l.length)&&await sleep(2501);n.push({productId:o.productId,productinfo:o,lists:[{date:a,options:l}]})}else console.log("error615"),console.log(url),console.log(t)}return n}function sleep(t){return new Promise(e=>setTimeout(e,t))}async function fetchstock(e,t,r,a){console.log(e,t,r);for(var n,o,s=await chrome.scripting.executeScript({target:{tabId:a.id},func:i,args:[e,t,r]}),c=(console.log(s),s[0].result),l=0;!s[0].result.resultContents[0];)await sleep(1e4),l++,c=(await chrome.scripting.executeScript({target:{tabId:a.id},func:i,args:[e,t,r]}))[0].result,5==l&&(c={resultContents:[{vendorItemId:"nothing",cartId:"nothing"}]});return"nothing"==c.resultContents[0].vendorItemId?{stock:"오류",vendorId:"nothing",price:0}:(t=c.resultContents[0].vendorItemId,n=c.resultContents[0].cartId,o=(await chrome.scripting.executeScript({target:{tabId:a.id},func:async function(e){var t=await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(await(await fetch("https://cart.coupang.com/cartView.pang",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text()),r=(console.log(t),e.toString());console.log(t.body),console.log(t.querySelectorAll(".option-item"));for(var a=0;a<t.querySelectorAll(".option-item").length;a++)if(t.querySelectorAll(".option-item")[a].id===r){var n=t.querySelectorAll(".option-item")[a];break}console.log(n);e=parseInt(n.parentElement.parentElement.querySelector(".unit-total-sale-price").innerText.replaceAll(",","").replaceAll("원",""))/n.dataset.quantity,e={stock:n.dataset.quantity,vendorId:n.dataset.vendorId,price:e};return console.log(e),e},args:[t]}))[0].result,await chrome.scripting.executeScript({target:{tabId:a.id},func:async function(e){e=await fetch("https://cart.coupang.com/api/anonymousCartItem/deleteItems?cartItemIds[]="+e+"&itemStatus=CHECKED",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://cart.coupang.com/cartView.pang",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"POST",mode:"cors",credentials:"include"});console.log(e)},args:[n]}),console.log(o),o);async function i(e,t,r){t=await(await fetch("https://www.coupang.com/vp/cart/"+e+"/items",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:"items%5B%5D="+t+"%3A+99999&clickProductId="+e+"&landProductId="+e+"&clickItemId="+r+"&cartItemId="+r+"&sdpVisitKey=&q=&searchId=",method:"POST",mode:"cors",credentials:"include"})).text(),console.log(t),e=await JSON.parse(t);return console.log(e),e}}function deepClone(e){if(null===e||"object"!=typeof e)return e;var t,r=Array.isArray(e)?[]:{};for(t of Object.keys(e))r[t]=this.deepClone(e[t]);return r}async function othervendorinfo(e,t,r){var[a]=await chrome.tabs.query({active:!0,currentWindow:!0}),a=await chrome.scripting.executeScript({target:{tabId:a.id},func:async function(e,t,r){e=await(await fetch("https://www.coupang.com/vp/products/"+e+"/other-seller-json?itemId="+t+" &selectedId="+r,{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text();return JSON.parse(e)},args:[e,r,t]});return console.log(a[0].result),a[0].result}async function getvendorinfo(e,t){t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e){try{var t=await async function(e){return e=await e,(new DOMParser).parseFromString(e,"text/html")}(await(await fetch("https://store.coupang.com/vp/vendors/"+e+"/products",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text());return{vendorName:t.querySelector("#store-wrapper").dataset.vendorName,vendorId:t.querySelector("#store-wrapper").dataset.vendorId,storeTitle:t.querySelector("#store-wrapper").dataset.storeTitle}}catch(e){return{vendorName:""}}},args:[e]});return console.log(t[0].result),t[0].result}async function fetchtrackinginfo(e,t){t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(e){async function t(e){e=await e;return(new DOMParser).parseFromString(e,"text/html")}function r(t){var e=t.indexOf('"stickBanners":');if(-1===e)return t;let r=0,a=e+15;for(let e=a;e<t.length;e++)if("["===t[e]&&r++,"]"===t[e]&&r--,0===r){a=e+1;break}return t.slice(0,e)+'"stickBanners":[]'+t.slice(a)}var a=await(await fetch("https://www.coupang.com/vp/products/"+e.productId+"?itemId="+e.itemId+"&vendorItemId="+e.vendorItemId+"&isAddedCart=",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),n=(await t(a)).querySelectorAll("script"),o="",s=null;if(a.includes("exports.sdp")){n.forEach(e=>{e.innerHTML.includes("exports.sdp")&&(o=e.innerHTML)}),console.log(o);var c=o.indexOf("exports.sdpIssueTypes"),l=(-1==c&&(c=o.indexOf("exports.disableCSR")),o.lastIndexOf(";",c)),i=(o=o.substring(0,l)).slice(o.search("exports.sdp")+14);console.log(i);try{s=JSON.parse(i)}catch(e){console.log(e),i=r(i),s=JSON.parse(i)}console.log(s)}else if(a.includes("exports.product")){n.forEach(e=>{e.innerHTML.includes("exports.product")&&(o=e.innerHTML)}),console.log(o),-1==(c=o.indexOf("exports.sdpIssueTypes"))&&(c=o.indexOf("exports.disableCSR")),l=o.lastIndexOf(";",c),o=o.substring(0,l),i=o.slice(o.search("exports.product")+18),console.log(i);try{s=JSON.parse(i)}catch(e){console.log(e),i=r(i),s=JSON.parse(i)}console.log(s)}else a.includes("atfData")&&(i=function(t){if(console.log("--- 함수 시작 ---"),"string"!=typeof t||null===t)return console.error("입력 텍스트가 유효한 문자열이 아닙니다."),null;var e='{\\"atfData\\":';let r=t.indexOf(e),a=-1;{if(-1===r)return console.error(`시작 마커 "${e}" (또는 다른 주요 마커)를 찾을 수 없습니다.`),null;console.log(`마커 "${e}" 찾음. 인덱스: `+r),a=r+e.length}let n=-1;for(let e=a;e<t.length;e++){if("{"===t[e]){n=e,console.log("객체 시작 '{' 찾음. 인덱스:",n);break}if(e>a+5&&" "!==t[e])return console.error("마커 뒤에서 '{'를 적절한 위치에서 찾지 못했습니다."),null}if(-1===n)return console.error("객체 시작 '{'를 찾을 수 없습니다."),null;a=n;let o=1,s=-1;for(let e=a+1;e<t.length;e++)if("{"===t[e]?o++:"}"===t[e]&&o--,0===o){s=e,console.log("객체 끝 '}' 찾음. 인덱스:",s);break}if(-1===s)return console.error("객체의 짝이 맞는 '}'를 찾을 수 없습니다."),null;let c=t.substring(a,s+1);console.log("추출된 문자열 (원본):",c.substring(0,200)+"..."),65279===(c=c.trim()).charCodeAt(0)&&(c=c.substring(1));if(c=(c=c.replaceAll("\\\\","\\")).replaceAll('\\"','"'),console.log("최종 처리 후 문자열 (파싱 시도):",c.substring(0,200)+"..."),0===c.length)return console.error("최종 처리 후 문자열이 비어있습니다."),null;try{return JSON.parse(c),console.log("JSON 파싱 성공!"),c}catch(e){return console.error("JSON 파싱 실패:",e.message),console.error("파싱 시도한 문자열 (전체):\n",c),null}}(a),s=JSON.parse(i),console.log(s));n=await t(await(await fetch("https://www.coupang.com/vp/products/"+e.productId+"/breadcrumb-gnbmenu",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Chromium";v="118", "Google Chrome";v="118", "Not=A?Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text()),c=n.querySelector("#breadcrumb").children[n.querySelector("#breadcrumb").children.length-1].querySelector("a").href;l=0<c.search("\\?")?c.slice(c.search("categories")+11,c.search("\\?")):c.slice(c.search("categories")+11,c.length);return console.log(l),s.categoryCode=l,console.log(s),s},args:[e]});return console.log(t[0].result),t[0].result}async function regtracking(e){return await(await fetch(domain+"api/analysis/updatetracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result:e})}).catch(e=>{console.log("line759"),console.log(e),alert("수집실패(760)")})).json()}function parsestock(d,h){function f(e){e=new Date(e);return e.getFullYear()+"-"+("0"+(1+e.getMonth())).slice(-2)+"-"+("0"+e.getDate()).slice(-2)}async function p(e,t){async function u(e,t,r){return await(await fetch("https://supplier.coupang.com/scm/receive/detail?page="+r+"&startDate="+e+"&endDate="+t+"&requestSeq=&vendorPaymentInfoSeq=")).text()}async function d(e){e=await e;return(new DOMParser).parseFromString(e,"text/html")}return async function(e,t){console.log("a");var r=await d(u(e,t,1));if(console.log(r.getElementsByClassName("scmTable basic marginT")),1<r.getElementsByClassName("scmTable basic marginT").length){for(var a="",n=0;n<r.querySelectorAll("script").length;n++){var o=r.querySelectorAll("script")[n];o.innerHTML.includes("#pagination")&&(a=o.innerHTML.slice(o.innerHTML.search("#pagination")+22,o.innerHTML.search("#pagination")+o.innerHTML.slice(o.innerHTML.search("#pagination"),o.innerHTML.length).search("}")+1).replaceAll(" ",""))}s=(s=a).replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": ').replaceAll("'",'"');var s=JSON.parse(s),s=parseInt(s.total),s={total:parseInt(r.getElementsByClassName("scmTable basic marginT")[0].children[0].children[1].children[3].innerText.replaceAll(",","")),pages:s}}else s={total:0};var c=[];if(console.log(s),0<s.total){console.log("b");for(var l,i=s.pages,n=(console.log(i),0);n<i;n++)l=await d(u(e,t,n+1)).then(e=>{for(var t=e.getElementsByClassName("scmTableArea")[0].children[0],r=[],a=[],n=0;n<t.rows[0].cells.length;n++)a[n]=t.rows[0].cells[n].innerText.toLowerCase().replace(/ /gi,"");for(n=1;n<t.rows.length;n++){for(var o=t.rows[n],s={},c=0;c<o.cells.length;c++)s[a[c]]=o.cells[c].innerText.replaceAll("\n","").replaceAll("            ","").trim();r.push(s)}return r}),c=c.concat(l)}return c}(e,t)}async function m(e,t){var r,a=0,n=[],o={},s=Date.now(),t=(console.log(s),t.filter(e=>1e7<parseInt(e["SKU ID"])));console.log(t.length);for(r of t){console.log((a+1).toString()+"/"+t.length.toString()),chrome.runtime.sendMessage({target:"sales",content:(a/t.length*100).toFixed(1)+"%"});var c="https://supplier.coupang.com/marketing/cmg-api/vendoritems?page=1&size=1&keyword="+parseInt(r["SKU ID"])+"&searchBy=sku",c=await(await fetch(c).catch(e=>{console.log("line374"),console.log(e)})).text(),c=JSON.parse(c);if(console.log(c),o=0<c.products.length?{companyid:e,date:s,SKUID:r["SKU ID"],"바코드":r.바코드,"등록상품명":r.상품명,"발주가능상태":r.발주가능상태,"판매상품명":c.products[0].itemnm,"판매링크":"https://www.coupang.com/vp/products/"+c.products[0].productid+"?itemId="+c.products[0].itemid+"&vendorItemId="+c.products[0].vendoritemid+"&isAddedCart=","카테고리":c.products[0].categoryId,"판매가":c.products[0].sales_price,"판매재고":c.products[0].stockQuantity,"썸네일":"https://image10.coupangcdn.com/image/"+c.products[0].mainImagePath,"리뷰수":c.products[0].review.ratingCount,"평점":c.products[0].review.ratingAverage,"아이템위너":c.products[0].buyboxStatus}:{companyid:e,date:s,SKUID:r["SKU ID"],"바코드":r.바코드,"등록상품명":r.상품명,"발주가능상태":r.발주가능상태,"카테고리":"","판매상품명":"","판매링크":"","판매가":"","판매재고":"","썸네일":"","리뷰수":"","평점":"","아이템위너":""},n.push(o),++a==t.length)return n}}!async function(){var e,[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),r=t.id,a=(e=r,await new Promise(n=>{chrome.tabs.update(e,{url:"https://supplier.coupang.com/marketing/dashboard/pa"},async a=>{chrome.tabs.onUpdated.addListener(function e(t,r){"complete"===r.status&&t===a.id&&(chrome.tabs.onUpdated.removeListener(e),n(a))})})})),n=(console.log(a),Date.now()),o=await async function(e){var e=f(Date.now()-864e5*e),t=function(){var e=new Date,t=e.getFullYear(),r=("0"+(1+e.getMonth())).slice(-2),e=("0"+e.getDate()).slice(-2);return t+"-"+r+"-"+e}();console.log(e,t);let[r]=await chrome.tabs.query({active:!0,currentWindow:!0}),a=await chrome.scripting.executeScript({target:{tabId:r.id},func:p,args:[e,t]});return console.log(a),a[0].result}(30);if(0<o.length){for(var s,c=[],l=[],i=30;-1<i;i--)s=f(n-864e5*i),c.push({importdate:s,companyid:d,importlist:l});console.log(c),console.log(o),console.log(o.filter(e=>!e["입고/반출일자"]));var u=0;c.forEach(async t=>{var e;t.importlist=o.filter(e=>e["입고/반출일자"].slice(0,10)==t.importdate),u+=t.importlist.length,console.log(u,o.length),u==o.length&&(e=c,console.log(e),e=await(await fetch(domain+"api/addsales/supplylist/addlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyid:d,data:e})}).catch(e=>{console.log("line212"),console.log(e)})).json(),console.log(e),e.요청결과)})}a=await chrome.scripting.executeScript({target:{tabId:t.id},func:m,args:[d,h,r]}),console.log(a[0].result),t=await(await fetch(domain+"api/addsales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a[0].result)})).json(),console.log(t),"판매현황 업데이트 완료"!=t.요청결과?alert(t.요청결과):alert("판매현황 수집완료"),document.querySelector("#addsales").className="btn btn-outline-secondary fw-bold",document.querySelector("#addsalesloading").className="d-none"}()}function addsales(){!async function(){e=await(await fetch("https://supplier.coupang.com/vendor").catch(e=>{console.log("line432"),console.log(e),alert("쿠팡Supplier의 로그인상태를 확인해 주세요")})).text(),console.log(e),console.log(e.slice(e.search("vendorId")+12,e.search("vendorId")+21));var e=await e.slice(e.search("vendorId")+12,e.search("vendorId")+21);"A"!=e[0]?alert("쿠팡Supplier의 로그인상태를 확인해 주세요"):(e=await(await fetch(domain+"api/addpolist/confirmvendor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({suppliercode:e})}).catch(e=>{console.log("line451"),console.log(e),alert("[Confirm]COUPLUS의 로그인상태를 확인해 주세요")})).json(),console.log("companyid : "+e.companyid),"로그인성공"==e.loginstatus?"lite"==e.version?alert("프리미엄 버전에서 이용 가능합니다."):(searchinfo.auth=e.auth,0==e.productdb.length?(alert("발주서/판매현황을 수집하기 전에 SKU리스트를 먼저 수집해 주세요"),document.querySelector("#addsales").innerText="판매현황 수집"):addskustatus?alert("SKU리스트 수집이 완료된 후 수집해 주세요"):(document.querySelector("#addsales").className="d-none",document.querySelector("#addsalesloading").className="btn btn-outline-secondary fw-bold",document.querySelector("#addsalesstatus").innerText="약 "+(.2*e.productdb.length/60).toFixed(0)+"분 소요예상",document.querySelector("#addsalestext").innerText="수집중...",parsestock(e.companyid,e.productdb))):alert(e.loginstatus))}()}async function importskulist(e){var[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t=await chrome.scripting.executeScript({target:{tabId:t.id},func:async function(){async function c(e,t){return await(await fetch("https://supplier.coupang.com/plan/v1/ticket/sku/listTicketSku?locale=ko",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","content-type":"application/json",locale:"ko","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://supplier.coupang.com/plan/ticket/supplySkuList",referrerPolicy:"strict-origin-when-cross-origin",body:'{"skuId":"","skuName":"","barcode":"","orderingStatus":"","unit1":"","unit2":"","issueStatus":"","issueType":"","size":'+t+',"page":'+(e+1)+"}",method:"POST",mode:"cors",credentials:"include"}).catch(e=>console.log(e))).text()}async function l(e){return await(await fetch("https://supplier.coupang.com/plan/v1/ticket/sku/get/detail?skuId="+e+"&locale=ko",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7",locale:"ko","sec-ch-ua":'"Google Chrome";v="105", "Not)A;Brand";v="8", "Chromium";v="105"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://supplier.coupang.com/plan/ticket/supplySkuList",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).catch(e=>console.log("err899line : "+e))).text()}return async function(){var e=[],t=await c(0,10).catch(e=>console.log(e)),r=JSON.parse(t);if(console.log(r),100<=r.body.total){var a,t=await c(0,100).catch(e=>console.log(e));for(a of(r=JSON.parse(t)).body.content){var n=await l(a.skuId);a.detail=JSON.parse(n)}e=e.concat(r.body.content),console.log(r.body.total),console.log(r.body.content.length),console.log(parseInt(r.body.total/r.body.content.length)+1);for(var o=parseInt(r.body.total/r.body.content.length)+1,s=1;s<o;s++){console.log(e),t=await c(s,100).catch(e=>console.log(e));for(a of(r=JSON.parse(t)).body.content)n=await l(a.skuId),a.detail=JSON.parse(n);e=e.concat(r.body.content),chrome.runtime.sendMessage({target:"sku",content:((s-1)/o*100).toFixed(1)+"%"})}}else{for(a of r.body.content)a.detail=await l(a.skuId);for(e=e.concat(r.body.content),o=parseInt(r.body.total/r.body.content.length)+1,s=1;s<o;s++){console.log(e),t=await c(s,10).catch(e=>console.log(e));for(a of(r=JSON.parse(t)).body.content)n=await l(a.skuId),a.detail=JSON.parse(n);e=e.concat(r.body.content),chrome.runtime.sendMessage({target:"sku",content:((s-1)/o*100).toFixed(1)+"%"})}}return console.log(e),e}()}}),console.log(t);var r,t=await t[0].result,a=[];t&&t.forEach(e=>{r={"SKU ID":e.skuId,"요청":e.issueCount,"상품명":e.skuName,"바코드":e.barCode,"발주가능상태":e.orderStatus,"담당 BM":e.mdName,"발주담당자":e.scmName,"등록이미지":e.imagePath,skudetail:e},a.push(r)}),console.log(a),document.querySelector("#addskutext").className="DB저장중...","업데이트완료"==(await(await fetch(domain+"api/addproduct/updateskulist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyid:e,arr:a})}).catch(e=>{console.log("line880"),console.log(e),alert("SKU List수집 실패 : "+e)})).json()).요청결과&&(document.querySelector("#addsku").className="btn btn-outline-primary fw-bold",document.querySelector("#addskuloading").className="d-none",addskustatus=!1,alert("SKU 리스트 수집이 완료되었습니다."))}function importpolist(d,e,h){var f,p=["발주번호","발주유형","발주주문유형","발주상태","발주일시","발주구분","발주운송","거래처담당","거래처명","첫SKU명","SKU개수","발주센터","납품센터","발주수량","입고수량","금액","입고예정일","입고시작일","입고종료일","예약상태","계약서번호","계약서상태","발주세부내역"],m=["순서","SKUID","바코드","IMGURL","상품명","매입유형","면세여부","발주수량","확정수량","매입가","공급가액","부가세액","입고수량","데이터수집일자"],g=[],y=new Date;!async function(e){const r=await fetch(e),a=await r.text();var o=(new DOMParser).parseFromString(a,"text/html"),s=[];for(i=0;i<o.getElementsByTagName("script").length;i++)if(0<o.getElementsByTagName("script")[i].outerHTML.search("total")){var t=o.getElementsByTagName("script")[i].outerHTML.slice(o.getElementsByTagName("script")[i].outerHTML.search("total")+6,o.getElementsByTagName("script")[i].outerHTML.search("total")+15),t=t.slice(t.search("'"),t.search(","));for(f=parseInt(t.replaceAll("'","")),console.log(f+"page검색"),i=0;i<f;i++)s.push("https://supplier.coupang.com/scm/purchase/order/list?page="+(i+1)+h);break}console.log(s),document.querySelector("#addpo").className="d-none",document.querySelector("#addpoloading").className="btn btn-outline-success fw-bold",document.querySelector("#addpostatus").innerText="0%",document.querySelector("#addpotext").innerText="수집중...";for(let[e,t]of s.entries()){document.querySelector("#addpostatus").innerText=(e/s.length*100).toFixed(0)+"%";const r=await fetch(t),a=await r.text();var c={"발주세부내역":[]},l=(new DOMParser).parseFromString(a,"text/html");if(console.log(t),console.log(l.getElementsByClassName("scmTable basic marginT")[0].children[1].children.length),"검색 결과가 없습니다."==l.getElementsByClassName("scmTable basic marginT")[0].children[1].children[0].children[0].innerText)return alert("가져올 발주내역이 없습니다."),!1;for(n=0;n<l.getElementsByClassName("scmTable basic marginT")[0].children[1].children.length;n++){for(j=1;j<22;j++)c[p[j-1]]=l.getElementsByClassName("scmTable basic marginT")[0].children[1].children[n].children[j].innerText.replaceAll("\n","").replaceAll("SKU 바코드 출력","").trim();c.companyid=d,c.lastupdate=new Date,link="https://supplier.coupang.com/scm/purchase/order/get/"+c["발주번호"],console.log(link);const r=await fetch(link),a=await r.text();var o=(new DOMParser).parseFromString(a,"text/html"),u={};for(i=0;i<o.getElementsByClassName("scmTable productInfo").length;i++)if(0<o.getElementsByClassName("scmTable productInfo")[i].innerText.search("입고 주소")&&(c["입고주소"]=o.getElementsByClassName("scmTable productInfo")[i].children[2].children[0].children[3].innerText),0<o.getElementsByClassName("scmTable productInfo")[i].innerText.search("바코드")){for(j=0;j<o.getElementsByClassName("scmTable productInfo")[i].children[1].children.length-2;j++)j%2==0?(u[m[0]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[0].innerText.trim(),u[m[1]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[2].innerText.trim(),u[m[2]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[3].children[0].children[0].innerText.trim(),u[m[3]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[2].children[2].src.trim(),u[m[4]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[3].children[0].children[1].innerText.trim(),u[m[5]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[4].children[0].children[0].innerText.trim(),u[m[6]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[4].children[0].children[1].innerText.trim(),u[m[7]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[5].innerText.trim(),u[m[8]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[6].innerText.trim(),u[m[9]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[7].innerText.trim(),u[m[10]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[8].innerText.trim(),u[m[11]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[9].innerText.trim()):(u[m[12]]=o.getElementsByClassName("scmTable productInfo")[i].children[1].children[j].children[0].innerText.trim(),u[m[13]]=y.toLocaleString(),c["발주세부내역"].push(u),u={});break}g.push(c),c={"발주세부내역":[]}}}return document.querySelector("#addpotext").innerText="DB저장중...",g}(e).then(e=>{console.log(e),fetch(domain+"api/addpolist/addpo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{document.querySelector("#addpo").className="btn btn-outline-success fw-bold",document.querySelector("#addpoloading").className="d-none",alert("발주서 수집이 완료되었습니다.")})}).catch(e=>{console.log("line591"),console.log(e)})}function addpo(t,r){!async function(){e=await(await fetch("https://supplier.coupang.com/vendor").catch(e=>{console.log("line602"),console.log(e),alert("쿠팡Supplier의 로그인상태를 확인해 주세요")})).text(),console.log(e),console.log(e.slice(e.search("vendorId")+12,e.search("vendorId")+21));var e=await e.slice(e.search("vendorId")+12,e.search("vendorId")+21);"A"!=e[0]?alert("쿠팡Supplier의 로그인상태를 확인해 주세요"):"로그인성공"==(e=await(await fetch(domain+"api/addpolist/confirmvendor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({suppliercode:e})}).catch(e=>{console.log("line621"),console.log(e)})).json()).loginstatus?"lite"==e.version?alert("프리미엄 버전에서 이용 가능합니다."):(searchinfo.auth=e.auth,0==e.productdb.length?alert("발주서/판매현황을 수집하기 전에 SKU리스트를 먼저 수집해 주세요"):addskustatus?alert("SKU리스트 수집이 완료된 후 수집해 주세요"):(document.querySelector("#addpo").value="발주서 수집중 (0%)",importpolist(e.companyid,t,r))):alert(e.loginstatus)}()}function addsku(){!async function(){e=await(await fetch("https://supplier.coupang.com/vendor").catch(e=>{console.log("line602"),console.log(e),alert("쿠팡Supplier의 로그인상태를 확인해 주세요")})).text(),console.log(e),console.log(e.slice(e.search("vendorId")+12,e.search("vendorId")+21));var e=await e.slice(e.search("vendorId")+12,e.search("vendorId")+21);"A"!=e[0]?alert("쿠팡Supplier의 로그인상태를 확인해 주세요"):"로그인성공"==(e=await(await fetch(domain+"api/addpolist/confirmvendor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({suppliercode:e})}).catch(e=>{console.log("line621"),console.log(e)})).json()).loginstatus?"lite"==e.version?alert("프리미엄 버전에서 이용 가능합니다."):(searchinfo.auth=e.auth,console.log(e),document.querySelector("#addsku").className="d-none",document.querySelector("#addskuloading").className="btn btn-outline-primary fw-bold",document.querySelector("#addskustatus").innerText="0%",document.querySelector("#addskutext").innerText="수집중...",addskustatus=!0,await importskulist(e.companyid)):alert(e.loginstatus)}()}function select(){var e=new Date,e=(e=e-432e7,(e=new Date(e)).getFullYear()+"-"+("0"+(1+e.getMonth())).slice(-2)+"-"+("0"+e.getDate()).slice(-2)),t=(t=new Date).getFullYear()+"-"+("0"+(1+t.getMonth())).slice(-2)+"-"+("0"+t.getDate()).slice(-2);function r(e,t){return{url:"https://supplier.coupang.com/scm/purchase/order/list?page=1&searchDateType=PURCHASE_ORDER_DATE&searchStartDate="+e+"&searchEndDate="+t+"&centerCode=&purchaseOrderSeq=&vendorPaymentInfoSeq=&purchaseOrderStatus=&purchaseOrderType=",urlafter:"&searchDateType=PURCHASE_ORDER_DATE&searchStartDate="+e+"&searchEndDate="+t+"&centerCode=&purchaseOrderSeq=&vendorPaymentInfoSeq=&purchaseOrderStatus=&purchaseOrderType="}}addpo(r(e,t).url,r(e,t).urlafter)}function makepage(){!async function(){console.log(domain+"api/addpolist/confirmlogin");var e=await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line768"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json();"로그인성공"==e.loginstatus?(searchinfo.auth=e.auth,console.log("ok"),document.querySelector("#polistsandsales").style.display="none",document.querySelector("#makepages").style.display="block"):(alert(e.loginstatus),console.log("a"))}()}function returnpage(){document.querySelector("#makepages").style.display="none",document.querySelector("#polistsandsales").style.display="block"}async function confirmlg(){return console.log(domain+"api/addpolist/confirmlogin"),await(await fetch(domain+"api/addpolist/confirmlogin",{method:"POST",headers:{"Content-Type":"application/json"}}).catch(e=>{console.log("line861"),console.log(e),alert("쿠플러스에 로그인해주세요")})).json()}async function btn01f(){var e=await confirmlg();if("로그인성공"!=e.loginstatus)searchinfo.auth=res.auth,alert(e.loginstatus);else{var p=document.querySelector("#product_num").value,t=document.querySelector("#product_name").value,m=document.querySelector("#option1_kr").value.trim().split("\n"),r=" ",n=(document.querySelector("#divider").value&&(r=document.querySelector("#divider").value),document.querySelector("#option1_kr").value.trim().split("\n")),o=document.querySelector("#option2_kr").value.trim().split("\n"),s="",c="",l=n.length;if(0<o.length)for(i=0;i<l;i++)for(j=0;j<o.length;j++)s+=n[i]+r+o[j]+"\n",c+=t+","+n[i]+r+o[j]+"\n";else for(s=n.join("\n"),i=0;i<l;i++)c+=t+n[i]+"\n";document.querySelector("#option_kr_comb").value=s,document.querySelector("#name_kr_comb").value=c,!async function(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),t=(t=await chrome.scripting.executeScript({target:{tabId:e.id},func:u}),console.log(t),await chrome.scripting.executeScript({target:{tabId:e.id},func:d}));console.log(t);var[e,t]=await async function(e){console.log("setpage");var t=e[0].result[0],r=[],n=e[0].result[1],o=e[0].result[2],e=e[0].result[3],s=document.querySelector("#imagelimit").value,c=document.querySelector("#maxthumbqty").value,l=document.querySelector("#thumbdivider").value,i=document.querySelector("#optiondivider").value;async function u(e){var t,a;e.includes("https://")&&(a=e,t=await new Promise((e,t)=>{var r=new Image;r.src=a,r.onload=()=>e(r.width),r.onerror=t}),s<t)&&r.push(e)}for(a of o)await u(a);async function d(e,r){console.log("downloading");var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){var e=(window.URL||window.webkitURL).createObjectURL(this.response),t=document.createElement("a");t.href=e,t.download=r,document.body.appendChild(t),t.click(),document.body.removeChild(t)},t.send()}var h=0,f=0;if(console.log(e[0]),c>t.length)for(h=0;h<t.length;h++)0<t[h].search(".jpg")?d(t[h],p+l+(h+1).toString()+".jpg"):d(t[h],p+l+(h+1).toString()+".png");else for(h=0;h<c;h++)0<t[h].search(".jpg")?d(t[h],p+l+(h+1).toString()+".jpg"):d(t[h],p+l+(h+1).toString()+".png");if(console.log(m.length),console.log(n),"1688"==e[0])for(f=0;f<m.length;f++)void 0!==n[f]&&(0<n[f].search(".jpg")?(console.log(p+i+m[f]+".jpg"),d(n[f],p+i+m[f]+".jpg")):d(n[f],p+i+m[f]+".png"));return[n,r]}(t);console.log(e,t),async function([e,t]){var r=`              
            <canvas id="canvas" data-productnum="`+p+`" width="800" height="100"></canvas>
            <h1>
            `,a=document.querySelector("#product_name").value,n=document.querySelector("#mdcomment").value.split("\n").join("<br>"),o=m,s="";if(0==o.length)s="";else if(1==o.length)s="<tr>\n<td>\n<img class='optionimg' src='"+e[0]+"'>\n<div class='optiontext'>"+o+"</div>\n</td>\n</tr>";else if(o.length%2==0)for(i=0;i<o.length/2;i++)s=s+"<tr>\n<td>\n<img class='optionimg' src='"+e[2*i]+"'>\n<div class='optiontext'>"+o[2*i]+"</div>\n</td>\n<td>\n<img class='optionimg' src='"+e[2*i+1]+"'>\n<div class='optiontext'>"+o[2*i+1]+"</div>\n</td>\n</tr>";else{for(i=0;i<o.length/2-.5;i++)s=s+"<tr>\n<td>\n<img class='optionimg' src='"+e[2*i]+"'>\n<div class='optiontext'>"+o[2*i]+"</div>\n</td>\n<td>\n<img class='optionimg' src='"+e[2*i+1]+"'>\n<div class='optiontext'>"+o[2*i+1]+"</div>\n</td>\n</tr>";s=s+"<tr>\n<td>\n<img class='optionimg' src='"+e[o.length-1]+"'>\n<div class='optiontext'>"+o[o.length-1]+"</div>\n</td>\n</tr>"}var c="";for(i=0;i<t.length;i++)c=c+"<div class='container'>\n<img class='image' src='"+t[i]+"'>\n<img class='changed' src=\""+t[i]+"\" alt=''>\n<div class='closebutton'>X</div>\n</div>";var l=r+a+'</h1><p class="md">'+n+`</p>
                          
                        <div class="container">
                            <table style="margin-left: auto; margin-right: auto; margin-bottom: 20px;">
                                <caption></caption>
            <tbody>
            `+s+`
            </tbody>
            </table>
            <div class="closebutton">X</div>
        </div>
        <h1></h1>
            `+c;chrome.tabs.create({url:chrome.runtime.getURL("imagepage.html"),selected:!1},e=>{chrome.scripting.executeScript({target:{tabId:e.id},files:["script.js"]},function(){chrome.tabs.sendMessage(e.id,{action:"changeHTML",headhtml:`<meta charset='UTF-8'>
            <title>Title</title>
            <link href='https://cdn.jsdelivr.net/gh/moonspam/NanumSquare@1.0/nanumsquare.css' rel='stylesheet'>
            
                <link rel="stylesheet" type="text/css" href="imagestyle.css">
                <link rel="stylesheet" type="text/css" href="cropper.css">

                




            `,bodyhtml:l,tabid:e.id})})})}([e,t])}()}async function u(){var t,e=0;return setInterval(function(){e<50&&(window.scrollTo(1e3*e,1e3*e+1e3),e++)},100),t=5e3,await new Promise(e=>setTimeout(e,t)),!0}async function d(){var e=[],t=[],r=[],a=[];if(document.querySelector("body").innerHTML.search("widget-custom-container")<0&&document.querySelector("body").innerHTML.search("J_UlThumb")<0){for(a.push("1688"),i=0;i<document.querySelectorAll("script").length;i++)0<document.querySelectorAll("script")[i].innerHTML.search("window.__GLOBAL_DADA")&&(h=document.querySelectorAll("script")[i].innerHTML);var n=h.search("window.__INIT_DATA"),o=h.slice(n+19,h.length),s=JSON.parse(o),c=s.globalData.skuModel.skuProps;s.globalData.skuModel.skuInfoMap;for(i=0;i<s.globalData.images.length;i++)e.push(s.globalData.images[i].fullPathImageURI);var l="content-detail";for(i=0;i<c[0].value.length;i++)void 0!==c[0].value[i].imageUrl&&t.push(c[0].value[i].imageUrl);for(i=0;i<document.getElementsByClassName(l)[0].getElementsByTagName("img").length;i++)r.push(document.getElementsByClassName(l)[0].getElementsByTagName("img")[i].src)}else if(document.querySelector("body").innerHTML.search("J_UlThumb")<0){a.push("1688");var n=document.getElementsByClassName("widget-custom-container")[0].innerHTML,u=n.search("var iDetailData ="),d=n.search("iDetailData.allTagIds ="),n=n.slice(u,d),c=(u=(n=(n=(n=n.trim()).replace(/ /gi,"")).replace('"skuProps"',"skuProps").replace('"skuMap"',"skuMap").replace('},"end"',"end")).search("skuProps"),d=n.search("skuMap"),endtext2=n.search("end:0"),data1=n.slice(u+9,d-2),data2=n.slice(d+7,endtext2-2),JSON.parse(data1));JSON.parse(data2);for(i=0;i<4;i++)e.push(document.getElementsByClassName("tab-content-container")[0].getElementsByClassName("box-img")[i].children[0].src.replace("64x64.","").replace("60x60.",""));l="desc-lazyload-container";for(i=0;i<c[0].value.length;i++)void 0!==c[0].value[i].imageUrl&&t.push(c[0].value[i].imageUrl);for(i=0;i<document.getElementsByClassName(l)[0].getElementsByTagName("img").length;i++)r.push(document.getElementsByClassName(l)[0].getElementsByTagName("img")[i].src)}else{a.push("taobao");for(var h,f="",f=0<(h=document.querySelector("#J_UlThumb").innerHTML.replaceAll("data-src","").replaceAll("_30x30.jpg","").replaceAll("_50x50.jpg","")).search(".jpg")?".jpg":".png";0<h.search("src=");)h=h.slice(h.search("src=")-1,h.length),e.push("https:"+h.slice(h.search("src=")+5,h.search(f)+4).replace("https:","")),h=h.replace("src=","");for(o=document.querySelector(".tb-skin").innerHTML.replaceAll("_30x30.jpg","");0<o.search("//");)console.log(o),o=o.search("//")>o.search(".jpg")&&0<o.search(".jpg")?o.replace(".jpg",""):o.search("//")>o.search(".png")&&0<o.search(".png")?o.replace(".png",""):(o.search("tb-out-of-stock")<o.search("//")&&0<o.search("tb-out-of-stock")?o=o.replace("tb-out-of-stock",""):(0<o.search(".jpg")&&0<o.search(".png")?f=o.search(".jpg")<o.search("png")?".jpg":".png":o.search(".jpg")<0?o.search(".png")<0?o.replaceAll("//",""):f=".png":f=".jpg",console.log("https:"+o.slice(o.search("//"),o.search(f)+4).replace("https:","")),t.push("https:"+o.slice(o.search("//"),o.search(f)+4).replace("https:","")),o)).replace("//","");for(0<(m=document.querySelector("#description").innerHTML).search(".jpg")?f=".jpg":0<m.search(".png")?f=".png":0<m.search(".gif")&&(f=".gif");0<m.search('src="https://img');)var p="https:"+m.slice(m.search('src="https://img')+5,m.search(f)+4).replace("https:",""),m=(p.slice(0,-3).includes(".jpg")||p.slice(0,-3).includes(".png")||p.slice(0,-3).includes(".gif")||r.push(p),(m=m.replace('src="https://img',"")).slice(m.search('src="https://img')-1,m.length))}console.log(t);u=[];return u.push(e),u.push(t),u.push(r),u.push(a),u}}function removearr(e,t){t=e.indexOf(t+1);-1<t&&e.splice(t,1)}function btn02f(){async function t(){var e,t=[],r=[],a=[],n=[];if(document.querySelector("body").innerHTML.search("widget-custom-container")<0&&document.querySelector("body").innerHTML.search("J_UlThumb")<0){for(i=0;i<document.querySelectorAll("script").length;i++)0<document.querySelectorAll("script")[i].innerHTML.search("window.__GLOBAL_DADA")&&(e=document.querySelectorAll("script")[i].innerHTML);var o=e.search("window.__INIT_DATA"),o=e.slice(o+19,e.length),o=JSON.parse(o),s=o.globalData.skuModel.skuProps,c=o.globalData.skuModel.skuInfoMap;for(i=0;i<s[0].value.length;i++)t.push(s[0].value[i].name);if(console.log(t),1<s.length){for(i=0;i<s[1].value.length;i++)r.push(s[1].value[i].name);console.log(r)}if(1<s.length)for(i=0;i<s[0].value.length;i++)for(j=0;j<s[1].value.length;j++)a.push(s[0].value[i].name+"&"+s[1].value[j].name),n.push(c[s[0].value[i].name+"&gt;"+s[1].value[j].name].canBookCount);else for(i=0;i<s[0].value.length;i++)a.push(s[0].value[i].name),n.push(c[s[0].value[i].name].canBookCount)}else if(document.querySelector("body").innerHTML.search("J_UlThumb")<0){var o=document.getElementsByClassName("widget-custom-container")[0].innerHTML,l=o.search("var iDetailData ="),u=o.search("iDetailData.allTagIds ="),o=o.slice(l,u),l=(o=(o=(o=o.trim()).replace(/ /gi,"")).replace('"skuProps"',"skuProps").replace('"skuMap"',"skuMap").replace('},"end"',"end")).search("skuProps"),u=o.search("skuMap");endtext2=o.search("end:0"),data1=o.slice(l+9,u-2),data2=o.slice(u+7,endtext2-2);const s=JSON.parse(data1),c=JSON.parse(data2);for(i=0;i<s[0].value.length;i++)t.push(s[0].value[i].name);if(console.log(t),1<s.length){for(i=0;i<s[1].value.length;i++)r.push(s[1].value[i].name);console.log(r)}if(1<s.length)for(i=0;i<s[0].value.length;i++)for(j=0;j<s[1].value.length;j++)a.push(s[0].value[i].name+"&"+s[1].value[j].name),n.push(c[s[0].value[i].name+"&gt;"+s[1].value[j].name].canBookCount);else for(i=0;i<s[0].value.length;i++)a.push(s[0].value[i].name),n.push(c[s[0].value[i].name].canBookCount)}else{for(i=0;i<document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[0].children[0].children.length;i++)t.push(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[0].children[0].children[i].children[0].children[0].innerText.replace("已选中",""));if(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].parentElement.innerHTML.search("数量")<0)for(i=0;i<document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].children[0].children.length;i++)r.push(document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].children[0].children[i].children[0].children[0].innerText.replace("已选中",""));if(console.log(t),console.log(r),document.getElementsByClassName("tb-skin")[0].getElementsByTagName("dd")[1].parentElement.innerHTML.search("数量")<0)for(i=0;i<t.length;i++)for(j=0;j<r.length;j++)a.push(t[i]+"&"+r[j]),n.push("");else for(i=0;i<t.length;i++)a.push(t[i]),n.push("");console.log(t),console.log(r)}console.log(a),console.log(n);l=[];return l.push(t),l.push(r),l.push(a),l.push(n),l}!async function(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=(console.log(e.id),await chrome.scripting.executeScript({target:{tabId:e.id},func:t}));console.log(e),async function(e){option1array=e[0].result[0],option2array=e[0].result[1],optioncomb=e[0].result[2],optionstock=e[0].result[3];var t="";for(i=0;i<option1array.length;i++)t=t+option1array[i]+"\n";document.querySelector("#option1_ch").value=t;var r="";for(i=0;i<optionstock.length;i++)r=r+optionstock[i]+"\n";if(document.querySelector("#option_stock").value=r,0<option2array.length){var a="",n="",o="";for(i=0;i<option2array.length;i++)a=a+option2array[i]+"\n";for(i=0;i<optioncomb.length;i++)n=n+optioncomb[i].split("&")[0]+"\n";for(i=0;i<optioncomb.length;i++)o=o+optioncomb[i].split("&")[1]+"\n";document.querySelector("#option2_ch").value=a,document.querySelector("#option1_ch_comb").value=n,document.querySelector("#option2_ch_comb").value=o}else document.querySelector("#option2_ch").value="",document.querySelector("#option1_ch_comb").value=t,document.querySelector("#option2_ch_comb").value="";void 0!==t&&(document.querySelector("#option1_kr").value=t),console.log(a),void 0!==a&&(document.querySelector("#option2_kr").value=a)}(e)}()}async function getreviewdownload(){await getreview(!1,"2099-09-09")}async function getreviewdownloadwith(){var e;await confirmloginstatus()&&(e=document.querySelector("#stddate").value,console.log(e),e)&&await getreview(!0,e)}async function getreview(e,t){var[r]=await chrome.tabs.query({active:!0,currentWindow:!0}),a=r.url;if(a.includes("www.coupang.com/")&&a.includes("products/")){document.querySelector("#reviewdownload").className="d-none",document.querySelector("#reviewdownloadloading").className="btn btn-outline-primary fw-bold";var n=[],o=await chrome.scripting.executeScript({target:{tabId:r.id},func:getreviewdetail,args:[a,1,30]}),n=n.concat(o[0].result[0]),s=parseInt(parseInt(o[0].result[1])/30)+1;document.querySelector("#loadingtext").innerText="리뷰수집중...";for(var c=1;c<s;c++)await sleep(500),document.querySelector("#loadingrate").innerText=(c/s*100).toFixed(0),o=await chrome.scripting.executeScript({target:{tabId:r.id},func:getreviewdetail,args:[a,c+1,30]}),n=n.concat(o[0].result[0]);if(console.log(n),0==n.length)alert("다운로드할 항목이 없습니다.");else{var l=[],i=[];n.forEach(t=>{t.판매자=t.판매자.replaceAll("판매자: ",""),t.도움=t.도움된인원수,l.find(e=>e.리뷰어번호==t.리뷰어번호)||l.push(t),i.find(e=>e.옵션명==t.상품옵션명)?i.find(e=>e.옵션명==t.상품옵션명).수량++:i.push({"옵션명":t.상품옵션명,"수량":1})});const I=["-","판매자"],E=["리뷰어번호","리뷰어이름"];if(e){var u,d=[],h=[],f=(l.forEach(t=>{h.find(e=>e.리뷰어번호==t.리뷰어번호)||(u={"이름":t.이름,"리뷰어번호":t.리뷰어번호},h.push(u))}),h.length);for(console.log(h),console.log(f),document.querySelector("#loadingtext").innerText="리뷰분석중...",c=0;c<f;c++){document.querySelector("#loadingrate").innerText=(c/h.length*100).toFixed(0);var p=await getreviewerinfo(h[c].리뷰어번호,h[c].이름,r,t);if(console.log(p),d=d.concat(p),console.log(d),1e4<d.length)break}console.log(d);var m,g=[],y={},v={},b=[],w={},x={},k=(0<d.length&&(x[v[y["-"]="-"]="-"]="-",v[y["판매자"]="판매자"]="상품명",x["판매자"]="중복리뷰어수",d.forEach((t,e)=>{Object.values(v).find(e=>e==t.상품명)||(y[e]=t.판매자,v[e]=t.상품명,x[e]=d.filter(e=>e.상품명==t.상품명).length),b.find(e=>e.리뷰어번호==t.리뷰어번호)?b.find(e=>e.리뷰어번호==t.리뷰어번호)[t.상품명]=t.리뷰날짜:((w={"리뷰어번호":t.리뷰어번호,"리뷰어이름":t.이름})[t.상품명]=t.리뷰날짜,b.push(w))}),g.push(y),g.push(v),g.push(x)),[]);Object.keys(g[2]).forEach(e=>{m={index:e,"판매자":g[0][e],"상품명":g[1][e],"리뷰어수":g[2][e]},k.push(m)}),k.sort(function(e,t){return e.리뷰어수<t.리뷰어수?1:t.리뷰어수<e.리뷰어수?-1:0}),k.forEach(e=>{"-"!==e.index&&"판매자"!==e.index&&(I.push(e.index),E.push(e.상품명))})}var S,_=i.reduce((e,t)=>e+t.수량,0),C=(i.forEach(e=>{e.판매비율=e.수량/_}),i.sort(function(e,t){return e.판매비율<t.판매비율?1:t.판매비율<e.판매비율?-1:0}),document.querySelector("#reviewdownload").className="btn btn-outline-primary fw-bold",document.querySelector("#reviewdownloadloading").className="d-none",XLSX.utils.json_to_sheet(n,{header:["작성일","리뷰어번호","이름","판매자","상품옵션명","평점","리뷰제목","리뷰내용","사진수","도움"]})),T=(e&&(S=XLSX.utils.json_to_sheet(g,{header:I,skipHeader:!0}),XLSX.utils.sheet_add_json(S,b,{header:E,origin:-1})),XLSX.utils.json_to_sheet(i,{header:["옵션명","수량","판매비율"]})),A=XLSX.utils.book_new();XLSX.utils.book_append_sheet(A,C,"전체리뷰"),e&&XLSX.utils.book_append_sheet(A,S,"리뷰어History"),XLSX.utils.book_append_sheet(A,T,"옵션판매비율"),XLSX.writeFile(A,"리뷰다운로드.xlsx")}}else alert("쿠팡 상품페이지에서 실행해 주세요")}async function getherreview(e,t,r,a){for(var n=parseInt(e/30+1),o=[],s=0;s<n;s++){if(res=await chrome.scripting.executeScript({target:{tabId:r.id},func:getprofiledetail,args:[t,s]}),(o=o.concat(res[0].result))[o.length-1]&&o[o.length-1].리뷰날짜&&new Date(o[o.length-1].리뷰날짜).getTime()<=new Date(a).getTime())return o;if(s===n-1)return o}}async function getreviewqty(e,t){return(await chrome.scripting.executeScript({target:{tabId:t.id},func:getprofile,args:[e]}))[0].result}async function getreviewerinfo(t,r,e,a){var n,o,s=(await chrome.scripting.executeScript({target:{tabId:e.id},func:getprofile,args:[t]}))[0].result;return 0==s?[]:(s=await getherreview(s,t,e,a),console.log(s),n={},o=[],s.forEach(e=>{n={"리뷰어번호":t,"이름":r,"판매자":e.판매자.replaceAll("\n","").trim(),"리뷰날짜":e.리뷰날짜,"상품명":e.상품명},o.push(n)}),console.log(o),o)}async function getreviewdetail(e,t,r){document.querySelector("#contents")&&(a=document.querySelector("#contents").dataset.productId),document.querySelector(".fw-font-apple-gothic")&&(a=document.querySelector(".fw-font-apple-gothic").dataset.productId),console.log(a);for(var a=await(await fetch("https://www.coupang.com/vp/product/reviews?productId="+a+"&page="+t+"&size="+r+"&sortBy=ORDER_SCORE_ASC&ratings=&q=&viRoleCode=3&ratingSummary=true",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:e,referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),n=(new DOMParser).parseFromString(a,"text/html"),t=n.querySelector(".js_reviewArticleTotalCountHiddenValue").dataset.totalCount,o=[],s=0;s<n.querySelectorAll(".js_reviewArticleReviewList").length;s++){var c=n.querySelectorAll(".js_reviewArticleReviewList")[s],l=c.querySelectorAll(".sdp-review__article__list__attachment__list").length,i=c.querySelector(".sdp-review__article__list__info__user").children[0].dataset.memberId,u=c.querySelector(".sdp-review__article__list__info__user").children[0].innerText,d=c.querySelector(".js_reviewArticleRatingValue").dataset.rating,h=c.querySelector(".sdp-review__article__list__info__product-info__reg-date").innerText,f=c.querySelector(".sdp-review__article__list__info__product-info__seller_name").innerText,p=c.querySelector(".sdp-review__article__list__info__product-info__name").innerText,m=c.querySelector(".sdp-review__article__list__headline")?c.querySelector(".sdp-review__article__list__headline").innerText:"",g=c.querySelector(".js_reviewArticleContent")?c.querySelector(".js_reviewArticleContent").innerText:"",c=c.querySelector(".js_reviewArticleHelpfulContainer")?c.querySelector(".js_reviewArticleHelpfulContainer").dataset.count:"",i={"리뷰어번호":i,"이름":u,"평점":d,"작성일":h,"판매자":f.replaceAll("\n","").trim(),"상품옵션명":p,"리뷰제목":m.replaceAll("\n","").trim(),"리뷰내용":g.replaceAll("\n","").trim(),"도움된인원수":c,"사진수":l};o.push(i)}return console.log(o),[o,t]}async function getprofile(e){try{var t=await(await fetch("https://www.coupang.com/vp/product/reviews/profile/"+e,{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text();return(new DOMParser).parseFromString(t,"text/html").querySelector(".sdp-review__profile__article__info__write__count").innerText}catch(e){return 0}}async function getprofiledetail(e,t){for(var e=await(await fetch("https://www.coupang.com/vp/product/reviews/profile/"+e+"/reviews?page="+t+"&size=30",{headers:{accept:"*/*","accept-language":"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7","sec-ch-ua":'"Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":""},referrer:"https://www.coupang.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})).text(),r=(new DOMParser).parseFromString(e,"text/html"),a=r.querySelectorAll(".sdp-review__profile__article__list__reviews").length,n=[],t=0;t<a;t++){var o=r.querySelectorAll(".sdp-review__profile__article__list__reviews")[t],s=o.querySelector(".sdp-review__profile__article__list__reviews__seller_name").innerText.replaceAll("판매자: ",""),c=o.querySelector(".sdp-review__profile__article__list__reviews__product__name").innerText,l=o.querySelector(".sdp-review__profile__article__list__reviews__star__date").innerText;console.log(o),n.push({"판매자":s,"상품명":c,"리뷰날짜":l})}return n}async function capturestop(){playstatus=!0,document.querySelector("#captureloading").className="d-none",document.querySelector("#capture").className="btn btn-outline-primary m-1 fw-bold"}async function changecaptureinterval(){intervaltime=1e3*parseInt(document.querySelector("#seconds").value)*60}async function captureplay(){document.querySelector("#captureloading").className="btn btn-outline-primary m-1 fw-bold",document.querySelector("#capture").className="d-none";var e=setInterval(function(){playstatus?(console.log("stopped capture"),document.querySelector("#captureloading").className="d-none",document.querySelector("#capture").className="btn btn-outline-primary m-1 fw-bold",playstatus=!1,clearInterval(e)):(console.log("start capture"),docapture())},intervaltime)}async function docapture(){for(var e,[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),r=[],a=0;a<5;a++)""!=document.querySelector("#link"+(a+1)).value&&(e={index:a,link:document.querySelector("#link"+(a+1)).value},r.push(e));if(console.log(r),0==r.length)alert("링크를 입력해 주세요"),capturestop();else if(0<r.filter(e=>!e.link.includes("www.coupang.com/vp/products/")).length)alert("잘못된 링크가 있습니다."),capturestop();else for(url of r){if(!url.link.includes("www.coupang.com/vp/products/"))return void alert("");await capture(t,url.link,url.index)}}async function capture(e,t,r){console.log(t),console.log(e);var e=await chrome.tabs.update(e.id,{url:t}),a=(console.log(e),await sleep(5e3),await chrome.scripting.executeScript({target:{tabId:e.id},func:function(){document.querySelector("#btfTab").children[0].children[1].click()}}),"_link"+(r+1)+"_"+new Date(Date.now()+324e5).toISOString().replaceAll(" ","").replaceAll(".","").replaceAll("T","-")+".jpg");await sleep(2e3),chrome.tabs.captureVisibleTab(null,null,e=>{var t=document.createElement("a");t.href=e,t.download=a,t.click()})}function fetchkeywordb(e,a,n){return new Promise((t,r)=>{chrome.runtime.sendMessage({action:"fetchKeyword",keyword:e,page:a,lastpage:n},e=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):e.success?t(e.data):r(new Error(e.error))})})}chrome.runtime.onMessage.addListener((e,t,a)=>{if("parseExcel"===e.action){try{console.log("popup.js에서 Excel 파싱 시작:",e.reportType);var n=new Uint8Array(e.uint8Array),o=(console.log(e.reportType+" 파일 크기:",n.length,"bytes"),String.fromCharCode(n[0],n[1]));if(console.log(e.reportType+" 파일 시그니처:",o),"PK"!==o)throw new Error(`유효하지 않은 Excel 파일 형식 (시그니처: ${o})`);var s=XLSX.read(n,{type:"array",cellDates:!1,cellNF:!1,cellStyles:!1,WTF:!0});console.log(e.reportType+" 시트명:",s.SheetNames);let r=[];if("CATEGORY_TR"===e.reportType){var c=s.Sheets[s.SheetNames[0]],l=XLSX.utils.sheet_to_json(c),i=(console.log(`판매수수료 원본 데이터: ${l.length}개`),l.filter(e=>{e=e["옵션ID"];return e&&!isNaN(parseInt(e))}));console.log(`유효한 판매수수료 데이터: ${i.length}개`),r=i.map(e=>({vendorItemId:e["옵션ID"],productId:e["상품ID"],optionId:e["옵션ID"],skuId:e["SKU ID"],productName:e["상품명"],optionName:e["옵션명"],orderId:e["주문ID"],categoryId:e["카테고리ID"],categoryName:e["카테고리명"],orderDate:e["주문일"],settlementDate:e["정산일"],revenueDate:e["매출인식일"],salePrice:parseFloat(e["판매가"]||0),saleQuantity:parseInt(e["판매수량"]||0),saleAmount:parseFloat(e["매출금액"]||0),commission:parseFloat(e["판매수수료"]||0),commissionRate:parseFloat(e["판매수수료율"]||0),commissionVAT:parseFloat(e["판매수수료VAT"]||0),settlementAmount:parseFloat(e["정산금액"]||0),revenue:parseFloat(e["매출금액"]||0),coupangDiscount:parseFloat(e["쿠팡지원할인"]||0),instantCoupon:parseFloat(e["즉시할인쿠폰"]||0),downloadCoupon:parseFloat(e["다운로드쿠폰"]||0),sellerCoupon:parseFloat(e["판매자할인쿠폰"]||0)}))}else if("WAREHOUSING_SHIPPING"===e.reportType){var u=s.Sheets["입출고비"],d=s.Sheets["배송비"];if(!u||!d)throw new Error("입출고비 또는 배송비 시트를 찾을 수 없습니다");var h=XLSX.utils.sheet_to_json(u),f=XLSX.utils.sheet_to_json(d);console.log(`입출고비 데이터: ${h.length}개`),console.log(`배송비 데이터: ${f.length}개`),h.forEach(e=>{var t=e["옵션ID"];t&&!isNaN(parseInt(t))&&r.push({vendorItemId:t,orderId:e["주문ID"],type:"warehouse",warehouseFee:parseFloat(e["할인적용가"]||0),orderDate:e["주문일"],settlementDate:e["정산일"]})}),f.forEach(e=>{var t=e["옵션ID"];t&&!isNaN(parseInt(t))&&r.push({vendorItemId:t,orderId:e["주문ID"],type:"shipping",shippingFee:parseFloat(e["최종비용"]||0),orderDate:e["주문일"],settlementDate:e["정산일"]})}),console.log(`입출고배송비 파싱 완료: ${r.length}개`)}console.log(`popup.js 파싱 완료: ${r.length}개`),a({success:!0,data:r})}catch(e){console.error("popup.js Excel 파싱 오류:",e),a({success:!1,error:e.message})}return!0}});
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var XLSX={};function make_xlsx_lib(e){e.version="0.18.7";var u=1200,E=1252,a=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],F={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},n=function(e){-1!=a.indexOf(e)&&(E=F[0]=e)};var N=function(e){n(u=e)};function p(){N(1200),n(1252)}function o(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function s(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}function d(e){return String.fromCharCode(e)}var l=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);if(255!=t||254!=r)return 254==t&&255==r?s(e.slice(2)):65279==t?e.slice(1):e;for(var a=e.slice(2),n=[],o=0;o<a.length>>1;++o)n[o]=String.fromCharCode(a.charCodeAt(2*o)+(a.charCodeAt(2*o+1)<<8));return n.join("")},i=function(e){return String.fromCharCode(e)},ne=null,h=!0,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function he(e){for(var t,r,a,n,o="",s=0,c=0,l=0;l<e.length;)a=(t=e.charCodeAt(l++))>>2,n=(3&t)<<4|(t=e.charCodeAt(l++))>>4,s=(15&t)<<2|(r=e.charCodeAt(l++))>>6,c=63&r,isNaN(t)?s=c=64:isNaN(r)&&(c=64),o+=f.charAt(a)+f.charAt(n)+f.charAt(s)+f.charAt(c);return o}function fe(e){var t,r,a="";e=e.replace(/[^\w\+\/\=]/g,"");for(var n=0;n<e.length;)t=f.indexOf(e.charAt(n++)),r=f.indexOf(e.charAt(n++)),a+=String.fromCharCode(t<<2|r>>4),64!==(t=f.indexOf(e.charAt(n++)))&&(a+=String.fromCharCode((15&r)<<4|t>>2)),64!==(r=f.indexOf(e.charAt(n++)))&&(a+=String.fromCharCode((3&t)<<6|r));return a}var ue="undefined"!=typeof Buffer&&!1,pe=function(){if("undefined"==typeof Buffer)return function(){};var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch(e){t=!0}return t?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}();function me(e){return ue?Buffer.alloc?Buffer.alloc(e):new Buffer(e):new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)}function ge(e){return ue?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)}var ye=function(e){return ue?pe(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function m(e){if("undefined"==typeof ArrayBuffer)return ye(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function g(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function y(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return y(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ve=ue?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:pe(e)}))}:function(e){if("undefined"==typeof Uint8Array)return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}));for(var t=0,r=0,t=0;t<e.length;++t)r+=e[t].length;for(var a,n=new Uint8Array(r),r=t=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n};var be=/\u0000/g,we=/[\u0001-\u0006]/g;function q(e){for(var t="",r=e.length-1;0<=r;)t+=e.charAt(r--);return t}function D(e,t){e=""+e;return t<=e.length?e:k("0",t-e.length)+e}function P(e,t){e=""+e;return t<=e.length?e:k(" ",t-e.length)+e}function M(e,t){e=""+e;return t<=e.length?e:e+k(" ",t-e.length)}var v=Math.pow(2,32);function oe(e,t){var r,a;return v<e||e<-v?(a=e,r=t,a=""+Math.round(a),r<=a.length?a:k("0",r-a.length)+a):(r=Math.round(e),(a=t)<=(e=""+(e=r)).length?e:k("0",a-e.length)+e)}function se(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var ce=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],le=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var W={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},b={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ie={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xe(e,t,r){var a,n=e<0?-1:1,o=e*n,s=0,c=1,l=0,i=1,u=0,d=0;for(Math.floor(o);u<t&&(l=(a=Math.floor(o))*c+s,d=a*u+i,!(o-a<5e-8));)o=1/(o-a),s=c,c=l,i=u,u=d;return t<d&&(l=t<u?(d=i,s):(d=u,c)),r?[e=Math.floor(n*l/d),n*l-e*d,d]:[0,n*l,d]}function ke(e,t,r){var a,n,o,s;return 2958465<e||e<0?null:(o=[],s={D:a=0|e,T:n=Math.floor(86400*(e-a)),u:86400*(e-a)-n,y:e=0,m:0,d:0,H:0,M:0,S:0,q:0},Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(a+=1462),.9999<s.u&&(s.u=0,86400==++n)&&(s.T=n=0,++a,++s.D),60===a?(o=r?[1317,10,29]:[1900,2,29],e=3):0===a?(o=r?[1317,8,29]:[1900,1,0],e=6):(60<a&&--a,(t=new Date(1900,0,1)).setDate(t.getDate()+a-1),o=[t.getFullYear(),t.getMonth()+1,t.getDate()],e=t.getDay(),a<60&&(e=(e+6)%7),r&&(e=function(e,t){t[0]-=581;t=e.getDay();e<60&&(t=(t+6)%7);return t}(t,o))),s.y=o[0],s.m=o[1],s.d=o[2],s.S=n%60,n=Math.floor(n/60),s.M=n%60,n=Math.floor(n/60),s.H=n,s.q=e,s)}var Se=new Date(1899,11,31,0,0,0),_e=Se.getTime(),Ce=new Date(1900,2,1,0,0,0);function Te(e,t){var r=e.getTime();return t?r-=1262304e5:Ce<=e&&(r+=864e5),(r-(_e+6e4*(e.getTimezoneOffset()-Se.getTimezoneOffset())))/864e5}function Ae(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ie(e){var t,r,a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n=-4<=a&&a<=-1?e.toPrecision(10+a):Math.abs(a)<=9?(t=(n=e)<0?12:11,(r=Ae(n.toFixed(12))).length<=t||(r=n.toPrecision(10)).length<=t?r:n.toExponential(5)):10===a?e.toFixed(10).substr(0,12):(r=Ae((t=e).toFixed(11))).length>(t<0?12:11)||"0"===r||"-0"===r?t.toPrecision(6):r;return Ae(-1==(a=n.toUpperCase()).indexOf("E")?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Ee(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Ie(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Xe(14,Te(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ne(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(0<r.length?",":"")+e.substr(t,3);return r}var Oe=/%/g;var Fe=/# (\?+)( ?)\/( ?)(\d+)/;var qe=/^#*0*\.([0#]+)/,De=/\).*[0#]/,Pe=/\(###\) ###\\?-####/;function w(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Me(e,t){t=Math.pow(10,t);return""+Math.round(e*t)/t}function Re(e,t){var e=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function x(e,t,r){if(40===e.charCodeAt(0)&&!t.match(De))return a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=r?x("n",a,r):"("+x("n",a,-r)+")";if(44===t.charCodeAt(t.length-1)){for(var a=e,n=t,o=r,s=n.length-1;44===n.charCodeAt(s-1);)--s;return Be(a,n.substr(0,s),o/Math.pow(10,3*(n.length-s)))}if(-1!==t.indexOf("%"))return o=e,i=r,l=(u=t).replace(Oe,""),u=u.length-l.length,Be(o,l,i*Math.pow(10,2*u))+k("%",u);if(-1!==t.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var o=t.indexOf("."),s=(-1===o&&(o=t.indexOf("E")),Math.floor(Math.log(r)*Math.LOG10E)%o);if(s<0&&(s+=o),-1===(a=(r/Math.pow(10,s)).toPrecision(1+n+(o+s)%o)).indexOf("e")){var c=Math.floor(Math.log(r)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(c-a.length+s):a+="E+"+(c-s);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,o)+"."+a.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(o+s)%o)+"."+a.substr(s)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),(a=t.match(/E\-/)&&a.match(/e\+/)?a.replace(/e\+/,"e"):a).replace("e","E")}(t,r);if(36===t.charCodeAt(0))return"$"+x(e,t.substr(" "==t.charAt(1)?2:1),r);var c,l,i,u,d,h=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+oe(h,t.length);if(t.match(/^[#?]+$/))return(p="0"===(p=oe(r,0))?"":p).length>t.length?p:w(t.substr(0,t.length-p.length))+p;if(c=t.match(Fe))return l=c,i=h,u=f,v=parseInt(l[4],10),i=Math.round(i*v),d=Math.floor(i/v),u+(0===d?"":""+d)+" "+(0==(i=i-d*v)?k(" ",l[1].length+1+l[4].length):P(i,l[1].length)+l[2]+"/"+l[3]+D(v,l[4].length));if(t.match(/^#+0+$/))return f+oe(h,t.length-t.indexOf("0"));if(c=t.match(qe))return p=Me(r,c[1].length).replace(/^([^\.]+)$/,"$1."+w(c[1])).replace(/\.$/,"."+w(c[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+k("0",w(c[1]).length-t.length)}),-1!==t.indexOf("0.")?p:p.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),c=t.match(/^(0*)\.(#*)$/))return f+Me(h,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=t.match(/^#{1,3},##0(\.?)$/))return f+Ne(oe(h,0));if(c=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+x(e,t,-r):Ne(""+(Math.floor(r)+((d=c[1].length)<(""+Math.round((r-Math.floor(r))*Math.pow(10,d))).length?1:0)))+"."+D(Re(r,c[1].length),c[1].length);if(c=t.match(/^#,#*,#0/))return x(e,t.replace(/^#,#*,/,""),r);if(c=t.match(/^([0#]+)(\\?-([0#]+))+$/))return p=q(x(e,t.replace(/[\\-]/g,""),r)),m=0,q(q(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return m<p.length?p.charAt(m++):"0"===e?"0":""}));if(t.match(Pe))return"("+(p=x(e,"##########",r)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var p,m,g,y,v="";if(c=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return m=Math.min(c[4].length,7),y=xe(h,Math.pow(10,m)-1,!1),p=f," "==(v=Be("n",c[1],y[1])).charAt(v.length-1)&&(v=v.substr(0,v.length-1)+"0"),p+=v+c[2]+"/"+c[3],(v=M(y[2],m)).length<c[4].length&&(v=w(c[4].substr(c[4].length-v.length))+v),p+=v;if(c=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return m=Math.min(Math.max(c[1].length,c[4].length),7),f+((y=xe(h,Math.pow(10,m)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?P(y[1],m)+c[2]+"/"+c[3]+M(y[2],m):k(" ",2*m+1+c[2].length+c[3].length));if(c=t.match(/^[#0?]+$/))return p=oe(r,0),t.length<=p.length?p:w(t.substr(0,t.length-p.length))+p;if(c=t.match(/^([#0?]+)\.([#0]+)$/))return m=(p=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),y=t.indexOf(".")-m,g=t.length-p.length-y,w(t.substr(0,y)+p+t.substr(t.length-g));if(c=t.match(/^00,000\.([#0]*0)$/))return m=Re(r,c[1].length),r<0?"-"+x(e,t,-r):Ne((y=r)<2147483647&&-2147483648<y?""+(0<=y?0|y:y-1|0):""+Math.floor(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?D(0,3-e.length):"")+e})+"."+D(m,c[1].length);switch(t){case"###,##0.00":return x(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=Ne(oe(h,0));return"0"!==b?f+b:"";case"###,###.00":return x(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return x(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Le(e,t,r){if(40===e.charCodeAt(0)&&!t.match(De))return a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=r?Le("n",a,r):"("+Le("n",a,-r)+")";if(44===t.charCodeAt(t.length-1)){for(var a=e,n=t,o=r,s=n.length-1;44===n.charCodeAt(s-1);)--s;return Be(a,n.substr(0,s),o/Math.pow(10,3*(n.length-s)))}if(-1!==t.indexOf("%"))return o=e,l=r,i=(g=t).replace(Oe,""),g=g.length-i.length,Be(o,i,l*Math.pow(10,2*g))+k("%",g);if(-1!==t.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var o,s=t.indexOf("."),c=(-1===s&&(s=t.indexOf("E")),Math.floor(Math.log(r)*Math.LOG10E)%s);c<0&&(c+=s),(a=(r/Math.pow(10,c)).toPrecision(1+n+(s+c)%s)).match(/[Ee]/)||(o=Math.floor(Math.log(r)*Math.LOG10E),-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+c):a+="E+"+(o-c),a=a.replace(/\+-/,"-")),a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+c)%s)+"."+a.substr(c)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),(a=t.match(/E\-/)&&a.match(/e\+/)?a.replace(/e\+/,"e"):a).replace("e","E")}(t,r);if(36===t.charCodeAt(0))return"$"+Le(e,t.substr(" "==t.charAt(1)?2:1),r);var c,l,i,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+D(u,t.length);if(t.match(/^[#?]+$/))return(h=0===r?"":""+r).length>t.length?h:w(t.substr(0,t.length-h.length))+h;if(c=t.match(Fe))return d+(0===(i=u)?"":""+i)+k(" ",(l=c)[1].length+2+l[4].length);if(t.match(/^#+0+$/))return d+D(u,t.length-t.indexOf("0"));if(c=t.match(qe))return h=(h=(""+r).replace(/^([^\.]+)$/,"$1."+w(c[1])).replace(/\.$/,"."+w(c[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+k("0",w(c[1]).length-t.length)}),-1!==t.indexOf("0.")?h:h.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),c=t.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=t.match(/^#{1,3},##0(\.?)$/))return d+Ne(""+u);if(c=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Le(e,t,-r):Ne(""+r)+"."+k("0",c[1].length);if(c=t.match(/^#,#*,#0/))return Le(e,t.replace(/^#,#*,/,""),r);if(c=t.match(/^([0#]+)(\\?-([0#]+))+$/))return h=q(Le(e,t.replace(/[\\-]/g,""),r)),f=0,q(q(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return f<h.length?h.charAt(f++):"0"===e?"0":""}));if(t.match(Pe))return"("+(h=Le(e,"##########",r)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var h,f,p,m,g="";if(c=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),p=xe(u,Math.pow(10,f)-1,!1),h=d," "==(g=Be("n",c[1],p[1])).charAt(g.length-1)&&(g=g.substr(0,g.length-1)+"0"),h+=g+c[2]+"/"+c[3],(g=M(p[2],f)).length<c[4].length&&(g=w(c[4].substr(c[4].length-g.length))+g),h+=g;if(c=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),d+((p=xe(u,Math.pow(10,f)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?P(p[1],f)+c[2]+"/"+c[3]+M(p[2],f):k(" ",2*f+1+c[2].length+c[3].length));if(c=t.match(/^[#0?]+$/))return h=""+r,t.length<=h.length?h:w(t.substr(0,t.length-h.length))+h;if(c=t.match(/^([#0]+)\.([#0]+)$/))return f=(h=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),p=t.indexOf(".")-f,m=t.length-h.length-p,w(t.substr(0,p)+h+t.substr(t.length-m));if(c=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Le(e,t,-r):Ne(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?D(0,3-e.length):"")+e})+"."+D(0,c[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Ne(""+u);return"0"!==y?d+y:"";default:if(t.match(/\.[0#?]*$/))return Le(e,t.slice(0,t.lastIndexOf(".")),r)+w(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Be(e,t,r){return((0|r)===r?Le:x)(e,t,r)}var je=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function We(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":se(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(je))return!0;break;case".":case"0":case"#":for(;t<e.length&&(-1<"0#?.,E+-%".indexOf(r=e.charAt(++t))||"\\"==r&&"-"==e.charAt(t+1)&&-1<"0#".indexOf(e.charAt(t+2))););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&-1<"0123456789".indexOf(e.charAt(++t)););break;default:++t}return!1}function Ue(e,t,r,a){for(var n,o,s,c=[],l="",i=0,u="",d="t",h="H";i<e.length;)switch(u=e.charAt(i)){case"G":if(!se(e,i))throw new Error("unrecognized character "+u+" in "+e);c[c.length]={t:"G",v:"General"},i+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++i))&&i<e.length;)l+=String.fromCharCode(s);c[c.length]={t:"t",v:l},++i;break;case"\\":var f=e.charAt(++i);c[c.length]={t:"("===f||")"===f?f:"t",v:f},++i;break;case"_":c[c.length]={t:"t",v:" "},i+=2;break;case"@":c[c.length]={t:"T",v:t},++i;break;case"B":case"b":if("1"===e.charAt(i+1)||"2"===e.charAt(i+1)){if(null==n&&null==(n=ke(t,r,"2"===e.charAt(i+1))))return"";c[c.length]={t:"X",v:e.substr(i,2)},d=u,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=ke(t,r)))return"";for(l=u;++i<e.length&&e.charAt(i).toLowerCase()===u;)l+=u;"h"===(u="m"===u&&"h"===d.toLowerCase()?"M":u)&&(u=h),c[c.length]={t:u,v:l},d=u;break;case"A":case"a":case"上":f={t:u,v:u};if(null==n&&(n=ke(t,r)),"A/P"===e.substr(i,3).toUpperCase()?(null!=n&&(f.v=12<=n.H?e.charAt(i+2):u),f.t="T",h="h",i+=3):"AM/PM"===e.substr(i,5).toUpperCase()?(null!=n&&(f.v=12<=n.H?"PM":"AM"),f.t="T",i+=5,h="h"):"上午/下午"===e.substr(i,5).toUpperCase()?(null!=n&&(f.v=12<=n.H?"下午":"上午"),f.t="T",i+=5,h="h"):(f.t="t",++i),null==n&&"T"===f.t)return"";c[c.length]=f,d=u;break;case"[":for(l=u;"]"!==e.charAt(i++)&&i<e.length;)l+=e.charAt(i);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(je)){if(null==n&&null==(n=ke(t,r)))return"";c[c.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else-1<l.indexOf("$")&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",We(e)||(c[c.length]={t:"t",v:l}));break;case".":if(null!=n){for(l=u;++i<e.length&&"0"===(u=e.charAt(i));)l+=u;c[c.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++i<e.length&&-1<"0#?.,E+-%".indexOf(u=e.charAt(i));)l+=u;c[c.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++i)===u;)l+=u;c[c.length]={t:u,v:l},d=u;break;case"*":++i," "!=e.charAt(i)&&"*"!=e.charAt(i)||++i;break;case"(":case")":c[c.length]={t:1===a?"t":u,v:u},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;i<e.length&&-1<"0123456789".indexOf(e.charAt(++i));)l+=e.charAt(i);c[c.length]={t:"D",v:l};break;case" ":c[c.length]={t:u,v:u},++i;break;case"$":c[c.length]={t:"t",v:"$"},++i;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);c[c.length]={t:"t",v:u},++i}var p,m=0,g=0;for(i=c.length-1,d="t";0<=i;--i)switch(c[i].t){case"h":case"H":c[i].t=h,d="h",m<1&&(m=1);break;case"s":(p=c[i].v.match(/\.0+$/))&&(g=Math.max(g,p[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=c[i].t;break;case"m":"s"===d&&(c[i].t="M",m<2)&&(m=2);break;case"X":break;case"Z":(m=(m=m<1&&c[i].v.match(/[Hh]/)?1:m)<2&&c[i].v.match(/[Mm]/)?2:m)<3&&c[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:.5<=n.u&&(n.u=0,++n.S),60<=n.S&&(n.S=0,++n.M),60<=n.M&&(n.M=0,++n.H);break;case 2:.5<=n.u&&(n.u=0,++n.S),60<=n.S&&(n.S=0,++n.M)}var y="";for(i=0;i<c.length;++i)switch(c[i].t){case"t":case"T":case" ":case"D":break;case"X":c[i].v="",c[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[i].v=function(e,t,r,a){var n,o="",s=0,c=0,l=r.y,i=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:n=l%100,i=2;break;default:n=l%1e4,i=4}break;case 109:switch(t.length){case 1:case 2:n=r.m,i=t.length;break;case 3:return le[r.m-1][1];case 5:return le[r.m-1][0];default:return le[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=r.d,i=t.length;break;case 3:return ce[r.q][0];default:return ce[r.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(r.H+11)%12,i=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=r.H,i=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=r.M,i=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(60*(c=2<=a?3===a?1e3:100:1===a?10:1)<=(s=Math.round(c*(r.S+r.u)))&&(s=0),"s"===t?0===s?"0":""+s/c:(o=D(s,2+a),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):D(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":n=24*r.D+r.H;break;case"[m]":case"[mm]":n=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":n=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}i=3===t.length?1:2;break;case 101:n=l,i=1}return 0<i?D(n,i):""}(c[i].t.charCodeAt(0),c[i].v,n,g),c[i].t="t";break;case"n":case"?":for(x=i+1;null!=c[x]&&("?"===(u=c[x].t)||"D"===u||(" "===u||"t"===u)&&null!=c[x+1]&&("?"===c[x+1].t||"t"===c[x+1].t&&"/"===c[x+1].v)||"("===c[i].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===c[x].v||" "===c[x].v&&null!=c[x+1]&&"?"==c[x+1].t));)c[i].v+=c[x].v,c[x]={v:"",t:";"},++x;y+=c[i].v,i=x-1;break;case"G":c[i].t="t",c[i].v=Ee(t,r)}var v,b,w="";if(0<y.length){40==y.charCodeAt(0)?(v=t<0&&45===y.charCodeAt(0)?-t:t,b=Be("n",y,v)):(b=Be("n",y,v=t<0&&1<a?-t:t),v<0&&c[0]&&"t"==c[0].t&&(b=b.substr(1),c[0].v="-"+c[0].v));for(var x=b.length-1,k=c.length,i=0;i<c.length;++i)if(null!=c[i]&&"t"!=c[i].t&&-1<c[i].v.indexOf(".")){k=i;break}var S=c.length;if(k===c.length&&-1===b.indexOf("E")){for(i=c.length-1;0<=i;--i)null!=c[i]&&-1!=="n?".indexOf(c[i].t)&&(x>=c[i].v.length-1?(x-=c[i].v.length,c[i].v=b.substr(x+1,c[i].v.length)):x<0?c[i].v="":(c[i].v=b.substr(0,x+1),x=-1),c[i].t="t",S=i);0<=x&&S<c.length&&(c[S].v=b.substr(0,x+1)+c[S].v)}else if(k!==c.length&&-1===b.indexOf("E")){for(x=b.indexOf(".")-1,i=k;0<=i;--i)if(null!=c[i]&&-1!=="n?".indexOf(c[i].t)){for(o=-1<c[i].v.indexOf(".")&&i===k?c[i].v.indexOf(".")-1:c[i].v.length-1,w=c[i].v.substr(o+1);0<=o;--o)0<=x&&("0"===c[i].v.charAt(o)||"#"===c[i].v.charAt(o))&&(w=b.charAt(x--)+w);c[i].v=w,c[i].t="t",S=i}for(0<=x&&S<c.length&&(c[S].v=b.substr(0,x+1)+c[S].v),x=b.indexOf(".")+1,i=k;i<c.length;++i)if(null!=c[i]&&(-1!=="n?(".indexOf(c[i].t)||i===k)){for(o=-1<c[i].v.indexOf(".")&&i===k?c[i].v.indexOf(".")+1:0,w=c[i].v.substr(0,o);o<c[i].v.length;++o)x<b.length&&(w+=b.charAt(x++));c[i].v=w,c[i].t="t",S=i}}}for(i=0;i<c.length;++i)null!=c[i]&&-1<"n?".indexOf(c[i].t)&&(v=1<a&&t<0&&0<i&&"-"===c[i-1].v?-t:t,c[i].v=Be(c[i].t,c[i].v,v),c[i].t="t");var _="";for(i=0;i!==c.length;++i)null!=c[i]&&(_+=c[i].v);return _}var ze=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $e(e,t){if(null!=t){var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return 1;break;case">":if(r<e)return 1;break;case"<":if(e<r)return 1;break;case"<>":if(e!=r)return 1;break;case">=":if(r<=e)return 1;break;case"<=":if(e<=r)return 1}}}function He(e,t){var r=function(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),e=r.length,a=r[e-1].indexOf("@");if(e<4&&-1<a&&--e,4<r.length)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||-1<a?r[r.length-1]:"@"];switch(r.length){case 1:r=-1<a?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=-1<a?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=-1<a?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var n,o,s=0<t?r[0]:t<0?r[1]:r[2];return!(-1===r[0].indexOf("[")&&-1===r[1].indexOf("[")||null==r[0].match(/\[[=<>]/)&&null==r[1].match(/\[[=<>]/))?(n=r[0].match(ze),o=r[1].match(ze),$e(t,n)?[e,r[0]]:$e(t,o)?[e,r[1]]:[e,r[null!=n&&null!=o?2:1]]):[e,s]}function Xe(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:W)[e])?r.table&&r.table[b[e]]||W[b[e]]:a)&&(a=ie[e]||"General")}if(se(a,0))return Ee(t,r);var n=He(a,t=t instanceof Date?Te(t,r.date1904):t);if(se(n[1]))return Ee(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return Ue(n[1],t,r,n[0])}function Ke(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null==W[r])t<0&&(t=r);else if(W[r]==e){t=r;break}t<0&&(t=391)}return W[t]=e,t}function Ge(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Ke(e[t],t)}function Je(){var e;(e=e||{})[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',W=e}var Ve={format:Xe,load:Ke,_table:W,load_table:Ge,parse_date_code:ke,is_date:We,get_table:function(){return Ve._table=W}},Ye={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ze=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Qe={"d.m":"d\\.m"};function et(e,t){Ke(Qe[e]||e,t)}(r={}).version="1.2.0",c=function(){for(var e,t=new Array(256),r=0;256!=r;++r)t[e=r]=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&e?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),t=function(e){for(var t=0,r=0,a=0,n=new("undefined"!=typeof Int32Array?Int32Array:Array)(4096),a=0;256!=a;++a)n[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=n[t]=r>>>8^e[255&r];var o=[];for(a=1;16!=a;++a)o[a-1]="undefined"!=typeof Int32Array?n.subarray(256*a,256*a+256):n.slice(256*a,256*a+256);return o}(c),tt=t[0],rt=t[1],at=t[2],nt=t[3],ot=t[4],st=t[5],ct=t[6],lt=t[7],it=t[8],ut=t[9],dt=t[10],ht=t[11],ft=t[12],pt=t[13],mt=t[14],r.table=c,r.bstr=function(e,t){for(var r=-1^t,a=0,n=e.length;a<n;)r=r>>>8^c[255&(r^e.charCodeAt(a++))];return~r},r.buf=function(e,t){for(var r=-1^t,a=e.length-15,n=0;n<a;)r=mt[e[n++]^255&r]^pt[e[n++]^r>>8&255]^ft[e[n++]^r>>16&255]^ht[e[n++]^r>>>24]^dt[e[n++]]^ut[e[n++]]^it[e[n++]]^lt[e[n++]]^ct[e[n++]]^st[e[n++]]^ot[e[n++]]^nt[e[n++]]^at[e[n++]]^rt[e[n++]]^tt[e[n++]]^c[e[n++]];for(a+=15;n<a;)r=r>>>8^c[255&(r^e[n++])];return~r},r.str=function(e,t){for(var r,a=-1^t,n=0,o=e.length,s=0;n<o;)a=(s=e.charCodeAt(n++))<128?a>>>8^c[255&(a^s)]:s<2048?(a=a>>>8^c[255&(a^(192|s>>6&31))])>>>8^c[255&(a^(128|63&s))]:55296<=s&&s<57344?(s=64+(1023&s),r=1023&e.charCodeAt(n++),(a=(a=(a=a>>>8^c[255&(a^(240|s>>8&7))])>>>8^c[255&(a^(128|s>>2&63))])>>>8^c[255&(a^(128|r>>6&15|(3&s)<<4))])>>>8^c[255&(a^(128|63&r))]):(a=(a=a>>>8^c[255&(a^(224|s>>12&15))])>>>8^c[255&(a^(128|s>>6&63))])>>>8^c[255&(a^(128|63&s))];return~a};var c,tt,rt,at,nt,ot,st,ct,lt,it,ut,dt,ht,ft,pt,mt,gt,yt=r,z=function(){var n,e={};function f(e){var t;return"/"==e.charAt(e.length-1)?-1===e.slice(0,-1).indexOf("/")?e:f(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(0,t+1)}function p(e){var t;return"/"==e.charAt(e.length-1)?p(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(t+1)}function T(e){de(e,0);for(var t,r={};e.l<=e.length-4;){var a=e._R(2),n=e._R(2),o=e.l+n,s={};21589===a&&(1&(t=e._R(1))&&(s.mtime=e._R(4)),5<n&&(2&t&&(s.atime=e._R(4)),4&t)&&(s.ctime=e._R(4)),s.mtime)&&(s.mt=new Date(1e3*s.mtime)),e.l=o,r[a]=s}return r}function o(){n=n||void 0}function s(e,t){if(80==e[0]&&75==e[1])return ie(e,t);if(109==(32|e[0])&&105==(32|e[1])){var r=e,a=t;if("mime-version:"!=se(r.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=a&&a.root||"",o=(ue&&Buffer.isBuffer(r)?r.toString("binary"):se(r)).split("\r\n"),s=0,c="";for(s=0;s<o.length;++s)if(c=o[s],/^Content-Location:/i.test(c)&&(c=c.slice(c.indexOf("file")),n=n||c.slice(0,c.lastIndexOf("/")+1),c.slice(0,n.length)!=n))for(;0<n.length&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),c.slice(0,n.length)!=n););if(!(a=(o[1]||"").match(/boundary="(.*?)"/)))throw new Error("MAD cannot find boundary");var M="--"+(a[1]||""),l={FileIndex:[],FullPaths:[]};ae(l);var R,L=0;for(s=0;s<o.length;++s){var B=o[s];B!==M&&B!==M+"--"||(L++&&!function(e,t,r){for(var a,n="",o="",s="",c=0;c<10;++c){var l=t[c];if(!l||l.match(/^\s*$/))break;var i=l.match(/^(.*?):\s*([^\s].*)$/);if(i)switch(i[1].toLowerCase()){case"content-location":n=i[2].trim();break;case"content-type":s=i[2].trim();break;case"content-transfer-encoding":o=i[2].trim()}}switch(++c,o.toLowerCase()){case"base64":a=ye(fe(t.slice(c).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return ye(t.join("\r\n"))}(t.slice(c));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}e=ce(e,n.slice(r.length),a,{unsafe:!0});s&&(e.ctype=s)}(l,o.slice(R,s),n),R=s)}return l}if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var i,u=512,d=[],h=e.slice(0,512),j=(de(h,0),function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(le,"Header Signature: "),e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}(h));switch(i=j[0]){case 3:u=512;break;case 4:u=4096;break;case 0:if(0==j[1])return ie(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+i)}512!==u&&de(h=e.slice(0,u),28);var r=e.slice(0,u),a=h,W=i,f=9;switch(a.l+=2,f=a._R(2)){case 9:if(3!=W)throw new Error("Sector Shift: Expected 9 saw "+f);break;case 12:if(4!=W)throw new Error("Sector Shift: Expected 12 saw "+f);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+f)}a.chk("0600","Mini Sector Shift: "),a.chk("000000000000","Reserved: ");var p=h._R(4,"i");if(3===i&&0!==p)throw new Error("# Directory Sectors: Expected 0 saw "+p);h.l+=4,p=h._R(4,"i"),h.l+=4,h.chk("00100000","Mini Stream Cutoff Size: ");for(var U,m=h._R(4,"i"),z=h._R(4,"i"),g=h._R(4,"i"),y=h._R(4,"i"),v=0;v<109&&!((U=h._R(4,"i"))<0);++v)d[v]=U;for(var b,w=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],n=1;n<r;++n)a[n-1]=e.slice(n*t,(n+1)*t);return a[r-1]=e.slice(r*t),a}(e,u),g=(!function e(t,r,a,n,o){var s=oe;if(t===oe){if(0!==r)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var c=a[t],l=(n>>>2)-1;if(c){for(var i=0;i<l&&(s=jr(c,4*i))!==oe;++i)o.push(s);1<=r&&e(jr(c,n-4),r-1,a,n,o)}}}(g,y,w,u,d),function(e,t,r,a){var n=e.length,o=[],s=[],c=[],l=[],i=a-1,u=0,d=0,h=0,f=0;for(u=0;u<n;++u)if(c=[],n<=(h=u+t)&&(h-=n),!s[h]){l=[];var p=[];for(d=h;0<=d;){s[d]=p[d]=!0,c[c.length]=d,l.push(e[d]);var m=r[Math.floor(4*d/a)];if(a<4+(f=4*d&i))throw new Error("FAT boundary crossed: "+d+" 4 "+a);if(!e[m])break;if(d=jr(e[m],f),p[d])break}o[h]={nodes:c,data:Ar([l])}}return o}(w,p,d,u)),y=(g[p].name="!Directory",0<z&&m!==oe&&(g[m].name="!MiniFAT"),g[d[0]].name="!FAT",g.fat_addrs=d,g.ssz=u,[]),x=[],$=[],k=g,H=w,X=y,K=z,G={},J=x,V=m,S=0,Y=X.length?2:0,Z=k[p].data,_=0,Q=0;_<Z.length;_+=128){var C=Z.slice(_,_+128),T=(de(C,64),Q=C._R(2),b=Ir(C,0,Q-Y),X.push(b),{name:b,type:C._R(1),color:C._R(1),L:C._R(4,"i"),R:C._R(4,"i"),C:C._R(4,"i"),clsid:C._R(16),state:C._R(4,"i"),start:0,size:0});0!==C._R(2)+C._R(2)+C._R(2)+C._R(2)&&(T.ct=re(C,C.l-8)),0!==C._R(2)+C._R(2)+C._R(2)+C._R(2)&&(T.mt=re(C,C.l-8)),T.start=C._R(4,"i"),T.size=C._R(4,"i"),T.size<0&&T.start<0&&(T.size=T.type=0,T.start=oe,T.name=""),5===T.type?(S=T.start,0<K&&S!==oe&&(k[S].name="!StreamData")):4096<=T.size?(T.storage="fat",void 0===k[T.start]&&(k[T.start]=function(e,t,r,a,n){var o=[],s=[];n=n||[];var c=a-1,l=0,i=0;for(l=t;0<=l;){n[l]=!0,o[o.length]=l,s.push(e[l]);var u=r[Math.floor(4*l/a)];if(a<4+(i=4*l&c))throw new Error("FAT boundary crossed: "+l+" 4 "+a);if(!e[u])break;l=jr(e[u],i)}return{nodes:o,data:Ar([s])}}(H,T.start,k.fat_addrs,k.ssz)),k[T.start].name=T.name,T.content=k[T.start].data.slice(0,T.size)):(T.storage="minifat",T.size<0?T.size=0:S!==oe&&T.start!==oe&&k[S]&&(T.content=function(e,t,r){var a=e.start,n=e.size,o=[],s=a;for(;r&&0<n&&0<=s;)o.push(t.slice(s*ne,s*ne+ne)),n-=ne,s=jr(r,4*s);return 0===o.length?Gr(0):ve(o).slice(0,e.size)}(T,k[S].data,(k[V]||{}).data))),T.content&&de(T.content,0),G[b]=T,J.push(T)}for(var A=x,I=$,ee=y,E=0,N=0,O=0,te=0,F=0,q=ee.length,D=[],P=[];E<q;++E)D[E]=P[E]=E,I[E]=ee[E];for(;F<P.length;++F)N=A[E=P[F]].L,O=A[E].R,te=A[E].C,D[E]===E&&(-1!==N&&D[N]!==N&&(D[E]=D[N]),-1!==O)&&D[O]!==O&&(D[E]=D[O]),-1!==te&&(D[te]=E),-1!==N&&E!=D[E]&&(D[N]=D[E],P.lastIndexOf(N)<F)&&P.push(N),-1!==O&&E!=D[E]&&(D[O]=D[E],P.lastIndexOf(O)<F)&&P.push(O);for(E=1;E<q;++E)D[E]===E&&(-1!==O&&D[O]!==O?D[E]=D[O]:-1!==N&&D[N]!==N&&(D[E]=D[N]));for(E=1;E<q;++E)if(0!==A[E].type){if((F=E)!=D[F])for(;F=D[F],I[E]=I[F]+"/"+I[E],0!==F&&-1!==D[F]&&F!=D[F];);D[E]=-1}for(I[0]+="/",E=1;E<q;++E)2!==A[E].type&&(I[E]+="/");y.shift();g={FileIndex:x,FullPaths:$};return t&&t.raw&&(g.raw={header:r,sectors:w}),g}function re(e,t){return new Date(1e3*(Q(e,t+4)/1e7*Math.pow(2,32)+Q(e,t)/1e7-11644473600))}function ae(e,t){var t=t||{},r=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),r=e,t="Sh33tJ5",z.find(r,"/"+t)||((e=Gr(4))[0]=55,e[1]=e[3]=50,e[2]=54,r.FileIndex.push({name:t,type:2,content:e,size:4,L:69,R:69,C:69}),r.FullPaths.push(r.FullPaths[0]+t),$(r))}function $(e,t){ae(e);for(var r=!1,a=!1,n=e.FullPaths.length-1;0<=n;--n){var o=e.FileIndex[n];switch(o.type){case 0:a?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(r=!0),-1<o.R&&-1<o.L&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||t){for(var s=new Date(1987,1,19),c=0,l=Object.create?Object.create(null):{},i=[],n=0;n<e.FullPaths.length;++n)l[e.FullPaths[n]]=!0,0!==e.FileIndex[n].type&&i.push([e.FullPaths[n],e.FileIndex[n]]);for(n=0;n<i.length;++n)for(var u=f(i[n][0]),a=l[u];!a;){for(;f(u)&&!l[f(u)];)u=f(u);i.push([u,{name:p(u).replace("/",""),type:1,clsid:m,ct:s,mt:s,content:null}]),l[u]=!0,a=l[u=f(i[n][0])]}for(i.sort(function(e,t){for(var r,e=e[0],t=t[0],a=e.split("/"),n=t.split("/"),o=0,s=Math.min(a.length,n.length);o<s;++o){if(r=a[o].length-n[o].length)return r;if(a[o]!=n[o])return a[o]<n[o]?-1:1}return a.length-n.length}),e.FullPaths=[],e.FileIndex=[],n=0;n<i.length;++n)e.FullPaths[n]=i[n][0],e.FileIndex[n]=i[n][1];for(n=0;n<i.length;++n){var d=e.FileIndex[n],h=e.FullPaths[n];if(d.name=p(h).replace("/",""),d.L=d.R=d.C=-(d.color=1),d.size=d.content?d.content.length:0,d.start=0,d.clsid=d.clsid||m,0===n)d.C=1<i.length?1:-1,d.size=0,d.type=5;else if("/"==h.slice(-1)){for(c=n+1;c<i.length&&f(e.FullPaths[c])!=h;++c);for(d.C=i.length<=c?-1:c,c=n+1;c<i.length&&f(e.FullPaths[c])!=f(h);++c);d.R=i.length<=c?-1:c,d.type=1}else f(e.FullPaths[n+1]||"")==f(h)&&(d.R=n+1),d.type=2}}}function a(e,t){var r=t||{};if("mad"==r.fileType){for(var a=e,M=r||{},n=M.boundary||"SheetJS",o=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],R=a.FullPaths[0],s=R,c=a.FileIndex[0],l=1;l<a.FullPaths.length;++l)if(s=a.FullPaths[l].slice(R.length),(c=a.FileIndex[l]).size&&c.content&&"Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var i=c.content,u=ue&&Buffer.isBuffer(i)?i.toString("binary"):se(i),L=0,B=Math.min(1024,u.length),j=0,d=0;d<=B;++d)32<=(j=u.charCodeAt(d))&&j<128&&++L;i=4*B/5<=L;o.push(n),o.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+s),o.push("Content-Transfer-Encoding: "+(i?"quoted-printable":"base64")),o.push("Content-Type: "+function(e,t){if(e.ctype)return e.ctype;var e=e.name||"",r=e.match(/\.([^\.]+)$/);if(r&&K[r[1]])return K[r[1]];if(t&&(r=(e=t).match(/[\.\\]([^\.\\])+$/))&&K[r[1]])return K[r[1]];return"application/octet-stream"}(c,s)),o.push(""),o.push((i?function(e){e=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){e=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==e.length?"0"+e:e)});"\n"==(e=e.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(e="=0D"+e.slice(1));e=e.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A");for(var t=[],r=e.split("\r\n"),a=0;a<r.length;++a){var n=r[a];if(0==n.length)t.push("");else for(var o=0;o<n.length;){var s=76,c=n.slice(o,o+s);"="==c.charAt(s-1)?s--:"="==c.charAt(s-2)?s-=2:"="==c.charAt(s-3)&&(s-=3),c=n.slice(o,o+s),(o+=s)<n.length&&(c+="="),t.push(c)}}return t.join("\r\n")}:function(e){for(var t=he(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"})(u))}return o.push(n+"--\r\n"),o.join("\r\n")}if($(e),"zip"===r.fileType){var h=e,t=(t=r)||{},f=[],p=[],m=Gr(1),g=t.compression?8:0,y=0,v=0,b=0,w=0,x=0,W=h.FullPaths[0],k=W,S=h.FileIndex[0],_=[],U=0;for(v=1;v<h.FullPaths.length;++v)if(k=h.FullPaths[v].slice(W.length),(S=h.FileIndex[v]).size&&S.content&&"Sh33tJ5"!=k){var z=w,C=Gr(k.length);for(b=0;b<k.length;++b)C._W(1,127&k.charCodeAt(b));C=C.slice(0,C.l),_[x]=yt.buf(S.content,0);var T=S.content;8==g&&(T=function(e){return H?H.deflateRawSync(e):J(e)}(T)),(m=Gr(30))._W(4,67324752),m._W(2,20),m._W(2,y),m._W(2,g),S.mt?function(e,t){var r;r=((t="string"==typeof t?new Date(t):t).getHours()<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e._W(2,r),r=(t.getFullYear()-1980<<4|t.getMonth()+1)<<5|t.getDate(),e._W(2,r)}(m,S.mt):m._W(4,0),m._W(-4,8&y?0:_[x]),m._W(4,8&y?0:T.length),m._W(4,8&y?0:S.content.length),m._W(2,C.length),m._W(2,0),w+=m.length,f.push(m),w+=C.length,f.push(C),w+=T.length,f.push(T),8&y&&((m=Gr(12))._W(-4,_[x]),m._W(4,T.length),m._W(4,S.content.length),w+=m.l,f.push(m)),(m=Gr(46))._W(4,33639248),m._W(2,0),m._W(2,20),m._W(2,y),m._W(2,g),m._W(4,0),m._W(-4,_[x]),m._W(4,T.length),m._W(4,S.content.length),m._W(2,C.length),m._W(2,0),m._W(2,0),m._W(2,0),m._W(2,0),m._W(4,0),m._W(4,z),U+=m.l,p.push(m),U+=C.length,p.push(C),++x}return(m=Gr(22))._W(4,101010256),m._W(2,0),m._W(2,0),m._W(2,x),m._W(2,x),m._W(4,U),m._W(4,w),m._W(2,0),ve([ve(f),ve(p),m])}for(var A=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];n.content&&0<(n=n.content.length)&&(n<4096?t+=n+63>>6:r+=n+511>>9)}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,c=(t+7>>3)+r+o+s,l=c+127>>7,i=l<=109?0:Math.ceil((l-109)/127);l<c+l+i+127>>7;)i=++l<=109?0:Math.ceil((l-109)/127);s=[1,i,l,s,o,r,t,0];return e.FileIndex[0].size=t<<6,s[7]=(e.FileIndex[0].start=s[0]+s[1]+s[2]+s[3]+s[4]+s[5])+(s[6]+7>>3),s}(e),I=Gr(A[7]<<9),E=0,N=0,E=0;E<8;++E)I._W(1,G[E]);for(E=0;E<8;++E)I._W(2,0);for(I._W(2,62),I._W(2,3),I._W(2,65534),I._W(2,9),I._W(2,6),E=0;E<3;++E)I._W(2,0);for(I._W(4,0),I._W(4,A[2]),I._W(4,A[0]+A[1]+A[2]+A[3]-1),I._W(4,0),I._W(4,4096),I._W(4,A[3]?A[0]+A[1]+A[2]-1:oe),I._W(4,A[3]),I._W(-4,A[1]?A[0]-1:oe),I._W(4,A[1]),E=0;E<109;++E)I._W(-4,E<A[2]?A[1]+E:-1);if(A[1])for(N=0;N<A[1];++N){for(;E<236+127*N;++E)I._W(-4,E<A[2]?A[1]+E:-1);I._W(-4,N===A[1]-1?oe:N+1)}function O(e){for(N+=e;E<N-1;++E)I._W(-4,E+1);e&&(++E,I._W(-4,oe))}N=E=0;for(N+=A[1];E<N;++E)I._W(-4,X.DIFSECT);for(N+=A[2];E<N;++E)I._W(-4,X.FATSECT);O(A[3]),O(A[4]);for(var F=0,q=0,D=e.FileIndex[0];F<e.FileIndex.length;++F)!(D=e.FileIndex[F]).content||(q=D.content.length)<4096||(D.start=N,O(q+511>>9));for(O(A[6]+7>>3);511&I.l;)I._W(-4,X.ENDOFCHAIN);for(F=N=E=0;F<e.FileIndex.length;++F)!(D=e.FileIndex[F]).content||!(q=D.content.length)||4096<=q||(D.start=N,O(q+63>>6));for(;511&I.l;)I._W(-4,X.ENDOFCHAIN);for(E=0;E<A[4]<<2;++E){var P=e.FullPaths[E];if(P&&0!==P.length){D=e.FileIndex[E],0===E&&(D.start=D.size?D.start-1:oe);P=0===E&&r.root||D.name;if(32<P.length&&(console.error("Name "+P+" will be truncated to "+P.slice(0,32)),P=P.slice(0,32)),q=2*(P.length+1),I._W(64,P,"utf16le"),I._W(2,q),I._W(1,D.type),I._W(1,D.color),I._W(-4,D.L),I._W(-4,D.R),I._W(-4,D.C),D.clsid)I._W(16,D.clsid,"hex");else for(F=0;F<4;++F)I._W(4,0);I._W(4,D.state||0),I._W(4,0),I._W(4,0),I._W(4,0),I._W(4,0),I._W(4,D.start),I._W(4,D.size),I._W(4,0)}else{for(F=0;F<17;++F)I._W(4,0);for(F=0;F<3;++F)I._W(4,-1);for(F=0;F<12;++F)I._W(4,0)}}for(E=1;E<e.FileIndex.length;++E)if(4096<=(D=e.FileIndex[E]).size)if(I.l=D.start+1<<9,ue&&Buffer.isBuffer(D.content))D.content.copy(I,I.l,0,D.size),I.l+=D.size+511&-512;else{for(F=0;F<D.size;++F)I._W(1,D.content[F]);for(;511&F;++F)I._W(1,0)}for(E=1;E<e.FileIndex.length;++E)if(0<(D=e.FileIndex[E]).size&&D.size<4096)if(ue&&Buffer.isBuffer(D.content))D.content.copy(I,I.l,0,D.size),I.l+=D.size+63&-64;else{for(F=0;F<D.size;++F)I._W(1,D.content[F]);for(;63&F;++F)I._W(1,0)}if(ue)I.l=I.length;else for(;I.l<I.length;)I._W(1,0);return I}e.version="1.2.2";var H,ne=64,oe=-2,le="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],m="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:oe,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:m,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];for(var t,C="undefined"!=typeof Uint8Array,A=C?new Uint8Array(256):[],r=0;r<256;++r)A[r]=255&((t=139536&((t=r)<<1|t<<11)|558144&(t<<5|t<<15))>>16|t>>8|t);function I(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=5?0:e[1+t]<<8))>>>r&7}function F(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=3?0:e[1+t]<<8))>>>r&31}function q(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=1?0:e[1+t]<<8))>>>r&127}function g(e,t,r){var a=7&t,t=t>>>3,n=(1<<r)-1,o=e[t]>>>a;return r<8-a||(o|=e[1+t]<<8-a,r<16-a)||(o|=e[2+t]<<16-a,r<24-a)||(o|=e[3+t]<<24-a),o&n}function D(e,t,r){var a=7&t,n=t>>>3;return a<=5?e[n]|=(7&r)<<a:(e[n]|=r<<a&255,e[1+n]=(7&r)>>8-a),t+3}function _(e,t,r){var a=t>>>3;return e[a]|=255&(r<<=7&t),e[1+a]=r>>>=8,t+8}function P(e,t,r){var a=t>>>3;e[a]|=255&(r<<=7&t),e[1+a]=255&(r>>>=8),e[2+a]=r>>>8}function y(e,t){var r=e.length,a=t<2*r?2*r:t+5,n=0;if(!(t<=r)){if(ue){var o=ge(a);if(e.copy)e.copy(o);else for(;n<e.length;++n)o[n]=e[n];return o}if(C){var s=new Uint8Array(a);if(s.set)s.set(e);else for(;n<r;++n)s[n]=e[n];return s}e.length=a}return e}function E(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function N(e,t,r){for(var a,n=1,o=0,s=0,c=0,l=e.length,i=C?new Uint16Array(32):E(32),o=0;o<32;++o)i[o]=0;for(o=l;o<r;++o)e[o]=0;var l=e.length,u=C?new Uint16Array(l):E(l);for(o=0;o<l;++o)i[a=e[o]]++,n<a&&(n=a),u[o]=0;for(i[0]=0,o=1;o<=n;++o)i[o+16]=c=c+i[o-1]<<1;for(o=0;o<l;++o)0!=(c=e[o])&&(u[o]=i[c+16]++);var d,h,f,p;for(o=0;o<l;++o)if(0!=(d=e[o]))for(h=u[o],f=n,p=void 0,p=A[255&h],c=(f<=8?p>>>8-f:(p=p<<8|A[h>>8&255],f<=16?p>>>16-f:(p<<8|A[h>>16&255])>>>24-f))>>n-d,s=(1<<n+4-d)-1;0<=s;--s)t[c|s<<d]=15&d|o<<4;return n}var v=C?new Uint16Array(512):E(512),b=C?new Uint16Array(32):E(32);if(!C){for(var c=0;c<512;++c)v[c]=0;for(c=0;c<32;++c)b[c]=0}for(var u=[],l=0;l<32;l++)u.push(5);N(u,b,32);for(var i=[],l=0;l<=143;l++)i.push(8);for(;l<=255;l++)i.push(9);for(;l<=279;l++)i.push(7);for(;l<=287;l++)i.push(8);N(i,v,288);var d=function(){for(var w=C?new Uint8Array(32768):[],e=0,t=0;e<S.length-1;++e)for(;t<S[e+1];++t)w[t]=e;for(;t<32768;++t)w[t]=29;for(var x=C?new Uint8Array(259):[],e=0,t=0;e<k.length-1;++e)for(;t<k[e+1];++t)x[t]=e;return function(e,t){if(e.length<8){for(var r=e,a=t,n=0;n<r.length;){var o=Math.min(65535,r.length-n),s=n+o==r.length;for(a._W(1,+s),a._W(2,o),a._W(2,65535&~o);0<o--;)a[a.l++]=r[n++]}return a.l}for(var c,l=e,i=t,u=0,d=0,h=C?new Uint16Array(32768):[];d<l.length;){var f=Math.min(65535,l.length-d);if(f<10){for(7&(u=D(i,u,+!(d+f!=l.length)))&&(u+=8-(7&u)),i.l=u/8|0,i._W(2,f),i._W(2,65535&~f);0<f--;)i[i.l++]=l[d++];u=8*i.l}else{for(var u=D(i,u,+!(d+f!=l.length)+2),p=0;0<f--;){var m=l[d],p=32767&(p<<5^m),g=-1,y=0;if((g=h[p])&&(d<(g|=-32768&d)&&(g-=32768),g<d))for(;l[g+y]==l[d+y]&&y<250;)++y;if(2<y){(m=x[y])<=22?u=_(i,u,A[m+1]>>1)-1:(_(i,u,3),_(i,u+=5,A[m-23]>>5),u+=3);var v=m<8?0:m-4>>2,v=(0<v&&(P(i,u,y-k[m]),u+=v),m=w[d-g],u=_(i,u,A[m]>>3),u-=3,m<4?0:m-2>>1);0<v&&(P(i,u,d-g-S[m]),u+=v);for(var b=0;b<y;++b)h[p]=32767&d,p=32767&(p<<5^l[d]),++d;f-=y-1}else m<=143?m+=48:(v=1,i[(c=u)>>>3]|=v=(1&v)<<(7&c),u=c+1),u=_(i,u,A[m]),h[p]=32767&d,++d}u=_(i,u,0)-1}}return i.l=(u+7)/8|0,i.l}}();function J(e){var t=Gr(50+Math.floor(1.1*e.length)),e=d(e,t);return t.slice(0,e)}var M=C?new Uint16Array(32768):E(32768),R=C?new Uint16Array(32768):E(32768),L=C?new Uint16Array(128):E(128),B=1,j=1;function h(e,t){if(3==e[0]&&!(3&e[1]))return[me(t),2];for(var r=0,a=0,n=ge(t||1<<18),o=0,s=n.length>>>0,c=0,l=0;0==(1&a);)if(a=I(e,r),r+=3,a>>>1==0){7&r&&(r+=8-(7&r));var i=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,0<i)for(!t&&s<o+i&&(s=(n=y(n,o+i)).length);0<i--;)n[o++]=e[r>>>3],r+=8}else for(l=a>>1==1?(c=9,5):(r=function(e,t){for(var r,a,n,o=F(e,t)+257,s=F(e,t+=5)+1,c=(a=t+=5,n=7&t,4+(((r=e)[a=t>>>3]|(n<=4?0:r[1+a]<<8))>>>n&15)),l=(t+=4,0),i=C?new Uint8Array(19):E(19),u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=1,h=C?new Uint8Array(8):E(8),f=C?new Uint8Array(8):E(8),p=i.length,m=0;m<c;++m)i[O[m]]=l=I(e,t),d<l&&(d=l),h[l]++,t+=3;var g=0;for(h[0]=0,m=1;m<=d;++m)f[m]=g=g+h[m-1]<<1;for(m=0;m<p;++m)0!=(g=i[m])&&(u[m]=f[g]++);for(var y,m=0;m<p;++m)if(0!=(y=i[m]))for(var g=A[u[m]]>>8-y,v=(1<<7-y)-1;0<=v;--v)L[g|v<<y]=7&y|m<<3;for(var b,w,x,k=[],d=1;k.length<o+s;)switch(g=L[q(e,t)],t+=7&g,g>>>=3){case 16:for(l=3+(x=void 0,x=7&(w=t),((b=e)[w=t>>>3]|(x<=6?0:b[1+w]<<8))>>>x&3),t+=2,g=k[k.length-1];0<l--;)k.push(g);break;case 17:for(l=3+I(e,t),t+=3;0<l--;)k.push(0);break;case 18:for(l=11+q(e,t),t+=7;0<l--;)k.push(0);break;default:k.push(g),d<g&&(d=g)}var S=k.slice(0,o),_=k.slice(o);for(m=o;m<286;++m)S[m]=0;for(m=s;m<30;++m)_[m]=0;return B=N(S,M,286),j=N(_,R,30),t}(e,r),c=B,j);;){!t&&s<o+32767&&(s=(n=y(n,o+32767)).length);var u=g(e,r,c),d=(a>>>1==1?v:M)[u];if(r+=15&d,0==((d>>>=4)>>>8&255))n[o++]=d;else{if(256==d)break;var h=(d-=257)<8?0:d-4>>2,f=(5<h&&(h=0),o+k[d]),h=(0<h&&(f+=g(e,r,h),r+=h),u=g(e,r,l),r+=15&(d=(a>>>1==1?b:R)[u]),(d>>>=4)<4?0:d-2>>1),p=S[d];for(0<h&&(p+=g(e,r,h),r+=h),!t&&s<f&&(s=(n=y(n,f+100)).length);o<f;)n[o]=n[o-p],++o}}return t?[n,r+7>>>3]:[n.slice(0,o),r+7>>>3]}function W(e,t){t=h(e.slice(e.l||0),t);return e.l+=t[1],t[0]}function U(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function ie(e,t){for(var r=e,a=(de(r,0),{FileIndex:[],FullPaths:[]}),n=(ae(a,{root:t.root}),r.length-4);(80!=r[n]||75!=r[n+1]||5!=r[n+2]||6!=r[n+3])&&0<=n;)--n;r.l=n+4,r.l+=4;var o=r._R(2),e=(r.l+=6,r._R(4));for(r.l=e,n=0;n<o;++n){r.l+=20;var s=r._R(4),c=r._R(4),l=r._R(2),i=r._R(2),u=r._R(2),d=(r.l+=8,r._R(4)),h=T(r.slice(r.l+l,r.l+l+i)),l=(r.l+=l+i+u,r.l),f=(r.l=d+4,_=C=S=k=x=w=b=v=y=g=m=p=d=u=i=f=void 0,r),i=s,u=c,d=a,p=h,m=(f.l+=2,f._R(2)),g=f._R(2),y=function(e){var t=65535&e._R(2),e=65535&e._R(2),r=new Date,a=31&e,n=15&(e>>>=5),e=(e>>>=4,r.setMilliseconds(0),r.setFullYear(1980+e),r.setMonth(n-1),r.setDate(a),31&t),n=63&(t>>>=5);return r.setHours(t>>>=6),r.setMinutes(n),r.setSeconds(e<<1),r}(f);if(8257&m)throw new Error("Unsupported ZIP encryption");f._R(4);for(var v=f._R(4),b=f._R(4),w=f._R(2),x=f._R(2),k="",S=0;S<w;++S)k+=String.fromCharCode(f[f.l++]);x&&(((C=T(f.slice(f.l,f.l+x)))[21589]||{}).mt&&(y=C[21589].mt),((p||{})[21589]||{}).mt)&&(y=p[21589].mt),f.l+=x;var _=f.slice(f.l,f.l+v);switch(g){case 8:_=function(e,t){var r,a;return H?(a=(r=new H.InflateRaw)._processChunk(e.slice(e.l),r._finishFlushFlag),e.l+=r.bytesRead,a):W(e,t)}(f,b);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+g)}var C=!1;8&m&&(134695760==f._R(4)&&(f._R(4),C=!0),v=f._R(4),b=f._R(4)),v!=i&&U(C,"Bad compressed size: "+i+" != "+v),b!=u&&U(C,"Bad uncompressed size: "+u+" != "+b),ce(d,k,_,{unsafe:!0,mt:y}),r.l=l}return a}var K={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ce(e,t,r,a){var n,o=a&&a.unsafe,s=(o||ae(e),!o&&z.find(e,t));return s||(n=e.FullPaths[0],n=t.slice(0,n.length)==n?t:("/"!=n.slice(-1)&&(n+="/"),(n+t).replace("//","/")),s={name:p(t),type:2},e.FileIndex.push(s),e.FullPaths.push(n),o)||z.utils.cfb_gc(e),s.content=r,s.size=r?r.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct)&&(s.ct=a.ct),s}return e.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),n=!1,o=(47===t.charCodeAt(0)?(n=!0,t=r[0].slice(0,-1)+t):n=-1!==t.indexOf("/"),t.toUpperCase()),s=(!0===n?r:a).indexOf(o);if(-1!==s)return e.FileIndex[s];var c=!o.match(we),o=o.replace(be,"");for(c&&(o=o.replace(we,"!")),s=0;s<r.length;++s){if((c?r[s].replace(we,"!"):r[s]).replace(be,"")==o)return e.FileIndex[s];if((c?a[s].replace(we,"!"):a[s]).replace(be,"")==o)return e.FileIndex[s]}return null},e.read=function(e,t){var r,a=t&&t.type;switch(a||ue&&Buffer.isBuffer(e)&&(a="buffer"),a||"base64"){case"file":return r=t,o(),s(n.readFileSync(e),r);case"base64":return s(ye(fe(e)),t);case"binary":return s(ye(e),t)}return s(e,t)},e.parse=s,e.write=function(e,t){var r=a(e,t);switch(t&&t.type||"buffer"){case"file":return o(),n.writeFileSync(t.filename,r),r;case"binary":return"string"==typeof r?r:se(r);case"base64":return he("string"==typeof r?r:se(r));case"buffer":if(ue)return Buffer.isBuffer(r)?r:pe(r);case"array":return"string"==typeof r?ye(r):r}return r},e.writeFile=function(e,t,r){o(),e=a(e,r),n.writeFileSync(t,e)},e.utils={cfb_new:function(e){var t={};return ae(t,e),t},cfb_add:ce,cfb_del:function(e,t){ae(e);var r=z.find(e,t);if(r)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1},cfb_mov:function(e,t,r){ae(e);var a=z.find(e,t);if(a)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==a)return e.FileIndex[n].name=p(r),e.FullPaths[n]=r,!0;return!1},cfb_gc:function(e){$(e,!0)},ReadShift:Ur,CheckField:Kr,prep_blob:de,bconcat:ve,use_zlib:function(e){try{var t=new e.InflateRaw;if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");H=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:J,_inflateRaw:W,consts:X},e}();if("undefined"!=typeof require)try{gt=void 0}catch(e){}function vt(e){if("string"==typeof e)return m(e);if(Array.isArray(e)){var t=e;if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}return e}function bt(e,t,r){if(void 0!==gt&&gt.writeFileSync)return r?gt.writeFileSync(e,t,r):gt.writeFileSync(e,t);if("undefined"!=typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=m(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a="utf8"==r?rr(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(a,e);if("undefined"!=typeof Blob){a=new Blob([vt(a)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!=typeof saveAs)return saveAs(a,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(a);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});a=document.createElement("a");if(null!=a.download)return a.download=e,a.href=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=g(t)),o.write(t),o.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function O(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function wt(e){for(var t=[],r=O(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function xt(e){for(var t=[],r=O(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}var kt=new Date(1899,11,30,0,0,0);function H(e,t){var r=e.getTime(),t=(t&&(r-=1263168e5),kt.getTime()+6e4*(e.getTimezoneOffset()-kt.getTimezoneOffset()));return(r-t)/864e5}var t=new Date,St=kt.getTime()+6e4*(t.getTimezoneOffset()-kt.getTimezoneOffset()),_t=t.getTimezoneOffset();function Ct(e){var t=new Date;return t.setTime(24*e*60*60*1e3+St),t.getTimezoneOffset()!==_t&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-_t)),t}var r=new Date("2017-02-19T19:06:09.000Z"),Tt=isNaN(r.getFullYear())?new Date("2/19/17"):r,At=2017==Tt.getFullYear();function X(e,t){var r=new Date(e);return At?(0<t?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r):e instanceof Date?e:1917!=Tt.getFullYear()||isNaN(r.getFullYear())?(t=e.match(/\d+/g)||["2017","2","19","0","0","0"],t=new Date(+t[0],+t[1]-1,+t[2],+t[3]||0,+t[4]||0,+t[5]||0),-1<e.indexOf("Z")?new Date(t.getTime()-60*t.getTimezoneOffset()*1e3):t):(t=r.getFullYear(),-1<e.indexOf(""+t)||r.setFullYear(r.getFullYear()+100),r)}function It(e,t){if(ue&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return rr(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return rr(s(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return rr(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return rr(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return r[e]||e})}catch(e){}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function K(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t,r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=K(e[t]));return r}function k(e,t){for(var r="";r.length<t;)r+=e;return r}function Et(e){var r,t=Number(e);return isNaN(t)?!/\d/.test(e)||(r=1,e=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""}),isNaN(t=Number(e))&&(e=e.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(e))))?t:t/r:isFinite(t)?t:NaN}var Nt=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ot(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&-1==Nt.indexOf(s))return r}else if(s.match(/[a-z]/))return r;return a<0||8099<a||(!(0<n||1<o)||101==a)&&e.match(/[^-0-9:,\/\\]/)?r:t}"abacaba".split(/(:?b)/i).length;function Ft(e){return e?e.content&&e.type?It(e.content,!0):e.data?l(e.data):e.asNodeBuffer&&ue?l(e.asNodeBuffer().toString("binary")):e.asBinary?l(e.asBinary()):e._data&&e._data.getContent?l(It(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function qt(e){var t;return e?e.data?o(e.data):e.asNodeBuffer&&ue?e.asNodeBuffer():e._data&&e._data.getContent?"string"==typeof(t=e._data.getContent())?o(t):Array.prototype.slice.call(t):e.content&&e.type?e.content:null:null}function R(e,t){for(var r=e.FullPaths||O(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),o=0;o<r.length;++o){var s=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function Dt(e,t){e=R(e,t);if(null==e)throw new Error("Cannot find file "+t+" in zip");return e}function L(e,t,r){if(!r)return((r=Dt(e,t))&&".bin"===r.name.slice(-4)?qt:Ft)(r);if(!t)return null;try{return L(e,t)}catch(e){return null}}function B(e,t,r){if(!r)return Ft(Dt(e,t));if(!t)return null;try{return B(e,t)}catch(e){return null}}function Pt(e){for(var t=e.FullPaths||O(e.files),r=[],a=0;a<t.length;++a)"/"!=t[a].slice(-1)&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function j(e,t,r){if(e.FullPaths){var a;if("string"==typeof r)return a=(ue?pe:function(e){for(var t=[],r=0,a=e.length+250,n=me(e.length+255),o=0;o<e.length;++o){var s,c=e.charCodeAt(o);c<128?n[r++]=c:c<2048?(n[r++]=192|c>>6&31,n[r++]=128|63&c):55296<=c&&c<57344?(c=64+(1023&c),s=1023&e.charCodeAt(++o),n[r++]=240|c>>8&7,n[r++]=128|c>>2&63,n[r++]=128|s>>6&15|(3&c)<<4,n[r++]=128|63&s):(n[r++]=224|c>>12&15,n[r++]=128|c>>6&63,n[r++]=128|63&c),a<r&&(t.push(n.slice(0,r)),r=0,n=me(65535),a=65530)}return t.push(n.slice(0,r)),ve(t)})(r),z.utils.cfb_add(e,t,a);z.utils.cfb_add(e,t,r)}else e.file(t,r)}function Mt(){return z.utils.cfb_new()}function Rt(e,t){if("/"==e.charAt(0))return e.slice(1);for(var r=t.split("/"),a=("/"!=t.slice(-1)&&r.pop(),e.split("/"));0!==a.length;){var n=a.shift();".."===n?r.pop():"."!==n&&r.push(n)}return r.join("/")}var S='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Lt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,t=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,U=S.match(t)?t:/<[^>]*>/g,Bt=/<\w*:/,jt=/<(\/?)\w+:/;function G(e,t,r){for(var a={},n=0,o=0;n!==e.length&&32!==(o=e.charCodeAt(n))&&10!==o&&13!==o;++n);if(t||(a[0]=e.slice(0,n)),n!==e.length){var s,c,l=e.match(Lt),i=0,u=0,d="",h="";if(l)for(u=0;u!=l.length;++u){for(h=l[u],o=0;o!=h.length&&61!==h.charCodeAt(o);++o);for(d=h.slice(0,o).trim();32==h.charCodeAt(o+1);)++o;for(s=34==(n=h.charCodeAt(o+1))||39==n?1:0,s=h.slice(o+1+s,h.length-s),i=0;i!=d.length&&58!==d.charCodeAt(i);++i);i===d.length?(a[d=0<d.indexOf("_")?d.slice(0,d.indexOf("_")):d]=s,r||(a[d.toLowerCase()]=s)):a[c=(5===i&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(i+1)]&&"ext"==d.slice(i-3,i)||(a[c]=s,r)||(a[c.toLowerCase()]=s)}}return a}function Wt(e){return e.replace(jt,"<$1")}var Ut,zt,$t={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ht=wt($t),J=(Ut=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,zt=/_x([\da-fA-F]{4})_/gi,function(e,t){e=function e(t){var r,t=t+"",a=t.indexOf("<![CDATA[");return-1==a?t.replace(Ut,function(e,t){return $t[e]||String.fromCharCode(parseInt(t,-1<e.indexOf("x")?16:10))||e}).replace(zt,function(e,t){return String.fromCharCode(parseInt(t,16))}):(r=t.indexOf("]]>"),e(t.slice(0,a))+t.slice(a+9,r)+e(t.slice(r+3)))}(e);return t?e.replace(/\r\n/g,"\n"):e}),Xt=/[&<>'"]/g,Kt=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function _(e){return(e+"").replace(Xt,function(e){return Ht[e]}).replace(Kt,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}var Gt=/[\u0000-\u001f]/g;function Jt(e){return(e+"").replace(Xt,function(e){return Ht[e]}).replace(/\n/g,"<br/>").replace(Gt,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function V(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Vt(e){for(var t,r,a,n="",o=0,s=0;o<e.length;)(a=e.charCodeAt(o++))<128?n+=String.fromCharCode(a):(t=e.charCodeAt(o++),191<a&&a<224?(s=(31&a)<<6,s|=63&t,n+=String.fromCharCode(s)):(r=e.charCodeAt(o++),a<240?n+=String.fromCharCode((15&a)<<12|(63&t)<<6|63&r):(a=((7&a)<<18|(63&t)<<12|(63&r)<<6|63&(s=e.charCodeAt(o++)))-65536,n=(n+=String.fromCharCode(55296+(a>>>10&1023)))+String.fromCharCode(56320+(1023&a)))));return n}function Yt(e){for(var t,r,a=me(2*e.length),n=1,o=0,s=0,c=0;c<e.length;c+=n)n=1,(r=e.charCodeAt(c))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(c+1)),n=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(c+1))+(63&e.charCodeAt(c+2)),n=3):(n=4,t=262144*(7&r)+4096*(63&e.charCodeAt(c+1))+64*(63&e.charCodeAt(c+2))+(63&e.charCodeAt(c+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(a[o++]=255&s,a[o++]=s>>>8,s=0),a[o++]=t%256,a[o++]=t>>>8;return a.slice(0,o).toString("ucs2")}function Zt(e){return pe(e,"binary").toString("utf8")}var Qt,er,tr,r="foo bar bazâð£",Y=ue&&(Zt(r)==Vt(r)?Zt:Yt(r)==Vt(r)&&Yt)||Vt,rr=ue?function(e){return pe(e,"utf8").toString("binary")}:function(e){for(var t,r=[],a=0,n=0;a<e.length;)switch(!0){case(n=e.charCodeAt(a++))<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(63&n)));break;case 55296<=n&&n<57344:n-=55296,t=e.charCodeAt(a++)-56320+(n<<10),r.push(String.fromCharCode(240+(t>>18&7))),r.push(String.fromCharCode(144+(t>>12&63))),r.push(String.fromCharCode(128+(t>>6&63))),r.push(String.fromCharCode(128+(63&t)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(63&n)))}return r.join("")},ar=(Qt={},function(e,t){var r=e+"|"+(t||"");return Qt[r]||(Qt[r]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||""))}),nr=(er=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<er.length;++r)t=t.replace(er[r][0],er[r][1]);return t}),or=(tr={},function(e){return void 0!==tr[e]?tr[e]:tr[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}),sr=/<\/?(?:vt:)?variant>/g,cr=/<(?:vt:)([^>]*)>([\s\S]*)</;function lr(e,t){var r=G(e),e=e.match(or(r.baseType))||[],a=[];if(e.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+e.length+" != "+r.size)}else e.forEach(function(e){e=e.replace(sr,"").match(cr);e&&a.push({v:Y(e[2]),t:e[1]})});return a}var ir=/(^\s|\s$|\n)/;function ur(e,t){return"<"+e+(t.match(ir)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function dr(t){return O(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function C(e,t,r){return"<"+e+(null!=r?dr(r):"")+(null!=t?(t.match(ir)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function hr(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function fr(e){if(ue&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return Y(g(y(e)));throw new Error("Bad input format: expected Buffer or string")}var pr=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Z={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],gr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yr(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,n=e[0][r].length;a<n;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t}function vr(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Lr(e,n)));return a.join("").replace(be,"")}function br(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")}function wr(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Rr(e,n)));return a.join("")}function xr(e,t){var r=Q(e,t);return 0<r?Nr(e,t+4,t+4+r-1):""}function kr(e,t){var r=Q(e,t);return 0<r?Nr(e,t+4,t+4+r-1):""}function Sr(e,t){var r=2*Q(e,t);return 0<r?Nr(e,t+4,t+4+r-1):""}function _r(e,t){var r=Q(e,t);return 0<r?Ir(e,t+4,t+4+r):""}function Cr(e,t){var r=Q(e,t);return 0<r?Nr(e,t+4,t+4+r):""}function Tr(e,t){for(var r=e,a=t,e=1-2*(r[a+7]>>>7),t=((127&r[a+7])<<4)+(r[a+6]>>>4&15),n=15&r[a+6],o=5;0<=o;--o)n=256*n+r[a+o];return 2047==t?0==n?1/0*e:NaN:(0==t?t=-1022:(t-=1023,n+=Math.pow(2,52)),e*Math.pow(2,t-52)*n)}var Ar=ue?function(e){return 0<e[0].length&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:pe(e)})):yr(e)}:yr,Ir=ue?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(be,""):vr(e,t,r)}:vr,Er=ue?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):br(e,t,r)}:br,Nr=ue?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):wr(e,t,r)}:wr,Or=xr,Fr=kr,qr=Sr,Dr=_r,Pr=Cr,Mr=Tr;ue&&(Or=function(e,t){var r;return Buffer.isBuffer(e)?0<(r=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+r-1):"":xr(e,t)},Fr=function(e,t){var r;return Buffer.isBuffer(e)?0<(r=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+r-1):"":kr(e,t)},qr=function(e,t){var r;return Buffer.isBuffer(e)?(r=2*e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+r-1)):Sr(e,t)},Dr=function(e,t){var r;return Buffer.isBuffer(e)?(r=e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+r)):_r(e,t)},Pr=function(e,t){var r;return Buffer.isBuffer(e)?(r=e.readUInt32LE(t),e.toString("utf8",t+4,t+4+r)):Cr(e,t)},Mr=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Tr(e,t)}),"undefined"!=typeof $cptable&&(Ir=function(e,t,r){return $cptable.utils.decode(1200,e.slice(t,r)).replace(be,"")},Nr=function(e,t,r){return $cptable.utils.decode(65001,e.slice(t,r))},Or=function(e,t){var r=Q(e,t);return 0<r?$cptable.utils.decode(E,e.slice(t+4,t+4+r-1)):""},Fr=function(e,t){var r=Q(e,t);return 0<r?$cptable.utils.decode(u,e.slice(t+4,t+4+r-1)):""},qr=function(e,t){var r=2*Q(e,t);return 0<r?$cptable.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Dr=function(e,t){var r=Q(e,t);return 0<r?$cptable.utils.decode(1200,e.slice(t+4,t+4+r)):""},Pr=function(e,t){var r=Q(e,t);return 0<r?$cptable.utils.decode(65001,e.slice(t+4,t+4+r)):""});var Rr=function(e,t){return e[t]},Lr=function(e,t){return 256*e[t+1]+e[t]},Br=function(e,t){e=256*e[t+1]+e[t];return e<32768?e:-1*(65535-e+1)},Q=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jr=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Wr=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ur(e,t){var r,a,n,o,s,c,l="",i=[];switch(t){case"dbcs":if(c=this.l,ue&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Lr(this,c)),c+=2;e*=2;break;case"utf8":l=Nr(this,this.l,this.l+e);break;case"utf16le":l=Ir(this,this.l,this.l+(e*=2));break;case"wstr":if("undefined"==typeof $cptable)return Ur.call(this,e,"dbcs");l=$cptable.utils.decode(u,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Or(this,this.l),e=4+Q(this,this.l);break;case"lpstr-cp":l=Fr(this,this.l),e=4+Q(this,this.l);break;case"lpwstr":l=qr(this,this.l),e=4+2*Q(this,this.l);break;case"lpp4":e=4+Q(this,this.l),l=Dr(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Q(this,this.l),l=Pr(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(n=Rr(this,this.l+e++));)i.push(d(n));l=i.join("");break;case"_wstr":for(e=0,l="";0!==(n=Lr(this,this.l+e));)i.push(d(n)),e+=2;e+=2,l=i.join("");break;case"dbcs-cont":for(l="",c=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(c))return n=Rr(this,c),this.l=c+1,o=Ur.call(this,e-s,n?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(d(Lr(this,c))),c+=2}l=i.join(""),e*=2;break;case"cpstr":if("undefined"!=typeof $cptable){l=$cptable.utils.decode(u,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",c=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(c))return n=Rr(this,c),this.l=c+1,o=Ur.call(this,e-s,n?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(d(Rr(this,c))),c+=1}l=i.join("");break;default:switch(e){case 1:return r=Rr(this,this.l),this.l++,r;case 2:return r=("i"===t?Br:Lr)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(r=(0<e?jr:Wr)(this,this.l),this.l+=4,r):(a=Q(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return a=8==e?Mr(this,this.l):Mr([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:l=Er(this,this.l,e)}}return this.l+=e,l}var zr=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},$r=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Hr=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Xr(e,t,r){var a=0,n=0;if("dbcs"===r){for(n=0;n!=t.length;++n)Hr(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if("sbcs"===r){if("undefined"!=typeof $cptable&&874==E)for(n=0;n!=t.length;++n){var o=$cptable.utils.encode(E,t.charAt(n));this[this.l+n]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);a=t.length}else{if("hex"===r){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===r){for(var s=Math.min(this.l+e,this.length),n=0;n<Math.min(t.length,e);++n){var c=t.charCodeAt(n);this[this.l++]=255&c,this[this.l++]=c>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8);break;case 3:a=3,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8),this[this.l+2]=255&(t>>>=8);break;case 4:a=4,zr(this,t,this.l);break;case 8:if(a=8,"f"===r){var l=this,i=t,u=this.l,d=(i<0||1/i==-1/0?1:0)<<7,h=0,f=0,p=d?-i:i;isFinite(p)?0==p?h=f=0:(h=Math.floor(Math.log(p)/Math.LN2),f=p*Math.pow(2,52-h),h<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?h=-1022:(f-=Math.pow(2,52),h+=1023)):(h=2047,f=isNaN(i)?26985:0);for(var m=0;m<=5;++m,f/=256)l[u+m]=255&f;l[u+6]=(15&h)<<4|15&f,l[u+7]=h>>4|d;break}case 16:break;case-4:a=4,$r(this,t,this.l)}}return this.l+=a,this}function Kr(e,t){var r=Er(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function de(e,t){e.l=t,e._R=Ur,e.chk=Kr,e._W=Xr}function Gr(e){e=me(e);return de(e,0),e}function Jr(){function t(e){return de(e=Gr(e),0),e}function r(){o&&(o.length>o.l&&((o=o.slice(0,o.l)).l=o.length),0<o.length&&e.push(o),o=null)}function a(e){return o&&e<o.length-o.l?o:(r(),o=t(Math.max(e+1,n)))}var e=[],n=ue?256:2048,o=t(n);return{next:a,push:function(e){r(),null==(o=e).l&&(o.l=o.length),a(n)},end:function(){return r(),ve(e)},_bufs:e}}function Vr(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Yr(e){return""+(e+1)}function Zr(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Qr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ee(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);48<=n&&n<=57?t=10*t+(n-48):65<=n&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function te(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ea(e){var t=e.indexOf(":");return-1==t?{s:ee(e),e:ee(e)}:{s:ee(e.slice(0,t)),e:ee(e.slice(t+1))}}function re(e,t){return void 0===t||"number"==typeof t?re(e.s,e.e):(e="string"!=typeof e?te(e):e)==(t="string"!=typeof t?te(t):t)?e:e+":"+t}function ae(e){for(var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,o=e.length,r=0;a<o&&!((n=e.charCodeAt(a)-64)<1||26<n);++a)r=26*r+n;for(t.s.c=--r,r=0;a<o&&!((n=e.charCodeAt(a)-48)<0||9<n);++a)r=10*r+n;if(t.s.r=--r,a===o||10!=n)t.e.c=t.s.c,t.e.r=t.s.r;else{for(++a,r=0;a!=o&&!((n=e.charCodeAt(a)-64)<1||26<n);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=o&&!((n=e.charCodeAt(a)-48)<0||9<n);++a)r=10*r+n;t.e.r=--r}return t}function ta(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Xe(e.z,r?H(t):t)}catch(e){}try{return e.w=Xe((e.XF||{}).numFmtId||(r?14:0),r?H(t):t)}catch(e){return""+t}}function ra(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?ca[e.v]||e.v:ta(e,null==t?e.v:t))}function aa(e,t){var t=t&&t.sheet?t.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function na(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,o=(null!=ne&&null==n&&(n=ne),e||(n?[]:{})),s=0,c=0,l=(o&&null!=a.origin&&("number"==typeof a.origin?s=a.origin:(s=(r="string"==typeof a.origin?ee(a.origin):a.origin).r,c=r.c),o["!ref"]||(o["!ref"]="A1:A1")),{s:{c:1e7,r:1e7},e:{c:0,r:0}});o["!ref"]&&(e=ae(o["!ref"]),l.s.c=e.s.c,l.s.r=e.s.r,l.e.c=Math.max(l.e.c,e.e.c),l.e.r=Math.max(l.e.r,e.e.r),-1==s)&&(l.e.r=s=e.e.r+1);for(var i=0;i!=t.length;++i)if(t[i]){if(!Array.isArray(t[i]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[i].length;++u)if(void 0!==t[i][u]){var d={v:t[i][u]},h=s+i,f=c+u;if(l.s.r>h&&(l.s.r=h),l.s.c>f&&(l.s.c=f),l.e.r<h&&(l.e.r=h),l.e.c<f&&(l.e.c=f),!t[i][u]||"object"!=typeof t[i][u]||Array.isArray(t[i][u])||t[i][u]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[i][u][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(a.nullError)d.t="e",d.v=0;else{if(!a.sheetStubs)continue;d.t="z"}else"number"==typeof d.v?d.t="n":"boolean"==typeof d.v?d.t="b":d.v instanceof Date?(d.z=a.dateNF||W[14],a.cellDates?(d.t="d",d.w=Xe(d.z,H(d.v))):(d.t="n",d.v=H(d.v),d.w=Xe(d.z,d.v))):d.t="s";else d=t[i][u];n?(o[h]||(o[h]=[]),o[h][f]&&o[h][f].z&&(d.z=o[h][f].z),o[h][f]=d):(o[f=te({c:f,r:h})]&&o[f].z&&(d.z=o[f].z),o[f]=d)}}return l.s.c<1e7&&(o["!ref"]=re(l)),o}function oa(e,t){return na(null,e,t)}var sa=K([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),ca={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},la={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ia={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ua={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function da(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ha(r,a){function e(e){r[e]&&0<r[e].length&&(o=r[e][0],c[c.length]=C("Override",null,{PartName:("/"==o[0]?"":"/")+o,ContentType:ua[e][a.bookType]||ua[e].xlsx}))}function t(t){(r[t]||[]).forEach(function(e){c[c.length]=C("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ua[t][a.bookType]||ua[t].xlsx})})}function n(t){(r[t]||[]).forEach(function(e){c[c.length]=C("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:s[t][0]})})}var o,s=function(e){for(var t=[],r=O(e),a=0;a!==r.length;++a)null==t[e[r[a]]]&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}(ia),c=[];c[c.length]=S,c[c.length]=C("Types",null,{xmlns:Z.CT,"xmlns:xsd":Z.xsd,"xmlns:xsi":Z.xsi}),c=c.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return C("Default",null,{Extension:e[0],ContentType:e[1]})}));return e("workbooks"),t("sheets"),t("charts"),n("themes"),["strs","styles"].forEach(e),["coreprops","extprops","custprops"].forEach(n),n("vba"),n("comments"),n("threadedcomments"),n("drawings"),t("metadata"),n("people"),2<c.length&&(c[c.length]="</Types>",c[1]=c[1].replace("/>",">")),c.join("")}var I={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fa(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function pa(e,a){var n,o={"!id":{}};return e&&("/"!==a.charAt(0)&&(a="/"+a),n={},(e.match(U)||[]).forEach(function(e){var t,r,e=G(e);"<Relationship"===e[0]&&((t={}).Type=e.Type,t.Target=e.Target,t.Id=e.Id,e.TargetMode&&(t.TargetMode=e.TargetMode),r="External"===e.TargetMode?e.Target:Rt(e.Target,a),n[e.Id]=o[r]=t)}),o["!id"]=n),o}function ma(t){var r=[S,C("Relationships",null,{xmlns:Z.RELS})];return O(t["!id"]).forEach(function(e){r[r.length]=C("Relationship",null,t["!id"][e])}),2<r.length&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function T(e,t,r,a,n,o){if(n=n||{},e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,o?n.TargetMode=o:-1<[I.HLINK,I.XPATH,I.XMISS].indexOf(n.Type)&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var ga="application/vnd.oasis.opendocument.spreadsheet";function ya(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function va(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+e.version+"</meta:generator></office:meta></office:document-meta>"}var ba=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wa=function(){for(var e=new Array(ba.length),t=0;t<ba.length;++t){var r=ba[t],r="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function xa(e){var t={};e=Y(e);for(var r=0;r<ba.length;++r){var a=ba[r],n=e.match(wa[r]);null!=n&&0<n.length&&(t[a[1]]=J(n[1])),"date"===a[2]&&t[a[1]]&&(t[a[1]]=X(t[a[1]]))}return t}function ka(e,t,r,a,n){null==n[e]&&null!=t&&""!==t&&(t=_(n[e]=t),a[a.length]=r?C(e,t,r):ur(e,t))}function Sa(e,t){var r=t||{},a=[S,C("cp:coreProperties",null,{"xmlns:cp":Z.CORE_PROPS,"xmlns:dc":Z.dc,"xmlns:dcterms":Z.dcterms,"xmlns:dcmitype":Z.dcmitype,"xmlns:xsi":Z.xsi})],n={};if(e||r.Props){e&&(null!=e.CreatedDate&&ka("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:hr(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),null!=e.ModifiedDate)&&ka("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:hr(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n);for(var o=0;o!=ba.length;++o){var s=ba[o],c=r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e?e[s[1]]:null;!0===c?c="1":!1===c?c="0":"number"==typeof c&&(c=String(c)),null!=c&&ka(s[0],c,null,a,n)}2<a.length&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">"))}return a.join("")}var _a=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Ca(a,n,e){var o={};if(n=n||{},a=Y(a),_a.forEach(function(e){var t=(a.match(ar(e[0]))||[])[1];switch(e[2]){case"string":t&&(n[e[1]]=J(t));break;case"bool":n[e[1]]="true"===t;break;case"raw":var r=a.match(new RegExp("<"+e[0]+"[^>]*>([\\s\\S]*?)</"+e[0]+">"));r&&0<r.length&&(o[e[1]]=r[1])}}),o.HeadingPairs&&o.TitlesOfParts){var t=o.HeadingPairs,r=o.TitlesOfParts,s=n,c=[];if("string"==typeof t)c=lr(t,e);else for(var l=0;l<t.length;++l)c=c.concat(t[l].map(function(e){return{v:e}}));var i,u="string"==typeof r?lr(r,e).map(function(e){return e.v}):r,d=0;if(0<u.length)for(var h=0;h!==c.length;h+=2){switch(i=+c[h+1].v,c[h].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":s.Worksheets=i,s.SheetNames=u.slice(d,d+i);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":s.NamedRanges=i,s.DefinedNames=u.slice(d,d+i);break;case"Charts":case"Diagramme":s.Chartsheets=i,s.ChartNames=u.slice(d,d+i)}d+=i}}}function Ta(r){var a=[],n=C;return(r=r||{}).Application="SheetJS",a[a.length]=S,a[a.length]=C("Properties",null,{xmlns:Z.EXT_PROPS,"xmlns:vt":Z.vt}),_a.forEach(function(e){if(void 0!==r[e[1]]){var t;switch(e[2]){case"string":t=_(String(r[e[1]]));break;case"bool":t=r[e[1]]?"true":"false"}void 0!==t&&(a[a.length]=n(e[0],t))}}),a[a.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=n("TitlesOfParts",n("vt:vector",r.SheetNames.map(function(e){return"<vt:lpstr>"+_(e)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),2<a.length&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var Aa=/<[^>]+>[^<]*/g;function Ia(t){var r,a=[S,C("Properties",null,{xmlns:Z.CUST_PROPS,"xmlns:vt":Z.vt})];return t&&(r=1,O(t).forEach(function(e){++r,a[a.length]=C("property",function(e,t){switch(typeof e){case"string":var r=C("vt:lpwstr",_(e));return r=t?r.replace(/&quot;/g,"_x0022_"):r;case"number":return C((0|e)==e?"vt:i4":"vt:r8",_(String(e)));case"boolean":return C("vt:bool",e?"true":"false")}if(e instanceof Date)return C("vt:filetime",hr(e));throw new Error("Unable to serialize "+e)}(t[e],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:_(e)})}),2<a.length)&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var Ea,Na,Oa,Fa=[2,3,48,49,131,139,140,245],qa=(Ea={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Na=wt({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),Oa={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(e,t){try{return aa(Da(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:Da,from_sheet:function(e,t){if(0<=+(t=t||{}).codepage&&N(+t.codepage),"string"==t.type)throw new Error("Cannot write DBF to JS string");for(var r=Jr(),a=(t=Js(e,{header:1,raw:!0,cellDates:!0}))[0],n=t.slice(1),o=e["!cols"]||[],s=0,c=0,l=0,i=1,s=0;s<a.length;++s)if(((o[s]||{}).DBF||{}).name)a[s]=o[s].DBF.name,++l;else if(null!=a[s]){if(++l,"number"==typeof a[s]&&(a[s]=a[s].toString(10)),"string"!=typeof a[s])throw new Error("DBF Invalid column name "+a[s]+" |"+typeof a[s]+"|");if(a.indexOf(a[s])!==s)for(c=0;c<1024;++c)if(-1==a.indexOf(a[s]+"_"+c)){a[s]+="_"+c;break}}var u=ae(e["!ref"]),d=[],h=[],f=[];for(s=0;s<=u.e.c-u.s.c;++s){for(var p="",m="",g=0,y=[],c=0;c<n.length;++c)null!=n[c][s]&&y.push(n[c][s]);if(0==y.length||null==a[s])d[s]="?";else{for(c=0;c<y.length;++c){switch(typeof y[c]){case"number":m="B";break;case"string":m="C";break;case"boolean":m="L";break;case"object":m=y[c]instanceof Date?"D":"C";break;default:m="C"}g=Math.max(g,String(y[c]).length),p=p&&p!=m?"C":m}250<g&&(g=250),"C"==(m=((o[s]||{}).DBF||{}).type)&&o[s].DBF.len>g&&(g=o[s].DBF.len),"B"==p&&"N"==m&&(p="N",f[s]=o[s].DBF.dec,g=o[s].DBF.len),h[s]="C"==p||"N"==m?g:Oa[p]||0,i+=h[s],d[s]=p}}var v,b,w=r.next(32);for(w._W(4,318902576),w._W(4,n.length),w._W(2,296+32*l),w._W(2,i),s=0;s<4;++s)w._W(4,0);for(w._W(4,0|(+Na[E]||3)<<8),c=s=0;s<a.length;++s)null!=a[s]&&(v=r.next(32),b=(a[s].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),v._W(1,b,"sbcs"),v._W(1,"?"==d[s]?"C":d[s],"sbcs"),v._W(4,c),v._W(1,h[s]||Oa[d[s]]||0),v._W(1,f[s]||0),v._W(1,2),v._W(4,0),v._W(1,0),v._W(4,0),v._W(4,0),c+=h[s]||Oa[d[s]]||0);var x=r.next(264);for(x._W(4,13),s=0;s<65;++s)x._W(4,0);for(s=0;s<n.length;++s){var k=r.next(i);for(k._W(1,0),c=0;c<a.length;++c)if(null!=a[c])switch(d[c]){case"L":k._W(1,null==n[s][c]?63:n[s][c]?84:70);break;case"B":k._W(8,n[s][c]||0,"f");break;case"N":var S="0";for("number"==typeof n[s][c]&&(S=n[s][c].toFixed(f[c]||0)),l=0;l<h[c]-S.length;++l)k._W(1,32);k._W(1,S,"sbcs");break;case"D":n[s][c]?(k._W(4,("0000"+n[s][c].getFullYear()).slice(-4),"sbcs"),k._W(2,("00"+(n[s][c].getMonth()+1)).slice(-2),"sbcs"),k._W(2,("00"+n[s][c].getDate()).slice(-2),"sbcs")):k._W(8,"00000000","sbcs");break;case"C":var _=String(null!=n[s][c]?n[s][c]:"").slice(0,h[c]);for(k._W(1,_,"sbcs"),l=0;l<h[c]-_.length;++l)k._W(1,32)}}return r.next(1)._W(1,26),r.end()}});function Da(e,t){t=t||{},t.dateNF||(t.dateNF="yyyymmdd"),e=oa(function(e,t){var r=[],a=me(1);switch(t.type){case"base64":a=ye(fe(e));break;case"binary":a=ye(e);break;case"buffer":case"array":a=e}de(a,0);var n=a._R(1),o=!!(136&n),s=!1,c=!1;switch(n){case 2:case 3:break;case 48:case 49:o=s=!0;break;case 131:case 139:break;case 140:c=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+n.toString(16))}for(var l=0,i=521,u=(2==n&&(l=a._R(2)),a.l+=3,1048576<(l=2!=n?a._R(4):l)&&(l=1e6),2!=n&&(i=a._R(2)),a._R(2)),d=t.codepage||1252,h=(2!=n&&(a.l+=16,a._R(1),0!==a[a.l]&&(d=Ea[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36),[]),f={},p=Math.min(a.length,2==n?521:i-10-(s?264:0)),m=c?32:11;a.l<p&&13!=a[a.l];)switch((f={}).name=$cptable.utils.decode(d,a.slice(a.l,a.l+m)).replace(/[\u0000\r\n].*$/g,""),a.l+=m,f.type=String.fromCharCode(a._R(1)),2==n||c||(f.offset=a._R(4)),f.len=a._R(1),2==n&&(f.offset=a._R(2)),f.dec=a._R(1),f.name.length&&h.push(f),2!=n&&(a.l+=c?13:14),f.type){case"B":s&&8==f.len||!t.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":t.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==a[a.l]&&(a.l=i-1),13!==a._R(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=i;var g=0,y=0;for(r[0]=[],y=0;y!=h.length;++y)r[0][y]=h[y].name;for(;0<l--;)if(42===a[a.l])a.l+=u;else for(++a.l,r[++g]=[],y=y=0;y!=h.length;++y){var v=a.slice(a.l,a.l+h[y].len),b=(a.l+=h[y].len,de(v,0),$cptable.utils.decode(d,v));switch(h[y].type){case"C":b.trim().length&&(r[g][y]=b.replace(/\s+$/,""));break;case"D":8===b.length?r[g][y]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):r[g][y]=b;break;case"F":r[g][y]=parseFloat(b.trim());break;case"+":case"I":r[g][y]=c?2147483648^v._R(-4,"i"):v._R(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":r[g][y]=!0;break;case"N":case"F":r[g][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+n.toString(16));r[g][y]="##MEMO##"+(c?parseInt(b.trim(),10):v._R(4));break;case"N":(b=b.replace(/\u0000/g,"").trim())&&"."!=b&&(r[g][y]=+b||0);break;case"@":r[g][y]=new Date(v._R(-8,"f")-621356832e5);break;case"T":r[g][y]=new Date(864e5*(v._R(4)-2440588)+v._R(4));break;case"Y":r[g][y]=v._R(4,"i")/1e4+v._R(4,"i")/1e4*Math.pow(2,32);break;case"O":r[g][y]=-v._R(-8,"f");break;case"B":if(s&&8==h[y].len){r[g][y]=v._R(8,"f");break}case"G":case"P":v.l+=h[y].len;break;case"0":if("_NullFlags"===h[y].name)break;default:throw new Error("DBF Unsupported data type "+h[y].type)}}if(2!=n&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return t&&t.sheetRows&&(r=r.slice(0,t.sheetRows)),t.DBF=h,r}(e,t),t);return e["!cols"]=t.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete t.DBF,e}Pa={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},Ma=new RegExp("N("+O(Pa).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),Ra=function(e,t){t=Pa[t];return"number"==typeof t?i(t):t},La=function(e,t,r){t=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==t?e:i(t)},Pa["|"]=254;var Pa,Ma,Ra,La,Ba={to_workbook:function(e,t){return aa(Wa(e,t),t)},to_sheet:Wa,from_sheet:function(e,t){var r,a,n=["ID;PWXL;N;E"],o=[],s=ae(e["!ref"]),c=Array.isArray(e),l="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=n,e["!cols"].forEach(function(e,t){t="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?t+="0":("number"!=typeof e.width||e.wpx||(e.wpx=En(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Nn(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&r.push(t)})),e["!rows"]&&(a=n,e["!rows"].forEach(function(e,t){var r="F;";e.hidden?r+="M0;":e.hpt?r+="M"+20*e.hpt+";":e.hpx&&(r+="M"+20*Pn(e.hpx)+";"),2<r.length&&a.push(r+"R"+(t+1))})),n.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var i=s.s.r;i<=s.e.r;++i)for(var u=s.s.c;u<=s.e.c;++u){var d=te({r:i,c:u});(d=c?(e[i]||[])[u]:e[d])&&(null!=d.v||d.f&&!d.F)&&o.push(function(e,t,r){var a="C;Y"+(t+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+po(e.f,{r:t,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}(d,i,u))}return n.join(l)+l+o.join(l)+l+"E"+l}};function ja(e,t){var r,a,n=e.split(/[\n\r]+/),o=-1,s=-1,c=0,l=0,i=[],u=[],d=null,e={},h=[],f=[],p=0;for(0<=+t.codepage&&N(+t.codepage);c!==n.length;++c){var m,p=0,g=n[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,La).replace(Ma,Ra),y=g.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),v=y[0];if(0<g.length)switch(v){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==y[1].charAt(0)&&u.push(g.slice(3).replace(/;;/g,";"));break;case"C":for(var b=!1,w=!1,x=!1,k=!1,S=-1,_=-1,l=1;l<y.length;++l)switch(y[l].charAt(0)){case"A":break;case"X":s=parseInt(y[l].slice(1))-1,w=!0;break;case"Y":for(o=parseInt(y[l].slice(1))-1,w||(s=0),a=i.length;a<=o;++a)i[a]=[];break;case"K":'"'===(m=y[l].slice(1)).charAt(0)?m=m.slice(1,m.length-1):"TRUE"===m?m=!0:"FALSE"===m?m=!1:isNaN(Et(m))?isNaN(Ot(m).getDate())||(m=X(m)):(m=Et(m),null!==d&&We(d)&&(m=Ct(m))),"undefined"!=typeof $cptable&&"string"==typeof m&&"string"!=(t||{}).type&&(t||{}).codepage&&(m=$cptable.utils.decode(t.codepage,m)),b=!0;break;case"E":var k=!0,C=uo(y[l].slice(1),{r:o,c:s});i[o][s]=[i[o][s],C];break;case"S":x=!0,i[o][s]=[i[o][s],"S5S"];break;case"G":break;case"R":S=parseInt(y[l].slice(1))-1;break;case"C":_=parseInt(y[l].slice(1))-1;break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}if(b&&(i[o][s]&&2==i[o][s].length?i[o][s][0]=m:i[o][s]=m,d=null),x){if(k)throw new Error("SYLK shared formula cannot have own formula");var T=-1<S&&i[S][_];if(!T||!T[1])throw new Error("SYLK shared formula cannot find base");i[o][s][1]=mo(T[1],{r:o-S,c:s-_})}break;case"F":var A=0;for(l=1;l<y.length;++l)switch(y[l].charAt(0)){case"X":s=parseInt(y[l].slice(1))-1,++A;break;case"Y":for(o=parseInt(y[l].slice(1))-1,a=i.length;a<=o;++a)i[a]=[];break;case"M":p=parseInt(y[l].slice(1))/20;break;case"F":case"G":break;case"P":d=u[parseInt(y[l].slice(1))];break;case"S":case"D":case"N":break;case"W":for(r=y[l].slice(1).split(" "),a=parseInt(r[0],10);a<=parseInt(r[1],10);++a)p=parseInt(r[2],10),f[a-1]=0===p?{hidden:!0}:{wch:p},qn(f[a-1]);break;case"C":f[s=parseInt(y[l].slice(1))-1]||(f[s]={});break;case"R":h[o=parseInt(y[l].slice(1))-1]||(h[o]={}),0<p?(h[o].hpt=p,h[o].hpx=Mn(p)):0===p&&(h[o].hidden=!0);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}A<1&&(d=null);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}}return 0<h.length&&(e["!rows"]=h),0<f.length&&(e["!cols"]=f),[i=t&&t.sheetRows?i.slice(0,t.sheetRows):i,e]}function Wa(e,t){var e=function(e,t){switch(t.type){case"base64":return ja(fe(e),t);case"binary":return ja(e,t);case"buffer":return ja(ue&&Buffer.isBuffer(e)?e.toString("binary"):g(e),t);case"array":return ja(It(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=e[0],a=e[1],n=oa(r,t);return O(a).forEach(function(e){n[e]=a[e]}),n}var Ua={to_workbook:function(e,t){return aa($a(e,t),t)},to_sheet:$a,from_sheet:function(e){var t=[],r=ae(e["!ref"]),a=Array.isArray(e);Ha(t,"TABLE",0,1,"sheetjs"),Ha(t,"VECTORS",0,r.e.r-r.s.r+1,""),Ha(t,"TUPLES",0,r.e.c-r.s.c+1,""),Ha(t,"DATA",0,0,"");for(var n=r.s.r;n<=r.e.r;++n){Xa(t,-1,0,"BOT");for(var o=r.s.c;o<=r.e.c;++o){var s,c=te({r:n,c:o});if(s=a?(e[n]||[])[o]:e[c])switch(s.t){case"n":var l=h?s.w:s.v;null==(l=l||null==s.v?l:s.v)?Xa(t,1,0,h&&s.f&&!s.F?"="+s.f:""):Xa(t,0,l,"V");break;case"b":Xa(t,0,s.v?1:0,s.v?"TRUE":"FALSE");break;case"s":Xa(t,1,0,!h||isNaN(s.v)?s.v:'="'+s.v+'"');break;case"d":s.w||(s.w=Xe(s.z||W[14],H(X(s.v)))),h?Xa(t,0,s.w,"V"):Xa(t,1,0,s.w);break;default:Xa(t,1,0,"")}else Xa(t,1,0,"")}}Xa(t,-1,0,"EOD");return t.join("\r\n")}};function za(e,t){for(var r=e.split("\n"),a=-1,n=-1,o=0,s=[];o!==r.length;++o)if("BOT"===r[o].trim())s[++a]=[],n=0;else if(!(a<0)){for(var c=r[o].trim().split(","),l=c[0],i=c[1],u=r[++o]||"";1&(u.match(/["]/g)||[]).length&&o<r.length-1;)u+="\n"+r[++o];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++a]=[],n=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[a][n]=!0:"FALSE"===u?s[a][n]=!1:isNaN(Et(i))?isNaN(Ot(i).getDate())?s[a][n]=i:s[a][n]=X(i):s[a][n]=Et(i),++n;break;case 1:u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'),h&&u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[a][n++]=""!==u?u:null}if("EOD"===u)break}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}function $a(e,t){return oa(function(e,t){switch(t.type){case"base64":return za(fe(e),t);case"binary":return za(e,t);case"buffer":return za(ue&&Buffer.isBuffer(e)?e.toString("binary"):g(e),t);case"array":return za(It(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t)}function Ha(e,t,r,a,n){e.push(t),e.push(r+","+a),e.push('"'+n.replace(/"/g,'""')+'"')}function Xa(e,t,r,a){e.push(t+","+r),e.push(1==t?'"'+a.replace(/"/g,'""')+'"':a)}Ka=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),Ga=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",Ja=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),Va="--SocialCalcSpreadsheetControlSave--";var Ka,Ga,Ja,Va,Ya={to_workbook:function(e,t){return aa(Qa(e,t),t)},to_sheet:Qa,from_sheet:function(e){return[Ka,Ga,Ja,Ga,function(e){if(!e||!e["!ref"])return"";for(var t,r,a=[],n=[],o=ea(e["!ref"]),s=Array.isArray(e),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l)if(r=te({r:c,c:l}),(t=s?(e[c]||[])[l]:e[r])&&null!=t.v&&"z"!==t.t){switch(n=["cell",r,"t"],t.t){case"s":case"str":n.push(Za(t.v));break;case"n":t.f?(n[2]="vtf",n[3]="n",n[4]=t.v,n[5]=Za(t.f)):(n[2]="v",n[3]=t.v);break;case"b":n[2]="vt"+(t.f?"f":"c"),n[3]="nl",n[4]=t.v?"1":"0",n[5]=Za(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var i=H(X(t.v));n[2]="vtc",n[3]="nd",n[4]=""+i,n[5]=t.w||Xe(t.z||W[14],i);break;case"e":continue}a.push(n.join(":"))}return a.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}(e),Va].join("\n")}};function Za(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Qa(e,t){return oa(function(e,t){for(var r,a=e.split("\n"),n=-1,o=0,s=[];o!==a.length;++o){var c=a[o].trim().split(":");if("cell"===c[0]){var l=ee(c[1]);if(s.length<=l.r)for(n=s.length;n<=l.r;++n)s[n]||(s[n]=[]);switch(n=l.r,r=l.c,c[2]){case"t":s[n][r]=c[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[n][r]=+c[3];break;case"vtf":var i=c[c.length-1];case"vtc":s[n][r]="nl"===c[3]?!!+c[4]:+c[4],"vtf"==c[2]&&(s[n][r]=[s[n][r],i])}}}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}(e,t),t)}en={44:",",9:"\t",59:";",124:"|"},tn={44:3,9:2,59:1,124:0};var en,tn,rn={to_workbook:function(e,t){return aa(cn(e,t),t)},to_sheet:cn,from_sheet:function(e){for(var t=[],r=ae(e["!ref"]),a=Array.isArray(e),n=r.s.r;n<=r.e.r;++n){for(var o=[],s=r.s.c;s<=r.e.c;++s){var c=te({r:n,c:s});if((c=a?(e[n]||[])[s]:e[c])&&null!=c.v){for(var l=(c.w||(ra(c),c.w)||"").slice(0,10);l.length<10;)l+=" ";o.push(l+(0===s?" ":""))}else o.push("          ")}t.push(o.join(""))}return t.join("\n")}};function an(e,t,r,a,n){n.raw?t[r][a]=e:""!==e&&("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(Et(e))?isNaN(Ot(e).getDate())?t[r][a]=e:t[r][a]=X(e):t[r][a]=Et(e))}function nn(e){for(var t={},r=!1,a=0,n=0;a<e.length;++a)34==(n=e.charCodeAt(a))?r=!r:!r&&n in en&&(t[n]=(t[n]||0)+1);for(a in n=[],t)Object.prototype.hasOwnProperty.call(t,a)&&n.push([t[a],a]);if(!n.length)for(a in t=tn)Object.prototype.hasOwnProperty.call(t,a)&&n.push([t[a],a]);return n.sort(function(e,t){return e[0]-t[0]||tn[e[1]]-tn[t[1]]}),en[n.pop()[1]]||44}function on(a,e){var n=e||{},e="",o=(null!=ne&&null==n.dense&&(n.dense=ne),n.dense?[]:{}),s={s:{c:0,r:0},e:{c:0,r:0}},c=("sep="==a.slice(0,4)?13==a.charCodeAt(5)&&10==a.charCodeAt(6)?(e=a.charAt(4),a=a.slice(7)):13==a.charCodeAt(5)||10==a.charCodeAt(5)?(e=a.charAt(4),a=a.slice(6)):e=nn(a.slice(0,1024)):e=n&&n.FS?n.FS:nn(a.slice(0,1024)),0),l=0,i=0,u=0,d=0,h=e.charCodeAt(0),t=!1,f=0,p=a.charCodeAt(0),m=null!=n.dateNF?(e=(e="number"==typeof(e=n.dateNF)?W[e]:e).replace(Ze,"(\\d+)"),new RegExp("^"+e+"$")):null;function r(){var e,t=a.slice(u,d),r={};if(0===(t='"'==(t="\r"==t.slice(-1)?t.slice(0,-1):t).charAt(0)&&'"'==t.charAt(t.length-1)?t.slice(1,-1).replace(/""/g,'"'):t).length?r.t="z":n.raw||0===t.trim().length?(r.t="s",r.v=t):61==t.charCodeAt(0)?34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t):"TRUE"==t?(r.t="b",r.v=!0):"FALSE"==t?(r.t="b",r.v=!1):isNaN(i=Et(t))?!isNaN(Ot(t).getDate())||m&&t.match(m)?(r.z=n.dateNF||W[14],e=0,m&&t.match(m)&&(t=function(e,a){var n=-1,o=-1,s=-1,c=-1,l=-1,i=-1;(e.match(Ze)||[]).forEach(function(e,t){var r=parseInt(a[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=r;break;case"d":s=r;break;case"h":c=r;break;case"s":i=r;break;case"m":0<=c?l=r:o=r}}),0<=i&&-1==l&&0<=o&&(l=o,o=-1);8==(e=7==(e=(""+(0<=n?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(1<=o?o:1)).slice(-2)+"-"+("00"+(1<=s?s:1)).slice(-2)).length?"0"+e:e).length&&(e="20"+e);var t=("00"+(0<=c?c:0)).slice(-2)+":"+("00"+(0<=l?l:0)).slice(-2)+":"+("00"+(0<=i?i:0)).slice(-2);return-1==c&&-1==l&&-1==i?e:-1==n&&-1==o&&-1==s?t:e+"T"+t}(n.dateNF,t.match(m)||[]),e=1),n.cellDates?(r.t="d",r.v=X(t,e)):(r.t="n",r.v=H(X(t,e))),!1!==n.cellText&&(r.w=Xe(r.z,r.v instanceof Date?H(r.v):r.v)),n.cellNF||delete r.z):(r.t="s",r.v=t):(!(r.t="n")!==n.cellText&&(r.w=t),r.v=i),"z"!=r.t&&(n.dense?(o[c]||(o[c]=[]),o[c][l]=r):o[te({c:l,r:c})]=r),u=d+1,p=a.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<c&&(s.e.r=c),f!=h)return l=0,++c,!!(n.sheetRows&&n.sheetRows<=c);++l}e:for(;d<a.length;++d)switch(f=a.charCodeAt(d)){case 34:34===p&&(t=!t);break;case 13:if(t)break;10==a.charCodeAt(d+1)&&++d;case h:case 10:if(!t&&r())break e}return 0<d-u&&r(),o["!ref"]=re(s),o}function sn(e,t){return!t||!t.PRN||t.FS||"sep="==e.slice(0,4)||0<=e.indexOf("\t")||0<=e.indexOf(",")||0<=e.indexOf(";")?on(e,t):oa(function(e,t){var r=t||{},a=[];if(e&&0!==e.length){for(var n=e.split(/[\r\n]/),o=n.length-1;0<=o&&0===n[o].length;)--o;for(var s=10,c=0,l=0;l<=o;++l)-1==(c=n[l].indexOf(" "))?c=n[l].length:c++,s=Math.max(s,c);for(l=0;l<=o;++l){a[l]=[];var i=0;for(an(n[l].slice(0,s).trim(),a,l,i,r),i=1;i<=(n[l].length-s)/10+1;++i)an(n[l].slice(s+10*(i-1),s+10*i).trim(),a,l,i,r)}r.sheetRows&&(a=a.slice(0,r.sheetRows))}return a}(e,t),t)}function cn(e,t){var r="",a="string"==t.type?[0,0,0,0]:qs(e,t);switch(t.type){case"base64":r=fe(e);break;case"binary":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!=typeof $cptable?$cptable.utils.decode(t.codepage,e):ue&&Buffer.isBuffer(e)?e.toString("binary"):g(e);break;case"array":r=It(e);break;case"string":r=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]?r=Y(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Y(r):"binary"==t.type&&"undefined"!=typeof $cptable&&t.codepage&&(r=$cptable.utils.decode(t.codepage,$cptable.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Ya.to_sheet("string"==t.type?r:Y(r),t):sn(r,t)}ln=ar("t"),un=ar("rPr"),dn=/<(?:\w+:)?r>/g,hn=/<\/(?:\w+:)?r>/;var ln,un,dn,hn,fn=function(e){return e.replace(dn,"").split(hn).map(pn).filter(function(e){return e.v})};function pn(e){var t=e.match(ln);return t?(t={t:"s",v:J(t[1])},(e=e.match(un))&&(t.s=function(e){var t={},r=e.match(U),a=0,n=!1;if(r)for(;a!=r.length;++a){var o=G(r[a]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":"1"!=o.val&&(t.cp=F[parseInt(o.val,10)]);break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==o[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+o[0])}}return t}(e[1])),t):{t:"s",v:""}}mn=/(\r\n|\n)/g;var mn,gn=function(e){return e.map(yn).join("")};function yn(e){var t,r,a,n=[[],e.v,[]];return e.v?(e.s&&(t=n[0],r=n[2],a=[],(e=e.s).u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),t.push('<span style="'+a.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>")),"superscript"==(a=e.valign||"")||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")),n[0].join("")+n[1].replace(mn,"<br/>")+n[2].join("")):""}var vn=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,bn=/<(?:\w+:)?r>/,wn=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function xn(e,t){var t=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=J(Y(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),r.r=Y(e),t&&(r.h=Jt(r.t))):e.match(bn)&&(r.r=Y(e),r.t=J(Y((e.replace(wn,"").match(vn)||[]).join("").replace(U,"")),!0),t)&&(r.h=gn(fn(r.r))),r):{t:""}}var kn=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Sn=/<(?:\w+:)?(?:si|sstItem)>/g,_n=/<\/(?:\w+:)?(?:si|sstItem)>/;var Cn=/^\s|\s$|[\t\n\r]/;function Tn(e,t){if(0===t)return e;for(var e=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,e=Math.max(t,r,a),n=Math.min(t,r,a),o=e-n;if(0==o)return[0,0,t];var s=0,c=o/(1<(n=e+n)?2-n:n);switch(e){case t:s=((r-a)/o+6)%6;break;case r:s=(a-t)/o+2;break;case a:s=(t-r)/o+4}return[s/6,c,n/2]}((e=(e=e).slice("#"===e[0]?1:0).slice(0,6),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)])),r=(e[2]=t<0?e[2]*(1+t):1-(1-e[2])*(1-t),function(e){var t,r=e[0],a=e[1],n=2*a*((e=e[2])<.5?e:1-e),o=[e=e-n/2,e,e],s=6*r;if(0!==a)switch(0|s){case 0:case 6:t=n*s,o[0]+=n,o[1]+=t;break;case 1:o[0]+=t=n*(2-s),o[1]+=n;break;case 2:t=n*(s-2),o[1]+=n,o[2]+=t;break;case 3:o[1]+=t=n*(4-s),o[2]+=n;break;case 4:t=n*(s-4),o[2]+=n,o[0]+=t;break;case 5:o[2]+=t=n*(6-s),o[0]+=n}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(e)),a=0,n=1;3!=a;++a)n=256*n+(255<r[a]?255:r[a]<0?0:r[a]);return n.toString(16).toUpperCase().slice(1)}var An=15,In=1,A=6;function En(e){return Math.floor((e+Math.round(128/A)/256)*A)}function Nn(e){return Math.floor((e-5)/A*100+.5)/100}function On(e){return Math.round((e*A+5)/A*256)/256}function Fn(e){return On(Nn(En(e)))}function qn(e){e.width?(e.wpx=En(e.width),e.wch=Nn(e.wpx),e.MDW=A):e.wpx?(e.wch=Nn(e.wpx),e.width=On(e.wch),e.MDW=A):"number"==typeof e.wch&&(e.width=On(e.wch),e.wpx=En(e.width),e.MDW=A),e.customWidth&&delete e.customWidth}var Dn=96;function Pn(e){return 96*e/Dn}function Mn(e){return e*Dn/96}var Rn=["numFmtId","fillId","fontId","borderId","xfId"],Ln=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];Bn=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,jn=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Wn=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,Un=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,zn=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;var Bn,jn,Wn,Un,zn,$n=function(e,t,r){var a,n,o,s,c,l,i,u,d,h,f,p,m,g,y,v,b,w,x={};if(e){if(a=(e=e.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Bn)){var k=a,S=x,_=r;S.NumberFmt=[];for(var C=O(W),T=0;T<C.length;++T)S.NumberFmt[C[T]]=W[C[T]];var A=k[0].match(U);if(A)for(T=0;T<A.length;++T){var I=G(A[T]);switch(Wt(I[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var E=J(Y(I.formatCode)),N=parseInt(I.numFmtId,10);if(S.NumberFmt[N]=E,0<N){if(392<N){for(N=392;60<N&&null!=S.NumberFmt[N];--N);S.NumberFmt[N]=E}et(E,N)}break;case"</numFmt>":break;default:if(_.WTF)throw new Error("unrecognized "+I[0]+" in numFmts")}}}(a=e.match(Un))&&(k=a,o=t,s=r,(n=x).Fonts=[],l=!(c={}),(k[0].match(U)||[]).forEach(function(e){var t,r=G(e);switch(Wt(r[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(c),c={};break;case"<name":r.val&&(c.name=Y(r.val));break;case"<name/>":case"</name>":break;case"<b":c.bold=r.val?V(r.val):1;break;case"<b/>":c.bold=1;break;case"<i":c.italic=r.val?V(r.val):1;break;case"<i/>":c.italic=1;break;case"<u":switch(r.val){case"none":c.underline=0;break;case"single":c.underline=1;break;case"double":c.underline=2;break;case"singleAccounting":c.underline=33;break;case"doubleAccounting":c.underline=34}break;case"<u/>":c.underline=1;break;case"<strike":c.strike=r.val?V(r.val):1;break;case"<strike/>":c.strike=1;break;case"<outline":c.outline=r.val?V(r.val):1;break;case"<outline/>":c.outline=1;break;case"<shadow":c.shadow=r.val?V(r.val):1;break;case"<shadow/>":c.shadow=1;break;case"<condense":c.condense=r.val?V(r.val):1;break;case"<condense/>":c.condense=1;break;case"<extend":c.extend=r.val?V(r.val):1;break;case"<extend/>":c.extend=1;break;case"<sz":r.val&&(c.sz=+r.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":r.val&&(c.vertAlign=r.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":r.val&&(c.family=parseInt(r.val,10));break;case"<family/>":case"</family>":break;case"<scheme":r.val&&(c.scheme=r.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":"1"!=r.val&&(r.codepage=F[parseInt(r.val,10)]);break;case"<color":c.color||(c.color={}),r.auto&&(c.color.auto=V(r.auto)),r.rgb?c.color.rgb=r.rgb.slice(-6):r.indexed?(c.color.index=parseInt(r.indexed,10),t=sa[c.color.index],t=(t=81==c.color.index?sa[1]:t)||sa[1],c.color.rgb=t[0].toString(16)+t[1].toString(16)+t[2].toString(16)):r.theme&&(c.color.theme=parseInt(r.theme,10),r.tint&&(c.color.tint=parseFloat(r.tint)),r.theme)&&o.themeElements&&o.themeElements.clrScheme&&(c.color.rgb=Tn(o.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(s&&s.WTF&&!l)throw new Error("unrecognized "+r[0]+" in fonts")}})),(a=e.match(Wn))&&(t=a,u=r,(i=x).Fills=[],h=!(d={}),(t[0].match(U)||[]).forEach(function(e){var t=G(e);switch(Wt(t[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":d={},i.Fills.push(d);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":i.Fills.push(d),d={};break;case"<patternFill":case"<patternFill>":t.patternType&&(d.patternType=t.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":d.bgColor||(d.bgColor={}),t.indexed&&(d.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(d.bgColor.theme=parseInt(t.theme,10)),t.tint&&(d.bgColor.tint=parseFloat(t.tint)),t.rgb&&(d.bgColor.rgb=t.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":d.fgColor||(d.fgColor={}),t.theme&&(d.fgColor.theme=parseInt(t.theme,10)),t.tint&&(d.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(d.fgColor.rgb=t.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":h=!0;break;case"</ext>":h=!1;break;default:if(u&&u.WTF&&!h)throw new Error("unrecognized "+t[0]+" in fills")}})),(a=e.match(zn))&&(t=a,p=r,(f=x).Borders=[],g=!(m={}),(t[0].match(U)||[]).forEach(function(e){var t=G(e);switch(Wt(t[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":m={},t.diagonalUp&&(m.diagonalUp=V(t.diagonalUp)),t.diagonalDown&&(m.diagonalDown=V(t.diagonalDown)),f.Borders.push(m);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":g=!0;break;case"</ext>":g=!1;break;default:if(p&&p.WTF&&!g)throw new Error("unrecognized "+t[0]+" in borders")}})),(a=e.match(jn))&&(t=a,v=r,w=!((y=x).CellXf=[]),(t[0].match(U)||[]).forEach(function(e){var t=G(e),r=0;switch(Wt(t[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(b=t)[0],r=0;r<Rn.length;++r)b[Rn[r]]&&(b[Rn[r]]=parseInt(b[Rn[r]],10));for(r=0;r<Ln.length;++r)b[Ln[r]]&&(b[Ln[r]]=V(b[Ln[r]]));if(y.NumberFmt&&392<b.numFmtId)for(r=392;60<r;--r)if(y.NumberFmt[b.numFmtId]==y.NumberFmt[r]){b.numFmtId=r;break}y.CellXf.push(b);break;case"</xf>":break;case"<alignment":case"<alignment/>":var a={};t.vertical&&(a.vertical=t.vertical),t.horizontal&&(a.horizontal=t.horizontal),null!=t.textRotation&&(a.textRotation=t.textRotation),t.indent&&(a.indent=t.indent),t.wrapText&&(a.wrapText=V(t.wrapText)),b.alignment=a;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":w=!0;break;case"</AlternateContent>":w=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;default:if(v&&v.WTF&&!w)throw new Error("unrecognized "+t[0]+" in cellXfs")}}))}return x};function Hn(e,t){var r,a,n,o,s=[S,C("styleSheet",null,{xmlns:mr[0],"xmlns:vt":Z.vt})];return e.SSF&&null!=(a=e.SSF,n=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=a[t]&&(n[n.length]=C("numFmt",null,{numFmtId:t,formatCode:_(a[t])}))}),r=1===n.length?"":(n[n.length]="</numFmts>",n[0]=C("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join("")))&&(s[s.length]=r),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',e=t.cellXfs,(o=[])[o.length]="<cellXfs/>",e.forEach(function(e){o[o.length]=C("xf",null,e)}),o[o.length]="</cellXfs>",(r=2===o.length?"":(o[0]=C("cellXfs",null,{count:o.length-2}).replace("/>",">"),o.join("")))&&(s[s.length]=r),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<s.length&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}var Xn=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Kn(e,r,a){r.themeElements.clrScheme=[];var n={};(e[0].match(U)||[]).forEach(function(e){var t=G(e);switch(t[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=t.val;break;case"<a:sysClr":n.rgb=t.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===t[0].charAt(1)?(r.themeElements.clrScheme[Xn.indexOf(t[0])]=n,n={}):n.name=t[0].slice(3,t[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+t[0]+" in clrScheme")}})}function Gn(){}function Jn(){}var Vn=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Yn=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Zn=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Qn=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eo(e,t){e&&0!==e.length||(e=to());var r,a,n,o,s,c={};if(r=e.match(Qn))return a=r[0],o=t,(n=c).themeElements={},[["clrScheme",Vn,Kn],["fontScheme",Yn,Gn],["fmtScheme",Zn,Jn]].forEach(function(e){if(!(s=a.match(e[1])))throw new Error(e[0]+" not found in themeElements");e[2](s,n,o)}),c.raw=e,c;throw new Error("themeElements not found in theme")}function to(e,t){return t&&t.themeXLSX?t.themeXLSX:e&&"string"==typeof e.raw?e.raw:((t=[S])[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join(""))}function ro(e,t,r,a){if(!e)return e;var n=a||{},o=!1,s=e,c=function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!t.T&&(!o||n.WTF))throw new Error("Unexpected record 0x"+r.toString(16))}},l=n;if(s){de(s,s.l||0);for(var i=s.length,u=0;s.l<i;){128&(u=s._R(1))&&(u=(127&u)+((127&s._R(1))<<7));for(var d,h=XLSBRecordEnum[u]||XLSBRecordEnum[65535],f=127&(d=s._R(1)),p=1;p<4&&128&d;++p)f+=(127&(d=s._R(1)))<<7*p;var m=s.l+f,g=h.f&&h.f(s,f,l);if(s.l=m,c(g,h,u))return}}}var ao=1024;function no(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[C("xml",null,{"xmlns:v":gr.v,"xmlns:o":gr.o,"xmlns:x":gr.x,"xmlns:mv":gr.mv}).replace(/\/>/,">"),C("o:shapelayout",C("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),C("v:shapetype",[C("v:stroke",null,{joinstyle:"miter"}),C("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];ao<1e3*e;)ao+=1e3;return t.forEach(function(e){var t=ee(e[0]),r={color2:"#BEFF82",type:"gradient"},a=("gradient"==r.type&&(r.angle="-180"),"gradient"==r.type?C("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null),a=C("v:fill",a,r);++ao,n=n.concat(["<v:shape"+dr({id:"_x0000_s"+ao,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,C("v:shadow",null,{on:"t",obscured:"t"}),C("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ur("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),ur("x:AutoFill","False"),ur("x:Row",String(t.r)),ur("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function oo(o,e,s,c){var l,i=Array.isArray(o);e.forEach(function(e){var t,r=ee(e.ref),a=((l=i?(o[r.r]||(o[r.r]=[]),o[r.r][r.c]):o[e.ref])||(l={t:"z"},i?o[r.r][r.c]=l:o[e.ref]=l,(t=ae(o["!ref"]||"BDWGO1000001:A1")).s.r>r.r&&(t.s.r=r.r),t.e.r<r.r&&(t.e.r=r.r),t.s.c>r.c&&(t.s.c=r.c),t.e.c<r.c&&(t.e.c=r.c),(r=re(t))!==o["!ref"]&&(o["!ref"]=r)),l.c||(l.c=[]),{a:e.author,t:e.t,r:e.r,T:s});e.h&&(a.h=e.h);for(var n=l.c.length-1;0<=n;--n){if(!s&&l.c[n].T)return;s&&!l.c[n].T&&l.c.splice(n,1)}if(s&&c)for(n=0;n<c.length;++n)if(a.a==c[n].id){a.a=c[n].name||a.a;break}l.c.push(a)})}var so="application/vnd.ms-office.vbaProject";var co=["xlsb","xlsm","xlam","biff8","xla"];lo=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,io={r:0,c:0};var lo,io,uo=function(e,t){return io=t,e.replace(lo,ho)};function ho(e,t,r,a){var n=!1,o=!1,r=(0==r.length?o=!0:"["==r.charAt(0)&&(o=!0,r=r.slice(1,-1)),0==a.length?n=!0:"["==a.charAt(0)&&(n=!0,a=a.slice(1,-1)),0<r.length?0|parseInt(r,10):0),a=0<a.length?0|parseInt(a,10):0;return n?a+=io.c:--a,o?r+=io.r:--r,t+(n?"":"$")+Qr(a)+(o?"":"$")+Yr(r)}var fo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,po=function(e,s){return e.replace(fo,function(e,t,r,a,n,o){a=Zr(a)-(r?0:s.c),o=Vr(o)-(n?0:s.r);return t+"R"+(0==o?"":n?1+o:"["+o+"]")+"C"+(0==a?"":r?1+a:"["+a+"]")})};function mo(e,s){return e.replace(fo,function(e,t,r,a,n,o){return t+("$"==r?r+a:Qr(Zr(a)+s.c))+("$"==n?n+o:Yr(Vr(o)+s.r))})}function go(e){return e.replace(/_xlfn\./g,"")}function yo(e){return(e=(e=(e=(e=61==(e="of:"==e.slice(0,3)?e.slice(3):e).charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)?e.slice(1):e).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function vo(e){e=e.split(":");return[e[0].split(".")[0],e[0].split(".")[1]+(1<e.length?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var bo={},wo={},xo="undefined"!=typeof Map;function ko(e,t,r){var a=r.revssf[null!=t.z?t.z:"General"],n=60,o=e.length;if(null==a&&r.ssf)for(;n<392;++n)if(null==r.ssf[n]){et(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}for(n=0;n!=o;++n)if(e[n].numFmtId===a)return n;return e[o]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}var So=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_o=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Co=/<(?:\w:)?hyperlink [^>]*>/gm,To=/"(\w*:\w*)"/,Ao=/<(?:\w:)?col\b[^>]*[\/]?>/g,Io=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Eo=/<(?:\w:)?pageMargins[^>]*\/>/g,No=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Oo=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Fo=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qo(e,t,r,a,n,o,s){if(!e)return e;a=a||{"!id":{}},null!=ne&&null==t.dense&&(t.dense=ne);var c,l,i=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",f=e.match(_o),e=(f?(d=e.slice(0,f.index),h=e.slice(f.index+f[0].length)):d=h=e,d.match(No)),p=(e?Do(e[0],0,n,r):(e=d.match(Oo))&&(e=e[0],c=i,l=n,r=r,Do(e.slice(0,e.indexOf(">")),0,l,r)),(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index),r=(0<p&&(e=d.slice(p,p+50).match(To))&&(c=i,(l=ae(l=e[1])).s.r<=l.e.r)&&l.s.c<=l.e.c&&0<=l.s.r&&0<=l.s.c&&(c["!ref"]=re(l)),d.match(Fo));if(r&&r[1]){var e=r[1],m=n;m.Views||(m.Views=[{}]),(e.match(Lo)||[]).forEach(function(e,t){e=G(e);m.Views[t]||(m.Views[t]={}),+e.zoomScale&&(m.Views[t].zoom=+e.zoomScale),e.rightToLeft&&V(e.rightToLeft)&&(m.Views[t].RTL=!0)})}r=[];if(t.cellStyles){n=d.match(Ao);if(n)for(var g=r,y=n,v=!1,b=0;b!=y.length;++b){var w=G(y[b],!0),x=(w.hidden&&(w.hidden=V(w.hidden)),parseInt(w.min,10)-1),k=parseInt(w.max,10)-1;for(w.outlineLevel&&(w.level=+w.outlineLevel||0),delete w.min,delete w.max,w.width=+w.width,!v&&w.width&&(v=!0,function(e){var t=Math.abs(e-Fn(e)),r=A;if(.005<t)for(A=In;A<An;++A)Math.abs(e-Fn(e))<=t&&(t=Math.abs(e-Fn(e)),r=A);A=r}(w.width)),qn(w);x<=k;)g[x++]=K(w)}}f&&Ko(f[1],i,t,u,o,s);var e=h.match(Io),S=(e&&(i["!autofilter"]={ref:(e[0].match(/ref="([^"]*)"/)||[])[1]}),[]),_=h.match(So);if(_)for(p=0;p!=_.length;++p)S[p]=ae(_[p].slice(_[p].indexOf('"')+1));var C,T,d=h.match(Co),n=(d&&!function(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var o=G(Y(t[n]),!0);if(!o.ref)return;for(var s=((r||{})["!id"]||[])[o.id],c=(s?(o.Target=s.Target,o.location&&(o.Target+="#"+J(o.location))):(o.Target="#"+J(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip),ae(o.ref)),l=c.s.r;l<=c.e.r;++l)for(var i=c.s.c;i<=c.e.c;++i){var u=te({c:i,r:l});a?(e[l]||(e[l]=[]),e[l][i]||(e[l][i]={t:"z",v:void 0}),e[l][i].l=o):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=o)}}}(i,d,a),h.match(Eo));return n&&(i["!margins"]=(C=G(n[0]),T={},["left","right","top","bottom","header","footer"].forEach(function(e){C[e]&&(T[e]=parseFloat(C[e]))}),T)),!i["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(i["!ref"]=re(u)),0<t.sheetRows&&i["!ref"]&&(f=ae(i["!ref"]),t.sheetRows<=+f.e.r)&&(f.e.r=t.sheetRows-1,f.e.r>u.e.r&&(f.e.r=u.e.r),f.e.r<f.s.r&&(f.s.r=f.e.r),f.e.c>u.e.c&&(f.e.c=u.e.c),f.e.c<f.s.c&&(f.s.c=f.e.c),i["!fullref"]=i["!ref"],i["!ref"]=re(f)),0<r.length&&(i["!cols"]=r),0<S.length&&(i["!merges"]=S),i}function Do(e,t,r,a){e=G(e);r.Sheets[a]||(r.Sheets[a]={}),e.codeName&&(r.Sheets[a].CodeName=J(Y(e.codeName)))}var Po=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Mo=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ro(e,t){for(var r,a,n,o=["<cols>"],s=0;s!=t.length;++s)(a=t[s])&&(o[o.length]=C("col",null,(n=void 0,r={min:(r=s)+1,max:r+1},n=-1,(a=a).MDW&&(A=a.MDW),null!=a.width?r.customWidth=1:null!=a.wpx?n=Nn(a.wpx):null!=a.wch&&(n=a.wch),-1<n?(r.width=On(n),r.customWidth=1):null!=a.width&&(r.width=a.width),a.hidden&&(r.hidden=!0),null!=a.level&&(r.outlineLevel=r.level=a.level),r)));return o[o.length]="</cols>",o.join("")}var Lo=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Bo(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var n="",o=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=ca[e.v];break;case"d":n=a&&a.cellDates?X(e.v,-1).toISOString():((e=K(e)).t="n",""+(e.v=H(X(e.v)))),void 0===e.z&&(e.z=W[14]);break;default:n=e.v}var c=ur("v",_(n)),l={r:t},i=ko(a.cellXfs,e,a);switch(0!==i&&(l.s=i),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(null==e.v)delete e.t;else{if(32767<e.v.length)throw new Error("Text length must not exceed 32767 characters");a&&a.bookSST?(c=ur("v",""+function(e,t,r){var a=0,n=e.length;if(r){if(xo?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var o=xo?r.get(t):r[t];a<o.length;++a)if(e[o[a]].t===t)return e.Count++,o[a]}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t:t},e.Count++,e.Unique++,r&&(xo?(r.has(t)||r.set(t,[]),r.get(t)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t])).push(n),n}(a.Strings,e.v,a.revStrings)),l.t="s"):l.t="str"}}return e.t!=o&&(e.t=o,e.v=s),"string"==typeof e.f&&e.f&&(i=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null,c=C("f",_(e.f),i)+(null!=e.v?c:"")),e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),C("c",c,l)}jo=/<(?:\w+:)?c[ \/>]/,Wo=/<\/(?:\w+:)?row>/,Uo=/r=["']([^"']*)["']/,zo=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,$o=/ref=["']([^"']*)["']/,Ho=ar("v"),Xo=ar("f");var jo,Wo,Uo,zo,$o,Ho,Xo,Ko=function(M,e,t,r,R,a){for(var n,o,s,c,l=0,i="",u=[],d=[],h=0,f=0,p="",m=0,g=0,y=0,v=0,b=Array.isArray(a.CellXf),w=[],x=[],L=Array.isArray(e),k=[],S={},_=!1,C=!!t.sheetStubs,T=M.split(Wo),A=0,B=T.length;A!=B;++A){var j=(i=T[A].trim()).length;if(0!==j){var I=0;e:for(l=0;l<j;++l)switch(i[l]){case">":if("/"!=i[l-1]){++l;break e}if(t&&t.cellStyles){if(m=null!=(s=G(i.slice(I,l),!0)).r?parseInt(s.r,10):m+1,g=-1,t.sheetRows&&t.sheetRows<m)continue;_=!(S={}),s.ht&&(_=!0,S.hpt=parseFloat(s.ht),S.hpx=Mn(S.hpt)),s.hidden&&V(s.hidden)&&(S.hidden=_=!0),null!=s.outlineLevel&&(_=!0,S.level=+s.outlineLevel),_&&(k[m-1]=S)}break;case"<":I=l}if(l<=I)break;if(m=null!=(s=G(i.slice(I,l),!0)).r?parseInt(s.r,10):m+1,g=-1,!(t.sheetRows&&t.sheetRows<m)){r.s.r>m-1&&(r.s.r=m-1),r.e.r<m-1&&(r.e.r=m-1),t&&t.cellStyles&&(_=!(S={}),s.ht&&(_=!0,S.hpt=parseFloat(s.ht),S.hpx=Mn(S.hpt)),s.hidden&&V(s.hidden)&&(S.hidden=_=!0),null!=s.outlineLevel&&(_=!0,S.level=+s.outlineLevel),_)&&(k[m-1]=S);for(var u=i.slice(l).split(jo),E=0;E!=u.length&&"<"==u[E].trim().charAt(0);++E);for(u=u.slice(E),l=0;l!=u.length;++l)if(0!==(i=u[l].trim()).length){if(d=i.match(Uo),h=l,i="<c "+("<"==i.slice(f=0,1)?">":"")+i,null!=d&&2===d.length){for(p=d[1],f=h=0;f!=p.length&&!((n=p.charCodeAt(f)-64)<1||26<n);++f)h=26*h+n;g=--h}else++g;for(f=0;f!=i.length&&62!==i.charCodeAt(f);++f);if(++f,(s=G(i.slice(0,f),!0)).r||(s.r=te({r:m-1,c:g})),o={t:""},null!=(d=(p=i.slice(f)).match(Ho))&&""!==d[1]&&(o.v=J(d[1])),t.cellFormula){null!=(d=p.match(Xo))&&""!==d[1]?(o.f=J(Y(d[1]),!0),t.xlfn||(o.f=go(o.f)),-1<d[0].indexOf('t="array"')?(o.F=(p.match($o)||[])[1],-1<o.F.indexOf(":")&&w.push([ae(o.F),o.F])):-1<d[0].indexOf('t="shared"')&&(N=G(d[0]),O=J(Y(d[1])),t.xlfn||(O=go(O)),x[parseInt(N.si,10)]=[N,O,s.r])):(d=p.match(/<f[^>]*\/>/))&&x[(N=G(d[0])).si]&&(o.f=(O=x[N.si][1],q=x[N.si][2],P=s.r,q=ea(q).s,P=ee(P),mo(O,{r:P.r-q.r,c:P.c-q.c})));for(var N,O,F=ee(s.r),f=0;f<w.length;++f)F.r>=w[f][0].s.r&&F.r<=w[f][0].e.r&&F.c>=w[f][0].s.c&&F.c<=w[f][0].e.c&&(o.F=w[f][1])}if(null==s.t&&void 0===o.v)if(o.f||o.F)o.v=0,o.t="n";else{if(!C)continue;o.t="z"}else o.t=s.t||"n";switch(r.s.c>g&&(r.s.c=g),r.e.c<g&&(r.e.c=g),o.t){case"n":if(""==o.v||null==o.v){if(!C)continue;o.t="z"}else o.v=parseFloat(o.v);break;case"s":if(void 0===o.v){if(!C)continue;o.t="z"}else c=bo[parseInt(o.v,10)],o.v=c.t,o.r=c.r,t.cellHTML&&(o.h=c.h);break;case"str":o.t="s",o.v=null!=o.v?J(Y(o.v),!0):"",t.cellHTML&&(o.h=Jt(o.v));break;case"inlineStr":d=p.match(zo),o.t="s",null!=d&&(c=xn(d[1]))?(o.v=c.t,t.cellHTML&&(o.h=c.h)):o.v="";break;case"b":o.v=V(o.v);break;case"d":t.cellDates?o.v=X(o.v,1):(o.v=H(X(o.v,1)),o.t="n");break;case"e":t&&!1===t.cellText||(o.w=o.v),o.v=la[o.v]}var q,D,P,y=v=0;b&&void 0!==s.s&&null!=(P=a.CellXf[s.s])&&(null!=P.numFmtId&&(y=P.numFmtId),t.cellStyles)&&null!=P.fillId&&(v=P.fillId),!function(e,t,r,a,n,o){try{a.cellNF&&(e.z=W[t])}catch(e){if(a.WTF)throw e}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=X(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==W[t]&&et(Ye[t]||"General",t),"e"===e.t)e.w=e.w||ca[e.v];else if(0===t)if("n"===e.t)e.w=(0|e.v)===e.v?e.v.toString(10):Ie(e.v);else if("d"===e.t){var s=H(e.v);e.w=(0|s)===s?s.toString(10):Ie(s)}else{if(void 0===e.v)return;e.w=Ee(e.v,wo)}else e.w=Xe(t,"d"===e.t?H(e.v):e.v,wo)}catch(e){if(a.WTF)throw e}if(a.cellStyles&&null!=r)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Tn(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF)&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Tn(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF)&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb)}catch(e){if(a.WTF&&o.Fills)throw e}}}(o,y,v,t,R,a),t.cellDates&&b&&"n"==o.t&&We(W[y])&&(o.t="d",o.v=Ct(o.v)),s.cm&&t.xlmeta&&(q=(t.xlmeta.Cell||[])[+s.cm-1])&&"XLDAPR"==q.type&&(o.D=!0),L?(e[(D=ee(s.r)).r]||(e[D.r]=[]),e[D.r][D.c]=o):e[s.r]=o}}}}0<k.length&&(e["!rows"]=k)};function Go(e,t,r,a){var n=[S,C("worksheet",null,{xmlns:mr[0],"xmlns:r":Z.r})],o=r.SheetNames[e],o=r.Sheets[o],s=(o=null==o?{}:o)["!ref"]||"A1",c=ae(s);if(16383<c.e.c||1048575<c.e.r){if(t.WTF)throw new Error("Range "+s+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),s=re(c)}a=a||{},o["!comments"]=[];var l,i,c=[],u=o,d=r,h=e,f=t,p=n,m=!1,g={},y=null;if("xlsx"!==f.bookType&&d.vbaraw){f=d.SheetNames[h];try{d.Workbook&&(f=d.Workbook.Sheets[h].CodeName||f)}catch(e){}m=!0,g.codeName=rr(_(f))}u&&u["!outline"]&&(d={summaryBelow:1,summaryRight:1},u["!outline"].above&&(d.summaryBelow=0),u["!outline"].left&&(d.summaryRight=0),y=(y||"")+C("outlinePr",null,d)),(m||y)&&(p[p.length]=C("sheetPr",y,g)),n[n.length]=C("dimension",null,{ref:s}),n[n.length]=(h={workbookViewId:"0"},((((f=r)||{}).Workbook||{}).Views||[])[0]&&(h.rightToLeft=f.Workbook.Views[0].RTL?"1":"0"),C("sheetViews",C("sheetView",null,h),{})),t.sheetFormat&&(n[n.length]=C("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=o["!cols"]&&0<o["!cols"].length&&(n[n.length]=Ro(0,o["!cols"])),n[u=n.length]="<sheetData/>",o["!links"]=[],null!=o["!ref"]&&0<(d=function(e,t){for(var r,a,n=[],o=[],s=ae(e["!ref"]),c=[],l=0,i=0,u=e["!rows"],d=Array.isArray(e),h={r:""},f=-1,i=s.s.c;i<=s.e.c;++i)c[i]=Qr(i);for(l=s.s.r;l<=s.e.r;++l){for(o=[],r=Yr(l),i=s.s.c;i<=s.e.c;++i){var p=c[i]+r,m=d?(e[l]||[])[i]:e[p];void 0!==m&&null!=(m=Bo(m,p,e,t))&&o.push(m)}(0<o.length||u&&u[l])&&(h={r:r},u&&u[l]&&((a=u[l]).hidden&&(h.hidden=1),f=-1,a.hpx?f=Pn(a.hpx):a.hpt&&(f=a.hpt),-1<f&&(h.ht=f,h.customHeight=1),a.level)&&(h.outlineLevel=a.level),n[n.length]=C("row",o.join(""),h))}if(u)for(;l<u.length;++l)u&&u[l]&&(h={r:l+1},(a=u[l]).hidden&&(h.hidden=1),f=-1,a.hpx?f=Pn(a.hpx):a.hpt&&(f=a.hpt),-1<f&&(h.ht=f,h.customHeight=1),a.level&&(h.outlineLevel=a.level),n[n.length]=C("row","",h));return n.join("")}(o,t)).length&&(n[n.length]=d),u+1<n.length&&(n[n.length]="</sheetData>",n[u]=n[u].replace("/>",">")),o["!protect"]&&(n[n.length]=(l=o["!protect"],i={sheet:1},Po.forEach(function(e){null!=l[e]&&l[e]&&(i[e]="1")}),Mo.forEach(function(e){null==l[e]||l[e]||(i[e]="0")}),l.password&&(i.password=crypto_CreatePasswordVerifier_Method1(l.password).toString(16).toUpperCase()),C("sheetProtection",null,i))),null!=o["!autofilter"]&&(n[n.length]=function(e,t,r,a){var n="string"==typeof e.ref?e.ref:re(e.ref),o=(r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]),r.Workbook.Names);(e=ea(n)).s.r==e.e.r&&(e.e.r=ea(t["!ref"]).e.r,n=re(e));for(var s=0;s<o.length;++s){var c=o[s];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),C("autoFilter",null,{ref:n})}(o["!autofilter"],o,r,e)),null!=o["!merges"]&&0<o["!merges"].length&&(n[n.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+re(e[r])+'"/>';return t+"</mergeCells>"}(o["!merges"]));var v,b,w,x=-1;return 0<o["!links"].length&&(n[n.length]="<hyperlinks>",o["!links"].forEach(function(e){e[1].Target&&(b={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(x=T(a,-1,_(e[1].Target).replace(/#.*$/,""),I.HLINK),b["r:id"]="rId"+x),-1<(v=e[1].Target.indexOf("#"))&&(b.location=_(e[1].Target.slice(v+1))),e[1].Tooltip&&(b.tooltip=_(e[1].Tooltip)),n[n.length]=C("hyperlink",null,b))}),n[n.length]="</hyperlinks>"),delete o["!links"],null!=o["!margins"]&&(n[n.length]=((p=m=o["!margins"])&&(w="xlml"==w?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],null==p.left&&(p.left=w[0]),null==p.right&&(p.right=w[1]),null==p.top&&(p.top=w[2]),null==p.bottom&&(p.bottom=w[3]),null==p.header&&(p.header=w[4]),null==p.footer)&&(p.footer=w[5]),C("pageMargins",null,m))),t&&!t.ignoreEC&&null!=t.ignoreEC||(n[n.length]=ur("ignoredErrors",C("ignoredError",null,{numberStoredAsText:1,sqref:s}))),0<c.length&&(x=T(a,-1,"../drawings/drawing"+(e+1)+".xml",I.DRAW),n[n.length]=C("drawing",null,{"r:id":"rId"+x}),o["!drawing"]=c),0<o["!comments"].length&&(x=T(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",I.VML),n[n.length]=C("legacyDrawing",null,{"r:id":"rId"+x}),o["!legacy"]=x),1<n.length&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Jo(e,t,r,a,n,o){var s,c,l,i,u=o||{"!type":"chart"};return e?(l="A",i={s:{r:2e6,c:2e6},e:{r:c=s=0,c:0}},(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){r=[],a=(e=e).match(/^<c:numCache>/),(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){e=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);e&&(r[+e[1]]=a?+e[2]:e[2])}),n=J((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]),(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")});var t,r,a,n,o=[r,n,t];i.s.r=i.s.c=0,i.e.c=s,l=Qr(s),o[0].forEach(function(e,t){u[l+Yr(t)]={t:"n",v:e,z:o[1]},c=t}),i.e.r<c&&(i.e.r=c),++s}),0<s&&(u["!ref"]=re(i)),u):o}var Vo=[["allowRefreshQuery",!(I.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet"),"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Yo=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Zo=[],Qo=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function es(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var o=t[n];if(null==a[o[0]])a[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof a[o[0]]&&(a[o[0]]=V(a[o[0]]));break;case"int":"string"==typeof a[o[0]]&&(a[o[0]]=parseInt(a[o[0]],10))}}}function ts(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=V(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}var rs="][*?/\\".split("");function as(t,r){if(31<t.length){if(r)return;throw new Error("Sheet names cannot exceed 31 chars")}rs.forEach(function(e){if(-1!=t.indexOf(e)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");0}})}function ns(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n,o,s,t=e.Workbook&&e.Workbook.Sheets||[];n=e.SheetNames,o=t,s=!!e.vbaraw,n.forEach(function(e,t){as(e);for(var r=0;r<t;++r)if(e==n[r])throw new Error("Duplicate Sheet Name: "+e);if(s){var a=o&&o[t]&&o[t].CodeName||e;if(95==a.charCodeAt(0)&&22<a.length)throw new Error("Bad Code Name: Worksheet"+a)}});for(var r=0;r<e.SheetNames.length;++r){a=void 0;c=void 0;l=void 0;var a=e.Sheets[e.SheetNames[r]];e.SheetNames[r];var c=r;if(a&&a["!ref"]){var l=ae(a["!ref"]);if(l.e.c<l.s.c||l.e.r<l.s.r)throw new Error("Bad range ("+c+"): "+a["!ref"])}}}var os=/<\w+:workbook/;function ss(a,n){if(!a)throw new Error("Could not find file");var e,o={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,c="xmlns",l={},i=0;if(a.replace(U,function(e,t){var r=G(e);switch(Wt(r[0])){case"<?xml":break;case"<workbook":e.match(os)&&(c="xmlns"+e.match(/<(\w+):/)[1]),o.xmlns=r[c];break;case"</workbook>":break;case"<fileVersion":delete r[0],o.AppVersion=r;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vo.forEach(function(e){if(null!=r[e[0]])switch(e[2]){case"bool":o.WBProps[e[0]]=V(r[e[0]]);break;case"int":o.WBProps[e[0]]=parseInt(r[e[0]],10);break;default:o.WBProps[e[0]]=r[e[0]]}}),r.codeName&&(o.WBProps.CodeName=Y(r.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete r[0],o.WBView.push(r);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(r.state){case"hidden":r.Hidden=1;break;case"veryHidden":r.Hidden=2;break;default:r.Hidden=0}delete r.state,r.name=J(Y(r.name)),delete r[0],o.Sheets.push(r);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":(l={}).Name=Y(r.name),r.comment&&(l.Comment=r.comment),r.localSheetId&&(l.Sheet=+r.localSheetId),V(r.hidden||"0")&&(l.Hidden=!0),i=t+e.length;break;case"</definedName>":l.Ref=J(Y(a.slice(i,t))),o.Names.push(l);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete r[0],o.CalcPr=r;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+r[0]+" in workbook")}return e}),-1===mr.indexOf(o.xmlns))throw new Error("Unknown Namespace: "+o.xmlns);return ts((e=o).WBProps,Vo),ts(e.CalcPr,Qo),es(e.WBView,Yo),es(e.Sheets,Zo),wo.date1904=V(e.WBProps.date1904),o}function cs(e,t,r,a,n,o,s,c){if(".bin"===t.slice(-4))return parse_cs_bin(e,a,r,n,o,s,c);t=e,a=r,s=n,c=o;if(!t)return t;s=s||{"!id":{}};e={"!type":"chart","!drawel":null,"!rel":""},r=t.match(No);return r&&Do(r[0],0,c,a),(r=t.match(/drawing r:id="(.*?)"/))&&(e["!rel"]=r[1]),s["!id"][e["!rel"]]&&(e["!drawel"]=s["!id"][e["!rel"]]),e}function ls(e,t,r){if(".bin"===t.slice(-4))return parse_sst_bin(e,r);var t=e,a=r,n=[],o="";if(t){t=t.match(kn);if(t){for(var o=t[2].replace(Sn,"").split(_n),s=0;s!=o.length;++s){var c=xn(o[s].trim(),a);null!=c&&(n[n.length]=c)}t=G(t[1]),n.Count=t.count,n.Unique=t.uniqueCount}}return n}function is(e,t,r){return".bin"===t.slice(-4)?parse_comments_bin(e,r):(a=r,(t=e).match(/<(?:\w+:)?comments *\/>/)?[]:(n=[],o=[],(r=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/))&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(e){""!==e&&""!==e.trim()&&(e=e.match(/<(?:\w+:)?author[^>]*>(.*)/))&&n.push(e[1])}),(r=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&r[1]&&r[1].split(/<\/\w*:?comment>/).forEach(function(e){var t,r;""!==e&&""!==e.trim()&&(r=e.match(/<(?:\w+:)?comment[^>]*>/))&&(t={author:(r=G(r[0])).authorId&&n[r.authorId]||"sheetjsghost",ref:r.ref,guid:r.guid},r=ee(r.ref),a.sheetRows&&a.sheetRows<=r.r||(e=!!(r=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!r[1]&&xn(r[1])||{r:"",t:"",h:""},t.r=e.r,"<t></t>"==e.r&&(e.t=e.h=""),t.t=(e.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),a.cellHTML&&(t.h=e.h),o.push(t)))}),o));var a,n,o}function us(e,t,r){return".bin"===t.slice(-4)?parse_xlmeta_bin(e,t,r):(a=r,c={Types:[],Cell:[],Value:[]},(t=e)&&(n=!1,o=2,t.replace(U,function(e){var t=G(e);switch(Wt(t[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":c.Types.push({name:t.name});break;case"</metadataType>":break;case"<futureMetadata":for(var r=0;r<c.Types.length;++r)c.Types[r].name==t.name&&(s=c.Types[r]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":1==o?c.Cell.push({type:c.Types[t.t-1].name,index:+t.v}):0==o&&c.Value.push({type:c.Types[t.t-1].name,index:+t.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":s&&(s.offsets||(s.offsets=[]),s.offsets.push(+t.i));break;default:if(!n&&a.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),c);var a,n,o,s,c}function ds(e,t){var r=t||{},t=null!=r.header?r.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a=null!=r.footer?r.footer:"</body></html>",n=[t],o=ea(e["!ref"]);r.dense=Array.isArray(e),n.push((t=r,[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"));for(var s=o.s.r;s<=o.e.r;++s)n.push(function(e,t,r,a){for(var n=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var c,l,i,u,d=0,h=0,f=0;f<n.length;++f)if(!(n[f].s.r>r||n[f].s.c>s||n[f].e.r<r||n[f].e.c<s)){if(n[f].s.r<r||n[f].s.c<s){d=-1;break}d=n[f].e.r-n[f].s.r+1,h=n[f].e.c-n[f].s.c+1;break}d<0||(c=te({r:r,c:s}),i=(l=a.dense?(e[r]||[])[s]:e[c])&&null!=l.v&&(l.h||Jt(l.w||(ra(l),l.w)||""))||"",u={},1<d&&(u.rowspan=d),1<h&&(u.colspan=h),a.editable?i='<span contenteditable="true">'+i+"</span>":l&&(u["data-t"]=l&&l.t||"z",null!=l.v&&(u["data-v"]=l.v),null!=l.z&&(u["data-z"]=l.z),l.l)&&"#"!=(l.l.Target||"#").charAt(0)&&(i='<a href="'+l.l.Target+'">'+i+"</a>"),u.id=(a.id||"sjs")+"-"+c,o.push(C("td",i,u)))}return"<tr>"+o.join("")+"</tr>"}(e,o,s,r));return n.push("</table>"+a),n.join("")}function hs(e,t,r){var a,n=r||{},o=(null!=ne&&(n.dense=ne),0),s=0,c=(null!=n.origin&&("number"==typeof n.origin?o=n.origin:(o=(r="string"==typeof n.origin?ee(n.origin):n.origin).r,s=r.c)),t.getElementsByTagName("tr")),l=Math.min(n.sheetRows||1e7,c.length),i={s:{r:0,c:0},e:{r:o,c:s}},u=(e["!ref"]&&(r=ea(e["!ref"]),i.s.r=Math.min(i.s.r,r.s.r),i.s.c=Math.min(i.s.c,r.s.c),i.e.r=Math.max(i.e.r,r.e.r),i.e.c=Math.max(i.e.c,r.e.c),-1==o)&&(i.e.r=o=r.e.r+1),[]),d=0,h=e["!rows"]||(e["!rows"]=[]),f=0,p=0,m=0,g=0;for(e["!cols"]||(e["!cols"]=[]);f<c.length&&p<l;++f){var y=c[f];if(ps(y)){if(n.display)continue;h[p]={hidden:!0}}for(var v=y.children,m=g=0;m<v.length;++m){var b=v[m];if(!n.display||!ps(b)){for(var w=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):nr(b.innerHTML),x=b.getAttribute("data-z")||b.getAttribute("z"),d=0;d<u.length;++d){var k=u[d];k.s.c==g+s&&k.s.r<p+o&&p+o<=k.e.r&&(g=k.e.c+1-s,d=-1)}a=+b.getAttribute("colspan")||1,(1<(S=+b.getAttribute("rowspan")||1)||1<a)&&u.push({s:{r:p+o,c:g+s},e:{r:p+o+(S||1)-1,c:g+s+(a||1)-1}});var S={t:"s",v:w},_=b.getAttribute("data-t")||b.getAttribute("t")||"",C=(null!=w&&(0==w.length?S.t=_||"z":n.raw||0==w.trim().length||"s"==_||("TRUE"===w?S={t:"b",v:!0}:"FALSE"===w?S={t:"b",v:!1}:isNaN(Et(w))?isNaN(Ot(w).getDate())||(S={t:"d",v:X(w)},(S=n.cellDates?S:{t:"n",v:H(S.v)}).z=n.dateNF||W[14]):S={t:"n",v:Et(w)})),void 0===S.z&&null!=x&&(S.z=x),""),T=b.getElementsByTagName("A");if(T&&T.length)for(var A=0;A<T.length&&(!T[A].hasAttribute("href")||"#"==(C=T[A].getAttribute("href")).charAt(0));++A);C&&"#"!=C.charAt(0)&&(S.l={Target:C}),n.dense?(e[p+o]||(e[p+o]=[]),e[p+o][g+s]=S):e[te({c:g+s,r:p+o})]=S,i.e.c<g+s&&(i.e.c=g+s),g+=a}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),i.e.r=Math.max(i.e.r,p-1+o),e["!ref"]=re(i),l<=p&&(e["!fullref"]=re((i.e.r=c.length-f+p-1+o,i))),e}function fs(e,t){return hs((t||{}).dense?[]:{},e,t)}function ps(e){var t="",r=(r=e).ownerDocument.defaultView&&"function"==typeof r.ownerDocument.defaultView.getComputedStyle?r.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null;return"none"===(t=(t=r?r(e).getPropertyValue("display"):t)||e.style&&e.style.display)}var ms={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gs(M,e){var t,r,a,n,R,o=e||{},s=(null!=ne&&null==o.dense&&(o.dense=ne),fr(M)),c=[],L={name:""},B=0,l={},i=[],u=o.dense?[]:{},d={value:""},h="",f=0,p=[],m=-1,g=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},v=0,b=[],j={},w=0,x=0,k=[],S=1,_=1,C=[],W={Names:[]},T={},A=["",""],I=[],E={},U="",z=0,N=!1,$=!1,O=0;for(pr.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");a=pr.exec(s);)switch(a[3]=a[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===a[1]?(y.e.c>=y.s.c&&y.e.r>=y.s.r?u["!ref"]=re(y):u["!ref"]="A1:A1",0<o.sheetRows&&o.sheetRows<=y.e.r&&(u["!fullref"]=u["!ref"],y.e.r=o.sheetRows-1,u["!ref"]=re(y)),b.length&&(u["!merges"]=b),k.length&&(u["!rows"]=k),r.name=r["名称"]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),i.push(r.name),l[r.name]=u,$=!1):"/"!==a[0].charAt(a[0].length-2)&&(r=G(a[0],!1),m=g=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,u=o.dense?[]:{},b=[],k=[],$=!0);break;case"table-row-group":"/"===a[1]?--v:++v;break;case"table-row":case"行":if("/"===a[1])m+=S,S=1;else{if((F=G(a[0],!1))["行号"]?m=F["行号"]-1:-1==m&&(m=0),(S=+F["number-rows-repeated"]||1)<10)for(O=0;O<S;++O)0<v&&(k[m+O]={level:v});g=-1}break;case"covered-table-cell":"/"!==a[1]&&++g,o.sheetStubs&&(o.dense?(u[m]||(u[m]=[]),u[m][g]={t:"z"}):u[te({r:m,c:g})]={t:"z"}),h="",p=[];break;case"table-cell":case"数据":if("/"===a[0].charAt(a[0].length-2))++g,d=G(a[0],!1),_=parseInt(d["number-columns-repeated"]||"1",10),n={t:"z",v:null},d.formula&&0!=o.cellFormula&&(n.f=yo(J(d.formula))),"string"==(d["数据类型"]||d["value-type"])&&(n.t="s",n.v=J(d["string-value"]||""),o.dense?(u[m]||(u[m]=[]),u[m][g]=n):u[te({r:m,c:g})]=n),g+=_-1;else if("/"!==a[1]){var h="",f=0,p=[],_=1,F=S?m+S-1:m;if(++g>y.e.c&&(y.e.c=g),g<y.s.c&&(y.s.c=g),m<y.s.r&&(y.s.r=m),F>y.e.r&&(y.e.r=F),I=[],n={t:(d=G(a[0],!(E={})))["数据类型"]||d["value-type"],v:null},o.cellFormula)if(d.formula&&(d.formula=J(d.formula)),d["number-matrix-columns-spanned"]&&d["number-matrix-rows-spanned"]&&(w=parseInt(d["number-matrix-rows-spanned"],10)||0,x=parseInt(d["number-matrix-columns-spanned"],10)||0,n.F=re(j={s:{r:m,c:g},e:{r:m+w-1,c:g+x-1}}),C.push([j,n.F])),d.formula)n.f=yo(d.formula);else for(O=0;O<C.length;++O)m>=C[O][0].s.r&&m<=C[O][0].e.r&&g>=C[O][0].s.c&&g<=C[O][0].e.c&&(n.F=C[O][1]);switch((d["number-columns-spanned"]||d["number-rows-spanned"])&&(w=parseInt(d["number-rows-spanned"],10)||0,x=parseInt(d["number-columns-spanned"],10)||0,b.push(j={s:{r:m,c:g},e:{r:m+w-1,c:g+x-1}})),d["number-columns-repeated"]&&(_=parseInt(d["number-columns-repeated"],10)),n.t){case"boolean":n.t="b",n.v=V(d["boolean-value"]);break;case"float":case"percentage":case"currency":n.t="n",n.v=parseFloat(d.value);break;case"date":n.t="d",n.v=X(d["date-value"]),o.cellDates||(n.t="n",n.v=H(n.v)),n.z="m/d/yy";break;case"time":n.t="n",n.v=function(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=n.length;++o)if(n[o]){switch(3<o&&(a=!0),n[o].slice(n[o].length-(r=1))){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[o].slice(n[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(n[o],10)}return t}(d["time-value"])/86400,o.cellDates&&(n.t="d",n.v=Ct(n.v)),n.z="HH:MM:SS";break;case"number":n.t="n",n.v=parseFloat(d["数据数值"]);break;default:if("string"!==n.t&&"text"!==n.t&&n.t)throw new Error("Unsupported value type "+n.t);n.t="s",null!=d["string-value"]&&(h=J(d["string-value"]),p=[])}}else{if(N=!1,"s"===n.t&&(n.v=h||"",p.length&&(n.R=p),N=0==f),T.Target&&(n.l=T),0<I.length&&(n.c=I,I=[]),h&&!1!==o.cellText&&(n.w=h),N&&(n.t="z",delete n.v),(!N||o.sheetStubs)&&!(o.sheetRows&&o.sheetRows<=m))for(var q=0;q<S;++q){if(_=parseInt(d["number-columns-repeated"]||"1",10),o.dense)for(u[m+q]||(u[m+q]=[]),u[m+q][g]=0==q?n:K(n);0<--_;)u[m+q][g+_]=K(n);else for(u[te({r:m+q,c:g})]=n;0<--_;)u[te({r:m+q,c:g+_})]=K(n);y.e.c<=g&&(y.e.c=g)}g+=(_=parseInt(d["number-columns-repeated"]||"1",10))-1,_=0,n={},h="",p=[]}T={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===a[1]){if((t=c.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"annotation":if("/"===a[1]){if((t=c.pop())[0]!==a[3])throw"Bad state: "+t;E.t=h,p.length&&(E.R=p),E.a=U,I.push(E)}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!1]);h=U="",f=z=0,p=[];break;case"creator":"/"===a[1]?U=s.slice(z,a.index):z=a.index+a[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===a[1]){if((t=c.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!1]);h="",f=0,p=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===a[1]){if(L.name,(t=c.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&(L=G(a[0],!1),c.push([a[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(c[c.length-1][0]){case"time-style":case"date-style":D=G(a[0],!1),ms[a[3]]["long"===D.style?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(c[c.length-1][0]){case"time-style":case"date-style":D=G(a[0],!1),ms[a[3]]["long"===D.style?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if("/>"!==a[0].slice(-2))if("/"===a[1])switch(c[c.length-1][0]){case"number-style":case"date-style":case"time-style":s.slice(B,a.index)}else B=a.index+a[0].length;break;case"named-range":var D,A=vo((D=G(a[0],!1))["cell-range-address"]),P={Name:D.name,Ref:A[0]+"!"+A[1]};$&&(P.Sheet=i.length),W.Names.push(P);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"文本串":-1<["master-styles"].indexOf(c[c.length-1][0])||("/"!==a[1]||d&&d["string-value"]?(G(a[0],!1),f=a.index+a[0].length):(P=(P=s.slice(f,a.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),R=[J(P.replace(/<[^>]*>/g,""))],h=(0<h.length?h+"\n":"")+R[0]));break;case"s":break;case"database-range":if("/"!==a[1])try{l[(A=vo(G(a[0])["target-range-address"]))[0]]["!autofilter"]={ref:A[1]}}catch(e){}break;case"date":case"object":break;case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==a[1]){if(!(T=G(a[0],!1)).href)break;T.Target=J(T.href),delete T.href,"#"==T.Target.charAt(0)&&-1<T.Target.indexOf(".")?(A=vo(T.Target.slice(1)),T.Target="#"+A[0]+"!"+A[1]):T.Target.match(/^\.\.[\\\/]/)&&(T.Target=T.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(a[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(o.WTF)throw new Error(a)}}e={Sheets:l,SheetNames:i,Workbook:W};return o.bookSheets&&delete e.Sheets,e}function ys(e,t){if(t=t||{},R(e,"META-INF/manifest.xml"))for(var r,a,n=L(e,"META-INF/manifest.xml"),o=t,s=fr(n);r=pr.exec(s);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(a=G(r[0],!1)).path&&a.type!==ga)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(o&&o.WTF)throw r}n=B(e,"content.xml");if(n)return t=gs(Y(n),t),R(e,"meta.xml")&&(t.Props=xa(L(e,"meta.xml"))),t;throw new Error("Missing content.xml in ODS / UOF file")}t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),vs="<office:document-styles "+dr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";var vs,bs,ws,xs,ks=function(){return S+vs},Ss=(bs=function(e){return _(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},ws="          <table:table-cell />\n",xs="          <table:covered-table-cell/>\n",function(e,t){var a,r,n,o,s=[S],c=dr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),l=dr({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(s.push("<office:document"+c+l+">\n"),s.push(va().replace(/office:document-meta/g,"office:meta"))):s.push("<office:document-content"+c+">\n"),r=e,(a=s).push(" <office:automatic-styles>\n"),a.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),a.push('   <number:month number:style="long"/>\n'),a.push("   <number:text>/</number:text>\n"),a.push('   <number:day number:style="long"/>\n'),a.push("   <number:text>/</number:text>\n"),a.push("   <number:year/>\n"),a.push("  </number:date-style>\n"),n=0,r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(e){if(e&&e["!cols"])for(var t=0;t<e["!cols"].length;++t)if(e["!cols"][t]){var r=e["!cols"][t];if(null==r.width&&null==r.wpx&&null==r.wch)continue;qn(r),r.ods=n;r=e["!cols"][t].wpx+"px";a.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+r+'"/>\n'),a.push("  </style:style>\n"),++n}}),o=0,r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(e){if(e&&e["!rows"])for(var t,r=0;r<e["!rows"].length;++r)e["!rows"][r]&&(e["!rows"][r].ods=o,t=e["!rows"][r].hpx+"px",a.push('  <style:style style:name="ro'+o+'" style:family="table-row">\n'),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+t+'"/>\n'),a.push("  </style:style>\n"),++o)}),a.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),a.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),a.push("  </style:style>\n"),a.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),a.push(" </office:automatic-styles>\n"),s.push("  <office:body>\n"),s.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)s.push(_s(e.Sheets[e.SheetNames[i]],e,i));return s.push("    </office:spreadsheet>\n"),s.push("  </office:body>\n"),"fods"==t.bookType?s.push("</office:document>"):s.push("</office:document-content>"),s.join("")});function _s(e,t,r){var a=[],n=(a.push('      <table:table table:name="'+_(t.SheetNames[r])+'" table:style-name="ta1">\n'),0),o=0,s=ea(e["!ref"]||"A1"),c=e["!merges"]||[],l=0,i=Array.isArray(e);if(e["!cols"])for(o=0;o<=s.e.c;++o)a.push("        <table:table-column"+(e["!cols"][o]?' table:style-name="co'+e["!cols"][o].ods+'"':"")+"></table:table-column>\n");for(var u="",d=e["!rows"]||[],n=0;n<s.s.r;++n)u=d[n]?' table:style-name="ro'+d[n].ods+'"':"",a.push("        <table:table-row"+u+"></table:table-row>\n");for(;n<=s.e.r;++n){for(u=d[n]?' table:style-name="ro'+d[n].ods+'"':"",a.push("        <table:table-row"+u+">\n"),o=0;o<s.s.c;++o)a.push(ws);for(;o<=s.e.c;++o){for(var h=!1,f={},p="",l=0;l!=c.length;++l)if(!(c[l].s.c>o||c[l].s.r>n||c[l].e.c<o||c[l].e.r<n)){c[l].s.c==o&&c[l].s.r==n||(h=!0),f["table:number-columns-spanned"]=c[l].e.c-c[l].s.c+1,f["table:number-rows-spanned"]=c[l].e.r-c[l].s.r+1;break}if(h)a.push(xs);else{var m=te({r:n,c:o}),g=i?(e[n]||[])[o]:e[m];if(g&&g.f&&(f["table:formula"]=_(("of:="+g.f.replace(fo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),g.F)&&g.F.slice(0,m.length)==m&&(m=ea(g.F),f["table:number-matrix-columns-spanned"]=m.e.c-m.s.c+1,f["table:number-matrix-rows-spanned"]=m.e.r-m.s.r+1),g){switch(g.t){case"b":p=g.v?"TRUE":"FALSE",f["office:value-type"]="boolean",f["office:boolean-value"]=g.v?"true":"false";break;case"n":p=g.w||String(g.v||0),f["office:value-type"]="float",f["office:value"]=g.v||0;break;case"s":case"str":p=null==g.v?"":g.v,f["office:value-type"]="string";break;case"d":p=g.w||X(g.v).toISOString(),f["office:value-type"]="date",f["office:date-value"]=X(g.v).toISOString(),f["table:style-name"]="ce1";break;default:a.push(ws);continue}var y,m=bs(p);g.l&&g.l.Target&&(m=C("text:a",m,{"xlink:href":(y="#"==(y="#"==(y=g.l.Target).charAt(0)?"#"+y.slice(1).replace(/\./,"!"):y).charAt(0)||y.match(/^\w+:/)?y:"../"+y).replace(/&/g,"&amp;")})),a.push("          "+C("table:table-cell",C("text:p",m,{}),f)+"\n")}else a.push(ws)}}a.push("        </table:table-row>\n")}return a.push("      </table:table>\n"),a.join("")}function Cs(e,t){var r,a,n,o;return"fods"==t.bookType?Ss(e,t):(o="",a=[],n=[],j(r=Mt(),o="mimetype","application/vnd.oasis.opendocument.spreadsheet"),j(r,o="content.xml",Ss(e,t)),a.push([o,"text/xml"]),n.push([o,"ContentFile"]),j(r,o="styles.xml",ks(e,t)),a.push([o,"text/xml"]),n.push([o,"StylesFile"]),j(r,o="meta.xml",S+va()),a.push([o,"text/xml"]),n.push([o,"MetadataFile"]),j(r,o="manifest.rdf",function(e){var t=[S];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(ya(e[r][0],e[r][1])),t.push(['  <rdf:Description rdf:about="">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[r][0]+'"/>\n',"  </rdf:Description>\n"].join(""));return t.push(ya("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(n)),a.push([o,"application/rdf+xml"]),j(r,o="META-INF/manifest.xml",function(e){var t=[S];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),r)}function Ts(a){return function(e){for(var t=0;t!=a.length;++t){var r=a[t];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}}}function As(e){Ts([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Is(t,e){if(!t)return 0;try{t=e.map(function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,(e=t["!id"][e.id].Type,-1<I.WS.indexOf(e)?"sheet":I.CS&&e==I.CS?"chart":I.DS&&e==I.DS?"dialog":I.MS&&e==I.MS?"macro":e&&e.length?e:"sheet")]})}catch(e){return null}return t&&0!==t.length?t:null}function Es(i,u,e,d,t,h,r,a,f,n,o,s){try{h[d]=pa(B(i,e,!0),u);var c,l,p,m,g,y=L(i,u);switch(a){case"sheet":x=y,k=t,S=f,_=h[d],C=n,T=o,A=s,g=(".bin"===u.slice(-4)?parse_ws_bin:qo)(x,S,k,_,C,T,A);break;case"chart":(g=cs(y,u,t,f,h[d],n,o,s))&&g["!drawel"]&&(l=fa(c=Rt(g["!drawel"].Target,u)),b=B(i,c,!0),w=pa(B(i,l,!0),c),m=fa(p=Rt(b?(b=(b.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],w["!id"][b].Target):"??",c)),g=Jo(B(i,p,!0),0,0,pa(B(i,m,!0),p),0,g));break;case"macro":u.slice(-4),g={"!type":"macro"};break;case"dialog":u.slice(-4),g={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+a)}r[d]=g;var v=[];h&&h[d]&&O(h[d]).forEach(function(e){var a,n,o,s,c,l,t="";if(h[d][e].Type==I.CMNT){var t=Rt(h[d][e].Target,u),r=is(L(i,t,!0),t,f);if(!r||!r.length)return;oo(g,r,!1)}h[d][e].Type==I.TCMNT&&(t=Rt(h[d][e].Target,u),v=v.concat((a=L(i,t,!0),n=f,s=!(o=[]),c={},l=0,a.replace(U,function(e,t){var r=G(e);switch(Wt(r[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":c={author:r.personId,guid:r.id,ref:r.ref,T:1};break;case"</threadedComment>":null!=c.t&&o.push(c);break;case"<text>":case"<text":l=t+e.length;break;case"</text>":c.t=a.slice(l,t).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e}),o)))}),v&&v.length&&oo(g,v,!0,f.people||[])}catch(e){if(f.WTF)throw e}var b,w,x,k,S,_,C,T,A}function Ns(e){return"/"==e.charAt(0)?e.slice(1):e}function Os(n,o){var t;if(Je(),Ts([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(o=o||{}),R(n,"META-INF/manifest.xml"))return ys(n,o);if(R(n,"objectdata.xml"))return ys(n,o);if(R(n,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if("undefined"!=typeof parse_numbers_iwa)return n.FileIndex?parse_numbers_iwa(n):(t=z.utils.cfb_new(),Pt(n).forEach(function(e){j(t,e,function e(t,r,a){if(!a)return qt(Dt(t,r));if(!r)return null;try{return e(t,r)}catch(e){return null}}(n,e))}),parse_numbers_iwa(t));throw new Error("Unsupported NUMBERS file")}if(!R(n,"[Content_Types].xml")){if(R(n,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(R(n,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var e=Pt(n),r=function(e){var r=da();if(e&&e.match){var a={};if((e.match(U)||[]).forEach(function(e){var t=G(e);switch(t[0].replace(Bt,"<")){case"<?xml":break;case"<Types":r.xmlns=t["xmlns"+(t[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[t.Extension]=t.ContentType;break;case"<Override":void 0!==r[ia[t.ContentType]]&&r[ia[t.ContentType]].push(t.PartName)}}),r.xmlns!==Z.CT)throw new Error("Unknown Namespace: "+r.xmlns);r.calcchain=0<r.calcchains.length?r.calcchains[0]:"",r.sst=0<r.strs.length?r.strs[0]:"",r.style=0<r.styles.length?r.styles[0]:"",r.defaults=a,delete r.calcchains}return r}(B(n,"[Content_Types].xml")),a=!1;if(0===r.workbooks.length&&L(n,s="xl/workbook.xml",!0)&&r.workbooks.push(s),0===r.workbooks.length){if(!L(n,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");r.workbooks.push(s),a=!0}"bin"==r.workbooks[0].slice(-3)&&(a=!0);var s,c={},l={};if(!o.bookSheets&&!o.bookProps){if(bo=[],r.sst)try{bo=ls(L(n,Ns(r.sst)),r.sst,o)}catch(e){if(o.WTF)throw e}o.cellStyles&&r.themes.length&&(c=eo(B(n,r.themes[0].replace(/^\//,""),!0)||"",o)),r.style&&(s=L(n,Ns(r.style)),i=r.style,u=c,d=o,l=(".bin"===i.slice(-4)?parse_sty_bin:$n)(s,u,d))}r.links.map(function(e){try{pa(B(n,fa(Ns(e))),e);var t=L(n,Ns(e)),r=e,a=o;if(".bin"===r.slice(-4))return ro(t,0,0,a)}catch(e){}});i=L(n,Ns(r.workbooks[0])),u=r.workbooks[0],d=o;var i,u,d,h=(".bin"===u.slice(-4)?parse_wb_bin:ss)(i,d),f={},p="",m=(r.coreprops.length&&((p=L(n,Ns(r.coreprops[0]),!0))&&(f=xa(p)),0!==r.extprops.length)&&(p=L(n,Ns(r.extprops[0]),!0))&&Ca(p,f,o),{}),g=(o.bookSheets&&!o.bookProps||0!==r.custprops.length&&(p=B(n,Ns(r.custprops[0]),!0))&&(m=function(e,t){var r={},a="",n=e.match(Aa);if(n)for(var o=0;o!=n.length;++o){var s=n[o],c=G(s);switch(c[0]){case"<?xml":case"<Properties":break;case"<property":a=J(c.name);break;case"</property>":a=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),i=l[0].slice(4),u=l[1];switch(i){case"lpstr":case"bstr":case"lpwstr":r[a]=J(u);break;case"bool":r[a]=V(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=X(u);break;case"cy":case"error":r[a]=J(u);break;default:"/"!=i.slice(-1)&&t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,i,l)}}else if("</"!==s.slice(0,2)&&t.WTF)throw new Error(s)}}return r}(p,o)),{});if(!o.bookSheets&&!o.bookProps||(h.Sheets?w=h.Sheets.map(function(e){return e.name}):f.Worksheets&&0<f.SheetNames.length&&(w=f.SheetNames),o.bookProps&&(g.Props=f,g.Custprops=m),o.bookSheets&&void 0!==w&&(g.SheetNames=w),o.bookSheets?!g.SheetNames:!o.bookProps)){var y,v,b,w={},p={},x=(o.bookDeps&&r.calcchain&&(N=L(n,Ns(r.calcchain)),C=r.calcchain,y=o,p=(".bin"===C.slice(-4)?parse_cc_bin:parse_cc_xml)(N,C,y)),0),k={},S=h.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var _=0;_!=S.length;++_)f.SheetNames[_]=S[_].name;for(var C,T,A,I,E=a?"bin":"xml",N=r.workbooks[0].lastIndexOf("/"),O=(r.workbooks[0].slice(0,N+1)+"_rels/"+r.workbooks[0].slice(N+1)+".rels").replace(/^\//,""),F=(R(n,O)||(O="xl/_rels/workbook."+E+".rels"),pa(B(n,O,!0),O.replace(/_rels.*/,"s5s"))),M=(1<=(r.metadata||[]).length&&(o.xlmeta=us(L(n,Ns(r.metadata[0])),r.metadata[0],o)),1<=(r.people||[]).length&&(o.people=(C=L(n,Ns(r.people[0])),T=o,I=!(A=[]),C.replace(U,function(e){var t;switch(Wt((t=G(e))[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":A.push({name:t.displayname,id:t.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":I=!0;break;case"</ext>":I=!1;break;default:if(!I&&T.WTF)throw new Error("unrecognized "+t[0]+" in threaded comments")}return e}),A)),F=F&&Is(F,h.Sheets),L(n,"xl/worksheets/sheet.xml",!0)?1:0),x=0;x!=f.Worksheets;++x){var q="sheet";if(F&&F[x]?(v="xl/"+F[x][1].replace(/[\/]?xl\//,""),R(n,v)||(v=F[x][1]),R(n,v)||(v=O.replace(/_rels\/.*$/,"")+F[x][1]),q=F[x][2]):v=(v="xl/worksheets/sheet"+(x+1-M)+"."+E).replace(/sheet0\./,"sheet."),b=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),o&&null!=o.sheets)switch(typeof o.sheets){case"number":if(x!=o.sheets)continue;break;case"string":if(f.SheetNames[x].toLowerCase()!=o.sheets.toLowerCase())continue;break;default:if(Array.isArray&&Array.isArray(o.sheets)){for(var D=!1,P=0;P!=o.sheets.length;++P)"number"==typeof o.sheets[P]&&o.sheets[P]==x&&(D=1),"string"==typeof o.sheets[P]&&o.sheets[P].toLowerCase()==f.SheetNames[x].toLowerCase()&&(D=1);if(!D)continue}}Es(n,v,b,f.SheetNames[x],x,k,w,q,o,h,c,l)}g={Directory:r,Workbook:h,Props:f,Custprops:m,Deps:p,Sheets:w,SheetNames:f.SheetNames,Strings:bo,Styles:l,Themes:c,SSF:K(W)},o&&o.bookFiles&&(n.files?(g.keys=e,g.files=n.files):(g.keys=[],g.files={},n.FullPaths.forEach(function(e,t){e=e.replace(/^Root Entry[\/]/,""),g.keys.push(e),g.files[e]=n.FileIndex[t]}))),o&&o.bookVBA&&(0<r.vba.length?g.vbaraw=L(n,Ns(r.vba[0]),!0):r.defaults&&r.defaults.bin===so&&(g.vbaraw=L(n,"xl/vbaProject.bin",!0)))}return g}function Fs(e,t){ao=1024,e&&!e.SSF&&(e.SSF=K(W)),e&&e.SSF&&(Je(),Ge(e.SSF),t.revssf=xt(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=-1<co.indexOf(t.bookType),n=da(),o=(As(t=t||{}),Mt()),s="",c=0;if(t.cellXfs=[],ko(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),j(o,s="docProps/core.xml",Sa(e.Props,t)),n.coreprops.push(s),T(t.rels,2,s,I.CORE_PROPS),s="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var l=[],i=0;i<e.SheetNames.length;++i)2!=(e.Workbook.Sheets[i]||{}).Hidden&&l.push(e.SheetNames[i]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,j(o,s,Ta(e.Props)),n.extprops.push(s),T(t.rels,3,s,I.EXT_PROPS),e.Custprops!==e.Props&&0<O(e.Custprops||{}).length&&(j(o,s="docProps/custom.xml",Ia(e.Custprops)),n.custprops.push(s),T(t.rels,4,s,I.CUST_PROPS));var u,d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var h,f,p,m,g={"!id":{}},y=e.Sheets[e.SheetNames[c-1]];(y||{})["!type"];j(o,s="xl/worksheets/sheet"+c+"."+r,Go(c-1,t,e,g)),n.sheets.push(s),T(t.wbrels,-1,"worksheets/sheet"+c+"."+r,I.WS[0]),y&&(f=!1,p="",(h=y["!comments"])&&0<h.length&&(m=!1,h.forEach(function(e){e[1].forEach(function(e){1==e.T&&(m=!0)})}),m&&(j(o,p="xl/threadedComments/threadedComment"+c+".xml",function(e,o,s){var c=[S,C("ThreadedComments",null,{xmlns:Z.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var n="";(a[1]||[]).forEach(function(e,t){var r;e.T?(e.a&&-1==o.indexOf(e.a)&&o.push(e.a),r={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"},0==t?n=r.id:r.parentId=n,e.ID=r.id,e.a&&(r.personId="{54EE7950-7262-4200-6969-"+("000000000000"+o.indexOf(e.a)).slice(-12)+"}"),c.push(C("threadedComment",ur("text",e.t||""),r))):delete e.ID})}),c.push("</ThreadedComments>"),c.join("")}(h,d,t)),n.threadedcomments.push(p),T(g,-1,"../threadedComments/threadedComment"+c+".xml",I.TCMNT)),j(o,p="xl/comments"+c+"."+r,function(e){var o=[S,C("comments",null,{xmlns:mr[0]})],s=[];return o.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var t=_(e.a);-1==s.indexOf(t)&&(s.push(t),o.push("<author>"+t+"</author>")),e.T&&e.ID&&-1==s.indexOf("tc="+e.ID)&&(s.push("tc="+e.ID),o.push("<author>tc="+e.ID+"</author>"))})}),0==s.length&&(s.push("SheetJ5"),o.push("<author>SheetJ5</author>")),o.push("</authors>"),o.push("<commentList>"),e.forEach(function(e){var t=0,r=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?t=s.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(t=s.indexOf(_(e.a))),r.push(e.t||"")}),o.push('<comment ref="'+e[0]+'" authorId="'+t+'"><text>'),r.length<=1)o.push(ur("t",_(r[0]||"")));else{for(var a="Comment:\n    "+r[0]+"\n",n=1;n<r.length;++n)a+="Reply:\n    "+r[n]+"\n";o.push(ur("t",_(a)))}o.push("</text></comment>")}),o.push("</commentList>"),2<o.length&&(o[o.length]="</comments>",o[1]=o[1].replace("/>",">")),o.join("")}(h)),n.comments.push(p),T(g,-1,"../comments"+c+"."+r,I.CMNT),f=!0),y["!legacy"]&&f&&j(o,"xl/drawings/vmlDrawing"+c+".vml",no(c,y["!comments"])),delete y["!comments"],delete y["!legacy"]),g["!id"].rId1&&j(o,fa(s),ma(g))}return null!=t.Strings&&0<t.Strings.length&&(j(o,s="xl/sharedStrings.xml",function(e,t){if(!t.bookSST)return"";var r=[S];r[r.length]=C("sst",null,{xmlns:mr[0],count:e.Count,uniqueCount:e.Unique});for(var a,n,o=0;o!=e.length;++o)null!=e[o]&&(n="<si>",(a=e[o]).r?n+=a.r:(n+="<t",a.t||(a.t=""),a.t.match(Cn)&&(n+=' xml:space="preserve"'),n+=">"+_(a.t)+"</t>"),r[r.length]=n+="</si>");return 2<r.length&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}(t.Strings,t)),n.strs.push(s),T(t.wbrels,-1,"sharedStrings.xml",I.SST)),j(o,s="xl/workbook.xml",function(t){var r=[S],e=(r[r.length]=C("workbook",null,{xmlns:mr[0],"xmlns:r":Z.r}),t.Workbook&&0<(t.Workbook.Names||[]).length),a={codeName:"ThisWorkbook"},n=(t.Workbook&&t.Workbook.WBProps&&(Vo.forEach(function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(a[e[0]]=t.Workbook.WBProps[e[0]])}),t.Workbook.WBProps.CodeName)&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName),r[r.length]=C("workbookPr",null,a),t.Workbook&&t.Workbook.Sheets||[]),o=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=t.SheetNames.length&&n[o]&&n[o].Hidden;++o);o==t.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var s={name:_(t.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),n[o])switch(n[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}r[r.length]=C("sheet",null,s)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(r[r.length]=C("definedName",_(e.Ref),t))}),r[r.length]="</definedNames>"),2<r.length&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}(e)),n.workbooks.push(s),T(t.rels,1,s,I.WB),j(o,s="xl/theme/theme1.xml",to(e.Themes,t)),n.themes.push(s),T(t.wbrels,-1,"theme/theme1.xml",I.THEME),j(o,s="xl/styles.xml",Hn(e,t)),n.styles.push(s),T(t.wbrels,-1,"styles.xml",I.STY),e.vbaraw&&a&&(j(o,s="xl/vbaProject.bin",e.vbaraw),n.vba.push(s),T(t.wbrels,-1,"vbaProject.bin",I.VBA)),j(o,s="xl/metadata.xml",((a=[S]).push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),a.join(""))),n.metadata.push(s),T(t.wbrels,-1,"metadata.xml",I.XLMETA),1<d.length&&(j(o,s="xl/persons/person.xml",(a=d,u=[S,C("personList",null,{xmlns:Z.TCMNT,"xmlns:x":mr[0]}).replace(/[\/]>/,">")],a.forEach(function(e,t){u.push(C("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:e,providerId:"None"}))}),u.push("</personList>"),u.join(""))),n.people.push(s),T(t.wbrels,-1,"persons/person.xml",I.PEOPLE)),j(o,"[Content_Types].xml",ha(n,t)),j(o,"_rels/.rels",ma(t.rels)),j(o,"xl/_rels/workbook.xml.rels",ma(t.wbrels)),delete t.revssf,delete t.ssf,o}function qs(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fe(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ds(e,t){if(z.find(e,"EncryptedPackage")){var r=e,a=(a=t)||{},n="Workbook",o=z.find(r,n);try{if(n="/!DataSpaces/Version",!(o=z.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(o.content),n="/!DataSpaces/DataSpaceMap",!(o=z.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=parse_DataSpaceMap(o.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(o=z.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=parse_DataSpaceDefinition(o.content);if(1!=c.length||"StrongEncryptionTransform"!=c[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(o=z.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(o.content)}catch(e){}if(!(o=z.find(r,n="/EncryptionInfo"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s=parse_EncryptionInfo(o.content),n="/EncryptedPackage",!(o=z.find(r,n))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==s[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(s[1],o.content,a.password||"",a);if(2==s[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(s[1],o.content,a.password||"",a);throw new Error("File is password-protected")}return parse_xlscfb(e,t)}function Ps(e,t){var r=e,t=t||{};return t.type||(t.type=ue&&Buffer.isBuffer(e)?"buffer":"base64"),Os(function(e,t){switch(t.type){case"base64":return z.read(e,{type:"base64"});case"binary":return z.read(e,{type:"binary"});case"buffer":case"array":return z.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}(r,t),t)}function Ms(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return parse_xlml(e.slice(r),t);default:break e}return rn.to_workbook(e,t)}function Rs(e,t,r,a){return a?(r.type="string",rn.to_workbook(e,r)):rn.to_workbook(t,r)}function Ls(e,t){p();var r=t||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Ls(new Uint8Array(e),((r=K(r)).type="array",r));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!=typeof Deno?"buffer":"array");var a,n=e,o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),wo={},r.dateNF&&(wo.dateNF=r.dateNF),r.type||(r.type=ue&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=ue?"buffer":"binary",n=function(e){if(void 0!==gt)return gt.readFileSync(e);if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e),r=(t.open("r"),t.encoding="binary",t.read());return t.close(),r}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||ue||(r.type="array")),"string"==r.type&&(o=!0,r.type="binary",r.codepage=65001,n=(t=e).match(/[^\x00-\x7F]/)?rr(t):t),"array"==r.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){t=new ArrayBuffer(3),t=new Uint8Array(t);if(t.foo="bar",!t.foo)return(r=K(r)).type="array",Ls(y(n),r)}switch((a=qs(n,r))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return Ds(z.read(n,r),r);break;case 9:if(a[1]<=8)return parse_xlscfb(n,r);break;case 60:return parse_xlml(n,r);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68!==a[1])break;var s=n,c=r,l=c||{},i=!!l.WTF;l.WTF=!0;try{var u=Ba.to_workbook(s,l);return l.WTF=i,u}catch(e){if(l.WTF=i,!e.message.match(/SYLK bad record ID/)&&i)throw e;return rn.to_workbook(s,c)}return;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return Ua.to_workbook(n,r);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?Ps(n,r):Rs(e,n,r,o);case 239:return 60===a[3]?parse_xlml(n,r):Rs(e,n,r,o);case 255:if(254===a[1])return u=n,"base64"==(l=r).type&&(u=fe(u)),u=$cptable.utils.decode(1200,u.slice(2),"str"),l.type="binary",Ms(u,l);if(0===a[1]&&2===a[2]&&0===a[3])return WK_.to_workbook(n,r);break;case 0:if(0===a[1]){if(2<=a[2]&&0===a[3])return WK_.to_workbook(n,r);if(0===a[2]&&(8===a[3]||9===a[3]))return WK_.to_workbook(n,r)}break;case 3:case 131:case 139:case 140:return qa.to_workbook(n,r);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return RTF.to_workbook(n,r);break;case 10:case 13:case 32:var d=n,h=r,f="",i=qs(d,h);switch(h.type){case"base64":f=fe(d);break;case"binary":f=d;break;case"buffer":f=d.toString("binary");break;case"array":f=It(d);break;default:throw new Error("Unrecognized type "+h.type)}return 239==i[0]&&187==i[1]&&191==i[2]&&(f=Y(f)),h.type="binary",Ms(f,h);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet")}return-1<Fa.indexOf(a[0])&&a[2]<=12&&a[3]<=31?qa.to_workbook(n,r):Rs(e,n,r,o)}function Bs(e,t){t=t||{};return t.type="file",Ls(e,t)}function js(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bt(t.file,z.write(e,{type:ue?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return z.write(e,t)}function Ws(e,t){switch(t.bookType){case"ods":return Cs(e,t);case"numbers":return write_numbers_iwa(e,t);case"xlsb":var r=e,a=t,n=(ao=1024,r&&!r.SSF&&(r.SSF=K(W)),r&&r.SSF&&(Je(),Ge(r.SSF),a.revssf=xt(r.SSF),a.revssf[r.SSF[65535]]=0,a.ssf=r.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,xo?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo),"bin"),o=da(),s=(As(a=a||{}),Mt()),c="",l=0;if(a.cellXfs=[],ko(a.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),j(s,c="docProps/core.xml",Sa(r.Props,a)),o.coreprops.push(c),T(a.rels,2,c,I.CORE_PROPS),c="docProps/app.xml",!r.Props||!r.Props.SheetNames)if(r.Workbook&&r.Workbook.Sheets){for(var i=[],u=0;u<r.SheetNames.length;++u)2!=(r.Workbook.Sheets[u]||{}).Hidden&&i.push(r.SheetNames[u]);r.Props.SheetNames=i}else r.Props.SheetNames=r.SheetNames;for(r.Props.Worksheets=r.Props.SheetNames.length,j(s,c,Ta(r.Props)),o.extprops.push(c),T(a.rels,3,c,I.EXT_PROPS),r.Custprops!==r.Props&&0<O(r.Custprops||{}).length&&(j(s,c="docProps/custom.xml",Ia(r.Custprops)),o.custprops.push(c),T(a.rels,4,c,I.CUST_PROPS)),l=1;l<=r.SheetNames.length;++l){var d,h,f,p={"!id":{}},m=r.Sheets[r.SheetNames[l-1]];(m||{})["!type"];j(s,c="xl/worksheets/sheet"+l+"."+n,write_ws_bin(l-1,a,r,p)),o.sheets.push(c),T(a.wbrels,-1,"worksheets/sheet"+l+"."+n,I.WS[0]),m&&(h=!1,f="",(d=m["!comments"])&&0<d.length&&(j(s,f="xl/comments"+l+"."+n,write_comments_bin(d,a)),o.comments.push(f),T(p,-1,"../comments"+l+"."+n,I.CMNT),h=!0),m["!legacy"]&&h&&j(s,"xl/drawings/vmlDrawing"+l+".vml",no(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]),p["!id"].rId1&&j(s,fa(c),ma(p))}return null!=a.Strings&&0<a.Strings.length&&(j(s,c="xl/sharedStrings.bin",write_sst_bin(a.Strings,a)),o.strs.push(c),T(a.wbrels,-1,"sharedStrings.bin",I.SST)),j(s,c="xl/workbook.bin",write_wb_bin(r,a)),o.workbooks.push(c),T(a.rels,1,c,I.WB),j(s,c="xl/theme/theme1.xml",to(r.Themes,a)),o.themes.push(c),T(a.wbrels,-1,"theme/theme1.xml",I.THEME),j(s,c="xl/styles.bin",write_sty_bin(r,a)),o.styles.push(c),T(a.wbrels,-1,"styles.bin",I.STY),r.vbaraw&&(j(s,c="xl/vbaProject.bin",r.vbaraw),o.vba.push(c),T(a.wbrels,-1,"vbaProject.bin",I.VBA)),j(s,c="xl/metadata.bin",write_xlmeta_bin()),o.metadata.push(c),T(a.wbrels,-1,"metadata.bin",I.XLMETA),j(s,"[Content_Types].xml",ha(o,a)),j(s,"_rels/.rels",ma(a.rels)),j(s,"xl/_rels/workbook.bin.rels",ma(a.wbrels)),delete a.revssf,delete a.ssf,s;default:return Fs(e,t)}}function Us(e,t){var r={},a=ue?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}e=e.FullPaths?z.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!=typeof Deno&&"string"==typeof e){if("binary"==t.type||"base64"==t.type)return e;e=new Uint8Array(m(e))}return t.password&&"undefined"!=typeof encrypt_agile?js(encrypt_agile(e,t.password),t):"file"===t.type?bt(t.file,e):"string"==t.type?Y(e):e}function zs(e,t,r){var a=(r=r||"")+e;switch(t.type){case"base64":return he(rr(a));case"binary":return rr(a);case"string":return e;case"file":return bt(t.file,a,"utf8");case"buffer":return ue?pe(a,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(a):zs(a,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $s(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return"base64"==t.type?he(r):"string"==t.type?Y(r):r;case"file":return bt(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Hs(e,t){p(),ns(e);var r,t=K(t||{});return t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type?(t.type="binary",r=Hs(e,t),t.type="array",m(r)):(r=e,e=K((e=t)||{}),Us(Fs(r,e),e))}function Xs(e,t){p(),ns(e);var r=K(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type)return r.type="binary",t=Xs(e,r),r.type="array",m(t);var a,n,o=0;if(r.sheet&&(o="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return zs(write_xlml(e,r),r);case"slk":case"sylk":return zs(Ba.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"htm":case"html":return zs(ds(e.Sheets[e.SheetNames[o]],r),r);case"txt":var s=Zs(e.Sheets[e.SheetNames[o]],r),c=r;switch(c.type){case"base64":return he(s);case"binary":case"string":return s;case"file":return bt(c.file,s,"binary");case"buffer":return ue?pe(s,"binary"):s.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+c.type);case"csv":return zs(Ys(e.Sheets[e.SheetNames[o]],r),r,"\ufeff");case"dif":return zs(Ua.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"dbf":return $s(qa.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"prn":return zs(rn.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"rtf":return zs(RTF.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"eth":return zs(Ya.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"fods":return zs(Cs(e,r),r);case"wk1":return $s(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[o]],r),r);case"wk3":return $s(WK_.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$s(write_biff_buf(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),n=(n=r)||{},js(write_xlscfb(e,n),n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return n=e,a=K((a=r)||{}),Us(Ws(n,a),a);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Ks(e){var t;e.bookType||((t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType)}function Gs(e,t,r){r=r||{};return r.type="file",r.file=t,Ks(r),Xs(e,r)}function Js(e,t){if(null==e||null==e["!ref"])return[];var r,a={t:"n",v:0},n=0,o=1,s=[],c="",l={s:{r:0,c:0},e:{r:0,c:0}},i=t||{},u=null!=i.range?i.range:e["!ref"];switch(1===i.header?n=1:"A"===i.header?n=2:Array.isArray(i.header)?n=3:null==i.header&&(n=0),typeof u){case"string":l=ae(u);break;case"number":(l=ae(e["!ref"])).s.r=u;break;default:l=u}0<n&&(o=0);for(var d,h=Yr(l.s.r),f=[],p=[],m=0,g=0,y=Array.isArray(e),v=l.s.r,b=0,w={},x=(y&&!e[v]&&(e[v]=[]),i.skipHidden&&e["!cols"]||[]),k=i.skipHidden&&e["!rows"]||[],b=l.s.c;b<=l.e.c;++b)if(!(x[b]||{}).hidden)switch(f[b]=Qr(b),a=y?e[v][b]:e[f[b]+h],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=f[b];break;case 3:s[b]=i.header[b-l.s.c];break;default:if(c=r=ra(a=null==a?{w:"__EMPTY",t:"s"}:a,null,i),g=w[r]||0){for(;w[c=r+"_"+g++];);w[r]=g,w[c]=1}else w[r]=1;s[b]=c}for(v=l.s.r+o;v<=l.e.r;++v)!(k[v]||{}).hidden&&(!1===(d=function(e,t,r,a,n,o,s,c){var l=Yr(r),i=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),d=!0,h=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(e){h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[r][f]:e[a[f]+l];if(void 0===p||void 0===p.t)void 0!==i&&null!=o[f]&&(h[o[f]]=i);else{var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=o[f]){if(null==m)if("e"==p.t&&null===m)h[o[f]]=null;else if(void 0!==i)h[o[f]]=i;else{if(!u||null!==m)continue;h[o[f]]=null}else h[o[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==c.rawNumbers)?m:ra(p,m,c);null!=m&&(d=!1)}}}return{row:h,isempty:d}}(e,l,v,f,n,s,y,i)).isempty||(1===n?!1!==i.blankrows:i.blankrows))&&(p[m++]=d.row);return p.length=m,p}var Vs=/"/g;function Ys(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var n=ae(e["!ref"]),o=void 0!==a.FS?a.FS:",",s=o.charCodeAt(0),c=void 0!==a.RS?a.RS:"\n",l=c.charCodeAt(0),i=new RegExp(("|"==o?"\\|":o)+"+$"),u="",d=[],h=(a.dense=Array.isArray(e),a.skipHidden&&e["!cols"]||[]),f=a.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(h[p]||{}).hidden||(d[p]=Qr(p));for(var m=0,g=n.s.r;g<=n.e.r;++g)(f[g]||{}).hidden||null==(u=function(e,t,r,a,n,o,s,c){for(var l=!0,i=[],u="",d=Yr(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var f=c.dense?(e[r]||[])[h]:e[a[h]+d];if(null==f)u="";else if(null!=f.v){for(var p,l=!1,u=""+(c.rawNumbers&&"n"==f.t?f.v:ra(f,null,c)),m=0;m!==u.length;++m)if((p=u.charCodeAt(m))===n||p===o||34===p||c.forceQuotes){u='"'+u.replace(Vs,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,0<=(u="="+f.f).indexOf(",")&&(u='"'+u.replace(Vs,'""')+'"'));i.push(u)}return!1===c.blankrows&&l?null:i.join(s)}(e,n,g,d,s,l,o,a))||!(u=a.strip?u.replace(i,""):u)&&!1===a.blankrows||r.push((m++?c:"")+u);return delete a.dense,r.join("")}function Zs(e,t){(t=t||{}).FS="\t",t.RS="\n";e=Ys(e,t);return"undefined"==typeof $cptable||"string"==t.type?e:(t=$cptable.utils.encode(1200,e,"str"),String.fromCharCode(255)+String.fromCharCode(254)+t)}function Qs(e,t,r){var s,c=r||{},l=+!c.skipHeader,i=e||{},u=0,d=0,e=(i&&null!=c.origin&&("number"==typeof c.origin?u=c.origin:(r="string"==typeof c.origin?ee(c.origin):c.origin,u=r.r,d=r.c)),{s:{c:0,r:0},e:{c:d,r:u+t.length-1+l}}),h=(i["!ref"]?(r=ae(i["!ref"]),e.e.c=Math.max(e.e.c,r.e.c),e.e.r=Math.max(e.e.r,r.e.r),-1==u&&(u=r.e.r+1,e.e.r=u+t.length-1+l)):-1==u&&(u=0,e.e.r=t.length-1+l),c.header||[]),f=0,a=(t.forEach(function(n,o){O(n).forEach(function(e){-1==(f=h.indexOf(e))&&(h[f=h.length]=e);var e=n[e],t="z",r="",a=te({c:d+f,r:u+o+l});s=ec(i,a),!e||"object"!=typeof e||e instanceof Date?("number"==typeof e?t="n":"boolean"==typeof e?t="b":"string"==typeof e?t="s":e instanceof Date?(t="d",c.cellDates||(t="n",e=H(e)),r=c.dateNF||W[14]):null===e&&c.nullError&&(t="e",e=0),s?(s.t=t,s.v=e,delete s.w,delete s.R,r&&(s.z=r)):i[a]=s={t:t,v:e},r&&(s.z=r)):i[a]=e})}),e.e.c=Math.max(e.e.c,d+h.length-1),Yr(u));if(l)for(f=0;f<h.length;++f)i[Qr(f+d)+a]={t:"s",v:h[f]};return i["!ref"]=re(e),i}function ec(e,t,r){var a;return"string"==typeof t?Array.isArray(e)?(e[(a=ee(t)).r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})):e[t]||(e[t]={t:"z"}):ec(e,te("number"!=typeof t?t:{r:t,c:r||0}))}function tc(){return{SheetNames:[],Sheets:{}}}function rc(e,t,r,a){var n=1;if(!r)for(;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||65535<=e.SheetNames.length)throw new Error("Too many worksheets");if(a&&0<=e.SheetNames.indexOf(r)){var a=r.match(/(^.*?)(\d+)$/),n=a&&+a[2]||0,o=a&&a[1]||r;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(r=o+n);++n);}if(as(r),0<=e.SheetNames.indexOf(r))throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ac(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}r={encode_col:Qr,encode_row:Yr,encode_cell:te,encode_range:re,decode_col:Zr,decode_row:Vr,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ee,decode_range:ea,format_cell:ra,sheet_add_aoa:na,sheet_add_json:Qs,sheet_add_dom:hs,aoa_to_sheet:oa,json_to_sheet:function(e,t){return Qs(null,e,t)},table_to_sheet:fs,table_to_book:function(e,t){return aa(fs(e,t),t)},sheet_to_csv:Ys,sheet_to_txt:Zs,sheet_to_json:Js,sheet_to_html:ds,sheet_to_formulae:function(e){var t,r="",a="";if(null==e||null==e["!ref"])return[];for(var n,o=ae(e["!ref"]),s=[],c=[],l=Array.isArray(e),i=o.s.c;i<=o.e.c;++i)s[i]=Qr(i);for(var u=o.s.r;u<=o.e.r;++u)for(n=Yr(u),i=o.s.c;i<=o.e.c;++i)if(r=s[i]+n,a="",void 0!==(t=l?(e[u]||[])[i]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;a=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)a=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)a=""+t.v;else if("b"==t.t)a=t.v?"TRUE":"FALSE";else if(void 0!==t.w)a="'"+t.w;else{if(void 0===t.v)continue;a="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=r+"="+a}return c},sheet_to_row_object_array:Js,sheet_get_cell:ec,book_new:tc,book_append_sheet:rc,book_set_sheet_visibility:function(e,t,r){switch(e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]),t=function(e,t){if("number"==typeof t){if(0<=t&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"!=typeof t)throw new Error("Cannot find sheet |"+t+"|");if(-1<(e=e.SheetNames.indexOf(t)))return e;throw new Error("Cannot find sheet name |"+t+"|")}(e,t),e.Workbook.Sheets[t]||(e.Workbook.Sheets[t]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[t].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:ac,cell_set_internal_link:function(e,t,r){return ac(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,a){for(var n="string"!=typeof t?t:ae(t),o="string"==typeof t?t:re(t),s=n.s.r;s<=n.e.r;++s)for(var c=n.s.c;c<=n.e.c;++c){var l=ec(e,s,c);l.t="n",l.F=o,delete l.v,s==n.s.r&&c==n.s.c&&(l.f=r,a)&&(l.D=!0)}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};"undefined"!=typeof parse_xlscfb&&(e.parse_xlscfb=parse_xlscfb),e.parse_zip=Os,e.read=Ls,e.readFile=Bs,e.readFileSync=Bs,e.write=Xs,e.writeFile=Gs,e.writeFileSync=Gs,e.writeFileAsync=function(e,t,r,a){var n=r||{};return n.type="file",n.file=e,Ks(n),n.type="buffer",a instanceof Function||(a=r),gt.writeFile(e,Xs(t,n),a)},e.utils=r,e.writeXLSX=Hs,e.writeFileXLSX=function(e,t,r){return(r=r||{}).type="file",r.file=t,Ks(r),Hs(e,r)},e.SSF=Ve,"undefined"!=typeof __stream&&(e.stream=__stream),void 0!==z&&(e.CFB=z),"undefined"!=typeof require&&{}.Readable&&set_readable((void 0).Readable)}if("undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define("xlsx",function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX}):make_xlsx_lib(XLSX),"undefined"!=typeof window&&!window.XLSX)try{window.XLSX=XLSX}catch(e){}